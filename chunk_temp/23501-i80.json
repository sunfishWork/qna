[
  {
    "id": "23501-i80_chunk_1",
    "document_id": "23501-i80",
    "chunk_id": 1,
    "text": "Contents Foreword 22 1 Scope 23 2 References 23 3 Definitions and abbreviations 30 31 Definitions 30 32 Abbreviations 37 4 Architecture model and concepts 41 41 General concepts 41 42 Architecture reference model 41 421 General 41 422 Network Functions and entities 42 423 Non-roaming reference architecture 43 424 Roaming reference architectures 46 425 Data Storage architectures 50 425a Radio Capabilities Signalling optimisation 52 426 Service-based interfaces 52 427 Reference points 53 428 Support of non-3GPP access 56 4280 General 56 4281 General Concepts to Support Trusted and Untrusted Non-3GPP Access 56 4281A General Concepts to support Wireline Access 57 4282 Architecture Reference Model for Trusted and Untrusted Non-3GPP Accesses 58 42821 Non-roaming Architecture 58 42822 LBO Roaming Architecture 59 42823 Home-routed Roaming Architecture 62 4283 Reference Points for Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2",
    "document_id": "23501-i80",
    "chunk_id": 2,
    "text": "Access 64 42831 Overview 64 42832 Requirements on Ta 64 4284 Architecture Reference Model for Wireline Access network 65 4285 Access to 5GC from devices that do not support 5GC NAS over WLAN access 66 42851 General 66 42852 Reference Architecture 67 42853 Network Functions 67 42854 Reference Points 67 429 Network Analytics architecture 68 4210 Architecture Reference Model for ATSSS Support 68 4211 Architecture for 5G multicast-broadcast services 70 4212 Architecture for Proximity based Services ProSe in 5GS 70 4213 Architecture enhancements for Edge Computing 70 4214 Architecture for Support of Uncrewed Aerial Systems connectivity identification and tracking 70 4215 Architecture to support WLAN connection using 5G credentials without 5GS registration 70 4216 Architecture to support User Plane Information Exposure via a service-based interface 74 4217 Architecture for Ranging based services and Sidelink Positioning 74 43 Interworking with EPC 75 431 Non-roaming architecture 75 432 Roaming architecture 75 433 Interworking between 5GC via non-3GPP access and E-UTRAN connected to EPC 77 4331 Non-roaming architecture 77 4332 Roaming architecture 78 434 Interworking between ePDG connected to EPC and 5GS 80 4341 Non-roaming architecture 80 4342 Roaming architectures 81 435 Service Exposure in Interworking Scenarios 83 4351 Non-roaming architecture 83 4352 Roaming architectures 84 44 Specific services 85 441 Public Warning System 85 442 SMS over NAS 85 4420 General 85 4421 Architecture to support SMS over NAS 85 4422 Reference point to support SMS over NAS 87 4423 Service based interface to support SMS over NAS 87 443 IMS support 87 444 Location services 88 4441 Architecture to support Location Services 88 4442 Reference point to support Location Services 88 4443 Service Based Interfaces to support Location Services 88 445 Application Triggering Services 88 446 5G LAN-type Services 88 4461 User plane architecture to support 5G LAN-type service 88 4462 Reference points to support 5G LAN-type service 89 447 MSISDN-less MO SMS Service 89 448 Architecture to enable Time Sensitive Communication Time Synchronization and Deterministic Networking 89 4481 General 89 4482 Architecture to support IEEE Time Sensitive Networking 90 4483 Architecture for AF requested support of Time Sensitive Communication and Time Synchronization 91 4484 Architecture to support IETF Deterministic Networking 91 5 High level features 92 51 General 92 52 Network Access Control 93 521 General 93 522 Network selection 93",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_3",
    "document_id": "23501-i80",
    "chunk_id": 3,
    "text": "522a Void 93 523 Identification and authentication 93 524 Authorisation 93 525 Access control and barring 93 526 Policy control 94 527 Lawful Interception 94 53 Registration and Connection Management 94 531 General 94 532 Registration Management 94 5321 General 94 5322 5GS Registration Management states 95 53221 General 95 53222 RM-DEREGISTERED state 95 53223 RM-REGISTERED state 95 53224 5GS Registration Management State models 96 5323 Registration Area management 96 5324 Support of a UE registered over both 3GPP and Non-3GPP access 98 533 Connection Management 99 5331 General 99 5332 5GS Connection Management states 100 53321 General 100 53322 CM-IDLE state 100 53323 CM-CONNECTED state 100 53324 5GS Connection Management State models 101 53325 CM-CONNECTED with RRC_INACTIVE state 101 5333 NAS signalling connection management 104 53331 General 104 53332 NAS signalling connection establishment 104 53333 NAS signalling connection Release 104 5334 Support of a UE connected over both 3GPP and Non-3GPP access 104 534 UE Mobility 105 5341 Mobility Restrictions 105 53411 General 105 53412 Management of Service Area Restrictions 108 5342 Mobility Pattern 109 5343 Radio Resource Management functions 109 53431 General 109 53432 Preferred bands per data radio bearers 110 53433 Redirection to dedicated frequency bands for an S-NSSAI 110 53434 Network Slice based cell reselection and Random Access 111 5344 UE mobility event notification 112 535 Triggers for network analytics 113 54 3GPP access specific aspects 114 541 UE reachability in CM-IDLE 114 5411 General 114 5412 UE reachability allowing mobile terminated data while the UE is CM-IDLE 115 5413 Mobile Initiated Connection Only MICO mode 115 5414 Support of Unavailability Period 116 542 UE reachability in CM-CONNECTED 118 543 Paging strategy handling 118 5431 General 118 5432 Paging Policy Differentiation 118 5433 Paging Priority 119 544 UE Radio Capability handling 119 5441 UE radio capability information storage in the AMF 119 5441a UE radio capability signalling optimisation RACS 120 5442",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_4",
    "document_id": "23501-i80",
    "chunk_id": 4,
    "text": "Void 124 5442a UE Radio Capability Match Request 124 5443 Paging assistance information 125 544a UE MM Core Network Capability handling 125 544b UE 5GSM Core Network Capability handling 126 545 DRX Discontinuous Reception framework 127 546 Core Network assistance information for RAN optimization 127 5461 General 127 5462 Core Network assisted RAN parameters tuning 127 5463 Core Network assisted RAN paging information 128 547 NG-RAN location reporting 129 548 Support for identification and restriction of using unlicensed spectrum 129 549 Wake Up Signal Assistance 130 5491 General 130 5492 Group Wake Up Signal 131 5410 Support for identification and restriction of using NR satellite access 131 5411 Support for integrating NR satellite access into 5GS 132 54111 General 132 54112 Support of RAT types defined in 5GC for satellite access 132 54113",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_5",
    "document_id": "23501-i80",
    "chunk_id": 5,
    "text": "Void 132 54114 Verification of UE location 132 54115 Network selection for NR satellite access 133 54116 Support of Mobility Registration Update 133 54117 Tracking Area handling for NR satellite access 133 54118 Support for mobility Forbidden Area and Service Area Restrictions for NR satellite access 133 5412 Paging Early Indication with Paging Subgrouping Assistance 134 54121 General 134 54122 Core Network Assistance for PEIPS 134 5413 Support of discontinuous network coverage for satellite access 135 54130 General 135 54131 Mobility Management and Power Saving Optimization 135 54132 Coverage availability information provisioning to the UE 136 54133 Coverage availability information provisioning to the AMF 136 54134 Paging 136 54135 Overload control 136 55 Non-3GPP access specific aspects 137 550 General 137 551 Registration Management 137 552 Connection Management 138 553 UE Reachability 139 5531 UE reachability in CM-IDLE 139 5532 UE reachability in CM-CONNECTED 139 56 Session Management 140 561 Overview 140 562 Interaction between AMF and SMF 143 563",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_6",
    "document_id": "23501-i80",
    "chunk_id": 6,
    "text": "Roaming 145 564 Single PDU Session with multiple PDU Session Anchors 145 5641 General 145 5642 Usage of an UL Classifier for a PDU Session 146 5643 Usage of IPv6 multi-homing for a PDU Session 148 565 Support for Local Area Data Network 149 565a Supporting LADN per DNN and S-NSSAI 151 566 Secondary authenticationauthorization by a DN-AAA server during the establishment of a PDU Session 152 567 Application Function influence on traffic routing 154 5671 General 154 5672 Enhancement of UP path management based on the coordination with AFs 164 568 Selective activation and deactivation of UP connection of existing PDU Session 165 569 Session and Service Continuity 166 5691 General 166 5692 SSC mode 166 56921 SSC Mode 1 166 56922 SSC Mode 2 166 56923 SSC Mode 3 167 5693 SSC mode selection 167 5610 Specific aspects of different PDU Session types 168 56101 Support of IP PDU Session type 168 56102 Support of Ethernet PDU Session type 168 56103 Support of Unstructured PDU Session type 170 56104 Maximum Transfer Unit size considerations 171 5611 UE presence in Area of Interest reporting usage by SMF 171 5612 Use of Network Instance 173 5613 Always-on PDU session 173 5614 Support of Framed Routing 174 5615 Triggers for network analytics 174 5616 Support for Service Function Chaining 175 56161 General 175 56162 Application Function influence on Service Function Chaining 175 57 QoS model 176 571 General Overview",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_7",
    "document_id": "23501-i80",
    "chunk_id": 7,
    "text": "176 5711 QoS Flow 176 5712 QoS Profile 177 5712a Alternative QoS Profile 178 5713 Control of QoS Flows 178 5714 QoS Rules 178 5715 QoS Flow mapping 179 5716 DL traffic 181 5717 UL Traffic 181 5718 AMBRMFBR enforcement and rate limitation 182 5719 Precedence Value 182 57110 UE-Slice-MBR enforcement and rate limitation 182 57111 QoS aspects of home-routed roaming 183 572 5G QoS Parameters 184 5721 5QI 184 5722 ARP 184 5723 RQA 184 5724 Notification control 185 57241 General 185 57241a Notification Control without Alternative QoS Profiles 185 57241b Notification control with Alternative QoS Profiles 186 57242 Usage of Notification control with Alternative QoS Profiles at handover 186 57243 Usage of Notification control with Alternative QoS Profiles during QoS Flow establishment and modification 187 5725 Flow Bit Rates 187 5726 Aggregate Bit Rates 188 5727 Default values 188 5728 Maximum Packet Loss Rate 189 5729 Wireline access network specific 5G QoS parameters 189 573 5G QoS characteristics 189 5731 General 189 5732 Resource Type 190 5733 Priority Level 190 5734 Packet Delay Budget 190 5735 Packet Error Rate 191 5736",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_8",
    "document_id": "23501-i80",
    "chunk_id": 8,
    "text": "Averaging Window 191 5737 Maximum Data Burst Volume 192 574 Standardized 5QI to QoS characteristics mapping 192 575 Reflective QoS 197 5751 General 197 5752 UE Derived QoS Rule 198 5753 Reflective QoS Control 199 576 Packet Filter Set 200 5761 General 200 5762 IP Packet Filter Set 200 5763 Ethernet Packet Filter Set 201 577 PDU Set QoS Parameters 201 5771 General 201 5772 PDU Set Delay Budget 201 5773 PDU Set Error Rate 202 5774 PDU Set Integrated Handling Information 202 58 User Plane Management 202 581 General 202 582 Functional Description 203 5821 General 203 5822 UE IP Address Management 203 58221 General 203 58222 Routing rules configuration 205 58223",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_9",
    "document_id": "23501-i80",
    "chunk_id": 9,
    "text": "The procedure of Stateless IPv6 Address Autoconfiguration 206 58224 IPv6 Prefix Delegation via DHCPv6 206 5823 Management of CN Tunnel Info 207 58231 General 207 58232 Void 207 58233 Management of CN Tunnel Info in the UPF 207 5824 Traffic Detection 207 58241 General 207 58242 Traffic Detection Information 207 5825 Control of User Plane Forwarding 208 58251 General 208 58252 Data forwarding between the SMF and UPF 208 58253 Support of Ethernet PDU Session type 209 5826 Charging and Usage Monitoring Handling 210 58261 General 210 58262 Activation of Usage Reporting in UPF 210 58263 Reporting of Usage Information towards SMF 211 5827 PDU Session and QoS Flow Policing 211 5828 PCC Related Functions 211 58281 ActivationDeactivation of predefined PCC rules 211 58282 Enforcement of Dynamic PCC Rules 212 58283 Redirection 212 58284 Support of PFD Management 213 5829 Functionality of Sending of End marker 213 58290",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_10",
    "document_id": "23501-i80",
    "chunk_id": 10,
    "text": "Introduction 213 58291 UPF Constructing the End marker Packets 213 58292 SMF Constructing the End marker Packets 214 58210 UP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_11",
    "document_id": "23501-i80",
    "chunk_id": 11,
    "text": "Tunnel Management 214 58211 Parameters for N4 session management moved 214 58212 Reporting of the UE MAC addresses used in a PDU Session 215 58213 Support for 5G VN group communication 215 582130 General 215 582131 Support for unicast traffic forwarding of a 5G VN 216 582132 Support for unicast traffic forwarding update due to UE mobility 217 582133 Support for user plane traffic replication in a 5G VN 217 58214 Inter PLMN User Plane Security functionality 219 58215 Void 220 58216 Support for L2TP tunnelling on N6 220 58217 Data exposure via Service Based interface 220 58218 QoS Flow related QoS monitoring and reporting 221 58219 Explicit Buffer Management 221 582191 General 221 582192 Buffering at UPF 222 582193 Buffering at SMF 222 58220 SMF Pause of Charging 223 583 Explicit Buffer Management moved 223 584 SMF Pause of Charging moved 223 585 Parameters for N4 session management 223 5851",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_12",
    "document_id": "23501-i80",
    "chunk_id": 12,
    "text": "General 223 5852 N4 Session Context 224 5853 Packet Detection Rule 224 5854 QoS Enforcement Rule 227 5855 Usage Reporting Rule 230 5856 Forwarding Action Rule 233 5857 Usage Report generated by UPF 236 5858 Multi-Access Rule 237 5859 BridgeRouter Information 238 58510 Void 238 58511 Session Reporting Rule 239 58512 Session reporting generated by UPF 239 58513 Void 240 58514 TSC Management Information 240 58515 Downlink Data Report generated by UPF 240 59 Identifiers 241 591 General 241 592 Subscription Permanent Identifier 241 592a Subscription Concealed Identifier 241 593 Permanent Equipment Identifier 241 594 5G Globally Unique Temporary Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_13",
    "document_id": "23501-i80",
    "chunk_id": 13,
    "text": "242 595 AMF Name 243 596 Data Network Name DNN 243 597 Internal-Group Identifier 243 598 Generic Public Subscription Identifier 243 599 AMF UE NGAP ID 243 5910 UE Radio Capability ID 244 510 Security aspects 244 5101 General 244 5102 Security Model for non-3GPP access 244 51021 Signalling Security 244 5103 PDU Session User Plane Security 245 511 Support for Dual Connectivity Multi-Connectivity 247 5111 Support for Dual Connectivity 247 512",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_14",
    "document_id": "23501-i80",
    "chunk_id": 14,
    "text": "Charging 248 5121 General 248 5122 Usage Data Reporting for Secondary RAT 248 5123 Secondary RAT Periodic Usage Data Reporting Procedure 249 513 Support for Edge Computing 249 514 Policy Control 250 515 Network slicing 250 5151 General 250 5152 Identification and selection of a Network Slice the S-NSSAI and the NSSAI 251 51521 General 251 51522 Standardised SST values 252 5153 Subscription aspects 253 5154 UE NSSAI configuration and NSSAI storage aspects 254 51541 General 254 515411 UE Network Slice configuration 254 515412 Mapping of S-NSSAIs values in the Allowed NSSAI and in the Requested NSSAI to the S-NSSAIs values used in the HPLMN 257 51542 Update of UE Network Slice configuration 257 5155 Detailed Operation Overview 258 51551 General 258 51552 Selection of a Serving AMF supporting the Network Slices 258 515521 Registration to a set of Network Slices 258 515522 Modification of the Set of Network Slices for a UE 263 515523 AMF Re-allocation due to Network Slices Support 265 51553 Establishing a PDU Session in a Network Slice 265 5156 Network Slicing Support for Roaming 267 5157 Network slicing and Interworking with EPS 268 51571 General 268 51572 Idle mode aspects 268 51573 Connected mode aspects 269 51574 Support of Network Slice usage control and Interworking with EPC 269 5158 Configuration of Network Slice support and availability in a PLMN 269 5159 Operator-controlled inclusion of NSSAI in Access Stratum Connection Establishment 270 51510 Network Slice-Specific Authentication and Authorization 271 51511 Network Slice Admission Control 272 515110 General 272 515111 Network Slice Admission Control for maximum number of UEs 274 5151111",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_15",
    "document_id": "23501-i80",
    "chunk_id": 15,
    "text": "Non-Hierarchical NSAC architecture 274 5151112 Hierarchical NSAC architecture 274 5151113 Centralized NSAC architecture 276 515112 Network Slice Admission Control for maximum number of PDU sessions 276 5151121 Non- Hierarchical NSAC architecture 276 5151122 Hierarchical NSAC architecture 276 5151123 Centralized NSAC architecture 277 515113 Network Slice Admission Control for Roaming 277 5151130 General 277 5151131 VPLMN NSAC Admission Mode 277 5151132 VPLMN with HPLMN assistance NSAC Admission 278 5151133 HPLMN NSAC Admission Mode 278 515114 Network Slice status notifications and reports to a consumer NF 278 515115 Support of Network Slice Admission Control and Interworking with EPC 279 515115a Support of Network Slice Admission Control in 5GS for maximum number of UEs with at least one PDU SessionPDN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_16",
    "document_id": "23501-i80",
    "chunk_id": 16,
    "text": "Connection 281 51512 Support of subscription-based restrictions to simultaneous registration of network slices 282 515121 General 282 515122 UE and UE configuration aspects 282 51513 Support of data rate limitation per Network Slice for a UE 283 51514 Network Slice AS Groups support 284 51515 Support of Network Slice usage control 284 515151 General 284 515152 UE Configuration of network-controlled Slice Usage Policy 285 515153 Network-based per UE Network Slice usage behaviour control 286 51516 Optimized handling of temporarily available network slices 287 51517 Partial Network Slice support in a Registration Area 288 51518 Support for Network Slices with Network Slice Area of Service not matching deployed Tracking Areas 291 515181 General 291 515182 S-NSSAI location availability information 291 515183 Network based monitoring and enforcement of Network Slice Area of Service not matching deployed Tracking Areas 292 51519 Support of Network Slice Replacement 293 51520 Support of Network Slice Instance Replacement 296 516 Support for specific services 296 5161 Public Warning System 296 5162 SMS over NAS 296 51621 General 296 51622 SMS over NAS transport 297 5163 IMS support 297 51631",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_17",
    "document_id": "23501-i80",
    "chunk_id": 17,
    "text": "General 297 51632 IMS voice over PS Session Supported Indication over 3GPP access 297 51632a IMS voice over PS Session Supported Indication over non-3GPP access 298 51633 Homogeneous support for IMS voice over PS Session supported indication 298 51634 P-CSCF address delivery 299 51635 Domain selection for UE originating sessions calls 299 51636 Terminating domain selection for IMS voice 300 51637 UEs usage setting 300 51638 Domain and Access Selection for UE originating SMS 300 516381 UE originating SMS for IMS Capable UEs supporting SMS over IP 300 516382 Access Selection for SMS over NAS 300 51639 SMF support for P-CSCF restoration procedure 301 516310 IMS Voice Service via EPS Fallback or RAT fallback in 5GS 301 516311 P-CSCF discovery and selection 301 516312 HSS discovery and selection 302 5164 Emergency Services 302 51641 Introduction 302 51642 Architecture Reference Model for Emergency Services 305 51643 Mobility Restrictions and Access Restrictions for Emergency Services 305 51644 Reachability Management 306 51645 SMF and UPF selection function for Emergency Services 306 51646 QoS for Emergency Services 306 51647 PCC for Emergency Services 306 51648 IP Address Allocation 306 51649 Handling of PDU Sessions for Emergency Services 306 51649a Handling of PDU Sessions for normal services for Emergency Registered UEs 307 516410 Support of eCall Only Mode 307 516411 Emergency Services Fallback 307 5165 Multimedia Priority Services 308 5166 Mission Critical Services 310 517 Interworking and Migration 311 5171 Support for Migration from EPC to 5GC 311 51711 General 311 51712 User Plane management to support interworking with EPS 313 51713 QoS handling for home routed roaming 313 5172 Interworking with EPC 313 51721 General 313 51722 Interworking Procedures with N26 interface 317 517221 General 317 517222 Mobility for UEs in single-registration mode 318 51723 Interworking Procedures without N26 interface 319 517231 General 319 517232 Mobility for UEs in single-registration mode 320 517233 Mobility for UEs in dual-registration mode 320 517234 Redirection for UEs in connected state 322 51724 Mobility between 5GS and GERANUTRAN 322 51725 Secondary DN authentication and authorization in EPS Interworking case 323 5173 Interworking with EPC in presence of Non-3GPP PDU Sessions 323 5174 Network sharing support and interworking between EPS and 5GS 324 5175 Service Exposure in Interworking Scenarios 324 51751 General 324 51752 Support of interworking for Monitoring Events 325 517521 Interworking with N26 interface 325 517522 Interworking without N26 interface 325 51753 Availability or expected level of a service API 325",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_18",
    "document_id": "23501-i80",
    "chunk_id": 18,
    "text": "5176 Void 326 5177 Configuration Transfer Procedure between NG-RAN and E-UTRAN 326 51771 Architecture Principles for Configuration Transfer between NG-RAN and E-UTRAN 326 51772 Addressing routing and relaying 327 517721 Addressing 327 517722 Routing 327 517723 Relaying 328 5178 URSP Provisioning in EPS 328 518 Network Sharing 330 5181 General concepts 330 5182 Broadcast system information for network sharing 331 5182a PLMN list and SNPN list handling for network sharing 331 5183 Network selection by the UE 331 5184 Network selection by the network 332 5185 Network Sharing and Network Slicing 333 519 Control Plane Load Control Congestion and Overload Control 333 5191 General 333 5192 TNLA Load Balancing and TNLA Load Re-Balancing 333 5193 AMF Load Balancing 333 5194 AMF Load Re-Balancing 333 5195 AMF Control Of Overload 334 51951 General 334 51952 AMF Overload Control 334 5196 SMF Overload Control 335 5197 NAS level congestion control 335 51971 General 335 51972 General NAS level congestion control 336 51973 DNN based congestion control 337 51974 S-NSSAI based congestion control 338 51975 Group specific NAS level congestion control 340 51976 Control Plane data specific NAS level congestion control 340 520 External Exposure of Network Capability 341 520a Data Collection from an AF 342 520b Support exposure of DNN and S-NSSAI specific Group Parameters 343 520b1 Group attribute provisioning 343 520b2 Support LADN service area for a group 343 520b3 Support QoS for a group 343 520b4 Void 343 520b5 Void 343 520c Provisioning of traffic characteristics and monitoring of performance characteristics for a group 344 520d User Plane Direct 5GS Information Exposure 344 520d1 General 344 521 Architectural support for virtualized deployments 345 5210 General 345 5211 Architectural support for N2 345 52111 TNL associations 345 52112 NGAP UE-TNLA-binding 346 52113 N2 TNL association selection 346 5212 AMF Management 346 52121 AMF AdditionUpdate 346 52122 AMF planned removal procedure 347 521221 AMF planned removal procedure with UDSF deployed 347 521222 AMF planned removal procedure without UDSF 348 52123 Procedure for AMF Auto-recovery 350 5213 Network Reliability support with Sets 351 52131 General 351 52132 NF Set and NF Service Set 352 52133 Reliability of NF instances within the same NF Set 352 52134 Reliability of NF Services 352 5214 Network FunctionNF Service Context Transfer 352 52141 General 352 522 System Enablers for priority mechanism 353 5221 General 353 5222 Subscription-related Priority Mechanisms 353 5223 Invocation-related Priority Mechanisms 354 5224 QoS Mechanisms applied to established QoS Flows 355 523 Supporting for Asynchronous Type Communication 356 524 3GPP PS Data Off 356 525 Support of OAM Features 357 5251 Support of Tracing Signalling",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_19",
    "document_id": "23501-i80",
    "chunk_id": 19,
    "text": "Based ActivationDeactivation of Tracing 357 5252 Support of OAM-based 5G VN group management 358 5253 Signalling Based Activation of QoE Measurement Collection 358 526 Configuration Transfer Procedure 358 5261 Architecture Principles for Configuration Transfer 358 5262 Addressing routing and relaying 359 52621 Addressing 359 52622 Routing 359 52623 Relaying 359 527 Enablers for Time Sensitive Communications Time Synchronization and Deterministic Networking 359 5270 General 359 5271 Time Synchronization 360 52711 General 360 52712 Distribution of timing information 361 527121 Distribution of 5G internal system clock 361 527122 Distribution of grandmaster clock and time-stamping 361 52713 Support for multiple gPTP domains 364 52714 DS-TT and NW-TT Time Synchronization functionality 365 52715 Detection of gPTP Sync and Announce timeouts 366 52716 Distribution of Announce messages and best master clock selection 366 52717 Support for PTP grandmaster function in 5GS 367 52718 Exposure of Time Synchronization 367 52719 Support for derivation of Uu time synchronization error budget 369 527110 Support for coverage area filters for time synchronization service 369 527111 Controlling time synchronization service based on the Subscription 370 527112 Support for network timing synchronization status monitoring 373 5271a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_20",
    "document_id": "23501-i80",
    "chunk_id": 20,
    "text": "Periodic deterministic communication 376 5272 TSC Assistance Information TSCAI and TSC Assistance Container TSCAC 377 52721 General 377 52722 TSC Assistance Container determination based on PSFP 378 52723 TSC Assistance Container determination by TSCTSF 379 52724 TSCAI determination based on TSC Assistance Container 380 52725 RAN feedback for Burst Arrival Time offset and adjusted Periodicity 381 527251 Overview 381 527252 Proactive RAN feedback for adaptation of Burst Arrival Time and Periodicity 381 527253 Reactive RAN feedback for Burst Arrival Time adaptation 382 5273 Support for TSC QoS Flows 382 5274 Hold and Forward Buffering mechanism 383 5275 5G System Bridge delay 383 528 Support of integration with TSN Time Sensitive Communications Time Synchronization and Deterministic Networking 384 5280 General 384 5281 5GS bridge management for TSN 384 5282 5GS Bridge configuration for TSN 386 5283 Port and user plane node management information exchange in 5GS 388 52831 General 388 52832 Transfer of port or user plane node management information 389 52833 VLAN Configuration Information for TSN 390 5284 QoS mapping tables for TSN 390 5285 Support of integration with IETF Deterministic Networking 392 52851 General 392 52852 5GS DetNet node reporting 392 52853 DetNet node configuration mapping in 5GS 393 528a Support for TSN enabled Transport Network 394 528a1 General 394 528a2 Transfer of TL-Container between SMFCUC and AN-TL and CN-TL 394 528a3 Topology Information for TSN TN 395 529 Support for 5G LAN-type service 395 5291 General 395 5292 5G VN group management 396 5293 PDU Session management 397 5294 User Plane handling 398 530 Support for non-public networks 399 5301 General 399 5302 Stand-alone Non-Public Networks 400 53020 General 400 53021 Identifiers 400 53022 Broadcast system information 401 53023 UE configuration and subscription aspects 402 53024 Network selection in SNPN access mode 404 530241 General 404 530242 Automatic network selection 405 530243 Manual network selection 407 53025 Network access control 407 53026 Cell re-selection in SNPN access mode 407 53027 Access to PLMN services via stand-alone non-public networks 407 53028 Access to stand-alone non-public network services via PLMN 408 53029 SNPN connectivity for UEs with credentials owned by Credentials Holder 408 530291 General 408 530292 Credentials Holder using AAA Server for primary authentication and authorization 409 530293 Credentials Holder using AUSF and UDM for primary authentication and authorization 410 530210 Onboarding of UEs for SNPNs 411 5302101",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_21",
    "document_id": "23501-i80",
    "chunk_id": 21,
    "text": "General 411 5302102 Onboarding Network is an SNPN 411 5302103 Onboarding Network is a PLMN 416 5302104 Remote Provisioning of UEs in Onboarding Network 416 530211 UE Mobility support for SNPN 418 530212 Access to SNPN services via Untrusted non-3GPP access 419 530213 Access to SNPN services via Trusted non-3GPP access 420 530214 Access to SNPN services via wireline access network 421 530215 Access to SNPN services for N5CW devices 421 5303 Public Network Integrated NPN 421 53031",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_22",
    "document_id": "23501-i80",
    "chunk_id": 22,
    "text": "General 421 53032 Identifiers 422 53033 UE configuration subscription aspects and storage 422 53034 Network and cell re-selection and access control 423 53035 Support of emergency services in CAG cells 425 531 Support for Cellular IoT 425 5311 General 425 5312 Preferred and Supported Network Behaviour 425 5313 Selection steering and redirection between EPS and 5GS 426 5314 Control Plane CIoT 5GS Optimisation 427 53141 General 427 53142 Establishment of N3 data transfer during Data Transport in Control Plane CIoT 5GS Optimisation 428 53143 Control Plane Relocation Indication procedure 428 5315 Non-IP Data Delivery NIDD 428 5316 Reliable Data Service 429 5317 Power Saving Enhancements 430 53171 General 430 53172 Extended Discontinuous Reception DRX for CM-IDLE and CM-CONNECTED with RRC-INACTIVE 430 531721 Overview 430 531722 Paging for extended idle mode DRX in E-UTRA and NR connected to 5GC 432 531723 Paging for a UE registered in a tracking area with heterogeneous support of extended idle mode DRX 433 531724 Paging for extended DRX for RRC_INACTIVE in NR connected to 5GC 433 53173 MICO mode with Extended Connected Time 433 53174 MICO mode with Active Time 434 53175 MICO mode and Periodic Registration Timer Control 434 5318 High latency communication 435 5319 Support for Monitoring Events 436 53110 NB-IoT UE Radio Capability Handling 436 53111 Inter-RAT idle mode mobility to and from NB-IoT 436 53112 Restriction of use of Enhanced Coverage 437 53113 Paging for Enhanced Coverage 438 53114 Support of rate control of user data 438 531141 General 438 531142 Serving PLMN Rate Control 438 531143 Small Data Rate Control 439 53115 Control Plane Data Transfer Congestion Control 440 53116 Service Gap Control 440 53117 Inter-UE QoS for NB-IoT 442 53118 User Plane CIoT 5GS Optimisation 442 53119 QoS model for NB-IoT 443 53120 Category M UEs differentiation 443 532 Support for ATSSS 444 5321 General 444 5322 Multi Access PDU Sessions 445 5323 Policy for ATSSS Control 450 5324 QoS Support 450 5325 Access Network Performance Measurements",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_23",
    "document_id": "23501-i80",
    "chunk_id": 23,
    "text": "452 53251 General principles 452 53251a Address of PMF messages 455 53252 Round Trip Time Measurements 456 53252a Packet Loss Rate Measurements 456 53253 Access AvailabilityUnavailability Report 457 53254 Protocol stack for user plane measurements and measurement reports 457 53255 UE Assistance Operation 458 53256 Suspend and Resume Traffic Duplication 459 5326 Support of Steering Functionalities 459 53261 General 459 53262 High-Layer Steering Functionalities 462 532621 MPTCP Functionality 462 532622 MPQUIC Functionality 463 53263 Low-Layer Steering Functionalities 466 532631 ATSSS-LL Functionality 466 5327 Interworking with EPS 466 53271 General 466 53272 Interworking with N26 Interface 467 53273 Interworking without N26 Interface 468 5328",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_24",
    "document_id": "23501-i80",
    "chunk_id": 24,
    "text": "ATSSS Rules 468 533 Support for Ultra Reliable Low Latency Communication 472 5331 General 472 5332 Redundant transmission for high reliability communication 473 53321 Dual Connectivity based end to end Redundant User Plane Paths 473 53322 Support of redundant transmission on N3N9 interfaces 475 53323 Support for redundant transmission at transport layer 477 5333 QoS Monitoring for packet delay 477 53331 General 477 53332 Per QoS Flow per UE QoS Measurement 477 53333 GTP-U Path Measurement 478 534 Support of deployments topologies with specific SMF Service Areas 480 5341 General 480 5342 Architecture 481 53421 SBA architecture 481 53422 Non-roaming architecture 481 53423 Roaming architecture 482 5343 I-SMF selection V-SMF reselection 483 5344 Usage of an UL Classifier for a PDU Session controlled by I-SMF 484 5345 Usage of IPv6 multi-homing for a PDU Session controlled by I-SMF 484 5346 Interaction between I-SMF and SMF for the support of traffic offload by UPF controlled by the I-SMF 485 53461 General 485 53462 N4 information sent from SMF to I-SMF for local traffic offload 486 5347 Event Management 486 53471 UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_25",
    "document_id": "23501-i80",
    "chunk_id": 25,
    "text": "Mobility Event Management 486 53472 SMF event exposure service 487 53473 AMF implicit subscription about events related with the PDU Session 487 5348 Support for Cellular IoT 487 5349 Support of the Deployment Topologies with specific SMF Service Areas feature within and between PLMNs 487 53410 Support for 5G LAN-type service 488 535 Support for Integrated access and backhaul IAB 488 5351 IAB architecture and functional entities 488 5352 5G System enhancements to support IAB 489 5353 Data handling and QoS support with IAB 490 5354 Mobility support with IAB 490 5355 Charging support with IAB 490 5356 IAB operation involving EPC 490 535A Support for Mobile Base Station Relay MBSR 491 535A1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_26",
    "document_id": "23501-i80",
    "chunk_id": 26,
    "text": "General 491 535A2 Configuration of the MBSR 491 535A3 Mobility support of UEs served by MBSR 492 535A31 UE mobility between a fixed cell and MBSR cell 492 535A32 UE mobility between MBSR cells 492 535A33 UE mobility when moving together with a MBSR cell 492 535A34 MBSR mobility 492 535A4 MBSR authorization 493 535A5 Location Service Support of UEs served by MBSR 494 535A6 Providing cell IDTAC of MBSR for services 494 535A7 Control of UE access to MBSR 494 536 RIM Information Transfer 495 537 Support for high data rate low latency services eXtended Reality XR and interactive media services 495 5371 General 495 5372 Policy control enhancements to support multi-modal services 495 5373 Support of ECN marking for L4S to expose the congestion information 496 53731 General 496 53732 Support of ECN marking for L4S in NG-RAN 497 53733 Support of ECN marking for L4S in PSA UPF 497 5374 Network Exposure of 5GS information 497 5375 PDU Set based Handling 498 53751 General 498 53752 PDU Set Information and Identification 500 53753 Non-homogenous support of PDU set based handling in NG-RAN 500 5376 ULDL policy control based on round-trip latency requirement 501 5377 5GS Packet Delay Variation monitoring and reporting 501 53771 General 501 5378 UE power saving management 501 53781 General 501 53782 Periodicity and N6 Jitter Information associated with Periodicity 502 53783 End of Data Burst Indication 502 538 Support for Multi-USIM UE 503 5381 General 503 5382 Connection Release 503 5383 Paging Cause Indication for Voice Service 504 5384 Reject Paging Request 504 5385 Paging Restriction 504 5386 Paging Timing Collision Control 505 539 Remote provisioning of credentials for NSSAA or secondary authenticationauthorization 505 5391 General 505 5392 Configuration for the UE 506 540 Support of Disaster Roaming with Minimization of Service Interruption 506 5401 General 506 5402 UE configuration and provisioning for Disaster Roaming 506 5403 Disaster Condition Notification and Determination 507 5404 Registration for Disaster Roaming service 507 5405 Handling when a Disaster Condition is no longer applicable 508 5406 Prevention of signalling overload related to Disaster Condition and Disaster Roaming service 509 541 NR RedCap and NR eRedCap UEs differentiation 509 542 Support of Non-seamless WLAN offload 510 543 Support for 5G Satellite Backhaul 511 5431 General 511 5432 Edge Computing via UPF deployed on satellite 511 5433 Local switch for UE-to-UE communications via UPF deployed on GEO satellite 512 54331 General 512 54332 Local switch with PSA UPF deployed on satellite 512 54333 Local switching with UL CLBP and local PSA UPF deployed on satellite 512 5434 Reporting of satellite backhaul to SMF 513 5435 QoS monitoring when dynamic Satellite Backhaul is used 513 544 Support of Personal IoT network service 514 5441 General 514 5442 UE policy delivery for PIN 514 5443 Session management enhancement for PIN service support 514 54431 PDU Session Establishment for PIN 514 54432 Session management related policy control 515 54433 Non-3GPP QoS Assistance Information 515 54434 Non-3GPP delay budget between PINE and PEGC 515 5444 Identifiers for PIN 515 545 QoS Monitoring 516 5451 General 516 5452 Packet delay monitoring 517 5453 Congestion information monitoring 517 5454 Data rate monitoring 517 5455 Void 517 546 Assistance to AIML Operations in the Application Layer 517 5461 General 517 5462 Member UE selection assistance functionality for application operation 519 547 Support for Network Controlled Repeater NCR 519 6 Network Functions 520 61 General 520 62 Network Function Functional description 520 621 AMF 520 622 SMF 522 623 UPF 524 624 PCF 525 625 NEF 525 6250 NEF functionality 525 6251 Support for CAPIF 526 625a Void 527",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_27",
    "document_id": "23501-i80",
    "chunk_id": 27,
    "text": "626 NRF 527 6261 General 527 6262 NF profile 527 6263 SCP profile 530 627 UDM 530 628 AUSF 531 629 N3IWF 531 629A TNGF 532 6210 AF 532 6211 UDR 532 6212 UDSF 533 6213 SMSF 533 6214 NSSF 533 6215 5G-EIR 533 6216 LMF 534 6216A GMLC 534 6217 SEPP 534 6218 Network Data Analytics Function NWDAF 534 6219 SCP 535 6220 W-AGF 535 6221 UE radio Capability Management Function UCMF 535 6222 TWIF 536 6223 NSSAAF 536 6224 DCCF 536 6225 MFAF 536 6226 ADRF 537 6227 MB-SMF 537 6227a MB-UPF 537 6227b MBSF 537 6227c MBSTF 537 6228 NSACF 537 6229",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_28",
    "document_id": "23501-i80",
    "chunk_id": 28,
    "text": "TSCTSF 538 6230 5G DDNMF 538 6231 EASDF 538 6232 TSN AF 539 6233 NSWOF 539 63 Principles for Network Function and Network Function Service discovery and selection 539 631 General 539 6310 Principles for Binding Selection and Reselection 540 6311 NF Discovery and Selection aspects relevant with indirect communication 543 6312 Location information 543 632 SMF discovery and selection 543 633 User Plane Function Selection 546 6331 Overview 546 6332 SMF Provisioning of available UPFs 547 6333 Selection of an UPF for a particular PDU Session 547 634 AUSF discovery and selection 548 635 AMF discovery and selection 549 636 N3IWF selection 552 6361 General 552 6362 Stand-alone N3IWF selection 554 6362a SNPN N3IWF selection 555 6363 Combined N3IWFePDG Selection 556 6364 PLMN and non-3GPP access node Selection for emergency services 558 63641 General 558 63642 Stand-alone N3IWF selection 558 63633 Combined N3IWFePDG",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_29",
    "document_id": "23501-i80",
    "chunk_id": 29,
    "text": "Selection 559 637 PCF discovery and selection 560 6370 General principles 560 6371 PCF discovery and selection for a UE or a PDU Session 560 6372 Providing policy requirements that apply to multiple UE and hence to multiple PCF 563 6373 Binding an AF request targeting a UE address to the relevant PCF 563 6374 Binding an AF request targeting a UE to the relevant PCF 563 638 UDM discovery and selection 563 639 UDR discovery and selection 564 6310 SMSF discovery and selection 565 6311 CHF discovery and selection 565 6312 Trusted Non-3GPP Access Network selection 567 63121 General 567 63122 Access Network Selection Procedure 568 6312a Access Network selection for devices that do not support 5GC NAS over WLAN 571 6312a1 General 571 6312a2 Access Network Selection Procedure 571 6312b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_30",
    "document_id": "23501-i80",
    "chunk_id": 30,
    "text": "Access Network selection for 5G NSWO 572 6313 NWDAF discovery and selection 573 6314 NEF Discovery 574 6315 UCMF Discovery and Selection 575 6316 SCP discovery and selection 575 6317 NSSAAF discovery and selection 576 6318 5G-EIR discovery and selection 576 6319 DCCF discovery and selection 576 6320 ADRF discovery and selection 577 6321 MFAF discovery and selection 577 6322 NSACF discovery and selection 577 6323 EASDF discovery and selection 578 6324 TSCTSF Discovery 578 6325 AF Discovery and Selection 579 6326 NRF discovery and selection 579 7 Network Function Services and descriptions 579 71 Network Function Service Framework 579 711 General 579 712 NF Service Consumer - NF Service Producer interactions 580 713 Network Function Service discovery 582 714 Network Function Service Authorization 582 715 Network Function and Network Function Service registration and de-registration 583 72 Network Function Services 583 721 General 583 722 AMF Services 584 723 SMF Services 585 724 PCF Services 585 725 UDM Services 586 726 NRF Services 587 727 AUSF Services 588 728 NEF Services 588 728A Void 591 729 SMSF Services 591 7210 UDR Services 591 7211 5G-EIR Services 592 7212 NWDAF Services 592 7213 UDSF Services 593 7214 NSSF Services 593 7215 BSF Services 594 7216 LMF Services 594 7216A GMLC Services 594 7217 CHF Services 594 7218 UCMF Services 595 7219 AF Services 595 7220 NSSAAF Services 596 7221 DCCF Services 596 7222 MFAF Services 596 7223 ADRF Services 597 7224 5G DDNMF Services 597 7225 EASDF Services 597 7226 TSCTSF Services 597 7227 NSACF Services 598 7228 MB-SMF Services 598 7229 UPF Services 599 73 Exposure 599 8 Control and User Plane Protocol Stacks 599 81 General 599 82 Control Plane Protocol Stacks 599 821 Control Plane Protocol Stacks between the 5G-AN and the 5G Core N2 599 8211 General 599 8212 5G-AN - AMF 600 8213 5G-AN - SMF 601 822 Control Plane Protocol Stacks between the UE and the 5GC 601 8221 General 601 8222 UE - AMF 603 8223 UE SMF 603 823 Control Plane Protocol Stacks between the network functions in 5GC 604 8231 The Control Plane Protocol Stack for the service based interface 604 8232 The Control Plane protocol stack for the N4 interface between SMF and UPF 604 824 Control Plane for untrusted non 3GPP Access 604 825 Control Plane for trusted non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_31",
    "document_id": "23501-i80",
    "chunk_id": 31,
    "text": "Access 605 826 Control Plane for W-5GAN Access 606 827 Control Plane for Trusted WLAN Access for N5CW Device 606 83 User Plane Protocol Stacks 606 831 User Plane Protocol Stack for a PDU Session 606 832 User Plane for untrusted non-3GPP Access 608 833 User Plane for trusted non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_32",
    "document_id": "23501-i80",
    "chunk_id": 32,
    "text": "Access 608 834 User Plane for W-5GAN Access 608 835 User Plane for N19-based forwarding of a 5G VN group 609 836 User Plane for Trusted WLAN Access for N5CW Device 609 Annex A informative Relationship between Service-Based Interfaces and Reference Points 610 Annex B normative Mapping between temporary identities 612 Annex C informative Guidelines and Principles for Compute-Storage Separation 613 Annex D informative 5GS support for Non-Public Network deployment options 614 D1 Introduction 614 D2 Support of Non-Public Network as a network slice of a PLMN 614 D3 Support for access to PLMN services via Stand-alone Non-Public Network and access to Stand-alone Non Public Network services via PLMN 615 D4 Support for UE capable of simultaneously connecting to an SNPN and a PLMN 616 D5 Support for keeping UE in CM-CONNECTED state in overlay network when accessing services via NWu 616 D6 Support for sessionservice continuity between SNPN and PLMN when using N3IWF 617 D7 Guidance for underlay network to support QoS differentiation for User Plane IPsec Child SA 618 D71 Network initiated QoS 618 D72 UE initiated QoS 619 Annex E informative Communication models for NFNF services interaction 621 E1 General 621 Annex F informative Redundant user plane paths based on multiple UEs per device 623 Annex G informative SCP Deployment Examples 626 G1 General 626 G2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_33",
    "document_id": "23501-i80",
    "chunk_id": 33,
    "text": "An SCP based on service mesh 626 G21 Introduction 626 G22 Communication across service mesh boundaries 627 G3 An SCP based on independent deployment units 628 G4 An SCP deployment example based on name-based routing 629 G40 General Information 629 G41 Service Registration and Service Discovery 630 G42 Overview of Deployment Scenario 631 G43 References 631 Annex H normative PTP usage guidelines 632 H1 General 632 H2 Signalling of ingress time for time synchronization 632 H3 Void 632 H4 Path and Link delay measurements 632 Annex I normative TSN usage guidelines 634 I1 Determination of traffic pattern information 634",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_34",
    "document_id": "23501-i80",
    "chunk_id": 34,
    "text": "Annex J informative Link MTU considerations 636 Annex K normative Port and user plane node management information exchange 638 K1 Standardized port and user plane node management information 638 K2 Port and user plane node management information exchange for time synchronization 654 K21 Capability exchange 654 K22 PTP Instance configuration 655 K221 General 655 K222 Configuration for Sync and Announce reception timeouts 656 K223 Configuration for PTP port states 656 K224 Configuration for PTP grandmaster function 657 K225 Configuration for Sync and Announce",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_35",
    "document_id": "23501-i80",
    "chunk_id": 35,
    "text": "intervals 657 K226 Configuration for transport protocols 658 Annex L normative Support of GERANUTRAN access 659 Annex M normative Interworking with TSN deployed in the Transport Network 660 M1 Mapping of the parameters between 5GS and TSN UNI 660 M2 TL-Container Information 664 Annex N informative Support for access to Localized Services 667 N1 General 667 N2 Enabling access to Localized Services 667 N21 General 667 N22 Configuration of network to provide access to Localized Services 668 N23 Session Management aspects 668 N3 Selection of network providing access to Localized Services 668 N4 Enabling the UE access to Localized Services 668 N5 Support for leaving network that provides access to Localized Services 668 N6 Configuration of Credentials Holder for determining SNPN selection information 669 Annex O informative Allowing UE to simultaneously send data to different groups with different QoS policy 671 O1 A PDU Session with multiple QoS Flows for different groups 671 O2 Multiple PDU Sessions for different groups 672 O3 A PDU Session targeting a predefined group formed of multiple sub-groups 673 Annex P informative Personal IoT Networks 675 P1 PIN Reference Architecture 675 P2 Session management and traffic routing for PIN 675 Annex Q informative Satellite coverage availability information 677 Annex R informative Change history 678 Foreword This Technical Specification has been produced by the 3rd Generation Partnership Project 3GPP The contents of the present document are subject to continuing work within the TSG and may change following formal TSG approval Should the TSG modify the contents of the present document it will be re-released by the TSG with an identifying change of release date and an increase in version number as follows Version xyz where x the first digit 1 presented to TSG for information 2 presented to TSG for approval 3 or greater indicates TSG approved document under change control y the second digit is incremented for all changes of substance ie technical enhancements corrections updates etc z the third digit is incremented when editorial only changes have been incorporated in the document 1 Scope The present document defines the Stage 2 system architecture for the 5G System The 5G System provides data connectivity and services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_36",
    "document_id": "23501-i80",
    "chunk_id": 36,
    "text": "This specification covers both roaming and non-roaming scenarios in all aspects including interworking between 5GS and EPS mobility within 5GS QoS policy control and charging authentication and in general 5G System wide features eg SMS Location Services Emergency Services ITU-T Recommendation I130 11 describes a three-stage method for characterisation of telecommunication services and ITU-T Recommendation Q65 12 defines Stage 2 of the method TS 23502 3 contains the stage 2 procedures and flows for 5G System and it is a companion specification to this specification TS 23503 45 contains the stage 2 Policy Control and Charging architecture for 5G System and it is a companion specification to this specification 2 References The following documents contain provisions which through reference in this text constitute provisions of the present document - References are either specific identified by date of publication edition number version number etc or non-specific - For a specific reference subsequent revisions do not apply - For a non-specific reference the latest version applies In the case of a reference to a 3GPP document including a GSM document a non-specific reference implicitly refers to the latest version of that document in the same Release as the present document 1 3GPP TR 21905 Vocabulary for 3GPP Specifications 2 3GPP TS 22261 Service requirements for next generation new services and markets",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_37",
    "document_id": "23501-i80",
    "chunk_id": 37,
    "text": "Stage 1 3 3GPP TS 23502 Procedures for the 5G System Stage 2 4 3GPP TS 23203 Policies and Charging control architecture Stage 2 5 3GPP TS 23040 Technical realization of the Short Message Service SMS Stage 2 6 3GPP TS 24011 Point-to-Point PP Short Message Service SMS support on mobile radio interface Stage 3 7 IETF RFC 7157 IPv6 Multihoming without Network Address Translation 8 IETF RFC 4191 Default Router Preferences and More-Specific Routes 9 IETF RFC 2131 Dynamic Host Configuration Protocol 10 IETF RFC 4862 IPv6 Stateless Address Autoconfiguration 11 ITU-T Recommendation I130 Method for the characterization of telecommunication services supported by an ISDN and network capabilities of an ISDN 12 ITU-T Recommendation Q65",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_38",
    "document_id": "23501-i80",
    "chunk_id": 38,
    "text": "The unified functional methodology for the characterization of services and network capabilities 13 3GPP TS 24301 Non-Access-Stratum NAS protocol for Evolved Packet System EPS Stage 3 14 Void 15 3GPP TS 23228 IP Multimedia Subsystem IMS Stage 2 16 3GPP TS 22173 IMS Multimedia Telephony Service and supplementary services Stage 1 17 3GPP TS 23122 Non-Access-Stratum NAS functions related to Mobile Station in idle mode 18 3GPP TS 23167 3rd Generation Partnership Project Technical Specification Group Services and Systems Aspects IP Multimedia Subsystem IMS emergency sessions 19 3GPP TS 23003 Numbering Addressing and Identification 20 IETF RFC 7542 The Network Access Identifier 21 3GPP TS 23002 Network Architecture 22 3GPP TS 23335 User Data Convergence UDC Technical realization and information flows Stage 2 23 3GPP TS 23221 Architectural requirements 24 3GPP TS 22153 Multimedia priority service 25 3GPP TS 22011 Service Accessibility 26 3GPP TS 23401 General Packet Radio Service GPRS enhancements for Evolved Universal Terrestrial Radio Access Network E-UTRAN access 27 3GPP TS 38300 NR NR and NG-RAN Overall Description 28 3GPP TS 38331 NR Radio Resource Control RRC Protocol Specification 29 3GPP TS 33501 Security architecture and procedures for 5G system 30 3GPP TS 36300",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_39",
    "document_id": "23501-i80",
    "chunk_id": 39,
    "text": "Evolved Universal Terrestrial Radio Access E-UTRA and Evolved Universal Terrestrial Radio Access Network E-UTRAN Overall description Stage 2 31 3GPP TS 37340 Evolved Universal Terrestrial Radio Access E-UTRA and NR Multi-connectivity Stage 2 32 3GPP TS 23214 Architecture enhancements for control and user plane separation of EPC nodes Stage 2 33 3GPP TS 22101 3rd Generation Partnership Project Technical Specification Group Services and Systems Aspects Service aspects Service principles 34 3GPP TS 38413 NG-RAN NG Application Protocol NGAP 35 3GPP TS 33126 Lawful Interception Requirements 36 3GPP TS 23682 Architecture enhancements to facilitate communications with packet data networks and applications 37 3GPP TS 22280 Mission Critical Services Common Requirements MCCoRe Stage 1 38 3GPP TS 23379 Functional architecture and information flows to support Mission Critical Push",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_40",
    "document_id": "23501-i80",
    "chunk_id": 40,
    "text": "To Talk MCPTT Stage 2 39 3GPP TS 23281 Functional architecture and information flows to support Mission Critical Video MCVideo Stage 2 40 3GPP TS 23282 Functional architecture and information flows to support Mission Critical Data MCData Stage 2 41 3GPP TS 32240 Charging management Charging architecture and principles 42 3GPP TS 38401 NG-RAN Architecture description 43 3GPP TS 23402 Architecture enhancements for non-3GPP accesses 44 IETF RFC 4960 Stream Control Transmission Protocol 45 3GPP TS 23503 Policy and Charging Control Framework for the 5G System 46 3GPP TS 23041 Public Warning System 47 3GPP TS 24501 Non-Access-Stratum NAS protocol for 5G System 5GS Stage 3 48 3GPP TS 24502 Access to the 5G System 5GS via non-3GPP access networks Stage 3 49 3GPP TS 29500 5G System Technical Realization of Service Based Architecture Stage 3 50 3GPP TS 38304 NR User Equipment UE procedures in idle mode 51 3GPP TS 36331",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_41",
    "document_id": "23501-i80",
    "chunk_id": 41,
    "text": "Evolved Universal Terrestrial Radio Access E-UTRA Radio Resource Control RRC Protocol specification 52 3GPP TS 36304 Evolved Universal Terrestrial Radio Access E-UTRA User Equipment UE procedures in idle mode 53 Void 54 IETF RFC 4861 Neighbor Discovery for IP version 6 IPv6 55 3GPP TS 23271 Functional stage 2 description of Location Services LCS 56 3GPP TS 23060 General Packet Radio Service GPRS Service description Stage 2 57 IETF RFC 4555 IKEv2 Mobility and Multihoming Protocol MOBIKE 58 3GPP TS 29510 5G System Network function repository services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_42",
    "document_id": "23501-i80",
    "chunk_id": 42,
    "text": "Stage 3 59 3GPP TS 29502 5G System Session Management Services Stage 3 60 IETF RFC 7296 Internet Key Exchange Protocol Version 2 IKEv2 61 3GPP TS 23380 IMS Restoration Procedures 62 3GPP TS 24229 IP multimedia call control protocol based on Session Initiation Protocol SIP and Session Description Protocol SDP Stage 3 63 3GPP TS 23292 IP Multimedia Subsystem IMS centralized services Stage 2 64 3GPP TS 23222 Functional architecture and information flows to support Common API Framework for 3GPP Northbound APIs 65 3GPP TS 29244 Interface between the Control Plane and the User Plane Nodes Stage 3 66 3GPP TS 32421 Telecommunication management Subscriber and equipment trace Trace concepts and requirements 67 3GPP TS 32290 5G system Services operations and procedures of charging using Service Based Interface SBI 68 3GPP TS 32255 5G Data connectivity domain charging Stage 2 69 3GPP TS 38306 NR User Equipment -UE radio access capabilities 70 3GPP TS 36306 Evolved Universal Terrestrial Radio Access -E-UTRA User Equipment -UE radio access capabilities 71 3GPP TS 29518 5G System Access and Mobility Management Services Stage 3 72 Void 73 IETF RFC 2865 Remote Authentication Dial In User Service RADIUS 74 IETF RFC 3162 RADIUS and IPv6 75 3GPP TS 29281 General Packet Radio System GPRS Tunnelling Protocol User Plane GTPv1-U 76 3GPP TS 26238 Uplink streaming 77 3GPP TR 26939 Guidelines on the Framework for Live Uplink Streaming FLUS 78 International Telecommunication Union ITU Standardization Bureau TSB Operational Bulletin",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_43",
    "document_id": "23501-i80",
    "chunk_id": 43,
    "text": "No 1156 retrieved October 5 2018 79 3GPP TS 28533 Management and orchestration Architecture framework 80 3GPP TS 24250 Protocol for Reliable Data Service Stage 3 81 IETF RFC 8684 TCP Extensions for Multipath Operation with Multiple Addresses 82 IETF RFC 8803 0-RTT TCP Convert Protocol 83 IEEE Std 8021CB-2017 IEEE Standard for Local and metropolitan area networks-Frame Replication and Elimination for Reliability 84 3GPP TS 23316 Wireless and wireline convergence access support for the 5G System 5GS 85 WiFi Alliance Technical Committee Hotspot 20 Technical Task Group Hotspot 20 Release 2 Technical Specification 86 3GPP TS 23288 Architecture enhancements for 5G System 5GS to support network data analytics services 87 3GPP TS 23273 5G System 5GS Location Services LCS Stage 2 88 3GPP TS 23216 Single Radio Voice Call Continuity SRVCC Stage 2 89 CableLabs DOCSIS MULPI Data-Over-Cable Service Interface Specifications DOCSIS 31 MAC and Upper Layer Protocols Interface Specification 90 BBF TR-124 issue 5 Functional Requirements for Broadband Residential Gateway Devices 91 BBF TR-101 issue 2 Migration to Ethernet-Based Broadband Aggregation 92 BBF TR-178 issue 1 Multi-service Broadband Network Architecture and Nodal Requirements 93 BBF TR-456 issue 2 AGF Functional Requirements 94 BBF WT-457 FMIF Functional Requirements Editors note The reference to BBF WT-457 will be revised when finalized by BBF 95",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_44",
    "document_id": "23501-i80",
    "chunk_id": 44,
    "text": "Void 96 Void 97 IEEE Std 8021AB-2016 IEEE Standard for Local and metropolitan area networks -- Station and Media Access Control Connectivity Discovery 98 IEEE Std 8021Q-2022 IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks 99 3GPP TS 38423 NG-RAN Xn Application Protocol XnAP 100 3GPP TS 36413 Evolved Universal Terrestrial Radio Access Network E-UTRAN S1 Application Protocol S1AP 101 3GPP TS 29274 Evolved General Packet Radio Service GPRS Tunnelling Protocol for Control plane GTPv2-C Stage 3 102 3GPP TS 23632 User Data Interworking Coexistence and Migration stage 2 103 3GPP TS 29563 5G System 5GS HSS services for interworking with UDM Stage 3 104 IEEE Std 8021AS-2020 IEEE Standard for Local and metropolitan area networks--Timing and Synchronization for Time-Sensitive Applications 105 3GPP TS 22104 Service requirements for cyber-physical control applications in vertical domains 106 IEEE Std 80211-2012 IEEE Standard for Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks - Specific requirements - Part 11 Wireless LAN Medium Access Control MAC and Physical Layer PHY Specifications 107 IEEE Std 1588-2008 IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems 108 3GPP TS 28552 Management and orchestration 5G performance measurements 109 3GPP TS 24193 Access Traffic Steering Switching and Splitting Stage 3 110 3GPP TS 24526 User Equipment UE policies for 5G System 5GS Stage 3 111 3GPP TS 22186 Enhancement of 3GPP support for V2X scenarios Stage 1 112 3GPP TR 38824 Study on physical layer enhancements for NR ultra-reliable and low latency case URLLC 113 IEEE Guidelines for Use of Extended Unique Identifier EUI Organizationally Unique Identifier OUI and Company ID CID 114 3GPP TS 32256 Charging Management 5G connection and mobility domain charging Stage 2 115 3GPP TS 33210 Network Domain Security NDS IP network layer security 116 3GPP TS 38415 PDU Session User Plane Protocol 117 3GPP TS 24535 Device-side Time-Sensitive Networking TSN Translator DS-TT to network-side TSN Translator NW-TT protocol aspects Stage 3 118 3GPP TS 32274 Charging Management Short Message Service SMS charging 119 3GPP TS 23008 Organization of subscriber data 120 3GPP TS 38314 NR Layer 2 measurements 121 3GPP TS 23287 Architecture enhancements for 5G System 5GS to support Vehicle-to-Everything V2X services 122 3GPP TS 29503 5G System Unified Data Management Services Stage 3 123 3GPP TS 32254 Charging management Exposure function Northbound Application Program Interfaces APIs charging 124 3GPP TS 33535 Authentication and Key Management for Applications based on 3GPP credentials in the 5G System 5GS 125 3GPP TS 38410 NG-RAN NG general aspects and principles 126 IEEE Std 1588 IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems Edition 2019 127 ST 2059-22015 SMPTE Standard - SMPTE Profile for Use of IEEE-1588 Precision Time Protocol in Professional Broadcast Applications 128 3GPP TS 23304 Proximity based Services ProSe in the 5G System 5GS 129 3GPP TS 23247 Architectural enhancements for 5G multicast-broadcast services 130 3GPP TS 23548 5G System Enhancements for Edge Computing Stage 2 131 IEEE Std 8023",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_45",
    "document_id": "23501-i80",
    "chunk_id": 45,
    "text": "Ethernet 132 3GPP TS 29561 5G System Interworking between 5G Network and external Data Networks Stage 3 133 3GPP TS 29513 Policy and Charging Control signalling flows and QoS parameter mapping Stage 3 134 3GPP TS 23558 Architecture for enabling Edge Applications EA 135 3GPP TS 26501 5G Media Streaming 5GMS General description and architecture 136 3GPP TS 23256 Support of Uncrewed Aerial Systems UAS connectivity identification and tracking Stage 2 137 GSMA NG116 Generic Network Slice Template 138 IETF RFC 3948 UDP Encapsulation of IPsec ESP Packets 139 3GPP TS 24539 5G System 5GS Network to TSN translator TT protocol aspects Stage",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_46",
    "document_id": "23501-i80",
    "chunk_id": 46,
    "text": "3 140 3GPP TS 33220 Generic Authentication Architecture GAA Generic bootstrapping architecture 141 3GPP TS 33223 Generic Authentication Architecture GAA Generic Bootstrapping Architecture GBA Push function 142 3GPP TS 23540 Technical realization of Service Based Short Message Service Stage 2 143 3GPP TS 38321 NR Medium Access Control MAC protocol specification 144 3GPP TS 29525 5G System UE Policy Control Service Stage 3 145 3GPP TS 29505 5G System Usage of the Unified Data Repository Services for Subscription Data Stage 3 146 IEEE Std 8021Qdj-2024 IEEE Draft Standard for Local and metropolitan area networks - Bridges and Bridged Networks - Amendment XX Configuration Enhancements for Time-Sensitive Networking 147 Void 148 3GPP TS 28557 Management and orchestration Management of Non-Public Networks NPN 149 3GPP TS 28541 Management and orchestration 5G Network Resource Model NRM 150 IETF RFC 8655 Deterministic Networking Architecture 151 IETF RFC 8343",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_47",
    "document_id": "23501-i80",
    "chunk_id": 47,
    "text": "A YANG Data Model for Interface Management 152 IETF RFC 8344 A YANG Data Model for IP Management 153 IETF RFC 7224 IANA Interface Type YANG Module 154 IETF draft-ietf-detnet-yang Deterministic Networking DetNet YANG Model Editors note The reference to draft-ietf-detnet-yang will be revised to RFC when finalized by IETF 155 IETF RFC 6241 Network Configuration Protocol NETCONF 156 IETF RFC 8040 RESTCONF Protocol 157 IETF RFC 8939 Deterministic Networking DetNet Data Plane IP 158 IETF RFC 5279 A Uniform Resource Name URN Namespace for the 3rd Generation Partnership Project 3GPP 159 IETF RFC 9330Low Latency Low Loss Scalable Throughput L4S Internet Service Architecture 160 IETF RFC 9331 Explicit Congestion Notification ECN Protocol for Very Low Queuing Delay L4S 161 IETF RFC 9332 Dual-Queue Coupled Active Queue Management AQM for Low Latency Low Loss and Scalable Throughput L4S 162 IETF RFC 6603 Prefix Exclude Option for DHCPv6-based Prefix Delegation 163 IETF RFC 8415 Dynamic Host Configuration Protocol for IPv6 DHCPv6 164 ITU-T Recommendation G810 Definitions and terminology for synchronization networks 165 3GPP TS 38470 NG-RAN F1 general aspects and principles 166 IETF RFC 9000 QUIC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_48",
    "document_id": "23501-i80",
    "chunk_id": 48,
    "text": "A UDP-Based Multiplexed and Secure Transport 167 IETF RFC 9001 Using TLS to Secure QUIC 168 IETF RFC 9002 QUIC Loss Detection and Congestion Control 169 IETF RFC 9221 An Unreliable Datagram Extension to QUIC 170 IETF RFC 9298 Proxying UDP in HTTP 171 IETF RFC 9114 Hypertext Transfer Protocol Version 3 HTTP3 172 IETF RFC 9297 HTTP Datagrams and the Capsule Protocol 173 IETF RFC 9220 Bootstrapping WebSockets with HTTP3 174 draft-ietf-quic-multipath Multipath Extension for QUIC Editors note The above document cannot be formally referenced until it is published as an RFC 175 3GPP TS 28530 Management and orchestration Concepts use cases and requirements 176 3GPP TS 28531 Management and orchestration",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_49",
    "document_id": "23501-i80",
    "chunk_id": 49,
    "text": "Provisioning 177 3GPP TS 23434 Service Enabler Architecture Layer for Verticals SEAL Functional architecture and information flows 178 IEEE Std 8021CBdb-2021 Amendment 2 Extend Stream Identification Functions 179 3GPP TS 26522 5G Real-time Media Transport Protocol Configurations 180 3GPP TS 23586 Architectural Enhancements to support Ranging based services and Sidelink Positioning 181 3GPP TS 23542 Application layer support for Personal IoT Network 182 IETF RFC 8415 Dynamic Host Configuration Protocol for IPv6 DHCPv6 183 3GPP TS 29571 5G System Common Data Types for Service Based Interfaces Stage 3 184 3GPP TS 23289 Mission Critical services over 5G System Stage 2 185 IETF RFC 3550 RTP A Transport Protocol for Real-Time Applications 186 IETF RFC 3711 The Secure Real-time Transport Protocol SRTP 187 IETF RFC 6184 RTP Payload Format for H264 Video 188 IETF RFC 7798 RTP Payload Format for High Efficiency Video Coding HEVC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_50",
    "document_id": "23501-i80",
    "chunk_id": 50,
    "text": "189 IETF RFC 8285 A General Mechanism for RTP Header Extensions 190 3GPP TS 28405 Quality of Experience QoE measurement collection Control and configuration 191 3GPP TS 37355 LTE Positioning Protocol LPP 192 3GPP TS 32422 Telecommunication management Subscriber and equipment trace Trace control and configuration management 193 IETF RFC 3168 The Addition of Explicit Congestion Notification ECN to IP 194 3GPP TS 33503 Security Aspects of Proximity based Services ProSe in the 5G System 5GS 3 Definitions and abbreviations 31 Definitions For the purposes of the present document the terms and definitions given in TR 21905 1 and the following apply A term defined in the present document takes precedence over the definition of the same term if any in TR 21905 1 5G VN Group A set of UEs using private communication for 5G LAN-type service 5G Access Network An access network comprising a NG-RAN andor non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_51",
    "document_id": "23501-i80",
    "chunk_id": 51,
    "text": "AN connecting to a 5G Core Network 5G Access Stratum-based Time Distribution A time synchronization distribution method that is used by an NG-RAN to provide the 5GS time to the UEs over the radio interface using procedures specified in TS 38331 28 5G Core Network The core network specified in the present document It connects to a 5G Access Network 5G LAN-Type Service A service over the 5G system offering private communication using IP andor non-IP type communications 5G LAN-Virtual Network A virtual network over the 5G system capable of supporting 5G LAN-type service 5G NSWO",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_52",
    "document_id": "23501-i80",
    "chunk_id": 52,
    "text": "The 5G NSWO is the capability provided by 5G system and by UE to enable the connection to a WLAN access network using 5GS credentials without registration to 5GS 5G QoS Flow or QoS Flow The finest granularity for QoS forwarding treatment in the 5G System All traffic mapped to the same 5G QoS Flow receive the same forwarding treatment eg scheduling policy queue management policy rate shaping policy RLC configuration etc Providing different QoS forwarding treatment requires separate 5G QoS Flow 5G QoS Identifier A scalar that is used as a reference to a specific QoS forwarding behaviour eg packet loss rate packet delay budget to be provided to a 5G QoS Flow This may be implemented in the access network by the 5QI referencing node specific parameters that control the QoS forwarding treatment eg scheduling weights admission thresholds queue management thresholds link layer protocol configuration etc 5G System 3GPP system consisting of 5G Access Network AN 5G Core Network and UE 5G-BRG The 5G-BRG is a 5G-RG defined in BBF 5G-CRG The 5G-CRG is a 5G-RG specified in DOCSIS MULPI 89 5G-RG A 5G-RG is a RG capable of connecting to 5GC playing the role of a UE with regard to the 5G core It supports secure element and exchanges N1 signalling with 5GC The 5G-RG can be either a 5G-BRG or 5G-CRG Access Traffic Steering The procedure that selects an access network for a new data flow and transfers the traffic of this data flow over the selected access network Access traffic steering is applicable between one 3GPP access and one non-3GPP access Access Traffic Switching The procedure that moves all traffic of an ongoing data flow from one access network to another access network in a way that maintains the continuity of the data flow Access traffic switching is applicable between one 3GPP access and one non-3GPP access Access Traffic Splitting The procedure that splits the traffic of a data flow across multiple access networks When traffic splitting is applied to a data flow some traffic of the data flow is transferred via one access and some other traffic of the same data flow is transferred via another access Access traffic splitting is applicable between one 3GPP access and one non-3GPP access Allowed NSSAI Indicating the S-NSSAIs values the UE could use in the Serving PLMN in the current Registration Area Allowed Area Area where the UE is allowed to initiate communication as specified in clause 5323 Alternative S-NSSAI Indicating a compatible S-NSSAI for an S-NSSAI in the Allowed NSSAI that the AMF uses to replace an S-NSSAI when the S-NSSAI is not available or congested as specified in clause 51519 AMF Region An AMF Region consists of one or multiple AMF Sets AMF Set An AMF Set consists of some AMFs that serve a given area and Network Slices AMF Set is unique within an AMF Region and it comprises of AMFs that support the same Network Slices Multiple AMF Sets may be defined per AMF Region The AMF instances in the same AMF Set may be geographically distributed but have access to the same context data Application Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_53",
    "document_id": "23501-i80",
    "chunk_id": 53,
    "text": "An identifier that can be mapped to a specific application traffic detection rule AUSF Group ID This refers to one or more AUSF instances managing a specific set of SUPIs An AUSF Group consists of one or multiple AUSF Sets Binding Indication Information included by a NF service producer to a NF service consumer in request responses or notifications to convey the scope within which selectionreselection of target NFNF Services may be performed or information included by the NF service consumer in requests or subscriptions to convey the scope within which selectionreselection of notification targets or the selection of other services that the NF consumer produces for the same data context may be performed See clause 6310 BSF Group ID This refers to one or more BSF instances managing a specific set of SUPIs or GPSIs A BSF Group consists of one or multiple BSF Sets Configured NSSAI NSSAI provisioned in the UE applicable to one or more PLMNs CHF Group ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_54",
    "document_id": "23501-i80",
    "chunk_id": 54,
    "text": "This refers to one or more CHF instances managing a specific set of SUPIs Credentials Holder Entity which authenticates and authorizes access to an SNPN separate from the Credentials Holder Data Burst A set of multiple PDUs generated and sent by the application in a short period of time NOTE 1 A Data Burst can be composed of one or multiple PDU Sets Default UE credentials Information configured in the UE to make the UE uniquely identifiable and verifiably secure to perform UE onboarding Default Credentials Server DCS An entity that can perform authentication based on the Default UE credentials or provide means for another entity to perform authentication based on the Default UE credentials Delegated Discovery",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_55",
    "document_id": "23501-i80",
    "chunk_id": 55,
    "text": "This refers to delegating the discovery and associated selection of NF instances or NF service instances to an SCP Direct Communication This refers to the communication between NFs or NF services without using an SCP Disaster Condition See definition in TS 22261 2 Disaster Inbound Roamer See definition in TS 22261 2 Disaster Roaming See definition in TS 22261 2 DN Access Identifier DNAI Identifier of a user plane access to one or more DNs where applications are deployed Emergency Registered A UE is considered Emergency Registered over an Access Type in a PLMN when registered for emergency services only over this Access Type in this PLMN Endpoint Address",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_56",
    "document_id": "23501-i80",
    "chunk_id": 56,
    "text": "An address in the format of an IP address or FQDN which is used to determine the hostauthority part of the target URI This Target URI is used to access an NF service ie to invoke service operations of an NF service producer or for notifications to an NF service consumer En-gNB as defined in TS 37340 31 Expected UE Behaviour Set of parameters provisioned by an external party to 5G network functions on the foreseen or expected UE behaviour see clause 520 Feeder link As defined in TS 38300 27 Fixed Network Residential Gateway A Fixed Network RG FN-RG is a RG that it does not support N1 signalling and it is not 5GC capable Fixed Network Broadband Residential Gateway A Fixed Network RG FN-BRG is a FN-RG specified in BBF TR-124 90 Fixed Network Cable Residential Gateway A Fixed Network Cable RG FN-CRG is a FN-RG with cable modem specified in DOCSIS MULPI 89 Forbidden Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_57",
    "document_id": "23501-i80",
    "chunk_id": 57,
    "text": "An area where the UE is not allowed to initiate communication as specified in clause 5323 GBR QoS Flow A QoS Flow using the GBR resource type or the Delay-critical GBR resource type and requiring guaranteed flow bit rate Group ID for Network Selection GIN An identifier used during SNPN selection to enhance the likelihood of selecting a preferred SNPN that supports a Default Credentials Server or a Credentials Holder gPTP-based Time Distribution a method to distribute timing among entities in a gPTP domain using PTP messages generated by a GM in the case the GM is external to 5GS or by 5GS in the case the 5GS acts as a GM for a given gPTP domain Possible dependencies between gPTP-based Time Distribution and 5G Access Stratum-based Time Distribution are described in clause 5271 The synchronization process is described in clause 5271 and follows the applicable profiles of IEEE Std 8021AS 104 or IEEE Std 1588 126 Home Network Public Key Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_58",
    "document_id": "23501-i80",
    "chunk_id": 58,
    "text": "An identifier used to indicate which publicprivate key pair is used for SUPI protection and de-concealment of the SUCI as specified in TS 23003 19 IAB-donor This is a NG-RAN node that supports Integrated access and backhaul IAB feature and provides connection to the core network to IAB-nodes It supports the CU function of the CUDU architecture for IAB defined in TS 38401 42 IAB-node A relay node that supports wireless in-band and out-of-band relaying of NR access traffic via NR Uu backhaul links It supports the UE function and the DU function of the CUDU architecture for IAB defined in TS 38401 42 Indirect Communication",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_59",
    "document_id": "23501-i80",
    "chunk_id": 59,
    "text": "This refers to the communication between NFs or NF services via an SCP Initial Registration UE registration in RM-DEREGISTERED state as specified in clause 532 Intermediate SMF I-SMF An SMF that is inserted to support a PDU session as the UE is located in an area which cannot be controlled by the original SMF because the UPFs belong to a different SMF Service Area Local Area Data Network a DN that is accessible by the UE only in specific locations that provides connectivity to a specific DNN and whose availability is provided to the UE Local Break Out LBO Roaming scenario for a PDU Session where the PDU Session Anchor and its controlling SMF are located in the serving PLMN VPLMN LTE-M a 3GPP RAT type Identifier used in the Core Network only which is a sub-type of E-UTRA RAT type and defined to identify in the Core Network the E-UTRA when used by a UE indicating Category M MA PDU Session A PDU Session that provides a PDU connectivity service which can use one access network at a time or simultaneously one 3GPP access network and one non-3GPP access network Mobile Base Station Relay A mobile base station acts as a relay between a UE and the 5G network Such mobile base station relay can for example be mounted on a moving vehicle and serve UEs that can be located inside or outside the vehicle or enteringleaving the vehicle See description of TS 22261 2 A mobile Base Station Relay is supported in 5GS with the IAB-architecture with mobility as specified in clause 535A and that described in TS 38401 42 Master RAN node A Master node as defined in TS 37340 31 Mobility Pattern Network concept of determining within the AMF the UE mobility parameters as specified in clause 5324 Mobility Registration Update UE re-registration when entering new TA outside the TAI List as specified in clause 532 MPS-subscribed UE A UE having a USIM with MPS subscription Multi-USIM UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_60",
    "document_id": "23501-i80",
    "chunk_id": 60,
    "text": "A UE with multiple USIMs capable of maintaining a separate registration state with a PLMN for each USIM at least over 3GPP Access and supporting one or more of the features described in clause 538 NB-IoT UE Priority Numerical value used by the NG-RAN to prioritise between different UEs accessing via NB-IoT NGAP UE association The logical per UE association between a 5G-AN node and an AMF NGAP UE-TNLA-binding The binding between a NGAP UE association and a specific TNL association for a given UE Network Function A 3GPP adopted or 3GPP defined processing function in a network which has defined functional behaviour and 3GPP defined interfaces NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_61",
    "document_id": "23501-i80",
    "chunk_id": 61,
    "text": "A network function can be implemented either as a network element on a dedicated hardware as a software instance running on a dedicated hardware or as a virtualised function instantiated on an appropriate platform eg on a cloud infrastructure Network Instance Information identifying a domain Used by the UPF for traffic detection and routing Network Slice A logical network that provides specific network capabilities and network characteristics Network Slice Area of Service NS-AoS The area where a network slice is available ie the UE can access and get service of a particular network slice as more than zero resources are allocated to the network slice in the NG-RAN cells This area may be depending on the specific network slice the whole PLMN one or more TAs or one or more cells when the NS-AoS does not match deployed TAs as defined in clause 51518 Network Slice instance",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_62",
    "document_id": "23501-i80",
    "chunk_id": 62,
    "text": "A set of Network Function instances and the required resources eg compute storage and networking resources which form a deployed Network Slice Non-GBR QoS Flow A QoS Flow using the Non-GBR resource type and not requiring guaranteed flow bit rate NSI ID an identifier for identifying the Core Network part of a Network Slice instance when multiple Network Slice instances of the same Network Slice are deployed and there is a need to differentiate between them in the 5GC NF instance an identifiable instance of the NF NF service a functionality exposed by a NF through a service-based interface and consumed by other authorized NFs NF service instance an identifiable instance of the NF service NF service operation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_63",
    "document_id": "23501-i80",
    "chunk_id": 63,
    "text": "An elementary unit a NF service is composed of NF Service Set A group of interchangeable NF service instances of the same service type within an NF instance The NF service instances in the same NF Service Set have access to the same context data NF Set A group of interchangeable NF instances of the same type supporting the same services and the same Network Slices",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_64",
    "document_id": "23501-i80",
    "chunk_id": 64,
    "text": "The NF instances in the same NF Set may be geographically distributed but have access to the same context data NG-RAN A radio access network that supports one or more of the following options with the common characteristics that it connects to 5GC 1 Standalone New Radio 2 New Radio is the anchor with E-UTRA extensions 3 Standalone E-UTRA 4 E-UTRA is the anchor with New Radio extensions Non-3GPP QoS Assistance Information A set of QoS assistance information provided to the UE eg PEGC to enable the UE to perform QoS differentiation for the connected devices in the non-3GPP network behind the UE Non-Allowed Area Area where the UE is allowed to initiate Registration procedure but no other communication as specified in clause 5323 Non-Public Network See definition in TS 22261 2 Non-Seamless Non-3GPP offload The offload of user plane traffic via non-3GPP access without traversing either N3IWFTNGF or UPF Non-Seamless WLAN offload Non-Seamless Non-3GPP offload when the non-3GPP access network is WLAN Onboarding Network Either a PLMN enabling Remote Provisioning for a registered UE or an Onboarding SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_65",
    "document_id": "23501-i80",
    "chunk_id": 65,
    "text": "Onboarding Standalone Non-Public Network An SNPN providing Onboarding access and enabling Remote Provisioning for a UE registered for Onboarding as specified in clause 42224 of TS 23502 3 Partially Allowed NSSAI Indicating the S-NSSAIs values the UE could use in the Serving PLMN or SNPN in some of the TAs in the current Registration Area Each S-NSSAI in the Partially Allowed NSSAI is associated with a list of TAs where the S-NSSAI is supported PCF Group ID This refers to one or more PCF instances managing a specific set of SUPIs A PCF Group consists of one or multiple PCF Sets PDU Connectivity Service A service that provides exchange of PDUs between a UE and a Data Network PDU Session Association between the UE and a Data Network that provides a PDU connectivity service PDU Session Type The type of PDU Session which can be IPv4 IPv6 IPv4v6 Ethernet or Unstructured PDU Set",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_66",
    "document_id": "23501-i80",
    "chunk_id": 66,
    "text": "One or more PDUs carrying the payload of one unit of information generated at the application level eg frames or video slices etc for eXtended Reality XR Services All the PDUs of a PDU set are transmitted within the same QoS Flow Pending NSSAI NSSAI provided by the Serving PLMN during a Registration procedure indicating the S-NSSAIs for which the network slice-specific authentication and authorization procedure is pending Periodic Registration Update UE re-registration at expiry of periodic registration timer as specified in clause 532 Personal IoT Network PIN A network with group of elements ie UE or non-3GPP device that are able to communicate with each other directly communicate with each other via intermediate elements communicate with each other via 5GS or communicate with external DN via 5GS PIN Element PINE A UE or non-3GPP device that is part of the group of elements in a PIN PIN Element with Gateway Capability PEGC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_67",
    "document_id": "23501-i80",
    "chunk_id": 67,
    "text": "A PINE with the ability to provide DN connectivity via the 5G network for other PINEs andor a PINE with the ability to provide relay functionality for communication between PINEs Only a UE is able to act as a PEGC A PIN includes at least one PEGC NOTE 3 In the context of PIN the terms PEGC and UE with PEGC capability are synonymous therefore when the term PEGC is used it is also intended as UE PIN Element with Management Capability PEMC A PINE with capability to manage the PIN and the management is supported by an AF if deployed A PIN includes at least one PEMC NOTE 4 A UE that is a PINE may both act as PEMC and PEGC in a PIN PIN management traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_68",
    "document_id": "23501-i80",
    "chunk_id": 68,
    "text": "The traffic among PINE PEGC PEMC and AF for PIN related to the management of PIN PIN-DN communication The communication between PINE and DN via a PEGC and 5G network as well as the communication between PEGC and DN via 5G network The communication includes both the data traffic and the PIN management traffic eg the data traffic towards the internet or the PIN management traffic towards the AF for PIN PIN direct communication The communication without traversing 5G network between two PINEs eg between a PINE and a PEGC between a PINE and a PEMC between a PEMC and a PEGC and between two PEGCs The communication traverses intermediate PINEs or not The communication includes both the data traffic and the PIN management traffic eg the data traffic between 2 PINEs or the PIN management traffic between PINE and PEMC PIN indirect communication The communication with traversing 5G network between PINEs connected to different PEGCs of the same PIN and between a PINE and a PEMC via PEGC and 5G network The communication includes both the data traffic and the PIN management traffic eg the data traffic between 2 PINEs or the PIN management traffic between PINE and PEMC PLMN with Disaster Condition A PLMN to which a Disaster Condition applies Pre-configured 5QI Pre-defined QoS characteristics configured in the AN and 5GC and referenced via a non-standardized 5QI value Corresponding to Operator-specific 5QI in TS 24501 47 Primary cell as defined in TS 36331 51 Primary RAT RAT of the Master RAN node when Dual Connectivity is used otherwise RAT of the RAN node Private communication See definition in TS 22261 2 Provisioning Server Entity that provisions network credentials and other data in the UE to enable SNPN access PTP domain As defined in IEEE Std 1588 126 Public network integrated NPN A non-public network deployed with the support of a PLMN Radio Access Network See 5G Access Network RAT type Identifies the transmission technology used in the access network for both 3GPP accesses and non-3GPP Accesses for example NR NB-IOT Untrusted Non-3GPP Trusted Non-3GPP Trusted IEEE 80211 Non-3GPP access Wireline Wireline-Cable Wireline-BBF etc NR RedCap a 3GPP RAT type Identifier used in the Core Network only which is a sub-type of NR RAT type and defined to identify in the Core Network the NR when used by a UE indicating NR RedCap NR eRedCap a 3GPP RAT type Identifier used in the Core Network only which is a sub-type of NR RAT type and defined to identify in the Core Network the NR when used by a UE indicating NR eRedCap Requested NSSAI NSSAI provided by the UE to the Serving PLMN during registration Residential Gateway",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_69",
    "document_id": "23501-i80",
    "chunk_id": 69,
    "text": "The Residential Gateway RG is a device providing for example voice data broadcast video video on demand to other devices in customer premises Routing Binding Indication Information included in a request or notification and that can be used by the SCP for discovery and associated selection to of a suitable target See clauses 6310 and 712 Routing Indicator Indicator that allows together with SUCISUPI Home Network Identifier to route network signalling to AUSF and UDM instances capable to serve the subscriber RRC_IDLE RRC_CONNECTED RRC_INACTIVE As defined in TS 38331 28 and TS 38306 69 SCP Domain A configured group of one or more SCPs and zero or more NF instancess An SCP within the group can communicate with any NF instance or SCP within the same group directly ie without passing through an intermediate SCP Secondary RAN node A Secondary node as defined in TS 37340 31 Secondary RAT RAT of the secondary RAN node Service link As defined in TS 38300 27 SNPN-enabled UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_70",
    "document_id": "23501-i80",
    "chunk_id": 70,
    "text": "A UE configured to use stand-alone Non-Public Networks SNPN access mode A UE operating in SNPN access mode only selects stand-alone Non-Public Networks over Uu Yt NWu NOTE 5 If there are multiple instances of UuYtNWu whether the UE is in SNPN access mode is determined for each instance independently NWu can be either direct access via untrusted non-3GPP access or access via underlay network see Annex D clause D3 Service based interface It represents how a set of services is providedexposed by a given NF Service Continuity",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_71",
    "document_id": "23501-i80",
    "chunk_id": 71,
    "text": "The uninterrupted user experience of a service including the cases where the IP address andor anchoring point change Service Data Flow Filter A set of packet flow header parameter valuesranges used to identify one or more of the IP or Ethernet packet flows constituting a Service Data Flow Service Data Flow Template The set of Service Data Flow filters in a policy rule or an application identifier in a policy rule referring to an application detection filter required for defining a Service Data Flow Session Continuity The continuity of a PDU Session For PDU Session of IPv4 or IPv6 or IPv4v6 type session continuity implies that the IP address is preserved for the lifetime of the PDU Session SMF Service Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_72",
    "document_id": "23501-i80",
    "chunk_id": 72,
    "text": "The collection of UPF Service Areas of all UPFs which can be controlled by one SMF SNPN ID PLMN ID and NID identifying an SNPN Stand-alone Non-Public Network A non-public network not relying on network functions provided by a PLMN Subscribed S-NSSAI S-NSSAI based on subscriber information which a UE is subscribed to use in a PLMN Subscription Owner Standalone Non-Public Network A Standalone Non-Public Network owning the subscription of a UE and providing subscription data to the UE via a Provisioning Server during the onboarding procedure Survival Time The time that an application consuming a communication service may continue without an anticipated message NOTE 6 Taken from clause 31 of TS 22261 2 Target NSSAI NSSAI provided by the Serving PLMN to the NG-RAN to cause the NG-RAN to attempt to steer the UE to a cell supporting the Network Slices identified by the S-NSSAIs in this NSSAI See clause 53433 for more details Time Sensitive Communication TSC A communication service that supports deterministic communication ie which ensures a maximum delay andor isochronous communication with high reliability and availability It is about providing packet transport with QoS characteristics such as bounds on latency loss and reliability where end systems and relaytransmit nodes may or may not be strictly synchronized TSN working domain Synchronization domain for a localized set of devices collaborating on a specific task or work function in a TSN network corresponding to a gPTP domain defined in IEEE 8021AS 104 UDM Group ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_73",
    "document_id": "23501-i80",
    "chunk_id": 73,
    "text": "This refers to one or more UDM instances managing a specific set of SUPIs An UDM Group consists of one or multiple UDM Sets UDR Group ID This refers to one or more UDR instances managing a specific set of SUPIs An UDR Group consists of one or multiple UDR Sets UE-DS-TT Residence Time The time taken within the UE and DS-TT to forward a packet ie between the ingress of the UE and the DS-TT port in the DL direction or between the DS-TT port and the egress of the UE in the UL direction UE-DS-TT Residence Time is provided at the time of PDU Session Establishment by the UE to the network NOTE 7 UE-DS-TT Residence Time is the same for uplink and downlink traffic and applies to all QoS Flows UPF Service Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_74",
    "document_id": "23501-i80",
    "chunk_id": 74,
    "text": "An area consisting of one or more TAs within which PDU Session associated with the UPF can be served by RAN nodes via a N3 interface between the RAN and the UPF without need to add a new UPF in between or to removere-allocate the UPF Uplink Classifier UPF functionality that aims at diverting Uplink traffic based on filter rules provided by SMF towards Data Network WB-E-UTRA In the RAN WB-E-UTRA is the part of E-UTRA that excludes NB-IoT In the Core Network WB-E-UTRA also excludes LTE-M Wireline 5G Access Network The Wireline 5G Access Network W-5GAN is a wireline AN that connects to a 5GC via N2 and N3 reference points The W-5GAN can be either a W-5GBAN or W-5GCAN Wireline 5G Cable Access Network The Wireline 5G Cable Access Network W-5GCAN is the Access Network defined in CableLabs Wireline BBF Access Network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_75",
    "document_id": "23501-i80",
    "chunk_id": 75,
    "text": "The Wireline 5G BBF Access Network W-5GBAN is the Access Network defined in BBF Wireline Access Gateway Function W-AGF The Wireline Access Gateway Function W-AGF is a Network function in W-5GAN that provides connectivity to the 5G Core to 5G-RG and FN-RG NOTE 8 If one AUSFPCFUDRUDM group consists of multiple AUSFPCFUDRUDM Sets AUSFPCFUDRUDM instance from different Set may be selected to serve the same UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_76",
    "document_id": "23501-i80",
    "chunk_id": 76,
    "text": "The temporary data which is not shared across different Sets may be lost eg the event subscriptions stored at one UDM instance are lost if another UDM instance from different Set is selected and no data shared across the UDM Sets 32 Abbreviations For the purposes of the present document the abbreviations given in TR 21905 1 and the following apply An abbreviation defined in the present document takes precedence over the definition of the same abbreviation if any in TR 21905 1 5GC 5G Core Network 5G DDNMF 5G Direct Discovery Name Management Function 5G LAN 5G Local Area Network 5GS 5G System 5G-AN 5G Access Network 5G-AN PDB 5G Access Network Packet Delay Budget 5G-EIR 5G-Equipment Identity Register 5G-GUTI 5G Globally Unique Temporary Identifier 5G-BRG 5G Broadband Residential Gateway 5G-CRG 5G Cable Residential Gateway 5G GM 5G Grand Master 5G NSWO 5G Non-Seamless WLAN offload 5G-RG 5G Residential Gateway 5G-S-TMSI 5G S-Temporary Mobile Subscription Identifier 5G VN 5G Virtual Network 5QI 5G QoS Identifier ADRF Analytics Data Repository Function AF Application Function AIML Artificial IntelligenceMachine Learning AKMA Authentication and Key Management for Applications AnLF Analytics Logical Function AMF Access and Mobility Management Function AoI Area of Interest AS Access Stratum ATSSS Access Traffic Steering Switching Splitting ATSSS-LL ATSSS Low-Layer AUSF Authentication Server Function BMCA Best Master Clock Algorithm BSF Binding Support Function CAG Closed Access Group CAPIF Common API Framework for 3GPP northbound APIs CH Credentials Holder CHF Charging Function CN PDB Core Network Packet Delay Budget CP Control Plane CQRCI Clock Quality Reporting Control Information DAPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_77",
    "document_id": "23501-i80",
    "chunk_id": 77,
    "text": "Dual Active Protocol Stacks DCCF Data Collection Coordination Function DCS Default Credentials Server DetNet Deterministic Networking DL Downlink DN Data Network DNAI DN Access Identifier DNN Data Network Name DRX Discontinuous Reception DS-TT Device-side TSN translator EAC Early Admission Control ePDG evolved Packet Data Gateway EBI EPS Bearer Identity EUI Extended Unique Identifier FAR Forwarding Action Rule FL Federated Learning FN-BRG Fixed Network Broadband RG FN-CRG Fixed Network Cable RG FN-RG Fixed Network RG FQDN Fully Qualified Domain Name GBA Generic Bootstrapping Architecture GEO Geostationary Orbit GFBR Guaranteed Flow Bit Rate GIN Group ID for Network Selection GMLC Gateway Mobile Location Centre GPSI Generic Public Subscription Identifier GUAMI Globally Unique AMF Identifier HMTC High-Performance Machine-Type Communications HR Home Routed roaming IAB Integrated access and backhaul IMEITAC IMEI Type Allocation Code IPUPS Inter PLMN UP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_78",
    "document_id": "23501-i80",
    "chunk_id": 78,
    "text": "Security I-SMF Intermediate SMF I-UPF Intermediate UPF LADN Local Area Data Network LBO Local Break Out roaming LEO Low Earth Orbit LMF Location Management Function LoA Level of Automation LPP LTE Positioning Protocol LRF Location Retrieval Function L4S Low Latency Low Loss and Scalable Throughput MBS MulticastBroadcast Service MBSF MulticastBroadcast Service Function MBSR Mobile Base Station Relay MBSTF MulticastBroadcast Service Transport Function MB-SMF MulticastBroadcast Session Management Function MB-UPF MulticastBroadcast User Plane Function MEO Medium Earth Orbit MFAF Messaging Framework Adaptor Function MCX Mission Critical Service MDBV Maximum Data Burst Volume MFBR Maximum Flow Bit Rate MICO Mobile Initiated Connection Only MINT Minimization of Service",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_79",
    "document_id": "23501-i80",
    "chunk_id": 79,
    "text": "Interruption ML Machine Learning MPQUIC Multi-Path QUIC MPS Multimedia Priority Service MPTCP Multi-Path TCP Protocol MTLF Model Training Logical Function N3IWF Non-3GPP InterWorking Function N3QAI Non-3GPP QoS Assistance Information N5CW Non-5G-Capable over WLAN NAI Network Access Identifier NCR Network Controlled Repeater NCR-MT NCR Mobile Termination NEF Network Exposure Function NF Network Function NGAP Next Generation Application Protocol NID Network identifier NPN Non-Public Network NR New Radio NRF Network Repository Function NS-AoS Network Slice Area of Service NSAC Network Slice Admission Control NSACF Network Slice Admission Control Function NSAG Network Slice",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_80",
    "document_id": "23501-i80",
    "chunk_id": 80,
    "text": "AS Group NSI ID Network Slice Instance Identifier NSSAA Network Slice-Specific Authentication and Authorization NSSAAF Network Slice-specific and SNPN Authentication and Authorization Function NSSAI Network Slice Selection Assistance Information NSSF Network Slice Selection Function NSSP Network Slice Selection Policy NSSRG Network Slice Simultaneous Registration Group NSWO Non-Seamless WLAN offload NSWOF Non-Seamless WLAN offload Function NW-TT Network-side TSN translator NWDAF Network Data Analytics Function ONN Onboarding Network ON-SNPN Onboarding Standalone Non-Public Network PCF Policy Control Function PDB Packet Delay Budget PDR Packet Detection Rule PDU Protocol Data Unit PDV Packet Delay Variation PEGC PIN Element with Gateway Capability PEI Permanent Equipment Identifier PEMC PIN Element with Management Capability PER Packet Error Rate PFD Packet Flow Description PIN Personal IoT Network PINE PIN Element PLR Packet Loss Rate PNI-NPN Public Network Integrated Non-Public Network PPD Paging Policy Differentiation PPF Paging Proceed Flag PPI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_81",
    "document_id": "23501-i80",
    "chunk_id": 81,
    "text": "Paging Policy Indicator PSA PDU Session Anchor PSDB PDU Set Delay Budget PSER PDU Set Error Rate PSIHI PDU Set Integrated Handling Information PTP Precision Time Protocol PVS Provisioning Server QFI QoS Flow Identifier QMC QoE Measurement Collection QoE Quality of Experience RACS Radio Capabilities Signalling optimisation RAN Radio Access Network RG Residential Gateway RIM Remote Interference Management RQA Reflective QoS Attribute RQI Reflective QoS Indication RSN Redundancy Sequence Number RTT Round Trip Time SA NR Standalone New Radio SBA Service Based Architecture SBI Service",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_82",
    "document_id": "23501-i80",
    "chunk_id": 82,
    "text": "Based Interface SCP Service Communication Proxy SD Slice Differentiator SEAF Security Anchor Functionality SEPP Security Edge Protection Proxy SF Service Function SFC Service Function Chain SMF Session Management Function SMSF Short Message Service Function SN Sequence Number SNPN Stand-alone Non-Public Network S-NSSAI Single Network Slice Selection Assistance Information SO-SNPN Subscription Owner Standalone Non-Public Network SSC Session and Service Continuity SSCMSP Session and Service Continuity Mode Selection Policy SST SliceService Type SUCI Subscription Concealed Identifier SUPI Subscription Permanent Identifier SV Software Version TA Tracking Area TAI Tracking Area Identity TNAN Trusted Non-3GPP Access Network TNAP Trusted Non-3GPP Access Point TNGF Trusted Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_83",
    "document_id": "23501-i80",
    "chunk_id": 83,
    "text": "Gateway Function TNL Transport Network Layer TNLA Transport Network Layer Association TSC Time Sensitive Communication TSCAC TSC Assistance Container TSCAI Traffic Assistance Information TSCTSF Time Sensitive Communication and Time Synchronization Function TSN Time Sensitive Networking TSN GM TSN Grand Master TSP Traffic Steering Policy TSS Timing Synchronization Status TT TSN Translator TWIF Trusted WLAN Interworking Function UAS NF Uncrewed Aerial System Network Function UCMF UE radio Capability Management Function UDM Unified Data Management UDR Unified Data Repository UDSF Unstructured Data Storage Function UL Uplink UL CL Uplink Classifier UPF User Plane Function URLLC Ultra Reliable Low Latency Communication URRP-AMF UE Reachability Request Parameter for AMF URSP UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_84",
    "document_id": "23501-i80",
    "chunk_id": 84,
    "text": "Route Selection Policy VID VLAN Identifier VLAN Virtual Local Area Network W-5GAN Wireline 5G Access Network W-5GBAN Wireline BBF Access Network W-5GCAN Wireline 5G Cable Access Network W-AGF Wireline Access Gateway Function 4 Architecture model and concepts 41 General concepts The 5G System architecture is defined to support data connectivity and services enabling deployments to use techniques such as eg Network Function Virtualization and Software Defined Networking The 5G System architecture shall leverage service-based interactions between Control Plane CP Network Functions where identified Some key principles and concept are to - Separate the User Plane UP functions from the Control Plane CP functions allowing independent scalability evolution and flexible deployments eg centralized location or distributed remote location - Modularize the function design eg to enable flexible and efficient network slicing - Wherever applicable define procedures ie the set of interactions between network functions as services so that their re-use is possible - Enable each Network Function and its Network Function Services to interact with other NF and its Network Function Services directly or indirectly via a Service Communication Proxy if required The architecture does not preclude the use of another intermediate function to help route Control Plane messages eg like a DRA - Minimize dependencies between the Access Network AN and the Core Network CN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_85",
    "document_id": "23501-i80",
    "chunk_id": 85,
    "text": "The architecture is defined with a converged core network with a common AN - CN interface which integrates different Access Types eg 3GPP access and non-3GPP access - Support a unified authentication framework - Support stateless NFs where the compute resource is decoupled from the storage resource - Support capability exposure - Support concurrent access to local and centralized services To support low latency services and local access to data networks UP functions can be deployed close to the Access Network - Support roaming with both Home routed traffic as well as Local breakout traffic in the visited PLMN 42 Architecture reference model 421 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_86",
    "document_id": "23501-i80",
    "chunk_id": 86,
    "text": "This specification describes the architecture for the 5G System The 5G architecture is defined as service-based and the interaction between network functions is represented in two ways - A service-based representation where network functions eg AMF within the Control Plane enables other authorized network functions to access their services This representation also includes point-to-point reference points where necessary - A reference point representation shows the interaction exist between the NF services in the network functions described by point-to-point reference point eg N11 between any two network functions eg AMF and SMF Service-based interfaces are listed in clause 426 Reference points are listed in clause 427 Network functions within the 5GC Control Plane shall only use service-based interfaces for their interactions NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_87",
    "document_id": "23501-i80",
    "chunk_id": 87,
    "text": "The interactions between NF services within one NF are not specified in this Release of the specification NFs and NF services can communicate directly referred to as Direct Communication or indirectly via the SCP referred to as Indirect Communication For more information on communication options see Annex E and clauses under 631 and 712 In addition to the architecture descriptions in clause 4 the following areas are further described in other specifications - NG-RAN architecture is described in TS 38300 27 and TS 38401 42 - Security architecture is described in TS 33501 29 and TS 33535 124 - Charging architecture is described in TS 32240 41 - 5G Media streaming architecture is described in TS 26501 135 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_88",
    "document_id": "23501-i80",
    "chunk_id": 88,
    "text": "The NFs listed in clause 422 are described in the following clauses or in the specifications above 422 Network Functions and entities The 5G System architecture consists of the following network functions NF - Authentication Server Function AUSF - Access and Mobility Management Function AMF - Data Network DN eg operator services Internet access or 3rd party services - Unstructured Data Storage Function UDSF - Network Exposure Function NEF - Network Repository Function NRF - Network Slice Admission Control Function NSACF - Network Slice-specific and SNPN Authentication and Authorization Function NSSAAF - Network Slice Selection Function NSSF - Policy Control Function PCF - Session Management Function SMF - Unified Data Management UDM - Unified Data Repository UDR - User Plane Function UPF - UE radio Capability Management Function UCMF - Application Function AF - User Equipment UE - Radio Access Network RAN - 5G-Equipment Identity Register 5G-EIR - Network Data Analytics Function NWDAF - CHarging Function CHF - Time Sensitive Networking AF TSN AF - Time Sensitive Communication and Time Synchronization Function TSCTSF - Data Collection Coordination Function DCCF - Analytics Data Repository Function ADRF - Messaging Framework Adaptor Function MFAF - Non-Seamless WLAN Offload Function NSWOF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_89",
    "document_id": "23501-i80",
    "chunk_id": 89,
    "text": "The functionalities provided by DCCF andor ADRF can also be hosted by an NWDAF - Edge Application Server Discovery Function EASDF The 5G System architecture also comprises the following network entities - Service Communication Proxy SCP - Security Edge Protection Proxy SEPP The functional descriptions of these Network Functions and entities are specified in clause 6 - Non-3GPP InterWorking Function N3IWF - Trusted Non-3GPP Gateway Function TNGF - Wireline Access Gateway Function W-AGF - Trusted WLAN Interworking Function TWIF 423 Non-roaming reference architecture Figure 423-1 depicts the non-roaming reference architecture Service-based interfaces are used within the Control Plane Figure 423-1 Non-Roaming 5G System Architecture NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_90",
    "document_id": "23501-i80",
    "chunk_id": 90,
    "text": "If an SCP is deployed it can be used for indirect communication between NFs and NF services as described in Annex E SCP does not expose services itself Figure 423-2 depicts the 5G System architecture in the non-roaming case using the reference point representation showing how various network functions interact with each other Figure 423-2 Non-Roaming 5G System Architecture in reference point representation NOTE 1 N9 N14 are not shown in all other figures however they may also be applicable for other scenarios NOTE 2 For the sake of clarity of the point-to-point diagrams the UDSF NEF and NRF have not been depicted However all depicted Network Functions can interact with the UDSF UDR NEF and NRF as necessary NOTE 3 The UDM uses subscription data and authentication data and the PCF uses policy data that may be stored in UDR refer to clause 425 NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_91",
    "document_id": "23501-i80",
    "chunk_id": 91,
    "text": "For clarity the UDR and its connections with other NFs eg PCF are not depicted in the point-to-point and service-based architecture diagrams For more information on data storage architectures refer to clause 425 NOTE 5 For clarity the NWDAFs DCCF MFAF and ADRF and their connections with other NFs are not depicted in the point-to-point and service-based architecture diagrams For more information on network data analytics architecture refer to TS 23288 86 NOTE 6 For clarity the 5G DDNMF and its connections with other NFs eg UDM PCF are not depicted in the point-to-point and service-based architecture diagrams For more information on ProSe architecture refer to TS 23304 128 NOTE 7 For clarity the TSCTSF and its connections with other NFs eg PCF NEF UDR are not depicted in the point-to-point and service-based architecture diagrams For more information on TSC architecture refer to clause 448 NOTE 8",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_92",
    "document_id": "23501-i80",
    "chunk_id": 92,
    "text": "For exposure of the QoS monitoring information as specified in clause 58218 exposure of data collected for analytics as specified in clause 52262 of TS 23502 3 and exposure of the TSC management information as specified in clause 58514 direct interaction between UPF and NFs can be supported via the Nupf interface see clause 4216 NOTE 9 For clarity the EASDF and its connections with SMF is not depicted in the point-to-point and service-based architecture diagrams For more information on edge computing architecture refer to TS 23548 130 Figure 423-3 depicts the non-roaming architecture for UEs concurrently accessing two eg local and central data networks using multiple PDU Sessions using the reference point representation This figure shows the architecture for multiple PDU Sessions where two SMFs are selected for the two different PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_93",
    "document_id": "23501-i80",
    "chunk_id": 93,
    "text": "However each SMF may also have the capability to control both a local and a central UPF within a PDU Session Figure 423-3 Applying Non-Roaming 5G System Architecture for multiple PDU Session in reference point representation Figure 423-4 depicts the non-roaming architecture in the case of concurrent access to two eg local and central data networks is provided within a single PDU Session using the reference point representation Figure 423-4 Applying Non-Roaming 5G System Architecture for concurrent access to two eg local and central data networks single PDU Session option in reference point representation Figure 423-5 depicts the non-roaming architecture for Network Exposure Function using reference point representation Figure 423-5 Non-Roaming Architecture for Network Exposure Function in reference point representation NOTE 1 In Figure 423-5 Trust domain for NEF is same as Trust domain for SCEF as defined in TS 23682 36 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_94",
    "document_id": "23501-i80",
    "chunk_id": 94,
    "text": "In Figure 423-5 3GPP Interface represents southbound interfaces between NEF and 5GC Network Functions eg N29 interface between NEF and SMF N30 interface between NEF and PCF etc All southbound interfaces from NEF are not shown for the sake of simplicity 424 Roaming reference architectures Figure 424-1 depicts the 5G System roaming architecture with local breakout with service-based interfaces within the Control Plane Figure 424-1 Roaming 5G System architecture- local breakout scenario in service-based interface representation NOTE 1 In the LBO architecture the PCF in the VPLMN may interact with the AF in order to generate PCC Rules for services delivered via the VPLMN the PCF in the VPLMN uses locally configured policies according to the roaming agreement with the HPLMN operator as input for PCC Rule generation the PCF in VPLMN has no access to subscriber policy information from the HPLMN NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_95",
    "document_id": "23501-i80",
    "chunk_id": 95,
    "text": "An SCP can be used for indirect communication between NFs and NF services within the VPLMN within the HPLMN or in within both VPLMN and HPLMN For simplicity the SCP is not shown in the roaming architecture NOTE 3 For clarity the NWDAFs with roaming exchange capability RE-NWDAF and their connections with other NFs are not depicted in the service-based architecture diagram For more information on network data analytics architecture refer to TS 23288 86 NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_96",
    "document_id": "23501-i80",
    "chunk_id": 96,
    "text": "Depending on the architecture deployed the Primary or Centralized NSACF at the VPLMN can fetch the maximum number of registered UEs or the maximum number of LBO PDU sessions to be enforced from the HPLMN Primary or Centralized NSACF as described in clause 5151131 Figure 424-2 Void Figure 424-3 depicts the 5G System roaming architecture in the case of home routed scenario with service-based interfaces within the Control Plane Figure 424-3 Roaming 5G System architecture - home routed scenario in service-based interface representation NOTE 4 An SCP can be used for indirect communication between NFs and NF services within the VPLMN within the HPLMN or in within both VPLMN and HPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_97",
    "document_id": "23501-i80",
    "chunk_id": 97,
    "text": "For simplicity the SCP is not shown in the roaming architecture NOTE 5 UPFs in the home routed scenario can be used also to support the IPUPS functionality see clause 58214 NOTE 6 For clarity the NWDAFs with roaming exchange capability RE-NWDAF and their connections with other NFs are not depicted in the service-based architecture diagram For more information on network data analytics architecture refer to TS 23288 86 Figure 424-4 depicts 5G System roaming architecture in the case of local break out scenario using the reference point representation Figure 424-4 Roaming 5G System architecture - local breakout scenario in reference point representation NOTE 7 The NRF is not depicted in reference point architecture figures Refer to Figure 424-7 for details on NRF and NF interfaces NOTE 8 For the sake of clarity SEPPs are not depicted in the roaming reference point architecture figures NOTE 9",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_98",
    "document_id": "23501-i80",
    "chunk_id": 98,
    "text": "For clarity the NWDAFs with roaming exchange capability RE-NWDAF and their connections with other NFs are not depicted in the reference point architecture figure For more information on network data analytics architecture refer to TS 23288 86 The following figure 424-6 depicts the 5G System roaming architecture in the case of home routed scenario using the reference point representation Figure 424-6 Roaming 5G System architecture - Home routed scenario in reference point representation The N38 references point can be between V-SMFs in the same VPLMN or between V-SMFs in different VPLMNs to enable inter-PLMN mobility NOTE 10 For clarity the NWDAFs with roaming exchange capability RE-NWDAF and their connections with other NFs are not depicted in the reference point architecture figure For more information on network data analytics architecture refer to TS 23288 86",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_99",
    "document_id": "23501-i80",
    "chunk_id": 99,
    "text": "For the roaming scenarios described above each PLMN implements proxy functionality to secure interconnection and hide topology on the inter-PLMN interfaces Figure 424-7 NRF Roaming architecture in reference point representation NOTE 11 For the sake of clarity SEPPs on both sides of PLMN borders are not depicted in figure 424-7 Figure 424-8 Void Operators can deploy UPFs supporting the Inter PLMN UP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_100",
    "document_id": "23501-i80",
    "chunk_id": 100,
    "text": "Security IPUPS functionality at the border of their network to protect their network from invalid inter PLMN N9 traffic in home routed roaming scenarios The UPFs supporting the IPUPS functionality in VPLMN and HPLMN are controlled by the V-SMF and the H-SMF of that PDU Session respectively A UPF supporting the IPUPS functionality terminates GTP-U N9 tunnels The SMF can activate the IPUPS functionality together with other UP functionality in the same UPF or insert a separate UPF for the IPUPS functionality in the UP path which eg may be dedicated to be used for IPUPS functionality Figure 424-9 depicts the home routed roaming architecture where a UPF is inserted in the UP path for the IPUPS functionality Figure 424-3 depicts the home routed roaming architecture where the two UPFs perform the IPUPS functionality and other UP functionality for the PDU Session NOTE 12 Operators are not prohibited from deploying the IPUPS functionality as a separate Network Function from the UPF acting as a transparent proxy which can transparently read N4 and N9 interfaces However such deployment option is not specified and needs to take at least into account very long lasting PDU Sessions with infrequent traffic and Inter-PLMN handover The IPUPS functionality is specified in clause 58214 and TS 33501 29 Figure 424-9 Roaming 5G System architecture - home routed roaming scenario in service-based interface representation employing UPF dedicated to IPUPS 425 Data Storage architectures As depicted in Figure 425-1 the 5G System architecture allows any NF to createreadupdatedelete its unstructured data in a UDSF eg UE contexts If such an NF is using UDSF is part of an NF set then any of the NF instance within this NF set may readupdatedelete the unstructured data that was created by this NF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_101",
    "document_id": "23501-i80",
    "chunk_id": 101,
    "text": "The UDSF belongs to the same PLMN where the network function is located CP NFsNF Sets may share a UDSF for storing their respective unstructured data or may each have their own UDSF eg a UDSF may be located close to the respective NF NOTE 1 Structured data in this specification refers to data for which the structure is defined in 3GPP specifications Unstructured data refers to data for which the structure is not defined in 3GPP specifications NOTE 2 If a NF Set has its own UDSF it is up to UDSF implementation and deployment that only the NF instance within the set can access the data created by another NF instance within the NF set If a UDSF is shared between several NFs not part of the same set or is shared between several NF sets it is up to UDSF implementation and deployment to make sure that only NFs that are authorized can access the data For further information about Guidelines and Principles for Compute-Storage Separation see Annex C Figure 425-1 Data Storage Architecture for unstructured data from any NF NOTE 3 3GPP will specify possibly by referencing the N18Nudsf interface As depicted in Figure 425-2 the 5G System architecture allows the UDM PCF and NEF to store data in the UDR including subscription data and policy data by UDM and PCF structured data for exposure and application data including Packet Flow Descriptions PFDs for application detection AF request information for multiple UEs by the NEF UDR can be deployed in each PLMN and it can serve different functions as follows - UDR accessed by the NEF belongs to the same PLMN where the NEF is located - UDR accessed by the UDM belongs to the same PLMN where the UDM is located if UDM supports a split architecture - UDR accessed by the PCF belongs to the same PLMN where the PCF is located NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_102",
    "document_id": "23501-i80",
    "chunk_id": 102,
    "text": "The UDR deployed in each PLMN can store application data for roaming subscribers Figure 425-2 Data Storage Architecture NOTE 5 There can be multiple UDRs deployed in the network each of which can accommodate different data sets or subsets eg subscription data subscription policy data data for exposure application data andor serve different sets of NFs Deployments where a UDR serves a single NF and stores its data and thus can be integrated with this NF can be possible NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_103",
    "document_id": "23501-i80",
    "chunk_id": 103,
    "text": "The internal structure of the UDR in figure 425-2 is shown for information only The Nudr interface is defined for the network functions ie NF Service Consumers such as UDM PCF and NEF to access a particular set of the data stored and to read update including add modify delete and subscribe to notification of relevant data changes in the UDR Each NF Service Consumer accessing the UDR via Nudr shall be able to add modify update or delete only the data it is authorised to change This authorisation shall be performed by the UDR on a per data set and NF service consumer basis and potentially on a per UE subscription granularity The following data in the UDR sets exposed via Nudr to the respective NF service consumer and stored shall be standardized - Subscription Data - Policy Data - Structured Data for exposure - Application data Packet Flow Descriptions PFDs for application detection and AF request information for multiple UEs as defined in clause 567",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_104",
    "document_id": "23501-i80",
    "chunk_id": 104,
    "text": "The service based Nudr interface defines the content and formatencoding of the 3GPP defined information elements exposed by the data sets In addition it shall be possible to access operator specific data sets by the NF Service Consumers from the UDR as well as operator specific data for each data set NOTE 7 The content and formatencoding of operator specific data and operator specific data sets are not subject to standardization NOTE 8 The organization of the different data stored in the UDR is not to be standardized 425a Radio Capabilities Signalling optimisation Figure 425a-1 depicts the AMF to UCMF reference point and interface Figure 425a-2 depicts the related interfaces in AMF and UCMF for the Radio Capabilities Signalling optimisation in the roaming architecture Figure 425a-1 Radio Capability Signalling optimisation architecture NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_105",
    "document_id": "23501-i80",
    "chunk_id": 105,
    "text": "The AF in the VPLMN ie the one having a relationship with the VPLMN NEF is the one which provisions Manufacturer Assigned UE radio capability IDs in the VPLMN UCMF RACS is a serving PLMN only feature it requires no specific support in the roaming agreement with the UE HPLMN to operate Figure 425a-2 Roaming architecture for Radio Capability Signalling optimisation 426 Service-based interfaces The 5G System Architecture contains the following service-based interfaces Namf Service-based interface exhibited by AMF Nsmf Service-based interface exhibited by SMF Nnef Service-based interface exhibited by NEF Npcf Service-based interface exhibited by PCF Nudm Service-based interface exhibited by UDM Naf Service-based interface exhibited by AF Nnrf Service-based interface exhibited by NRF Nnsacf Service-based interface exhibited by NSACF Nnssaaf Service-based interface exhibited by NSSAAF Nnssf Service-based interface exhibited by NSSF Nausf Service-based interface exhibited by AUSF Nudr Service-based interface exhibited by UDR Nudsf Service-based interface exhibited by UDSF N5g-eir Service-based interface exhibited by 5G-EIR Nnwdaf Service-based interface exhibited by NWDAF Nchf Service-based interface exhibited by CHF Nucmf Service-based interface exhibited by UCMF Ndccf Service based interface exhibited by DCCF Nmfaf Service based interface exhibited by MFAF Nadrf Service based interface exhibited by ADRF Naanf Service-based interface exhibited by AANF NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_106",
    "document_id": "23501-i80",
    "chunk_id": 106,
    "text": "The Service-based interface exhibited by AANF is defined in TS 33535 124 N5g-ddnmf Service-based interface exhibited by 5G DDNMF Nmbsmf Service-based interface exhibited by MB-SMF Nmbsf Service-based interface exhibited by MBSF NOTE 2 The Service-based interfaces exhibited by MB-SMF and MBSF are defined in TS 23247 129 Ntsctsf Service-based interface exhibited by TSCTSF Nbsp Service-based interface exhibited by an SBI capable Boostrapping Server Function in GBA NOTE 2 The Service-based interfaces exhibited by an SBI capable Boostrapping Server Function are defined in TS 33220 140 and TS 33223 141 Neasdf Service-based interface exhibited by EASDF NOTE 3 The Service-based interfaces exhibited by EADSF is defined in TS 23548 130 Nupf Service-based interface exhibited by UPF 427 Reference points",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_107",
    "document_id": "23501-i80",
    "chunk_id": 107,
    "text": "The 5G System Architecture contains the following reference points N1 Reference point between the UE and the AMF N2 Reference point between the RAN and the AMF N3 Reference point between the RAN and the UPF N4 Reference point between the SMF and the UPF N6 Reference point between the UPF and a Data Network N9 Reference point between two UPFs The following reference points show the interactions that exist between the NF services in the NFs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_108",
    "document_id": "23501-i80",
    "chunk_id": 108,
    "text": "These reference points are realized by corresponding NF service-based interfaces and by specifying the identified consumer and producer NF service as well as their interaction in order to realize a particular system procedure N5 Reference point between the PCF and an AF or TSN AF N7 Reference point between the SMF and the PCF N8 Reference point between the UDM and the AMF N10 Reference point between the UDM and the SMF N11 Reference point between the AMF and the SMF N12 Reference point between AMF and AUSF N13 Reference point between the UDM and Authentication Server function the AUSF N14 Reference point between two AMFs N15 Reference point between the PCF and the AMF in the case of non-roaming scenario PCF in the visited network and AMF in the case of roaming scenario N16 Reference point between two SMFs in roaming case between SMF in the visited network and the SMF in the home network N16a Reference point between SMF and I-SMF N17 Reference point between AMF and 5G-EIR N18 Reference point between any NF and UDSF N19 Reference point between two PSA UPFs for 5G LAN-type service N22 Reference point between AMF and NSSF N23 Reference point between PCF and NWDAF N24 Reference point between the PCF in the visited network and the PCF in the home network N27 Reference point between NRF in the visited network and the NRF in the home network N28 Reference point between PCF and CHF N29 Reference point between NEF and SMF N30 Reference point between PCF and NEF NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_109",
    "document_id": "23501-i80",
    "chunk_id": 109,
    "text": "The functionality of N28 and N29 and N30 reference points are defined in TS 23503 45 N31 Reference point between the NSSF in the visited network and the NSSF in the home network NOTE 2 In some cases a couple of NFs may need to be associated with each other to serve a UE N32 Reference point between a SEPP in one PLMN or SNPN and a SEPP in another PLMN or SNPN or between a SEPP in a SNPN and a SEPP in a CHDCS where the CHDCS contains a UDMAUSF NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_110",
    "document_id": "23501-i80",
    "chunk_id": 110,
    "text": "The functionality of N32 reference point is defined in TS 33501 29 N33 Reference point between NEF and AF N34 Reference point between NSSF and NWDAF N35 Reference point between UDM and UDR N36 Reference point between PCF and UDR N37 Reference point between NEF and UDR N38 Reference point between I-SMFs and between V-SMFs N40 Reference point between SMF and the CHF N41 Reference point between AMF and CHF in HPLMN N42 Reference point between AMF and CHF in VPLMN NOTE 4 The functionality of N40 N41 and N42 reference points are defined in TS 32240 41 N43 Reference point between PCFs NOTE 5 The functionality of N43 reference point is defined in TS 23503 45 NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_111",
    "document_id": "23501-i80",
    "chunk_id": 111,
    "text": "The reference points from N44 up to and including N49 are reserved for allocation and definition in TS 32240 41 N50 Reference point between AMF and the CBCF N51 Reference point between AMF and NEF N52 Reference point between NEF and UDM N55 Reference point between AMF and the UCMF N56 Reference point between NEF and the UCMF N57 Reference point between AF and the UCMF NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_112",
    "document_id": "23501-i80",
    "chunk_id": 112,
    "text": "The Public Warning System functionality of N50 reference point is defined in TS 23041 46 N58 Reference point between AMF and the NSSAAF N59 Reference point between UDM and the NSSAAF N60 Reference point between AUSF and NSWOF NOTE 8 The functionality of N60 reference point is defined in TS 33501 29 N80 Reference point between AMF and NSACF N81 Reference point between SMF and NSACF N82 Reference point between NSACF and NEF N83 Reference point between AUSF and NSSAAF N84 Reference point between TSCTSF and PCF N85 Reference point between TSCTSF and NEF N86 Reference point between TSCTSF and AF N87 Reference point between TSCTSF and UDM N88 Reference point between SMF and EASDF N89 Reference point between TSCTSF and AMF N96 Reference point between TSCTSF and NRF N97 Reference point between two NSACFs in different PLMNs N99 Reference point between two NSACFs within the same PLMN NOTE 9",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_113",
    "document_id": "23501-i80",
    "chunk_id": 113,
    "text": "The reference points from N90 up to and including N95 are reserved for allocation and definition in TS 23503 45 NOTE 10 The reference points from N100 up to and including N109 are reserved for allocation and definition in TS 32240 41 The reference points to support SMS over NAS are listed in clause 4422 The reference points to support Location Services are listed in TS 23273 87 The reference points to support SBA in IMS N5 N70 and N71 are described in TS 23228 15 The reference points to support AKMA N61 N62 and N63 are described in TS 33535 124 The reference points to support 5G ProSe are described in TS 23304 128 The reference points to support 5G multicast-broadcast services are described in TS 23247 129 The reference points to Support Uncrewed Aerial Systems UAS connectivity identification and tracking are described in TS 23256 136",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_114",
    "document_id": "23501-i80",
    "chunk_id": 114,
    "text": "The reference points to support SBA in GBA and GBA push N65 N66 N67 and N68 are described in TS 33220 140 and TS 33223 141 The reference points to support SMS delivery using SBA are described in TS 23540 142 The reference points to support Ranging based services and Sidelink Positioning are described in TS 23586 180 428 Support of non-3GPP access 4280 General In this Release of the specification the following types of non-3GPP access networks are defined - Untrusted non-3GPP access networks - Trusted non-3GPP access networks and - Wireline access networks The architecture to support Untrusted and Trusted non-3GPP access networks is defined in clause 4282 The architecture to support Wireline access networks is defined in clause 42824 and in TS 23316 84 4281 General Concepts to Support Trusted and Untrusted Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_115",
    "document_id": "23501-i80",
    "chunk_id": 115,
    "text": "Access The 5G Core Network supports connectivity of UEs via non-3GPP access networks eg WLAN access networks Only the support of non-3GPP access networks deployed outside the NG-RAN is described in this clause The 5G Core Network supports both untrusted non-3GPP access networks and trusted non-3GPP access networks TNANs An untrusted non-3GPP access network shall be connected to the 5G Core Network via a Non-3GPP InterWorking Function N3IWF whereas a trusted non-3GPP access network shall be connected to the 5G Core Network via a Trusted Non-3GPP Gateway Function TNGF Both the N3IWF and the TNGF interface with the 5G Core Network CP and UP functions via the N2 and N3 interfaces respectively A non-3GPP access network may advertise the PLMNs or SNPNs for which it supports trusted connectivity and the type of supported trusted connectivity eg 5G connectivity Therefore the UEs can discover the non-3GPP access networks that can provide trusted connectivity to one or more PLMNs or SNPNs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_116",
    "document_id": "23501-i80",
    "chunk_id": 116,
    "text": "This is further specified in clause 6312 Trusted Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_117",
    "document_id": "23501-i80",
    "chunk_id": 117,
    "text": "Access Network selection The UE decides to use trusted or untrusted non-3GPP access for connecting to a 5G PLMN or SNPNs by using procedures not specified in this document Examples of such procedures are defined in clause 63121 When the UE decides to use untrusted non-3GPP access to connect to a 5G Core Network in a PLMN - the UE first selects and connects with a non-3GPP access network and then - the UE selects a PLMNSNPN and an N3IWF in this PLMNSNPN The PLMNSNPNN3IWF selection and the non-3GPP access network selection are independent The N3IWF selection is defined in clause 636 When the UE decides to use trusted non-3GPP access to connect to a 5G Core Network in a PLMN - the UE first selects a PLMNSNPN and then - the UE selects a non-3GPP access network a TNAN that supports trusted connectivity to the selected PLMNSNPN In this case the non-3GPP access network selection is affected by the PLMNSNPN selection A UE that accesses the 5G Core Network over a non-3GPP access shall after UE registration support NAS signalling with 5G Core Network control-plane functions using the N1 reference point When a UE is connected via a NG-RAN and via a non-3GPP access multiple N1 instances shall exist for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_118",
    "document_id": "23501-i80",
    "chunk_id": 118,
    "text": "ie there shall be one N1 instance over NG-RAN and one N1 instance over non-3GPP access A UE simultaneously connected to the same 5G Core Network of a PLMNSNPN over a 3GPP access and a non-3GPP access shall be served by a single AMF in this 5G Core Network When a UE is connected to a 3GPP access of a PLMN if the UE selects a N3IWF and the N3IWF is located in a PLMN different from the PLMN of the 3GPP access eg in a different VPLMN or in the HPLMN the UE is served separately by the two PLMNs The UE is registered with two separate AMFs PDU Sessions over the 3GPP access are served by V-SMFs different from the V-SMF serving the PDU Sessions over the non-3GPP access The same can be true when the UE uses trusted non-3GPP access ie the UE may select one PLMN for 3GPP access and a different PLMN for trusted non-3GPP access NOTE The registrations with different PLMNs over different Access Types doesnt apply to UE registered for Disaster Roaming service as described in the clause 540",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_119",
    "document_id": "23501-i80",
    "chunk_id": 119,
    "text": "The PLMN selection for the 3GPP access does not depend on the PLMN that is used for non-3GPP access In other words if a UE is registered with a PLMN over a non-3GPP access the UE performs PLMN selection for the 3GPP access independently of this PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_120",
    "document_id": "23501-i80",
    "chunk_id": 120,
    "text": "A UE shall establish an IPsec tunnel with the N3IWF or with the TNGF in order to register with the 5G Core Network over non-3GPP access Further details about the UE registration to 5G Core Network over untrusted non-3GPP access and over trusted non-3GPP access are described in clause 4122 and in clause 4122a of TS 23502 3 respectively It shall be possible to maintain the UE NAS signalling connection with the AMF over the non-3GPP access after all the PDU Sessions for the UE over that access have been released or handed over to 3GPP access N1 NAS signalling over non-3GPP accesses shall be protected with the same security mechanism applied for N1 over a 3GPP access User plane QoS differentiation between UE and N3IWF is supported as described in clause 57 and clause 4125 of TS 23502 3 QoS differentiation between UE and TNGF is supported as described in clause 57 and clause 412a5 of TS 23502 3 4281A General Concepts to support Wireline Access Wireline 5G Access Network W-5GAN shall be connected to the 5G Core Network via a Wireline Access Gateway Function W-AGF The W-AGF interfaces the 5G Core Network CP and UP functions via N2 and N3 interfaces respectively For the scenario of 5G-RG connected via NG RAN the specification for UE defined in this TS TS 23502 3 and TS 23503 45 are applicable as defined for UE connected to 5GC via NG RAN unless differently specified in this TS and in TS 23316 84 When a 5G-RG is connected via a NG-RAN and via a W-5GAN multiple N1 instances shall exist for the 5G-RG",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_121",
    "document_id": "23501-i80",
    "chunk_id": 121,
    "text": "ie there shall be one N1 instance over NG-RAN and one N1 instance over W-5GAN A 5G-RG simultaneously connected to the same 5G Core Network of a PLMN over a 3GPP access and a W-5GAN access shall be served by a single AMF in this 5G Core Network 5G-RG shall maintain the NAS signalling connection with the AMF over the W-5GAN after all the PDU Sessions for the 5G-RG over that access have been released or handed over to 3GPP access The 5G-RG connected to 5GC via NG-RAN is specified in TS 23316 84 For the scenario of FN-RG which is not 5G capable connected via W-5GAN to 5GC the W-AGF provides the N1 interface to AMF on behalf of the FN-RG An UE connected to a 5G-RG or FN-RG can access to the 5GC via the N3IWF or via the TNGF where the combination of 5G-RGFN-RG W-AGF and UPF serving the 5G-RG or FN-RG is acting respectively as Untrusted Non-3GPP access network or as a Trusted Non-3GPP access network defined in clause 4282 for example a UE is connecting to 5G-RG by means of WLAN radio access and connected to 5GC via N3IWF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_122",
    "document_id": "23501-i80",
    "chunk_id": 122,
    "text": "The detailed description is specified in TS 23316 84 The roaming architecture for 5G-BRG FN-BRG 5G-CRG and FN-CRG with the W-5GAN is not specified in this Release The Home Routed roaming scenario is supported for 5G-RG connected via NG RAN while Local Breakout scenario is not supported 5G Multi-Operator Core Network 5G MOCN is supported for 5G-RG connected via NG RAN as defined in clause 518 4282 Architecture Reference Model for Trusted and Untrusted Non-3GPP Accesses 42821 Non-roaming Architecture Figure 42821-1 Non-roaming architecture for 5G Core Network with untrusted non-3GPP access Figure 42821-2 Non-roaming architecture for 5G Core Network with trusted non-3GPP access NOTE 1 The reference architecture in Figure 42821-1 and in Figure 42821-2 only shows the architecture and the network functions directly connected to non-3GPP access and other parts of the architecture are the same as defined in clause 42 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_123",
    "document_id": "23501-i80",
    "chunk_id": 123,
    "text": "The reference architecture in Figure 42821-1 and in Figure 42821-2 supports service based interfaces for AMF SMF and other NFs not represented in the figure NOTE 3 The two N2 instances in Figure 42821-1 and in Figure 42821-2 terminate to a single AMF for a UE which is simultaneously connected to the same 5G Core Network over 3GPP access and non-3GPP access NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_124",
    "document_id": "23501-i80",
    "chunk_id": 124,
    "text": "The two N3 instances in Figure 42821-1 and in Figure 42821-2 may terminate to different UPFs when different PDU Sessions are established over 3GPP access and non-3GPP access 42822 LBO Roaming Architecture Figure 42822-1 LBO Roaming architecture for 5G Core Network with untrusted non-3GPP access - N3IWF in the same VPLMN as 3GPP access Figure 42822-2 LBO Roaming architecture for 5G Core Network with untrusted non-3GPP access - N3IWF in a different PLMN from 3GPP access Figure 42822-3 LBO Roaming architecture for 5G Core Network with trusted non-3GPP access using the same VPLMN as 3GPP access Figure 42822-4 LBO Roaming architecture for 5G Core Network with trusted non-3GPP access using a different PLMN than 3GPP access NOTE 1 The reference architecture in all above figures only shows the architecture and the network functions directly connected to support non-3GPP access and other parts of the architecture are the same as defined in clause 42 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_125",
    "document_id": "23501-i80",
    "chunk_id": 125,
    "text": "The reference architecture in all above figures supports service based interfaces for AMF SMF and other NFs not represented in the figures NOTE 3 The two N2 instances in Figure 42822-1 and in Figure 42822-3 terminate to a single AMF for a UE which is connected to the same 5G Core Network over 3GPP access and non-3GPP access simultaneously NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_126",
    "document_id": "23501-i80",
    "chunk_id": 126,
    "text": "The two N3 instances in Figure 42822-1 and in Figure 42822-3 may terminate to different UPFs when different PDU Sessions are established over 3GPP access and non-3GPP access 42823 Home-routed Roaming Architecture Figure 42823-1 Home-routed Roaming architecture for 5G Core Network with untrusted non-3GPP access - N3IWF in the same VPLMN as 3GPP access Figure 42823-2 Home-routed Roaming architecture for 5G Core Network with untrusted non-3GPP access - N3IWF in a different VPLMN than 3GPP access Figure 42823-3 Home-routed Roaming architecture for 5G Core Network with untrusted non-3GPP access - N3IWF in HPLMN Figure 42823-4 Home-routed Roaming architecture for 5G Core Network with trusted non-3GPP access using the same VPLMN as 3GPP access NOTE 1 The reference architecture in all above figures only shows the architecture and the network functions directly connected to support non-3GPP access and other parts of the architecture are the same as defined in clause 42 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_127",
    "document_id": "23501-i80",
    "chunk_id": 127,
    "text": "The two N2 instances in Figure 42823-1 and in Figure 42823-4 terminate to a single AMF for a UE which is connected to the same 5G Core Network over 3GPP access and non-3GPP access simultaneously 4283 Reference Points for Non-3GPP Access 42831 Overview",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_128",
    "document_id": "23501-i80",
    "chunk_id": 128,
    "text": "The description of the reference points specific for the non-3GPP access N2 N3 N4 N6 these are defined in clause 42 Y1 Reference point between the UE and the untrusted non-3GPP access eg WLAN This depends on the non-3GPP access technology and is outside the scope of 3GPP Y2 Reference point between the untrusted non-3GPP access and the N3IWF for the transport of NWu traffic Y4 Reference point between the 5G-RG and the W-AGF which transports the user plane traffic and the N1 NAS protocol The definition of this interface is outside the scope of 3GPP Y5 Reference point between the FN-RG and the W-AGF The definition of this interface is outside the scope of 3GPP Yt Reference point between the UE and the TNAP See eg Figure 42821-2 Yt Reference point between the N5CW devices and the TWAP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_129",
    "document_id": "23501-i80",
    "chunk_id": 129,
    "text": "It is defined in clause 4285 NWu Reference point between the UE and N3IWF for establishing secure tunnels between the UE and N3IWF so that control-plane and user-plane exchanged between the UE and the 5G Core Network is transferred securely over untrusted non-3GPP access NWt Reference point between the UE and the TNGF A secure NWt connection is established over this reference point as specified in clause 412a22 of TS 23502 3 NAS messages between the UE and the AMF are transferred via this NWt connection Ta A reference point between the TNAP and the TNGF which is used to support an AAA interface Ta requirements are documented in clause 42832",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_130",
    "document_id": "23501-i80",
    "chunk_id": 130,
    "text": "Tn A reference point between two TNGFs which is used to facilitate UE mobility between different TNGFs inter-TNGF mobility Tn and inter-TNGF mobility are not specified in this Release of the specification 42832 Requirements on Ta Ta shall be able to - Carry EAP-5G traffic and user location information before the NWt connection is established between the UE and the TNGF - Allow the UE and the TNGF to exchange IP traffic In deployments where the TNAP does not allocate the local IP addresses to UEs Ta shall be able to - Allow the UE to request and receive IP configuration from the TNAN including a local IP address eg with DHCP This is to allow the UE to use an IP stack to establish a NWt connection between the UE and the TNGF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_131",
    "document_id": "23501-i80",
    "chunk_id": 131,
    "text": "The local IP address is the IP address that allows the UE to contact the TNGF the entity providing this local IP address is part of TNAN and out of 3GPP scope In this Release of the specification Ta is not specified 4284 Architecture Reference Model for Wireline Access network Figure 4284-1 Non- roaming architecture for 5G Core Network for 5G-RG with Wireline 5G Access network and NG RAN The 5G-RG can be connected to 5GC via W-5GAN NG RAN or via both accesses NOTE 1 The reference architecture in figure 4284-1 only shows the architecture and the network functions directly connected to Wireline 5G Access Network and other parts of the architecture are the same as defined in clause 42 NOTE 2 The reference architecture in figure 4284-1 supports service based interfaces for AMF SMF and other NFs not represented in the figure NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_132",
    "document_id": "23501-i80",
    "chunk_id": 132,
    "text": "The two N2 instances in Figure 4284-1 apply to a single AMF for a 5G-RG which is simultaneously connected to the same 5G Core Network over 3GPP access and Wireline 5G Access Network NOTE 4 The two N3 instances in Figure 428 4-1 may apply to different UPFs when different PDU Sessions are established over 3GPP access and Wireline 5G Access Network Figure 4284-2 Non- roaming architecture for 5G Core Network for FN-RG with Wireline 5G Access network and NG RAN The N1 for the FN-RG which is not 5G capable is terminated on W-AGF which acts on behalf of the FN-RG The FN-RG can only be connected to 5GC via W-5GAN NOTE 5 The reference architecture in figure 4284-2 only shows the architecture and the network functions directly connected to Wireline 5G Access Network and other parts of the architecture are the same as defined in clause 42 NOTE 6 The reference architecture in figure 4284-1 supports service based interfaces for AMF SMF and other NFs not represented in the figure 4285",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_133",
    "document_id": "23501-i80",
    "chunk_id": 133,
    "text": "Access to 5GC from devices that do not support 5GC NAS over WLAN access 42851 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_134",
    "document_id": "23501-i80",
    "chunk_id": 134,
    "text": "The devices that do not support 5GC NAS signalling over WLAN access are referred to as Non-5G-Capable over WLAN devices or N5CW devices for short A N5CW device is not capable to operate as a 5G UE that supports 5GC NAS signalling over a WLAN access network however it may be capable to operate as a 5G UE over NG-RAN Clause 4285 specifies the 5GC architectural enhancements that enable N5CW devices to access 5GC via trusted WLAN access networks A trusted WLAN access network is a particular type of a Trusted Non-3GPP Access Network TNAN that supports a WLAN access technology eg IEEE 80211 Not all trusted WLAN access networks support 5GC access from N5CW devices To support 5GC access from N5CW devices a trusted WLAN access network must support the special functionality specified below eg it must support a TWIF function When a N5CW device performs an EAP-based access authentication procedure to connect to a trusted WLAN access network the N5CW device may simultaneously be registered to a 5GC of a PLMN or SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_135",
    "document_id": "23501-i80",
    "chunk_id": 135,
    "text": "The 5GC registration is performed by the TWIF function see next clause in the trusted WLAN access network on behalf of the N5CW device The type of EAP authentication procedure which is used during the 5GC registration to authenticate the N5CW device is specified in TS 33501 29 In this Release of the specification Trusted WLAN Access for N5CW Device only supports IP PDU Session type 42852 Reference Architecture",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_136",
    "document_id": "23501-i80",
    "chunk_id": 136,
    "text": "The architecture diagram in Figure 42852-1 is based on the general 5GS architecture diagrams in clause 42 and shows the main network functions required to support 5GC access from N5CW devices Other network functions are not shown for simplicity Figure 42852-1 Non-roaming and LBO Roaming Architecture for supporting 5GC access from N5CW devices The reference architecture in Figure 42852-1 also supports N5CW device access to the subscribed SNPN or access to the SNPN with credentials owned by Credentials Holder Other parts of the architecture are the same as defined in clause 53029 42853 Network Functions Trusted WLAN Access Point TWAP It is a particular type of a Trusted Non-3GPP Access Point TNAP specified in clause 4282 that supports a WLAN access technology eg IEEE 80211 This function is outside the scope of the 3GPP specifications Trusted WLAN Interworking Function TWIF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_137",
    "document_id": "23501-i80",
    "chunk_id": 137,
    "text": "It provides interworking functionality that enables N5CW devices to access 5GC The TWIF supports the following functions - Terminates the N1 N2 and N3 interfaces -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_138",
    "document_id": "23501-i80",
    "chunk_id": 138,
    "text": "Implements the AMF selection procedure - Implements the NAS protocol stack and exchanges NAS messages with the AMF on behalf of the N5CW device - On the user plane it relays protocol data units PDUs between the Yw interface and the N3 interface - May implement a local mobility anchor within the trusted WLAN access network 42854 Reference Points The Yt and Yw reference points are both outside the scope of the 3GPP specifications The Yt reference point transports WLAN messages eg IEEE 80211 messages while the Yw reference point - Shall be able to transport authentication messages between the TNAP and the TWIF for enabling authentication of a N5CW device - Shall allow the N5CW device to request and receive IP configuration from the TWIF including an IP address eg with DHCP - Shall support the transport of user-plane traffic for the N5CW device The N1 N2 and N3 reference points are the same reference points defined in clause 427 429 Network Analytics architecture The Network Analytics architecture is defined in TS 23288 86 4210 Architecture Reference Model for ATSSS Support",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_139",
    "document_id": "23501-i80",
    "chunk_id": 139,
    "text": "In order to support the ATSSS feature the 5G System Architecture is extended as shown in Figure 4210-1 Figure 4210-2 and Figure 4210-3 The additional functionality that is supported by the UE and the network functions shown in these figures is specified in clause 532 below In summary - The UE supports one or more of the steering functionalities specified in clause 5326 ie the MPTCP functionality the MPQUIC functionality and the ATSSS-LL functionality Each steering functionality in the UE enables traffic steering switching and splitting across 3GPP access and non-3GPP access in accordance with the ATSSS rules provided by the network The ATSSS-LL functionality is mandatory in the UE for MA PDU Session of type Ethernet - The UPF may support the MPTCP Proxy functionality which communicates with the MPTCP functionality in the UE by using the MPTCP protocol IETF RFC 8684 81 as defined in clause 532621 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_140",
    "document_id": "23501-i80",
    "chunk_id": 140,
    "text": "The UPF may support the MPQUIC Proxy functionality which communicates with the MPQUIC functionality in the UE by using the QUIC protocol RFC 9000 166 RFC 9001 167 RFC 9002 168 and its multipath extensions draft-ietf-quic-multipath 174 as defined in clause 532622 - The UPF may support ATSSS-LL functionality which is similar to the ATSSS-LL functionality defined for the UE There is no user plane protocol defined between the ATSSS-LL functionality in the UE and the ATSSS-LL functionality in the UPF NOTE 1 ATSSS-LL functionality is needed in the 5GC for MA PDU Session of type Ethernet - In addition the UPF supports Performance Measurement Functionality PMF which may be used by the UE to obtain access performance measurements see clause 5325 over the user-plane of 3GPP access andor over the user-plane of non-3GPP access - The AMF SMF and PCF are extended with new functionality that is further discussed in clause 532 Figure 4210-1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_141",
    "document_id": "23501-i80",
    "chunk_id": 141,
    "text": "Non-roaming and Roaming with Local Breakout architecture for ATSSS support NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_142",
    "document_id": "23501-i80",
    "chunk_id": 142,
    "text": "The interactions between the UE and PCF that may be required for ATSSS control are specified in TS 23503 45 NOTE 3 The UPF shown in Figure 4210-1 can be connected via an N9 reference point instead of the N3 reference point Figure 4210-2 shows the 5G System Architecture for ATSSS support in a roaming case with home-routed traffic and when the UE is registered to the same VPLMN over 3GPP and non-3GPP accesses In this case the MPTCP Proxy functionality the MPQUIC Proxy functionality the ATSSS-LL functionality and the PMF are located in the H-UPF Figure 4210-2 Roaming with Home-routed architecture for ATSSS support UE registered to the same VPLMN Figure 4210-3 shows the 5G System Architecture for ATSSS support in a roaming case with home-routed traffic and when the UE is registered to a VPLMN over 3GPP access and to HPLMN over non-3GPP access ie the UE is registered to different PLMNs In this case the MPTCP Proxy functionality the MPQUIC Proxy functionality the ATSSS-LL functionality and the PMF are located in the H-UPF Figure 4210-3 Roaming with Home-routed architecture for ATSSS support UE registered to different PLMNs 4211 Architecture for 5G multicast-broadcast services The architecture for 5G multicast-broadcast services is defined in TS 23247 129 4212 Architecture for Proximity based Services ProSe in 5GS The architecture for Proximity based Services ProSe in the 5G System is defined in TS 23304 128 4213 Architecture enhancements for Edge Computing The architecture enhancements for edge computing are outlined in clause 513 and further described in TS 23548 130 4214 Architecture for Support of Uncrewed Aerial Systems connectivity identification and tracking The architecture for Support of Uncrewed Aerial Systems UAS connectivity identification and tracking is defined in TS 23256 136 4215 Architecture to support WLAN connection using 5G credentials without 5GS registration The reference architecture shown with reference point representation in Figure 4215-1 and with Service Based Interface SBI-representation in Figure 4215-2 enables a UE to connect to a WLAN access network using its 5GS credentials without registration to 5GS This architecture is based on the Non-Seamless WLAN Offload Function NSWOF which interfaces to the WLAN access network using the SWa reference point and interfaces to the AUSF using the Nausf SBI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_143",
    "document_id": "23501-i80",
    "chunk_id": 143,
    "text": "The SWa reference point corresponds to SWa reference point as defined in TS 23402 43 with the difference that SWa the EAP procedure ensures that the permanent user ID is not visible over the access as defined in TS 33501 29 and that SWa connects the Untrusted non-3GPP IP Access possibly via 3GPP AAA Proxy to the NSWOF and that the EAP user ID is a SUCI and not an IMSI The functionality of the NSWOF and the procedures applied for supporting a WLAN connection using 5GS credentials for Non-seamless WLAN offload are further defined in TS 33501 29 Annex S The roaming architectures are shown with reference point representation in Figure 4215-3 and with SBI representation in Figure 4215-4 The architecture in Figure 4215-1 and Figure 4215-2 applies to UEs with PLMN or SNPN credentials NOTE 1 For a UE with SNPN credentials it is assumed that the realm part of UE identifier in SUCI format is defined in a way that enables routing of SWa requests from the WLAN AN to the NSWOF in the SNPNs 5GC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_144",
    "document_id": "23501-i80",
    "chunk_id": 144,
    "text": "The architectures in Figure 4215-3a and Figure 4215-4a apply to UEs with PLMN or SNPN credentials from a CH using UDM The architecture in Figure 4215-3b applies to UEs with SNPN credentials from a CH using AAA Server In this architecture the UE procedures for access selection for 5G NSWO defined in clause 6312b apply Except the UE all NFs in Figure 4215-3b are out of scope of 3GPP The architectures in Figure 4215-3c and Figure 4215-4b apply to UEs with SNPN credentials from a CH using AAA Server via 5GC NSWOFAUSFUDMNSSAAF In this architecture the UE procedures for access selection for 5G NSWO defined in clause 6312b apply NOTE 2 How to protect the user identity over the WLAN interface in architecture defined in Figure 4215-3b and Figure 4215-3c is defined in TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_145",
    "document_id": "23501-i80",
    "chunk_id": 145,
    "text": "The UE can also connect to a WLAN access network using 5GS credentials by performing the 5GS registration via Trusted non-3GPP access procedure defined in clause 412a22 of TS 23502 3 With this procedure the UE connects to a WLAN access network using 5GS credentials and simultaneously registers in 5GS However the architecture defined in Figure 4215-1 Figure 4215-2 Figure 4215-3 and in Figure 4215-4 enables a UE to connect to a WLAN access network using 5GS credentials but without registration in 5GS If the WLAN is configured as Untrusted Non-3GPP access in the case that the WLAN supports IEEE 8021x the UE may first use the 5G NSWO procedure to obtain a connection with and the local IP address from the WLAN and any time after that the UE may initiate the Untrusted Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_146",
    "document_id": "23501-i80",
    "chunk_id": 146,
    "text": "Access to obtain the access to 5GC Figure 4215-1 Reference architecture to support authentication for Non-seamless WLAN offload in 5GS Figure 4215-2 Service based reference architecture to support authentication for Non-seamless WLAN offload in 5GS Figure 4215-3 Roaming reference architectures to support authentication for Non-seamless WLAN offload in 5GS Figure 4215-3a Reference architectures to support authentication for Non-seamless WLAN offload using credentials from Credentials Holder using UDM Figure 4215-3b Reference architecture to support authentication for Non-seamless WLAN offload using credentials from Credentials Holder using AAA Server Figure 4215-3c Reference architecture to support authentication for Non-seamless WLAN offload using credentials from Credentials Holder using AAA Server via 5GC NOTE 2 Configuration 2 in Figure 4215-3 and Figure 4215-3a is a deployment variant of configuration 1 Figure 4215-4 Service based Roaming reference architecture to support authentication for Non-seamless WLAN offload in 5GS The SWd reference point corresponds to the SWd reference point as defined in TS 23402 43 with the difference that SWd connects the 3GPP AAA Proxy possibly via intermediate 3GPP AAA Proxy to the NSWOF and that the EAP user ID is a SUCI and not an IMSI In both roaming and non-roaming scenarios the NSWOF acts towards the WLAN Access as a 3GPP AAA server with the difference that the EAP user ID is a SUCI and not an IMSI Figure 4215-4a Service based reference architecture to support authentication for Non-seamless WLAN offload using credentials from Credentials Holder using UDM Figure 4215-4b Service based reference architecture to support authentication for Non-seamless WLAN offload using credentials from Credentials Holder using AAA Server via 5GC 4216 Architecture to support User Plane Information Exposure via a service-based interface As depicted in Figure 4216-1 the 5G System architecture allows user plane information exposure to some NFs via service-based interface in UPF Figure 4216-1 Architecture to support User Plane Information Exposure via a service-based interface NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_147",
    "document_id": "23501-i80",
    "chunk_id": 147,
    "text": "In this Release of the specification only NWDAFDCCFMFAF NEFAF and TSNAFTSCTSF are considered as the receiver of the UPF event notifications NOTE 2 UPF information exposure is not restricted to SBI interface ie reporting via PFCP over N4 to SMF is still applicable Not all events can be subscribed to UPF directly The details and constraints for the subscription to UPF event exposure service ie direct vs indirect and the information exposed to certain NFs by UPF as well as the information contained in the event notifications are defined in clause 52262 of TS 23502 3 and clause 58217 4217",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_148",
    "document_id": "23501-i80",
    "chunk_id": 148,
    "text": "Architecture for Ranging based services and Sidelink Positioning The architecture for Ranging based services and Sidelink Positioning is defined in TS 23586 180 43 Interworking with EPC 431 Non-roaming architecture Figure 431-1 represents the non-roaming architecture for interworking between 5GS and EPCE-UTRAN Figure 431-1 Non-roaming architecture for interworking between 5GS and EPCE-UTRAN NOTE 1 N26 interface is an inter-CN interface between the MME and 5GS AMF in order to enable interworking between EPC and the NG core Support of N26 interface in the network is optional for interworking N26 supports subset of the functionalities essential for interworking that are supported over S10 NOTE 2 PGW-C SMF and UPF PGW-U are dedicated for interworking between 5GS and EPC which are optional and are based on UE MM Core Network Capability and UE subscription UEs that are not subject to 5GS and EPC interworking may be served by entities not dedicated for interworking ie by either by PGW or SMFUPF NOTE 3 There can be another UPF not shown in the figure above between the NG-RAN and the UPF PGW-U ie the UPF PGW-U can support N9 towards an additional UPF if needed NOTE 4 Figures and procedures in this specification that depict an SGW make no assumption whether the SGW is deployed as a monolithic SGW or as an SGW split into its control-plane and user-plane functionality as described in TS 23214 32 432 Roaming architecture Figure 432-1 represents the Roaming architecture with local breakout and Figure 432-2 represents the Roaming architecture with home-routed traffic for interworking between 5GS and EPCE-UTRAN Figure 432-1 Local breakout roaming architecture for interworking between 5GS and EPCE-UTRAN NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_149",
    "document_id": "23501-i80",
    "chunk_id": 149,
    "text": "There can be another UPF not shown in the figure above between the NG-RAN and the UPF PGW-U ie the UPF PGW-U can support N9 towards the additional UPF if needed NOTE 2 S9 interface from EPC is not required since no known deployment exists Figure 432-2 Home-routed roaming architecture for interworking between 5GS and EPCE-UTRAN 433 Interworking between 5GC via non-3GPP access and E-UTRAN connected to EPC 4331 Non-roaming architecture Figure 433-1 represents the non-roaming architecture for interworking between 5GC via non-3GPP access and EPCE-UTRAN Figure 4331-1 Non-roaming architecture for interworking between 5GC via non-3GPP access and EPCE-UTRAN NOTE 1 There can be another UPF not shown in the figure above between the N3IWFTNGF and the UPF PGW-U ie the UPF PGW-U can support N9 towards an additional UPF if needed NOTE 2 N26 interface is not precluded but it is not shown in the figure because it is not required for the interworking between 5GC via non-3GPP access and EPCE-UTRAN 4332",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_150",
    "document_id": "23501-i80",
    "chunk_id": 150,
    "text": "Roaming architecture Figure 4332-1 represents the Roaming architecture with local breakout and Figure 4332-2 represents the Roaming architecture with home-routed traffic for interworking between 5GC via non-3GPP access and EPCE-UTRAN Figure 4332-1 Local breakout roaming architecture for interworking between 5GC via non-3GPP access and EPCE-UTRAN NOTE 1 There can be another UPF not shown in the figure above between the N3IWFTNGF and the UPF PGW-U ie the UPF PGW-U can support N9 towards the additional UPF if needed NOTE 2 S9 interface from EPC is not required since no known deployment exists NOTE 3 N26 interface is not precluded",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_151",
    "document_id": "23501-i80",
    "chunk_id": 151,
    "text": "but it not shown in the figure because it is not required for the interworking between 5GC via non-3GPP access and EPCE-UTRAN Figure 4332-2 Home-routed roaming architecture for interworking between 5GC via non-3GPP access and EPCE-UTRAN NOTE 4 N26 interface is not precluded but it not shown in the figure because it is not required for the interworking between 5GC via non-3GPP access and EPCE-UTRAN 434 Interworking between ePDG connected to EPC and 5GS 4341 Non-roaming architecture Figure 4341-1 represents the non-roaming architecture for interworking between ePDGEPC and 5GS Figure 4341-1 Non-roaming architecture for interworking between ePDGEPC and 5GS NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_152",
    "document_id": "23501-i80",
    "chunk_id": 152,
    "text": "The details of the interfaces between the UE and the ePDG and between EPC nodes ie SWm SWx S2b and S6b are documented in TS 23402 43 NOTE 2 Interworking with ePDG is only supported with GTP based S2b S6b interface is optional see clause 411436 of TS 23502 3 4342 Roaming architectures Figure 4342-1 represents the Roaming architecture with local breakout and Figure 4342-2 represents the Roaming architecture with home-routed traffic for interworking between ePDGEPC and 5GS Figure 4342-1 Local breakout roaming architecture for interworking between ePDGEPC and 5GS NOTE 1 The details of the interfaces between the UE and the ePDG and between EPC nodes ie SWm SWd SWx S2b and S6b are documented in TS 23402 43 NOTE 2 Interworking with ePDG is only supported with GTP based S2b S6b interface is optional see clause 411436 of TS 23502 3 Figure 4342-2 Home-routed roaming architecture for interworking between ePDGEPC and 5GS NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_153",
    "document_id": "23501-i80",
    "chunk_id": 153,
    "text": "The details of the interfaces between the UE and the ePDG and between EPC nodes ie SWm SWd SWx S2b and S6b are documented in TS 23402 43 NOTE 2 Interworking with ePDG is only supported with GTP based S2b S6b interface is optional see clause 411436 of TS 23502 3 435 Service Exposure in Interworking Scenarios 4351 Non-roaming architecture Figure 4351-1 shows the non-roaming architecture for Service Exposure for EPC-5GC Interworking If the UE is capable of mobility between EPS and 5GS the network is expected to associate the UE with an SCEFNEF node for Service Capability Exposure Figure 4351 1 Non-roaming Service Exposure Architecture for EPC-5GC Interworking NOTE 1 In Figure 4351-1 Trust domain for SCEFNEF is same as Trust domain for SCEF as defined in TS 23682 36 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_154",
    "document_id": "23501-i80",
    "chunk_id": 154,
    "text": "In Figure 4351-1 EPC Interface represents southbound interfaces between SCEF and EPC nodes eg the S6t interface between SCEF and HSS the T6a interface between SCEF and MME etc All southbound interfaces from SCEF are defined in TS 23682 36 and are not shown for the sake of simplicity NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_155",
    "document_id": "23501-i80",
    "chunk_id": 155,
    "text": "In Figure 4351-1 5GC Interface represents southbound interfaces between NEF and 5GC Network Functions eg N29 interface between NEF and SMF N30 interface between NEF and PCF etc All southbound interfaces from NEF are not shown for the sake of simplicity NOTE 4 Interaction between the SCEF and NEF within the combined SCEFNEF is required For example when the SCEFNEF supports monitoring APIs the SCEF and NEF need to share context and state information on a UEs configured monitoring events if the UE moves between from EPC and 5GC NOTE 5 The north-bound APIs which can be supported by an EPC or 5GC network are discovered by the SCEFNEF node via the CAPIF function andor via local configuration of the SCEFNEF node Different sets of APIs can be supported by the two network types 4352 Roaming architectures Figure 4352-1 represents the roaming architecture for Service Exposure for EPC-5GC Interworking This architecture is applicable to both the home routed roaming and local breakout roaming Figure 4352-1 Roaming Service Exposure Architecture for EPC-5GC Interworking NOTE Figure 4352-1 does not include all the interfaces and network elements or network functions that may be connected to SCEFNEF 44 Specific services 441 Public Warning System The Public Warning System architecture for 5G System is specified in TS 23041 46 442 SMS over NAS 4420 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_156",
    "document_id": "23501-i80",
    "chunk_id": 156,
    "text": "This clause introduces legacy SMS over NAS architecture in which the interfaces between SMSFUDM and SMS-GMSCSMS-IWMSCIP-SM-GWSMS Router are still based on legacy protocol ie MAP or Diameter The SBI-based SMS architecture and interfaces are specified in TS 23540 142 4421 Architecture to support SMS over NAS Figure 4421-1 shows the non-roaming architecture to support SMS over NAS using the Service-based interfaces within the Control Plane Figure 4421-1 Non-roaming System Architecture for SMS over NAS Figure 4421-2 shows the non-roaming architecture to support SMS over NAS using the reference point representation Figure 4421-2 Non-roaming System Architecture for SMS over NAS in reference point representation NOTE 1 SMS Function SMSF may be connected to the SMS-GMSCIWMSCSMS Router via one of the standardized interfaces as shown in TS 23040 5 NOTE 2 UDM may be connected to the SMS-GMSCIWMSCSMS Router via one of the standardized interfaces as shown in TS 23040 5 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_157",
    "document_id": "23501-i80",
    "chunk_id": 157,
    "text": "Each UE is associated with only one SMS Function in the registered PLMN NOTE 4 SMSF re-allocation while the UE is in RM-REGISTERED state in the serving PLMN is not supported in this Release of the specification When serving AMF is re-allocated for a given UE the source AMF includes SMSF identifier as part of UE context transfer to target AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_158",
    "document_id": "23501-i80",
    "chunk_id": 158,
    "text": "If the target AMF eg in the case of inter-PLMN mobility detects that no SMSF has been selected in the serving PLMN then the AMF performs SMSF selection as specified in clause 6310 NOTE 5 To support MT SMS domain selection by IP-SM-GWSMS Router IP-SM-GWSMS Router may connect to SGs MSC MME and SMSF via one of the standardized interfaces as shown in TS 23040 5 Figure 4421-3 shows the roaming architecture to support SMS over NAS using the Service-based interfaces within the Control Plane Figure 4421-3 Roaming architecture for SMS over NAS Figure 4421-4 shows the roaming architecture to support SMS over NAS using the reference point representation Figure 4421-4 Roaming architecture for SMS over NAS in reference point representation 4422 Reference point to support SMS over NAS N1 Reference point for SMS transfer between UE and AMF via NAS Following reference points are realized by service based interfaces N8 Reference point for SMS Subscription data retrieval between AMF and UDM N20 Reference point for SMS transfer between AMF and SMS Function N21 Reference point for",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_159",
    "document_id": "23501-i80",
    "chunk_id": 159,
    "text": "SMS Function address registration management and SMS Management Subscription data retrieval between SMS Function and UDM 4423 Service based interface to support SMS over NAS Nsmsf Service-based interface exhibited by SMSF 443 IMS support IMS support for 5GC is defined in TS 23228 15 The 5G System architecture supports N5 interface between PCF and P-CSCF and supports Rx interface between PCF and P-CSCF to enable IMS service See TS 23228 15 TS 23503 45 and TS 23203 4 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_160",
    "document_id": "23501-i80",
    "chunk_id": 160,
    "text": "Rx support between PCF and P-CSCF is for backwards compatibility for early deployments using Diameter between IMS and 5GC functions NOTE 2 When service based interfaces are used between the PCF and P-CSCF in the same PLMN the P-CSCF performs the functions of a trusted AF in the 5GC 444 Location services 4441 Architecture to support Location Services Location Service feature is optional and applicable to both regulatory services and commercial services in this Release of the specification The non-roaming and roaming architecture to support Location Services are defined in clause 42 of TS 23273 87 4442 Reference point to support Location Services The reference points to support Location Services are defined in clause 44 of TS 23273 87 4443 Service Based Interfaces to support Location Services The Service Based Interfaces to support Location Services are defined in clause 45 of TS 23273 87 445 Application Triggering Services See clause 5261 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_161",
    "document_id": "23501-i80",
    "chunk_id": 161,
    "text": "Application trigger message contains information that allows the network to route the message to the appropriate UE and the UE to route the message to the appropriate application The information destined to the application excluding the information to route it is referred to as the Trigger payload The Trigger payload is implementation specific NOTE The application in the UE may perform actions indicated by the Trigger payload when the Triggered payload is received at the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_162",
    "document_id": "23501-i80",
    "chunk_id": 162,
    "text": "For example initiation of immediate or later communication with the application server based on the information contained in the Trigger payload which includes the PDU Session Establishment procedure if the related PDU Session is not already established 446 5G LAN-type Services 4461 User plane architecture to support 5G LAN-type service The general User Plane architectures described in clause 423 and clause 424 apply to 5G LAN-type services with the additional options described in this clause Figure 4461-1 depicts the non-roaming user plane architecture to support 5G LAN-type service using local switch Figure 4461-1 Local-switch based user plane architecture in",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_163",
    "document_id": "23501-i80",
    "chunk_id": 163,
    "text": "non-roaming scenario Figure 4461-2 depicts the non-roaming user plane architecture to support 5G LAN-type service using N19 tunnel Figure 4461-2 N19-based user plane architecture in non-roaming scenario NOTE As described in clause 5293 the PSA UPFs can be controlled by a dedicated SMF a dedicated SMF Set or multiple SMF Sets 4462 Reference points to support 5G LAN-type service N19 Reference point between two UPFs for direct routing of traffic between different PDU Sessions without using N6 It has a per 5G VN group granularity 447 MSISDN-less MO SMS Service MSISDN-less MO SMS via T4 is subscription based The subscription provides the information whether a UE is allowed to originate MSISDN-less MO SMS The UE is pre-configured with the Service Centre address that points to SMS-SC that performs this MO SMS delivery via NEF delivery procedure The recipient of this short message is set to the pre-configured address of the AF ie Address of the destination SME",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_164",
    "document_id": "23501-i80",
    "chunk_id": 164,
    "text": "If UE has multiple GPSIs associated to the same IMSI the GPSI that is associated with an SMS may be determined from the UEs IMSI and the Application Port ID value in the TP-User-Data field see TS 23040 5 The NEF may obtain the GPSI by querying the UDM with the IMSI and application port ID UE is aware whether the MO SMS delivery status success or fail based on the SMS delivery report from SMS-SC The network does not perform any storing and forwarding functionality for MO SMS See clause 526 of TS 23502 3 for a description of NEF Services and Service Operations 448 Architecture to enable Time Sensitive Communication Time Synchronization and Deterministic Networking 4481 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_165",
    "document_id": "23501-i80",
    "chunk_id": 165,
    "text": "The 5G System can be extended to support the following a Integration of 5GS into a TSN data network DN Integration as a bridge in an IEEE 8021 Time Sensitive Networking TSN The 5GS bridge supports the Time sensitive communication as defined in IEEE 8021 Time Sensitive Networking TSN standards The architecture is described in clause 4482 This Release supports of the specification integration of the 5G System with IEEE 8021 TSN networks that apply the fully centralized configuration model as defined in IEEE Std 8021Q 98 IEEE TSN is a set of standards to define mechanisms for the time-sensitive ie deterministic transmission of data over Ethernet networks b Enablers for AF requested support of Time Synchronization andor some aspects of Time Sensitive Communication The architecture is described in clause 4483 c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_166",
    "document_id": "23501-i80",
    "chunk_id": 166,
    "text": "Support for TSN enabled transport network TN Enablers for interworking with TSN network deployed in the transport network This option can be used simultaneously with either option a or b The architecture is described in clause 528a The interworking is applicable when the transport network deploys the fully centralized configuration model as defined in IEEE Std 8021Q 98 In this scenario a TSN TN is deployed to realize the N3 interface between RAN and UPF From the perspective of the TSN TN RAN and UPF act as End Stations of the TSN TN d Integration as a router in a Deterministic Network as defined in IETF RFC 8655 150",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_167",
    "document_id": "23501-i80",
    "chunk_id": 167,
    "text": "The architecture is described in clause 4484 4482 Architecture to support IEEE Time Sensitive Networking The 5G System is integrated with the external network as a TSN bridge This logical TSN bridge see Figure 4482-1 includes TSN Translator functionality for interoperation between TSN Systems and 5G System both for user plane and control plane 5GS TSN translator functionality consists of Device-side TSN translator DS-TT and Network-side TSN translator NW-TT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_168",
    "document_id": "23501-i80",
    "chunk_id": 168,
    "text": "The TSN AF is part of 5GC and provides the control plane translator functionality for the integration of the 5GS with a TSN network eg the interactions with the CNC 5G System specific procedures in 5GC and RAN wireless communication links etc remain hidden from the TSN network To achieve such transparency to the TSN network and the 5GS to appear as any other TSN Bridge the 5GS provides TSN ingress and egress ports via DS-TT and NW-TT DS-TT and NW-TT optionally support - hold and forward functionality for the purpose of de-jittering - per-stream filtering and policing as defined in clause 86521 of IEEE Std 8021Q 98 DS-TT optionally supports link layer connectivity discovery and reporting as defined in IEEE Std 8021AB 97 for discovery of Ethernet devices attached to DS-TT NW-TT supports link layer connectivity discovery and reporting as defined in IEEE Std 8021AB 97 for discovery of Ethernet devices attached to NW-TT If a DS-TT does not support link layer connectivity discovery and reporting then NW-TT performs link layer connectivity discovery and reporting as defined in IEEE Std 8021AB 97 for discovery of Ethernet devices attached to DS-TT on behalf of DS-TT NOTE 1 If NW-TT performs link layer connectivity discovery and reporting on behalf of DS-TT it is assumed that LLDP frames are transmitted between NW-TT and UE on the QoS Flow with the default QoS rule as defined in the clause 5711 Alternatively SMF can establish a dedicated QoS Flow matching on the Ethertype defined for LLDP IEEE Std 8021AB 97 There are three TSN configuration models defined in IEEE Std 8021Q 98",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_169",
    "document_id": "23501-i80",
    "chunk_id": 169,
    "text": "Amongst the three models - fully centralized model is supported in this Release of the specification - fully distributed model is not supported in this Release of the specification - centralized networkdistributed user model is not supported in this Release of the specification NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_170",
    "document_id": "23501-i80",
    "chunk_id": 170,
    "text": "This Release supports interworking with TSN using clause 8684 of IEEE Std 8021Q 98 scheduled traffic and clause 86521 of IEEE Std 8021Q 98 per-stream filtering and policy Figure 4482-1 System architecture view with 5GS appearing as TSN bridge NOTE 3 Whether DS-TT and UE are combined or are separate is up to implementation NOTE 4 TSN AF does not need to support N33 in this release of the specification 4483 Architecture for AF requested support of Time Sensitive Communication and Time Synchronization This clause describes the architecture to enable Time Sensitive Communication AF requested time sensitive communication and time synchronization services The Time Sensitive Communication and Time Synchronization related features that are supported based on AF request are described in clauses 5271 and 5272 respectively Figure 4483-1 shows the architecture to support Time Sensitive Communication and Time Synchronization services As shown in Figure 4483-1 to support Time Synchronization service based on IEEE Std 8021AS 104 or IEEE Std 1588 126 for Ethernet or IP type PDU Sessions the DS-TT NW-TT and Time Sensitive Communication and Time Synchronization Function TSCTSF are required in order to support the features in IEEE Std 8021AS 104 or IEEE Std 1588 126 as described in clause 527",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_171",
    "document_id": "23501-i80",
    "chunk_id": 171,
    "text": "The NEF exposes 5GS capability to support Time Synchronization service as described in clause 52718 TSCTSF controls the DS-TTs and NW-TT for the gPTP based time synchronization service In addition TSCTSF supports TSC assistance container related functionalities Figure 4483-1 Architecture to enable Time Sensitive Communication and Time Synchronization services NOTE 1 If the AF is considered to be trusted by the operator the AF could interact directly with TSCTSF the connection between AF and TSCTSF is not depicted in the architecture diagram for brevity UPFNW-TT distributes the gPTP messages as described in clause 5271 When the UPF supports one or more NW-TTs there is one-to-one association between an NW-TT and the network instance or between an NW-TT and network instance together with DNNS-NSSAI in the UPF When there are multiple network instances within a UPF each network instance is considered logically separate The network instance for the N6 interface clause 5612 may be indicated by the SMF to the UPF for a given PDU Session during PDU Session establishment procedure UPF allocates resources based on the Network Instance and S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_172",
    "document_id": "23501-i80",
    "chunk_id": 172,
    "text": "and it is supported according to TS 29244 65 DNNS-NSSAI may be indicated by the SMF together with the network instance to the UPF for a given PDU Session during PDU Session establishment procedure NOTE 2 The same NW-TT is used for all PDU Sessions in the UPF for the given DNNS-NSSAI the NW-TT is unique per DNNS-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_173",
    "document_id": "23501-i80",
    "chunk_id": 173,
    "text": "This ensures that the UPF selects an N4 session associated with the correct TSCTSF when the NW-TT initiates an UMIC or PMIC At any given time the NW-TT is associated with a single TSCTSF 4484 Architecture to support IETF Deterministic Networking The 5G System is integrated with the Deterministic Network as defined in IETF RFC 8655 150 as a logical DetNet transit router see Figure 4484-1 The TSCTSF performs mapping in the control plane between the 5GS internal functions and the DetNet controller 5G System specific procedures in 5GC and RAN remain hidden from the DetNet controller Figure 4484-1 5GS Architecture to support IETF Deterministic Networking On the device side the UE is connected with a DetNet system which may be a DetNet End System or a DetNet Node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_174",
    "document_id": "23501-i80",
    "chunk_id": 174,
    "text": "The architecture does not require the DS-TT functionality to be supported in the device nor require the user plane NW-TT functionality to be supported in the UPF however it can co-exist with such functions For the reporting of information of the network side ports NW-TT control plane function is used The architecture can be combined with architecture in clause 4483 to support time synchronization and TSC DetNet may be used in combination with time synchronization mechanisms as defined in clause 527 but it does not require usage of these mechanisms 5GS acts as a DetNet router in the DetNet domain Use cases where the 5GS acts as a sub-network see clause 412 of IETF RFC 8655 150 are also possible but do not require any additional 3GPP standardization A special case where the 5GS can act as a sub-network is when the 5GS acts as a TSN network which is supported by the 3GPP specifications based on the architecture in clause 4482 NOTE For DetNet interworking it is assumed that there is a business agreement to support the use of the DetNet controller so that it can be regarded trusted for the operator Depending on the needs of a given deployment functions such as the authentication authorization and potential throttling of signalling from the DetNet controller can be achieved by including such functionalities in the TSCTSF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_175",
    "document_id": "23501-i80",
    "chunk_id": 175,
    "text": "The routing of the downlink packets is achieved using the existing 3GPP functions 5 High level features 51 General Clause 5 specifies the high level functionality and features of the 5G System for both 3GPP and Non-3GPP access and for the interoperability with the EPC defined in TS 23401 26 52 Network Access Control 521 General Network access is the means for the user to connect to 5G CN Network access control comprises the following functionality - Network selection - Identification and authentication - Authorisation - Access control and barring - Policy control - Lawful Interception 522 Network selection In order to determine to which PLMN to attempt registration the UE performs network selection The network selection procedure comprises two main parts PLMN selection and access network selection The requirements for the PLMN selection are specified in TS 22011 25 and the procedures are in TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_176",
    "document_id": "23501-i80",
    "chunk_id": 176,
    "text": "The access network selection part for the 3GPP access networks is specified in TS 36300 30 for E-UTRAN and in TS 38300 27 for the NR The network selection for the Disaster Roaming is described in TS 23122 17 and TS 24501 47 522a Void 523 Identification and authentication The network may authenticate the UE during any procedure establishing a NAS signalling connection with the UE The security architecture is specified in TS 33501 29 The network may optionally perform an PEI check with 5G-EIR 524 Authorisation The authorisation for connectivity of the subscriber to the 5GC and the authorization for the services that the user is allowed to access based on subscription eg Operator Determined Barring Roaming restrictions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_177",
    "document_id": "23501-i80",
    "chunk_id": 177,
    "text": "Access Type and RAT Type currently in use is evaluated once the user is successfully identified and authenticated This authorization is executed during UE Registration procedure 525 Access control and barring When the UE needs to transmit an initial NAS message the UE shall request to establish an RRC Connection first and the NAS shall provide the RRC establishment related information to the lower layer",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_178",
    "document_id": "23501-i80",
    "chunk_id": 178,
    "text": "The RAN handles the RRC Connection with priority during and after RRC Connection Establishment procedure when UE indicates priority in Establishment related information Under high network load conditions the network may protect itself against overload by using the Unified Access Control functionality for 3GPP access specified in TS 22261 2 TS 24501 47 and TS 38300 27 to limit access attempts from UEs Depending on network configuration the network may determine whether certain access attempt should be allowed or blocked based on categorized criteria as specified in TS 22261 2 and TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_179",
    "document_id": "23501-i80",
    "chunk_id": 179,
    "text": "The NG-RAN may broadcast barring control information associated with Access Categories and Access Identities as specified in TS 38300 27 The NG-RAN node may initiate such Unified Access Control when - AMFs request to restrict the load for UEs that access the network by sending OVERLOAD START message containing conditions defined in clause 51952 or - requested by OAM or - triggered by NG-RAN itself If the NG-RAN node takes a decision to initiate UAC because of the reception of the N2 interface OVERLOAD START messages the NG-RAN should only initiate such procedure if all the AMFs relevant to the request contained in the OVERLOAD START message and connected to this NG-RAN node request to restrict the load for UEs that access the network If the UE supports both N1 and S1 modes NAS and as defined in TS 23401 26 the UE is configured for Extended Access Barring EAB but is not configured with a permission for overriding Extended Access Barring EAB when the UE wants to access the 5GS it shall perform Unified Access Control checks for Access Category 1 on receiving an indication from the upper layers as defined in TS 24501 47 TS 38331 28 TS 36331 51 If the UE supports both N1 and S1 modes NAS and as defined in TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_180",
    "document_id": "23501-i80",
    "chunk_id": 180,
    "text": "the UE is configured with a permission for overriding Extended Access Barring EAB when the UE wants to access the 5GS it shall ignore Unified Access Control checks for Access Category 1 on receiving an indication from the upper layers as defined in TS 24501 47 NOTE UE signalling of Low Access Priority indication over N1 in 5GS is not supported in this release of the specification Operator may provide one or more PLMN-specific Operator-defined access category definitions to the UE using NAS signalling and the UE handles the Operator-defined access category definitions stored for the Registered PLMN as specified in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_181",
    "document_id": "23501-i80",
    "chunk_id": 181,
    "text": "The access control for the Disaster Roaming is described in TS 23122 17 and TS 24501 47 526 Policy control Network access control including service authorization may be influenced by Policy control as specified in clause 514 527 Lawful Interception For definition and functionality of Lawful Interception please see TS 33126 35 53 Registration and Connection Management 531 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_182",
    "document_id": "23501-i80",
    "chunk_id": 182,
    "text": "The Registration Management is used to register or deregister a UEuser with the network and establish the user context in the network The Connection Management is used to establish and release the signalling connection between the UE and the AMF 532 Registration Management 5321 General A UEuser needs to register with the network to receive services that requires registration Once registered and if applicable the UE updates its registration with the network see TS 23502 3 - periodically in order to remain reachable Periodic Registration Update or - upon mobility Mobility Registration Update or - to update its capabilities or re-negotiate protocol parameters",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_183",
    "document_id": "23501-i80",
    "chunk_id": 183,
    "text": "Mobility Registration Update The Initial Registration procedure involves execution of Network Access Control functions as defined in clause 52 ie user authentication and access authorization based on subscription profiles in UDM As result of the Registration procedure the identifier of the serving AMF serving the UE in the access through which the UE has registered will be registered in UDM The registration management procedures are applicable over both 3GPP access and Non-3GPP access The 3GPP and Non-3GPP RM states are independent of each other see clause 5324 5322 5GS Registration Management states 53221 General Two RM states are used in the UE and the AMF that reflect the registration status of the UE in the selected PLMN - RM-DEREGISTERED - RM-REGISTERED 53222 RM-DEREGISTERED state In the RM-DEREGISTERED state the UE is not registered with the network The UE context in AMF holds no valid location or routing information for the UE so the UE is not reachable by the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_184",
    "document_id": "23501-i80",
    "chunk_id": 184,
    "text": "However some parts of UE context may still be stored in the UE and the AMF eg to avoid running an authentication procedure during every Registration procedure In the RM-DEREGISTERED state the UE shall - attempt to register with the selected PLMN using the Initial Registration procedure if it needs to receive service that requires registration see clause 4222 of TS 23502 3 - remain in RM-DEREGISTERED state if receiving a Registration Reject upon Initial Registration see clause 4222 of TS 23502 3 - enter RM-REGISTERED state upon receiving a Registration Accept see clause 4222 of TS 23502 3 When the UE RM state in the AMF is RM-DEREGISTERED the AMF shall - when applicable accept the Initial Registration of a UE by sending a Registration Accept to this UE and enter RM-REGISTERED state for the UE see clause 4222 of TS 23502 3 or - when applicable reject the Initial Registration of a UE by sending a Registration Reject to this UE see clause 4222 of TS 23502 3 53223 RM-REGISTERED state In the RM-REGISTERED state the UE is registered with the network In the RM-REGISTERED state the UE can receive services that require registration with the network In the RM-REGISTERED state the UE shall - perform Mobility Registration Update procedure if the current TAI of the serving cell see TS 37340 31 is not in the list of TAIs that the UE has received from the network in order to maintain the registration and enable the AMF to page the UE NOTE Additional considerations for Mobility Registration Update in case of NR satellite access are provided in clause 54116 - perform Periodic Registration Update procedure triggered by expiration of the periodic update timer to notify the network that the UE is still active - perform a Mobility Registration Update procedure to update its capability information or to re-negotiate protocol parameters with the network - perform Deregistration procedure see clause 42231 of TS 23502 3 and enter RM-DEREGISTERED state when the UE needs to be no longer registered with the PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_185",
    "document_id": "23501-i80",
    "chunk_id": 185,
    "text": "The UE may decide to deregister from the network at any time - enter RM-DEREGISTERED state when receiving a Registration Reject message or a Deregistration message The actions of the UE depend upon the cause value in the Registration Reject or Deregistration message See clause 422 of TS 23502 3 When the UE RM state in the AMF is RM-REGISTERED the AMF shall - perform Deregistration procedure see clauses 42232 42233 of TS 23502 3 and enter RM-DEREGISTERED state for the UE when the UE needs to be no longer registered with the PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_186",
    "document_id": "23501-i80",
    "chunk_id": 186,
    "text": "The network may decide to deregister the UE at any time - perform Implicit Deregistration at any time after the Implicit Deregistration timer expires The AMF shall enter RM-DEREGISTERED state for the UE after Implicit Deregistration - when applicable accept or reject Registration Requests or Service Requests from the UE 53224 5GS Registration Management State models Figure 53224-1 RM state model in UE Figure 53224-2 RM state model in AMF 5323 Registration Area management Registration Area management comprises the functions to allocate and reallocate a Registration area to a UE Registration area is managed per access type ie 3GPP access or Non-3GPP access When a UE registers with the network over the 3GPP access the AMF allocates a set of tracking areas in TAI List to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_187",
    "document_id": "23501-i80",
    "chunk_id": 187,
    "text": "When the AMF allocates registration area ie the set of tracking areas in TAI List to the UE it may take into account various information eg Mobility Pattern and AllowedNon-Allowed Area refer to clause 5341 An AMF which has the whole PLMN as serving area may alternatively allocate the whole PLMN all PLMN as registration area to a UE in MICO mode refer to clause 5413 When AMF allocates registration area for UE registered for Disaster Roaming service as specified in clause 5404 AMF shall only consider TAIs covering the area with the Disaster Condition The 5G System shall support allocating a Registration Area using a single TAI List which includes tracking areas of any NG-RAN nodes in the Registration Area for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_188",
    "document_id": "23501-i80",
    "chunk_id": 188,
    "text": "In the case of SNPN the TAI list allocated by AMF does not support Tracking Areas belonging to different SNPNs TAI used for non-3GPP access shall be dedicated to non-3GPP access TAIs dedicated to Non-3GPP access may be defined in a PLMN and apply within this PLMN Each N3IWF TNGF TWIF and W-AGF is locally configured with one TAI value Each N3IWF TNGF TWIF and W-AGF may be configured with a different TAI value or with the same TAI value as other N3IWFs TNGFs TWIFs andor W-AGFs The TAI is provided to the AMF during N2 interface setup and as part of the User Location Information in UE associated messages as described in TS 38413 34 When a UE registers with the network over a Non-3GPP access the AMF allocates to the UE a registration area that only includes the TAI received from the serving N3IWF TNGF TWIF or W-AGF NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_189",
    "document_id": "23501-i80",
    "chunk_id": 189,
    "text": "For example two W-AGFs can each correspond to a different TAI one TAI per W-AGF and thus support different sets of S-NSSAIs When generating the TAI list the AMF shall include only TAIs that are applicable on the access type ie 3GPP access or Non-3GPP access where the TAI list is sent NOTE 2 To prevent extra signalling load resulting from Mobility Registration Update occurring at every RAT change it is preferable to avoid generating a RAT-specific TAI list for a UE supporting more than one RAT NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_190",
    "document_id": "23501-i80",
    "chunk_id": 190,
    "text": "For a UE registered on N3GPP access the TAIs provided to the UE as part of the Registration Area is expected to enable the support of the slices that are intended to be provided for this UE over this specific Non-3GPP access In addition the Registration Area provided to the UE for non-3GPP access will never change until the UE deregisters from non-3GPP access either explicit deregistration or implicit deregistration due to Deregistration timer expiring due to UE entering CM_IDLE state For all 3GPP Access RATs in NG-RAN and for Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_191",
    "document_id": "23501-i80",
    "chunk_id": 191,
    "text": "Access the 5G System supports the TAI format as specified in TS 23003 19 consisting of MCC MNC and a 3-byte TAC only The additional aspects for registration management when a UE is registered over one access type while the UE is already registered over the other access type is further described in clause 5324 To ensure a UE initiates a Mobility Registration procedure when performing inter-RAT mobility to or from NB-IoT a Tracking Area shall not contain both NB-IoT and other RATs cells eg WB-E-UTRA NR and the AMF shall not allocate a TAI list that contains both NB-IoT and other RATs Tracking Areas For 3GPP access the AMF determines the RAT type the UE is camping on based on the Global RAN Node IDs associated with the N2 interface and additionally the Tracking Area indicated by NG-RAN When the UE is accessing NR using unlicensed bands as defined in clause 548 an indication is provided in N2 interface as defined in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_192",
    "document_id": "23501-i80",
    "chunk_id": 192,
    "text": "The AMF may also determine more precise RAT Type information based on further information received from NG-RAN - The AMF may determine the RAT Type to be LTE-M as defined in clause 53120 or - The AMF may determine the RAT Type to be NR using unlicensed bands as defined in clause 548 - The AMF may determine the RAT Type to be one of the RAT types for satellite access as defined in clause 5410 - The AMF may determine the RAT Type to be NR RedCap as defined in clause 541 For Non-3GPP accesses the AMF determines the RAT type the UE is camping based on the 5G-AN node associated with N2 interface as follows - The RAT type is Untrusted Non-3GPP if the 5G-AN node has a Global N3IWF Node ID - The RAT type is Trusted Non-3GPP if the 5G-AN node has a Global TNGF Node ID or a Global TWIF Node ID and - The RAT type is Wireline -BBF if the 5G-AN node has a Global W-AGF Node ID corresponding to a W-AGF supporting the Wireline BBF Access Network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_193",
    "document_id": "23501-i80",
    "chunk_id": 193,
    "text": "The RAT type is Wireline-Cable if the 5G-AN node has a Global W-AGF Node ID corresponding to a W-AGF supporting the Wireline Cable Access Network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_194",
    "document_id": "23501-i80",
    "chunk_id": 194,
    "text": "If not possible to distinguish between the two the RAT type is Wireline NOTE 4 How to differentiate between W-AGF supporting either Wireline BBF Access Network or the Wireline eg different Global W-AGF Node ID IE or the Global W-AGF Node ID including a field to distinguish between them is left to Stage 3 definition NOTE 5 If an operator supports only one kind of Wireline Access Network either Wireline BBF Access Network or a Wireline Cable Access Network the AMF may be configured to use RAT type Wireline or the specific one For Non-3GPP access the AMF may also use the User Location Information provided at N2 connection setup to determine a more precise RAT Type eg identifying IEEE 80211 access Wireline-Cable access Wireline-BBF access When the 5G-AN node has either a Global N3IWF Node ID or a Global TNGF Node ID or a Global TWIF Node ID or a Global W-AGF Node ID the Access Type is Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_195",
    "document_id": "23501-i80",
    "chunk_id": 195,
    "text": "Access 5324 Support of a UE registered over both 3GPP and Non-3GPP access This clause applies to Non-3GPP access network corresponding to the Untrusted Non-3GPP access network to the Trusted Non-3GPP and to the W-5GAN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_196",
    "document_id": "23501-i80",
    "chunk_id": 196,
    "text": "In the case of W-5GAN the UE mentioned in this clause corresponds to the 5G-RG For a given serving PLMN there is one RM context for a UE for each access eg when the UE is consecutively or simultaneously served by a 3GPP access and by a non-3GPP access ie via an N3IWF TNGF and W-AGF of the same PLMN UDM manages separateindependent UE Registration procedures for each access When served by the same PLMN for 3GPP and non-3GPP accesses an UE is served by the same AMF except in the temporary situation described in clause 517 ie after a mobility from EPS while the UE has PDU Sessions associated with non-3GPP access The 5G NSWO authentication as defined in Annex S of TS 33501 29 does not impact the RM state An AMF associates multiple access-specific RM contexts for an UE with - a 5G-GUTI that is common to both 3GPP and Non-3GPP accesses This 5G-GUTI is globally unique - a Registration state per access type 3GPP Non-3GPP - a Registration Area per access type one Registration Area for 3GPP access and another Registration Area for non 3GPP access Registration Areas for the 3GPP access and the Non-3GPP access are independent - timers for 3GPP access - a Periodic Registration timer and - a Mobile Reachable timer and an Implicit Deregistration timer - timers for non-3GPP access - a UE Non-3GPP Deregistration timer and -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_197",
    "document_id": "23501-i80",
    "chunk_id": 197,
    "text": "a Network Non-3GPP Implicit Deregistration timer The AMF shall not provide a Periodic Registration Timer for the UE over a Non-3GPP access Consequently the UE need not perform Periodic Registration Update procedure over Non-3GPP access Instead during the Initial Registration procedure and Re-registration the UE is provided by the network with a UE Non-3GPP Deregistration timer that starts when the UE enters non-3GPP CM-IDLE state When the 3GPP access and the non-3GPP access for the same UE are served by the same PLMN the AMF assigns the same 5G-GUTI for use over both accesses Such a 5G-GUTI may be assigned or re-assigned over any of the 3GPP and Non-3GPP accesses The 5G-GUTI is assigned upon a successful registration of the UE and is valid over both 3GPP and Non-3GPP access to the same PLMN for the UE Upon performing an initial access over the Non-3GPP access or over the 3GPP access while the UE is already registered with the 5G System over another access of the same PLMN the UE provides the native 5G-GUTI for the other access This enables the AN to select an AMF that maintains the UE context created at the previous Registration procedure via the GUAMI derived from the 5G-GUTI and enables the AMF to correlate the UE request to the existing UE context via the 5G-GUTI If the UE is performing registration over one access and intends to perform registration over the other access in the same PLMN eg the 3GPP access and the selected N3IWF TNGF or W-AGF are located in the same PLMN the UE shall not initiate the registration over the other access until the Registration procedure over first access is completed NOTE To which access the UE performs registration first is up to UE implementation When the UE is successfully registered to an access 3GPP access or Non-3GPP access respectively and the UE registers via the other access - if the second access is located in the same PLMN eg the UE is registered via a 3GPP access and selects a N3IWF TNGF or W-AGF located in the same PLMN the UE shall use for the registration to the PLMN associated with the new access the 5G-GUTI that the UE has been provided with at the previous registration or UE configuration update procedure for the first access in the same PLMN Upon successful completion of the registration to the second access if the network included a 5G-GUTI in the Registration Accept the UE shall use the 5G-GUTI received in the Registration Accept for both registrations If no 5G-GUTI is included in the Registration Accept then the UE uses the 5G-GUTI assigned for the existing registration also for the new registration - if the second access is located in a PLMN different from the registered PLMN of the first access ie not the registered PLMN eg the UE is registered to a 3GPP access and selects a N3IWF TNGF or W-AGF located in a PLMN different from the PLMN of the 3GPP access or the UE is registered over Non-3GPP and registers to a 3GPP access in a PLMN different from the PLMN of the N3IWF TNGF or W-AGF the UE shall use for the registration to the PLMN associated with the new access a 5G-GUTI only if it has got one previously received from a PLMN that is not the same as the PLMN the UE is already registered with If the UE does not include a 5G-GUTI the SUCI shall be used for the new registration Upon successful completion of the registration to the second access the UE has the two 5G-GUTIs one per PLMN A UE supporting registration over both 3GPP and Non-3GPP access to two PLMNs shall be able to handle two separate registrations including two 5G-GUTIs one per PLMN and two associated equivalent PLMN lists When a UE 5G-GUTI assigned during a Registration procedure over 3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_198",
    "document_id": "23501-i80",
    "chunk_id": 198,
    "text": "eg the UE registers first over a 3GPP access is location-dependent the same UE 5G-GUTI can be re-used over the Non-3GPP access when the selected N3IWF TNGF or W-AGF function is in the same PLMN as the 3GPP access When an UE 5G-GUTI is assigned during a Registration procedure performed over a Non 3GPP access eg the UE registers first over a non-3GPP access the UE 5G-GUTI may not be location-dependent so that the UE 5G-GUTI may not be valid for NAS procedures over the 3GPP access and in this case a new AMF is allocated during the Registration procedure over the 3GPP access When the UE is registered first via 3GPP access if the UE registers to the same PLMN via Non-3GPP access the UE shall send the GUAMI or 5G-GUTI obtained via 3GPP access to the N3IWF TNGF or W-AGF which uses the received GUAMI or 5G-GUTI to select the same AMF as the 3GPP access Whether GUAMI or 5G-GUTI is sent from the UE in a particular non-3GPP access is specified in TS 24501 47 and TS 24502 48 The Deregistration Request message indicates whether it applies to the 3GPP access the Non-3GPP access or both If the UE is registered on both 3GPP and Non-3GPP accesses and it is in CM-IDLE over Non-3GPP access then the UE or AMF may initiate a Deregistration procedure over the 3GPP access to deregister the UE only on the Non-3GPP access in which case all the PDU Sessions which are associated with the Non-3GPP access shall be released If the UE is registered on both 3GPP and non-3GPP accesses and it is in CM-IDLE over 3GPP access and in CM-CONNECTED over non-3GPP access then the UE may initiate a Deregistration procedure over the non-3GPP access to deregister the UE only on the 3GPP access in which case all the PDU Sessions which are associated with the 3GPP access shall be released Registration Management over Non-3GPP access is further defined in clause 551 533 Connection Management 5331 General Connection management comprises the functions of establishing and releasing a NAS signalling connection between a UE and the AMF over N1 This NAS signalling connection is used to enable NAS signalling exchange between the UE and the core network It comprises both the AN signalling connection between the UE and the AN RRC Connection over 3GPP access or UE-N3IWF connection over untrusted N3GPP access or UE-TNGF connection over trusted N3GPP access and the N2 connection for this UE between the AN and the AMF 5332 5GS Connection Management states 53321 General Two CM states are used to reflect the NAS signalling Connection of the UE with the AMF - CM-IDLE - CM-CONNECTED The CM state for 3GPP access and Non-3GPP access are independent of each other ie one can be in CM-IDLE state at the same time when the other is in CM-CONNECTED state 53322 CM-IDLE state A UE in CM-IDLE state has no NAS signalling connection established with the AMF over N1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_199",
    "document_id": "23501-i80",
    "chunk_id": 199,
    "text": "The UE performs cell selectioncell reselection according to TS 38304 50 and PLMN selection according to TS 23122 17 There are no AN signalling connection N2 connection and N3 connections for the UE in the CM-IDLE state If the UE is both in CM-IDLE state and in RM-REGISTERED state the UE shall unless otherwise specified in clause 5341 - Respond to paging by performing a Service Request procedure see clause 4232 of TS 23502 3 unless the UE is in MICO mode see clause 5413 - perform a Service Request procedure when the UE has uplink signalling or user data to be sent see clause 4232 of TS 23502 3 Specific conditions apply for LADN see clause 565 When the UE state in the AMF is RM-REGISTERED UE information required for initiating communication with the UE shall be stored The AMF shall be able to retrieve stored information required for initiating communication with the UE using the 5G-GUTI NOTE In 5GS there is no need for paging using the SUPISUCI of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_200",
    "document_id": "23501-i80",
    "chunk_id": 200,
    "text": "The UE provides 5G-S-TMSI as part of AN parameters during AN signalling connection establishment as specified in TS 38331 28 and TS 36331 51 The UE shall enter CM-CONNECTED state whenever an AN signalling connection is established between the UE and the AN entering RRC_CONNECTED state over 3GPP access or at the establishment of the UE-N3IWF connectivity over untrusted non-3GPP access or the UE-TNGF connectivity over trusted non-3GPP access The transmission of an Initial NAS message Registration Request Service Request or Deregistration Request initiates the transition from CM-IDLE to CM-CONNECTED state When the UE states in the AMF are CM-IDLE and RM-REGISTERED the AMF shall - perform a network triggered Service Request procedure when it has signalling or mobile-terminated data to be sent to this UE by sending a Paging Request to this UE see clause 4233 of TS 23502 3 if a UE is not prevented from responding eg due to MICO mode or Mobility Restrictions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_201",
    "document_id": "23501-i80",
    "chunk_id": 201,
    "text": "The AMF shall enter CM-CONNECTED state for the UE whenever an N2 connection is established for this UE between the AN and the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_202",
    "document_id": "23501-i80",
    "chunk_id": 202,
    "text": "The reception of initial N2 message eg N2 INITIAL UE MESSAGE initiates the transition of AMF from CM-IDLE to CM-CONNECTED state The UE and the AMF may optimize the power efficiency and signalling efficiency of the UE when in CM-IDLE state eg by activating MICO mode see clause 5413 53323 CM-CONNECTED state A UE in CM-CONNECTED state has a NAS signalling connection with the AMF over N1 A NAS signalling connection uses an RRC Connection between the UE and the NG-RAN and an NGAP UE association between the AN and the AMF for 3GPP access A UE can be in CM-CONNECTED state with an NGAP UE association that is not bound to any TNLA between the AN and the AMF See clause 52112 for details on the state of NGAP UE association for an UE in CM-CONNECTED state Upon completion of a NAS signalling procedure the AMF may decide to release the NAS signalling connection with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_203",
    "document_id": "23501-i80",
    "chunk_id": 203,
    "text": "In the CM-CONNECTED state the UE shall - enter CM-IDLE state whenever the AN signalling connection is released entering RRC_IDLE state over 3GPP access or when the release of the UE-N3IWF connectivity over untrusted non-3GPP access or the UE-TNGF connectivity over trusted non-3GPP access is detected by the UE see TS 38331 28 for 3GPP access When the UE CM state in the AMF is CM-CONNECTED the AMF shall - enter CM-IDLE state for the UE whenever the logical NGAP signalling connection and the N3 user plane connection for this UE are released upon completion of the AN Release procedure as specified in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_204",
    "document_id": "23501-i80",
    "chunk_id": 204,
    "text": "The AMF may keep a UE CM state in the AMF in CM-CONNECTED state until the UE de-registers from the core network A UE in CM-CONNECTED state can be in RRC_INACTIVE state see TS 38300 27 When the UE is in RRC_INACTIVE state the following applies - UE reachability is managed by the RAN with assistance information from core network - UE paging is managed by the RAN - UE monitors for paging with UEs CN 5G S-TMSI and RAN identifier 53324 5GS Connection Management State models Figure 53324-1 CM state transition in UE Figure 53324-2 CM state transition in AMF When a UE enters CM-IDLE state the UP connection of the PDU Sessions that were active on this access are deactivated NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_205",
    "document_id": "23501-i80",
    "chunk_id": 205,
    "text": "The activation of UP connection of PDU Sessions is documented in clause 568 53325 CM-CONNECTED with RRC_INACTIVE state RRC_INACTIVE state applies to NG-RAN UE support for RRC_INACTIVE state is defined in TS 38306 69 for NR and TS 36306 70 for E-UTRA connected to 5GC RRC_INACTIVE is not supported by NB-IoT connected to 5GC The AMF shall provide assistance information to the NG-RAN to assist the NG-RANs decision whether the UE can be sent to RRC_INACTIVE state except due to some exceptional cases such as - PLMN or AMF set does not support RRC_INACTIVE - The UE needs to be kept in CM-CONNECTED State eg for tracking The RRC Inactive Assistance Information includes - UE specific DRX values - UE specific extended idle mode DRX values cycle length and Paging Time Window length - The Registration Area provided to the UE - Periodic Registration Update timer - If the AMF has enabled MICO mode for the UE an indication that the UE is in MICO mode - Information from the UE identifier as defined in TS 38304 50 for NR and TS 36304 52 for E-UTRA connected to 5GC that allows the RAN to calculate the UEs RAN paging occasions -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_206",
    "document_id": "23501-i80",
    "chunk_id": 206,
    "text": "An indication that Paging Cause Indication for Voice Service is supported - AMF PEIPS Assistance Information see clause 54122 for paging a UE in CM-CONNECTED with RRC_INACTIVE state over NR as defined in TS 38300 27 - CN based MT communication handling support indication for RRC_INACATIVE state see clause 531721 The RRC Inactive Assistance Information mentioned above is provided by the AMF during N2 activation with the new serving NG-RAN node ie during Registration Service Request Handover to assist the NG RANs decision whether the UE can be sent to RRC_INACTIVE state If the AMF allocates a new Registration Area to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_207",
    "document_id": "23501-i80",
    "chunk_id": 207,
    "text": "the AMF should update the NG-RAN with the new Registration Area by sending the RRC Inactive Assistance Information accordingly The Paging Cause Indication for Voice Service is used to assist NG RAN to perform RAN based paging RRC_INACTIVE state is part of RRC state machine and it is up to the RAN to determine the conditions to enter RRC_INACTIVE state If any of the parameters included in the RRC Inactive Assistance Information changes as the result of NAS procedure the AMF shall update the RRC Inactive Assistance Information to the NG-RAN node When the UE is in CM-CONNECTED state if the AMF has provided RRC Inactive assistance information the RAN node may decide to move a UE to CM-CONNECTED with RRC_INACTIVE state The state and endpoints in the case of Dual Connectivity configuration of the N2 and N3 reference points are not changed by the UE entering CM-CONNECTED with RRC_INACTIVE state A UE in RRC_INACTIVE state is aware of the RAN Notification area and periodic RAN Notification Area Update timer",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_208",
    "document_id": "23501-i80",
    "chunk_id": 208,
    "text": "The 5GC network is not aware of the UE transitions between CM-CONNECTED with RRC_CONNECTED and CM-CONNECTED with RRC_INACTIVE state unless the 5GC network is notified via N2 notification procedure in clause 483 of TS 23502 3 At transition into CM-CONNECTED with RRC_INACTIVE state the NG-RAN configures the UE with a periodic RAN Notification Area Update timer taking into account the value of the Periodic Registration Update timer value indicated in the RRC Inactive Assistance Information and uses a guard timer with a value longer than the RAN Notification Area Update timer value provided to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_209",
    "document_id": "23501-i80",
    "chunk_id": 209,
    "text": "If the periodic RAN Notification Area Update guard timer expires in NG-RAN the NG-RAN shall initiate AN Release procedure as specified in clause 426 of TS 23502 3 When the UE is in CM-CONNECTED with RRC_INACTIVE state the UE performs PLMN selection procedures as defined in TS 23122 17 and TS 24501 47 When the UE is CM-CONNECTED with RRC_INACTIVE state the UE may resume the RRC Connection due to - Uplink data pending - Mobile initiated NAS signalling procedure - As a response to RAN paging - Notifying the network that it has left the RAN Notification Area - Upon periodic RAN Notification Area Update timer expiration If the UE resumes the connection in a different NG-RAN node within the same PLMN or equivalent PLMN or within the same SNPN or equivalent SNPN the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_210",
    "document_id": "23501-i80",
    "chunk_id": 210,
    "text": "AS context is retrieved from the old NG-RAN node and a procedure is triggered towards the CN see clause 482 of TS 23502 3 NOTE 1 With Dual Connectivity configuration if the UE resumes the RRC connection in the Master RAN node the Secondary RAN node configuration is defined in TS 38300 27 If the RAN paging procedure applying DRX or eDRX value no longer than 1024s as defined in TS 38300 27 is not successful in establishing contact with the UE the procedure shall be handled by the network as follows - If NG-RAN has at least one pending NAS PDU for transmission the RAN node shall initiate the AN Release procedure see clause 426 of TS 23502 3 to move the UE CM state in the AMF to CM-IDLE state and indicate to the AMF the NAS non-delivery - If NG RAN has only pending user plane data for transmission the NG-RAN node may keep the N2 connection active or initiate the AN Release procedure see clause 426 of TS 23502 3 based on local configuration in NG-RAN NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_211",
    "document_id": "23501-i80",
    "chunk_id": 211,
    "text": "The user plane data which triggers the RAN paging can be lost eg in the case of RAN paging failure If the RAN paging procedure applying eDRX value longer than 1024s as defined in TS 38300 27 has not requested the CN based mobile terminated MT communication handling as described in clause 531721 and is not successful in establishing contact with the UE after paging the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_212",
    "document_id": "23501-i80",
    "chunk_id": 212,
    "text": "the procedure shall be handled by network as follows - If NG-RAN has at least one pending NAS PDU for transmission the RAN node shall initiate the AN Release procedure see clause 426 of TS 23502 3 to move the UE CM state in the AMF to CM-IDLE state and indicate to the AMF the NAS non-delivery - If NG-RAN has only pending user plane data for transmission the NG-RAN node may keep the N2 connection active and based on implementation send indication to the CN requesting the CN based mobile terminated MT communication handling as described in clause 531721 or initiate the AN Release procedure see clause 426 of TS 23502 3 based on local configuration in NG-RAN NOTE 3 The user plane data which triggers the RAN paging can be lost eg in the case of RAN paging failure If a UE in CM-CONNECTED with RRC_INACTIVE state performs cell selection to GERANUTRANE-UTRAN it shall follow idle mode procedures of the selected RAT as specified in clause 517",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_213",
    "document_id": "23501-i80",
    "chunk_id": 213,
    "text": "In addition a UE in CM-CONNECTED state with RRC_INACTIVE state shall enter CM-IDLE state and initiates the NAS signalling recovery see TS 24501 47 in the following cases - If RRC resume procedure fails If the UE receives Core Network paging - If the periodic RAN Notification Area Update timer expires and the UE cannot successfully resume the RRC Connection -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_214",
    "document_id": "23501-i80",
    "chunk_id": 214,
    "text": "In any other failure scenario that cannot be resolved in RRC_INACTIVE state and requires the UE to move to CM-IDLE state When a UE is in CM-CONNECTED with RRC_INACTIVE state and a trigger to change the UEs NG-RAN or E-UTRAN UE Radio Capability information happens the UE shall move to CM-IDLE state and initiate the procedure for updating UE Radio Capability defined in clause 5441 For specific requirements for a UE operating in dual-registration mode see clause 51721 When UE is in CM-CONNECTED with RRC_INACTIVE state if RAN has received Location Reporting Control message from AMF with the Reporting Type indicating single stand-alone report or continuously reporting whenever the UE changes the cell the RAN shall perform location reporting as specified in clause 410 of TS 23502 3 When the UE is CM-CONNECTED with RRC_INACTIVE state If the AMF receives Nudm_UECM_DeregistrationNotification from UDM the AMF shall initiate AN Release procedure as specified in clause 426 of TS 23502 3 When UE is in CM-CONNECTED with RRC_INACTIVE state if RAN has received Location Reporting Control message from AMF with the Reporting Type of the Area Of Interest based reporting the RAN shall send a Location Report message to AMF including UE presence in the Area Of Interest ie IN OUT or UNKNOWN and the UEs last known location with time stamp When the UE is in CM-CONNECTED with RRC_INACTIVE state if the old NG-RAN node that sends the UE into RRC_INACTIVE state receives the downlink N2 signalling it initiates the RAN paging as defined in TS 38300 27 If the UE resumes the RRC Connection towards a different NG-RAN node the old NG-RAN node includes the UE Context Transfer indication into a response container to the NF eg AMF or SMF that generates such N2 downlink signalling Then the NF shall reattempt the same procedure when the path switch from the old NG-RAN node to the new NG-RAN node is complete 5333 NAS signalling connection management 53331 General NAS signalling connection management includes the functions of establishing and releasing a NAS signalling connection 53332 NAS signalling connection establishment NAS signalling connection establishment function is provided by the UE and the AMF to establish a NAS signalling connection for a UE in CM-IDLE state The AMF shall provide the list of recommended cells TAs NG-RAN node identifiers for paging if the NG-RAN had provided that information in an earlier AN Release Procedure in the AN see clause 426 of TS 23502 3 When the UE in CM-IDLE state needs to transmit an NAS message the UE shall initiate a Service Request a Registration or a Deregistration procedure to establish a NAS signalling connection to the AMF as specified in clauses 422 and 423 of TS 23502 3 If the NAS signalling connection is to be established via an NG-RAN node but the AMF detects that this UE has already established a NAS signalling connection via old NG-RAN node the AMF shall release the old established NAS signalling connection by triggering AN Release Procedure Based on UE preferences UE subscription Mobility Pattern and network configuration the AMF may keep the NAS signalling connection until the UE de-registers from the network 53333 NAS signalling connection Release",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_215",
    "document_id": "23501-i80",
    "chunk_id": 215,
    "text": "The procedure of releasing a NAS signalling connection is initiated by the AN node either 5G RAN node or N3IWF or the AMF The NG-RAN node may include the list of recommended cells TAs NG-RAN node identifiers for paging during the AN Release Procedure in the AN see clause 426 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_216",
    "document_id": "23501-i80",
    "chunk_id": 216,
    "text": "The AMF stores this information if provided by the NG-RAN The UE considers the NAS signalling connection is released if it detects the AN signalling connection is released The AMF considers the NAS signalling connection is released if it detects the N2 context is released 5334 Support of a UE connected over both 3GPP and Non-3GPP access The AMF manages two CM states for an UE a CM state for 3GPP access and a CM state for Non-3GPP access An N2 interface can serve the UE for either 3GPP access or for Non 3GPP access UE connected over both 3GPP and Non-3GPP has got two N2 interfaces one for each access A UE may be in any combination of the CM states between 3GPP and Non-3GPP access eg a UE may be CM-IDLE for one access and CM-CONNECTED for the other access CM-IDLE for both accesses or CM-CONNECTED for both accesses When the UE CM state in the AMF is CM-IDLE for 3GPP access and CM-CONNECTED for Non-3GPP access the AMF shall perform a network triggered Service Request procedure when it has downlink data to be sent to this UE for 3GPP access by sending either the Paging Request via 3GPP access or the NAS notification via Non-3GPP access to this UE see clause 4233 of TS 23502 3 Connection Management over Non-3GPP access is further defined in clause 552",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_217",
    "document_id": "23501-i80",
    "chunk_id": 217,
    "text": "534 UE Mobility 5341 Mobility Restrictions 53411 General Mobility Restrictions restrict mobility handling or service access of a UE The Mobility Restriction functionality is provided by the UE only for mobility restriction categories provided to the UE the radio access network and the core network Unless otherwise stated Mobility Restrictions only apply to 3GPP access and wireline access they do not apply to other non-3GPP accesses The UE and the network shall override Mobility restriction as specified in clause 51643 when accessing the network for Emergency Services For MPS and MCX based on operator policy or regionalnational regulations service area restrictions do not apply as specified in TS 24501 47 For UE requesting Disaster Roaming service the UE is only allowed to receive services in the area with Disaster Condition as specified in clause 5404",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_218",
    "document_id": "23501-i80",
    "chunk_id": 218,
    "text": "The other areas within the PLMN shall be considered as forbidden area for the UE registered for Disaster Roaming service Service Area restrictions and handling of Forbidden Areas for CM-IDLE state and for CM-CONNECTED state when in RRC_INACTIVE state are executed by the UE based on information received from the core network Mobility Restrictions for CM-CONNECTED state when in RRC_CONNECTED state are executed by the radio access network and the core network In CM-CONNECTED state the core network provides Mobility Restrictions to the radio access network within Mobility Restriction List Mobility Restrictions consists of RAT restriction Forbidden Area Service Area Restrictions Core Network type restriction and Closed Access Group information as follows - RAT restriction Defines the 3GPP and non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_219",
    "document_id": "23501-i80",
    "chunk_id": 219,
    "text": "Radio Access Technologyies a UE is not allowed to access in a PLMN In a restricted RAT a UE based on subscription is not permitted access to the network for this PLMN For 3GPP access and CM-CONNECTED state when radio access network determines target RAT and target PLMN during Handover or redirection procedure it should take per PLMN RAT restriction into consideration The RAT restriction is enforced in the network and not provided to the UE - Forbidden Area In a Forbidden Area the UE based on subscription is not permitted to initiate any communication with the network for this PLMN The UE behaviour in terms of cell selection RAT selection and PLMN selection depends on the network response that informs the UE of Forbidden Area A Forbidden Area applies either to 3GPP access or to non-3GPP access Further description on Forbidden Area when using wireline access is available in TS 23316 84 Support for Forbidden Area with NR satellite access is described in clause 54118 Forbidden Areas should not be used for Untrusted or Trusted non-3GPP access NOTE 1 If a UE receives that the UE is accessing from a forbidden tracking area when registering over untrusted non-3GPP access or trusted non-3GPP access the UE cannot determine the corresponding TAI and thus needs to consider that access to untrusted non-3GPP access and to trusted non-3GPP access in this PLMN is forbidden until the forbidden area list is removed as described in TS 24501 47 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_220",
    "document_id": "23501-i80",
    "chunk_id": 220,
    "text": "The UE reactions to specific network responses are described in TS 24501 47 - Service Area Restriction Defines areas in which the UE may or may not initiate communication with the network as follows - Allowed Area In an Allowed Area the UE is permitted to initiate communication with the network as allowed by the subscription - Non-Allowed Area In a Non-Allowed Area a UE is service area restricted based on subscription The UE and the network are not allowed to initiate Service Request or any connection requests for user plane data control plane data exception data reporting or SM signalling except for PS Data Off status change reporting to obtain user services that are not related to mobility The UE shall not use the entering of a Non-Allowed Area as a criterion for Cell Reselection a trigger for PLMN Selection or Domain selection for UE originating sessions or calls The RRC procedures while the UE is in CM-CONNECTED with RRC_INACTIVE state are unchanged compared to when the UE is in an Allowed Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_221",
    "document_id": "23501-i80",
    "chunk_id": 221,
    "text": "The RM procedures are unchanged compared to when the UE is in an Allowed Area The UE in a Non-Allowed Area may initiate MA PDU Session establishment or activation over a non-3GPP access other than wireline access but the User Plane resources on the 3GPP access for the MA-PDU shall not be established or activated The handling of Non-Allowed Area when using wireline access is described in TS 23316 84 The UE in a Non-Allowed Area - shall respond with a Service Request to core network paging indicating 3GPP access type or to a NAS Notification message received over non-3GPP access indicating 3GPP access type or when RAN paging failed but the UE shall not request User Plane resource establishment except for emergency services or when the UE is MPS-subscribed or MCX-subscribed - shall respond with Service Request to core network paging indicating non-3GPP access type or NAS Notification message received over 3GPP access indicating non-3GPP access type but the UE shall not request User Plane resource establishment except when the UE is MPS-subscribed NOTE 3 When the services are restricted in 5GS due to Service Area Restriction then it is assumed that the services will be also restricted in all RATsSystems at the same locations using appropriate mechanisms available in the other RATsSystems NOTE 4 Delivery of SOR transparent container UE policy container UE parameters update transparent container as defined in TS 24501 47 or removal of any stored Paging Restriction Information from network via Registration Request see clause 538 is part of the mobility related service and is allowed in an area with service restriction NOTE 5 For a UE in CM-CONNECTED state then neither control plane data transmission nor if user plane resources are already established user plane data transmission are restricted by a non-allowed area - Core Network type restriction Defines whether UE is allowed to connect to 5GC only EPC only both 5GC and EPC for this PLMN The Core Network type restriction when received applies in the PLMN either to both 3GPP and non-3GPP Access Types or to non-3GPP Access Type only NOTE 6 The Core Network type restriction can be used eg in network deployments where the E-UTRAN connects to both EPC and 5GC as described in clause 517 When the Core Network type restriction applies to non-3GPP Access Type the UE is restricted from using any connectivity to an N3IWF - Closed Access Group information As defined in clause 5303 For a given UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_222",
    "document_id": "23501-i80",
    "chunk_id": 222,
    "text": "the core network determines the Mobility Restrictions based on UE subscription information UE location andor local policy eg if the HPLMN has not deployed 5GC HPLMN ID of the UE and the operators policy are used in the VPLMN for determining the Core Network type restriction The Mobility Restriction may change due to eg UEs subscription location change and local policy Optionally the Service Area Restrictions or the Non-Allowed Area may in addition be fine-tuned by the PCF eg based on UE location PEI and network policies Service Area Restrictions may be updated during a Registration procedure or UE Configuration Update procedure If the network sends Service Area Restrictions to the UE the network sends only either an Allowed Area or a Non-Allowed Area but not both at the same time to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_223",
    "document_id": "23501-i80",
    "chunk_id": 223,
    "text": "If the UE has received an Allowed Area from the network any TA not part of the Allowed Area is considered by the UE as non-allowed If the UE has received a Non-Allowed Area from the network any TA not part of the Non-Allowed Area is considered by the UE as allowed If the UE has not received any Service Area Restrictions any TA in the PLMN is considered as allowed If the UE has overlapping areas between Forbidden Areas Service Area Restrictions or any combination of them the UE shall proceed in the following precedence order - The evaluation of Forbidden Areas shall take precedence over the evaluation of Service Area Restrictions The UDM shall provide to the AMF the information defined in TS 23008 119 about the subscribers NR or E-UTRA access restriction set by the operator determined eg by subscription scenario and roaming scenario -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_224",
    "document_id": "23501-i80",
    "chunk_id": 224,
    "text": "For NR - NR not allowed as primary RAT however any of the NR categories listed below may still be allowed - NR not allowed as secondary RAT - NR in unlicensed bands not allowed as primary RAT - NR in unlicensed bands not allowed as secondary RAT - NRLEO satellite access not allowed as primary RAT - NRMEO satellite access not allowed as primary RAT - NRGEO satellite access not allowed as primary RAT - NROTHERSAT satellite access not allowed as primary RAT - NR RedCap not allowed as primary RAT - NR eRedCap not allowed as primary RAT - For E-UTRA - E-UTRA not allowed as primary RAT - E-UTRA not allowed as secondary RAT - E-UTRA in unlicensed bands not allowed as secondary RAT - NB-IoT not allowed as primary RAT - LTE-M not allowed as primary RAT - WB-E-UTRAN LEO satellite access not allowed as primary access - WB-E-UTRAN MEO satellite access not allowed as primary access - WB-E-UTRAN GEO satellite access not allowed as primary access - WB-E-UTRAN OTHERSAT satellite access not allowed as primary access - LTE-M LEO satellite access not allowed as primary access - LTE-M MEO satellite access not allowed as primary access - LTE-M GEO satellite access not allowed as primary access - LTE-M OTHERSAT satellite access not allowed as primary access NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_225",
    "document_id": "23501-i80",
    "chunk_id": 225,
    "text": "The use of WB-E-UTRAN satellite accesses NB-IoT satellite accesses or LTE-M satellite accesses to connect to 5GC is not supported in this Release of the specification The access restriction data for LTE-M satellite accesses above is supported only to allow the AMF to provide it to MME in case of mobility from 5GS to EPS In order to enforce all primary RAT restrictions the related RAT has to be deployed in different Tracking Area Codes and the subscriber shall not be allowed to access the network in TAs using the particular RAT With all secondary RAT restrictions the subscriber shall not be allowed to use this RAT as secondary RAT 53412 Management of Service Area Restrictions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_226",
    "document_id": "23501-i80",
    "chunk_id": 226,
    "text": "This clause describes Service Area Restrictions for 3GPP access For Service Area Restrictions when using wireline access see TS 23316 84 A Service Area Restriction may contain one or more eg up to 16 entire Tracking Areas each or the Service Area Restriction may be set as unlimited ie contain all Tracking Areas of the PLMN The UEs subscription data in the UDM includes a Service Area Restriction which may contain either Allowed or Non-Allowed Areasspecified by using explicit Tracking Area identities andor other geographical information eg longitudelatitude zip code etc The geographical information used to specify Allowed or Non-Allowed Area is only managed in the network and the network will map it to a list of TAs before sending Service Area Restriction information to the PCF NG-RAN and UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_227",
    "document_id": "23501-i80",
    "chunk_id": 227,
    "text": "When the AMF assigns a limited allowed area to the UE the AMF shall provide the UE with Service Area Restrictions which consist of either Allowed Areas or Non-Allowed Areas The Allowed Areas included in the Service Area Restrictions can be pre-configured andor dynamically assigned by the AMF The Allowed Area may alternatively be configured as unlimited ie it may contain all Tracking Areas of the PLMN The Registration Area of a UE in the Non-Allowed Area should consist of a set of TAs which belongs to a Non-Allowed Area of the UE The Registration Area of a UE in the Allowed Area should consist of a set of TAs which belongs to an Allowed Area of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_228",
    "document_id": "23501-i80",
    "chunk_id": 228,
    "text": "The AMF provides the Service Area Restriction in the form of TAs which may be a subset of full list stored in UEs subscription data or provided by the PCF to the UE during the Registration procedure NOTE As the finest granularity for Service Area Restrictions are at TA level subscriptions with limited geographical extent like subscriptions for Fixed Wireless Access will be allocated one or a few TAs and will consequently be allowed to access services in a larger area than in eg a FWA system The limited allowed area may also be limited by the AMF by a maximum allowed number of Tracking Areas even though this limitation is not sent to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_229",
    "document_id": "23501-i80",
    "chunk_id": 229,
    "text": "If maximum allowed number of Tracking Areas is used in combination with Allowed Area the maximum allowed number of Tracking Areas indicates to the AMF the maximum number of TAs allowed in limited allowed area inside the Allowed Area If maximum allowed number of Tracking Areas is used in combination with Non-Allowed Area the maximum allowed number of Tracking Areas indicates to the AMF the maximum number of TAs allowed in limited allowed area outside of the Non-Allowed Area The UDM stores the Service Area Restrictions of a UE as part of the UEs subscription data The PCF in the serving network may eg due to varying conditions such as UEs location application in use time and date further adjust Service Area Restrictions of a UE either by expanding an Allowed Area or by reducing a Non-Allowed Area or by increasing the maximum allowed number of Tracking Areas",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_230",
    "document_id": "23501-i80",
    "chunk_id": 230,
    "text": "If NWDAF is deployed the PCF may use analytics ie statistics or predictions on UE mobility from NWDAF see TS 23288 86 to adjust Service Area Restrictions The UDM and the PCF may update the Service Area Restrictions of a UE at any time For the UE in CM-CONNECTED state the AMF updates the UE and RAN immediately For UE in CM-IDLE state the AMF may page the UE immediately or store the updated service area restriction and update the UE upon next signalling interaction with the UE as defined in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_231",
    "document_id": "23501-i80",
    "chunk_id": 231,
    "text": "During registration if the Service Area Restrictions of the UE is not present in the AMF the AMF fetches from the UDM the Service Area Restrictions of the UE that may be further adjusted by the PCF The serving AMF shall enforce the Service Area Restrictions of a UE A limited allowed area given by a maximum allowed number of Tracking Areas may be dynamically assigned by the AMF adding any not yet visited by the UE Tracking Areas to the limited allowed area until the maximum allowed number of Tracking Areas is reached ie the AMF adds new TAs to the limited allowed area until the number of TAs is equal to the maximum allowed number of Tracking Areas The AMF deletes the list of TAs that have been used up under the maximum allowed number of Tracking Areas quota at every Initial Registration For a UE in CM-CONNECTED state the AMF shall indicate the Service Area Restrictions of this UE to the RAN using a Mobility Restriction List",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_232",
    "document_id": "23501-i80",
    "chunk_id": 232,
    "text": "The UE shall store the received Service Area Restrictions and if there is previously stored Service Area Restrictions replace them with the newly received information If the Service Area Restrictions include a limited allowed area the Service Area Restrictions are applicable for the Tracking areas indicated in Service Area Restrictions If the Service Area Restrictions included an unlimited allowed area the received Service Area Restrictions are either applicable for the registered PLMN and its equivalent PLMNs that are available in the Registration Area or the registered SNPN that is available in the Registration Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_233",
    "document_id": "23501-i80",
    "chunk_id": 233,
    "text": "The RAN uses the Service Area Restrictions for target cell selection in Xn and N2 based handover Upon change of serving AMF due to mobility the old AMF may provide the new AMF with the Service Area Restrictions of the UE that may be further adjusted by the PCF The network may perform paging for a UE to update Service Area Restrictions with Generic UE Configuration Update procedure see clause 424 of TS 23502 3 In the case of roaming the Service Area Restrictions are transferred from the UDM via the serving AMF to the serving PCF in the visited network The serving PCF in the visited network may further adjust the Service Area Restrictions Support for Service Area Restrictions with NR satellite access is described in clause 54118 5342",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_234",
    "document_id": "23501-i80",
    "chunk_id": 234,
    "text": "Mobility Pattern The Mobility Pattern is a concept that may be used by the AMF to characterise and optimise the UE mobility The AMF determines and updates Mobility Pattern of the UE based on subscription of the UE statistics of the UE mobility network local policy and the UE assisted information or any combination of them The statistics of the UE mobility can be historical or expected UE moving trajectory If NWDAF is deployed the statistics of the UE mobility can also be analytics ie statistics or predictions provided by the NWDAF see TS 23288 86 The Mobility Pattern can be used by the AMF to optimize mobility support provided to the UE for example Registration area allocation 5343 Radio Resource Management functions 53431 General To support radio resource management in NG-RAN the AMF provides the parameter Index to RATFrequency Selection Priority RFSP Index to NG-RAN across N2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_235",
    "document_id": "23501-i80",
    "chunk_id": 235,
    "text": "The RFSP Index is mapped by the RAN to locally defined configuration in order to apply specific RRM strategies taking into account any available information in RAN The RFSP Index is UE specific and applies to all the Radio Bearers Examples of how this parameter may be used by the RAN - to derive UE specific cell reselection priorities to control idle mode camping - to decide on redirecting active mode UEs to different frequency layers or RATs eg see clause 53432",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_236",
    "document_id": "23501-i80",
    "chunk_id": 236,
    "text": "The HPLMN may set the RFSP Index taking into account the Subscribed S-NSSAIs The AMF receives the subscribed RFSP Index from the UDM eg during the Registration procedure For non-roaming subscribers the AMF chooses the RFSP Index in use according to one of the following procedures depending on operators configuration - the RFSP Index in use is identical to the subscribed RFSP Index or - the AMF chooses the RFSP Index in use based on the subscribed RFSP Index the locally configured operators policies the Allowed NSSAI and any Partially Allowed NSSAI S-NSSAIs rejected partially in the RA Rejected S-NSSAIs for the RA Pending NSSAI and the UE related context information available at the AMF including UEs usage setting if received during Registration procedures see clause TS 23502 3 NOTE 1 One example of how the AMF can use the UEs usage setting is to select an RFSP value that enforces idle mode camping on E-UTRA for a UE acting in a Voice centric way in the case voice over NR is not supported in the specific Registration Area and it contains NR cells The AMF may report to the PCF the subscribed RFSP Index received from the UDM for further evaluation as described in clause 6121 of TS 23503 45 When receiving the authorized RFSP Index from the PCF the AMF shall apply the authorized RFSP Index instead of the subscribed RFSP Index for choosing the RFSP index in use as described above For roaming subscribers the AMF may choose the RFSP Index in use based on the visited network policy but can take input from the HPLMN into account eg an RFSP Index value pre-configured per HPLMN or a single RFSP Index value to be used for all roamers independent of the HPLMN If the AMF receives authorized RFSP Index value from the V-PCF the AMF chooses the RFSP index in use based on the authorized RFSP Index value NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_237",
    "document_id": "23501-i80",
    "chunk_id": 237,
    "text": "The PCF can provide validity time together with the authorized RFSP Index indicating a change in priority from 5G access to E-UTRAN access as specified in clause 51722 The RFSP Index in use is also forwarded from source to target NG-RAN node when Xn or N2 is used for intra-NG-RAN handover The AMF stores the subscribed RFSP Index value received and the RFSP Index value in use During the Registration procedure the AMF may update the RFSP Index value in use eg the AMF may need to update the RFSP Index value in use if the UE related context information in the AMF has changed When the RFSP Index value in use is changed the AMF immediately provides the updated RFSP Index value in use to NG-RAN node by modifying an existing UE context or by establishing a new UE context in RAN or by being configured to include the updated RFSP Index value in use in the NGAP DOWNLINK NAS TRANSPORT message if the user plane establishment is not needed During inter-AMF mobility procedures the source AMF forwards both RFSP Index values to the target AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_238",
    "document_id": "23501-i80",
    "chunk_id": 238,
    "text": "The target AMF may replace the received RFSP Index value in use with a new RFSP Index value in use that is based on the operators policies and the UE related context information available at the target AMF In order to enable UE idle mode mobility control and priority-based reselection mechanism considering availability of Network Slices at the network and the Network Slices allowed for a UE an RFSP is derived as described in clause 5343 considering also the Allowed NSSAI and any Partially Allowed NSSAI for the UE A UE supporting NSAG see clause 51514 may be configured for some of the S-NSSAIs in the configured NSSAI with NSAGs it can use as described in TS 38300 27 TS 38304 50 TS 38331 28 TS 38321 143 TS 24501 47 and as described in clause 53434 53432 Preferred bands per data radio bearers The NG-RAN may prefer to use specific radio resources per data radio bearers eg depending on the Network Slices associated to the data radio bearer used by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_239",
    "document_id": "23501-i80",
    "chunk_id": 239,
    "text": "The UE idle mode mobility control and priority-based reselection mechanism operates as described in clause 53431 and when UP resources are activated eg for a specific S-NSSAI the NG-RAN can use local policies to decide on what specific radio resources to use for the associated data radio bearers A UE may be served by a set of data radio bearers which may be served by cells in different bands selected based on RRM policies 53433 Redirection to dedicated frequency bands for an S-NSSAI If a Network Slice S-NSSAI is configured to be available only in TAs covering specific dedicated frequency bands then there may be a need to redirect the UE to the dedicated frequency bands when such S-NSSAI is requested If the Requested NSSAI contains S-NSSAIs that are not available in the UEs current TA see clause 5158 the AMF itself or by interacting with the NSSF as described in clause 515521 may determine a Target NSSAI to be used by the NG-RAN in addition to the information the AMF receives such as the Allowed NSSAI and the RFSP for the Allowed NSSAI to attempt to redirect the UE to a cell and TA in another frequency band and TA that supports the S-NSSAIs in the Target NSSAI The Target NSSAI includes at least one S-NSSAI from the Requested NSSAI not available in the current TA but available in another TA in different frequency band possibly overlapping with the current TA and optionally additional S-NSSAIs from the Requested NSSAI that are configured to be available within the same TAs as the S-NSSAIs not available in the current TA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_240",
    "document_id": "23501-i80",
    "chunk_id": 240,
    "text": "If the serving PLMN supports the subscription-based restrictions to simultaneous registration of network slices see clause 51512 and if the UE has NSSRG as part of the subscription information received from the HPLMN the Target NSSAI includes only S-NSSAIs sharing at least one NSSRG The Target NSSAI may be excluding some of the S-NSSAIs in the Allowed NSSAI and include some of the rejected S-NSSAIs due to lack of support in the TA where the UE is located based on network policies that are in line with customer and operator agreements The Target NSSAI shall only include S-NSSAIs that can be provided in an Allowed NSSAI or in an Allowed NSSAI and Partially Allowed NSSAI for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_241",
    "document_id": "23501-i80",
    "chunk_id": 241,
    "text": "The Target NSSAI includes at least one Rejected S-NSSAI and may include eg - all or a subset of the Rejected S-NSSAIs for RA all or a subset of the S-NSSAIs rejected partially in the RA all or a subset of Partially Allowed NSSAI when none of the S-NSSAIs in the Requested S-NSSAI were available in the TA where the UE is - all the S-NSSAIs of the Allowed NSSAI all the S-NSSAIs of the Partially Allowed NSSAI and all or a subset of the Rejected S-NSSAIs for the RA and all or subset of S-NSSAIs rejected partially in the RA - a subset of the S-NSSAIs in the Allowed NSSAI a subset of the S-NSSAIs in the Partially Allowed NSSAI and all or a subset of the Rejected S-NSSAIs for the RA and all or subset of S-NSSAIs rejected partially in the RA if the operator policy is to prefer this Target S-NSSAI to the Allowed NSSAI The AMF should retrieve an RFSP Index suitable for the Target NSSAI and includes the RFSP Index in the information sent to the NG-RAN The AMF retrieves the RFSP Index from the PCF or in case PCF is not deployed the AMF determines the RFSP Index according to local configuration The RFSP index associated to the Target NSSAI is considered if the NG-RAN succeeds to redirect the UE to a new TA where the Target NSSAI or some S-NSSAIs of the Target NSSAI are supported otherwise the RFSP index of the Allowed NSSAI is considered If the Requested NSSAI contains S-NSSAIs which map to S-NSSAIs of the HPLMN subject to Network Slice-Specific Authentication and Authorization that are not available in the UEs current TA the AMF shall proceed with the Network Slice-Specific Authentication and Authorization procedure as described in clause 429 of TS 23502 3 If the AMF determines a new Allowed NSSAI andor Partially Allowed NSSAI at the end of Network Slice-Specific Authentication and Authorization steps and some S-NSSAI is not available in the UEs current TA a Target NSSAI and corresponding RFSP index may be determined and provided to NG-RAN during UE Configuration Update procedure as described in clause 4242 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_242",
    "document_id": "23501-i80",
    "chunk_id": 242,
    "text": "The NG-RAN shall attempt to find cells of TAs that can support all the S-NSSAIs in the Target S-NSSAIs and if no such cell of a TA is available the RAN can attempt to select cells of TAs that best match the Target S-NSSAI The NG-RAN shall attempt to ensure continuity of the PDU Sessions with activated User Plane associated with the S-NSSAIs in the Allowed NSSAI andor Partially Allowed NSSAI which are in the Target NSSAI Also the NG-RAN should attempt to ensure continuity of service for the S-NSSAIs of the Allowed NSSAI andor Partially Allowed NSSAI also available in the Target NSSAI before prioritizing cells that are not supporting one or more of the S-NSSAI of the Allowed NSSAI andor Partially Allowed NSSAI also available in the Target NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_243",
    "document_id": "23501-i80",
    "chunk_id": 243,
    "text": "The NG-RAN attempts to determine target cells supporting the Target NSSAI considering the UE Radio Capabilities ie the AMF if available in the UE context shall provide the NG-RAN with the current UE Radio Capability Information or the RACS UE Radio Capability ID when a Target NSSAI is provided if the NG-RAN had not yet received any of them or if the AMF cannot provide any of these the UE Radio Capability Information may be retrieved by the NG-RAN from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_244",
    "document_id": "23501-i80",
    "chunk_id": 244,
    "text": "Once the target cells are determined the NG-RAN initiates RRC redirection procedure towards the target cells or the NG-RAN initiates handover for the UE with active PDU Sessions associated with the S-NSSAIs which are in the Target NSSAI if possible After a successful redirection or handover of the UE to a new TA inside the current RA the UE may request a PDU Session and activate UP resources for a PDU Session for S-NSSAIs of Partially Allowed NSSAI that are supported in the new TA and the UE may request to register S-NSSAIs rejected partially in the RA that are not rejected in the new TA as described in clause 51517 After a successful redirection or handover of the UE to a new TA outside the current RA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_245",
    "document_id": "23501-i80",
    "chunk_id": 245,
    "text": "the UE shall perform a Mobility Registration Update procedure and the S-NSSAIs that the new TA supports can be allowed if the UE requests them In order to ensure that the UE is redirected to a TA outside the current RA when there are S-NSSAIs Rejected for the RA thus triggering a Mobility Registration Update procedure enabling the UE to request the S-NSSAIs that were rejected for the RA the AMF shall set the RA so that the RA does not include TAs supporting the S-NSSAIs rejected for the RA included in the Target NSSAI when the AMF provides a Target NSSAI to the RAN 53434 Network Slice based cell reselection and Random Access When one or more S-NSSAIs are associated with NSAGs the UE may perform Network Slice based cell reselection and Random Access as described in TS 38300 27 TS 38304 50 TS 38331 28 TS 38321 143 and TS 24501 47 When providing NSAG Information to the UE the AMF shall also provide the NSAG priority information for the NSAGs provided in the NSAG Information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_246",
    "document_id": "23501-i80",
    "chunk_id": 246,
    "text": "The AMF determines the NSAG priority information based on configured local policy of the serving PLMN or SNPN NOTE 1 How the AMF assigns the NSAG priority information per UE is not specified but AMF can take into account information like eg UE MM capabilities Subscribed S-NSSAIs and HPLMN NOTE 2 The AMF can assign same priority value for NSAGs provided in the NSAG Information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_247",
    "document_id": "23501-i80",
    "chunk_id": 247,
    "text": "If the UE has received NSAG Information from the AMF the UE shall use the NSAG Information provided by the AMF for cell reselection and Random Access as described below If the UE has not received any NSAG Information from the AMF the UE shall not use Network Slice based cell reselection and Random Access at all The UE NAS provides to the UE AS the NSAG Information as received from the AMF and the S-NSSAIs in the Allowed NSSAI and any Partially Allowed NSSAI as input to cell reselection except when the UE intends to register with a new including any S-NSSAIs rejected partially in the RA set of S-NSSAIs with a Requested NSSAI different from the current Allowed NSSAI and any Partially Allowed NSSAI in which case the UE NAS provides to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_248",
    "document_id": "23501-i80",
    "chunk_id": 248,
    "text": "AS layer the NSAG Information as received from the AMF and the S-NSSAIs in the Requested NSSAI and this may trigger a cell reselection before sending the Registration Request including the new Requested NSSAI For Network Slice based Random Access different Random Access resources may be assigned to different NSAGs The UE determines Random Access configuration among NSAGs that are published in SIB for Random Access and that are associated to the S-NSSAIs triggering the access If the signalling transaction triggering the access attempt is related to more than one network slice and the S-NSSAIs of these network slices are associated with more than one NSAG for Random Access the NSAG with the highest priority is selected NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_249",
    "document_id": "23501-i80",
    "chunk_id": 249,
    "text": "How the UE NAS provides the NSAGs priorities to UE AS is based internal UE interface and not specified When a S-NSSAI is replaced by an Alternative S-NSSAI for a UE supporting the Network Slice Replacement feature see clause 51519 then the AMF provides updated NSAG information also including the Alternative S-NSSAI to the UE when the Alternative S-NSSAI was not part of the UE Configured NSSAI and is Added to the UE configured NSSAI The NSAG priority may take into account the Alternative S-NSSAI is a replacement of the replaced NSSAI if the Alternative S-NSSAI is not part of the UE subscription",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_250",
    "document_id": "23501-i80",
    "chunk_id": 250,
    "text": "5344 UE mobility event notification 5G System supports the functionality of tracking and reporting UE mobility events The AMF provides the UE mobility related event reporting to NF that has been authorized to subscribe to the UE mobility event reporting service Any NF service consumer such as SMF NEF TSCTSF or NWDAF that wants to be reported on the UE location is able to subscribe to the UE mobility event notification service to the AMF with the following parameters - Event reporting type that specifies what to be reported on UE mobility eg UE location UE mobility on Area of Interest - Event filters indicating the - Area Of Interest that specifies a location area within 3GPP system The Area Of Interest is represented by a list of Tracking Areas list of cells or list of RAN node identifiers In the case of LADN the event consumer eg SMF provides the LADN DNN or LADN DNN and S-NSSAI to refer the LADN service area as the Area Of Interest In the case of PRA the event consumer eg SMF or PCF may provide an identifier for Area Of Interest to refer predefined area as the Area Of Interest In the case of Partial Network Slice Support and Support for Network Slices with Network Slice Area of Service not matching deployed Tracking Areas as described in clauses 51517 and 51518 the event consumer eg SMF provides the S-NSSAI to refer the slice restriction area area restriction applies for the S-NSSAI as the Area Of Interest - The Area Of Interest may include a RAN timing synchronization status change event indicator indicating that the presence in Area of Interest can be determined based on the most recent N2 connection - The Area Of Interest may include an Adjust AoI based on RA indicator indicating that the Area of Interest may be adjusted depending on UEs RA - The Area Of Interest may include the Notify the consumer considering UE identity indicator containing a list of UE identities or Internal Group ID and informing the AMF to notify the NF consumer about Area of Interest events only if an event is for the UE belonging to the provided list UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_251",
    "document_id": "23501-i80",
    "chunk_id": 251,
    "text": "The indicator may be included when the request is targeted to Any UE - The Area Of Interest may include the Notify the consumer considering DNNS-NSSAI indicator containing one or more DNNsS-NSSAIs and informing the AMF to notify the NF consumer about Area of Interest events only if an event is for the UE having a PDU sessions established for the specified DNNsS-NSSAIs - S-NSSAI and optionally the NSI IDs - Event Reporting Information event reporting mode number of reports maximum duration of reporting event reporting condition eg when the target UE moved into a specified Area Of Interest immediate reporting flag - Notification Endpoint of NF service consumer to be notified - The target of event reporting that indicates a list of specific UEs a group of UEs or any UE ie all UEs served by the AMF Further details on the information provided by the NF service consumer are provided in clause 415 of TS 23502 3 If an NF service consumer subscribes to the UE mobility event notification service provided by AMF for reporting of UE presence in Area Of Interest the AMF tracks UEs location considering UEs CM state and using NG-RAN procedures if RRC_INACTIVE state applies to NG-RAN in order to determine the UE presence in the Area Of Interest as described in clause 41542 of TS 23502 3 Upon detecting the change of the UE presence in the Area Of Interest the AMF notifies the UE presence in the Area Of Interest and the new UE location to the subscribed NF service consumer If the Area Of Interest in the subscription to the UE mobility event notification includes RAN timing synchronization status change event indicator as described in Table 52231-1 of TS 23502 3 and the registration request from the UE includes a UE 5GMM Core Network Capability with an indication for support for network reconnection due to RAN timing synchronization status change as described in clause 544a the AMF reports the UE presence in Area of Interest based on the most recent N2 connection as described in Annex D of TS 23502 3 If the Area Of Interest in the subscription to the UE mobility event notification includes Adjust AoI based on RA indicator as described in Table 52231-1 in TS 23502 3 the AMF reports the UE presence in Area of Interest based on the most recent N2 connection as described in Annex D in TS 23502 3 When the AMF is changed the subscription of mobility event for a UE or group of UEs is transferred from the old AMF Subscriptions targeted to Any UE shall not be moved to another AMF due to UE mobility The new AMF may decide not to notify the SMF with the current status related to the subscription of mobility event if the new AMF determines that based on MM Context of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_252",
    "document_id": "23501-i80",
    "chunk_id": 252,
    "text": "the event is reported by the old AMF In the network deployment where a UE may leave or enter the Area Of Interest without any notification to the 5GC in CM-CONNECTED state ie in the case that RRC_INACTIVE state applies to the NG-RAN the AMF may initiate the NG-RAN location reporting as described in clause 547 or N2 Notification as described in clause 483 of TS 23502 3 to track the UE presence in the Area Of Interest The AMF may provide UE mobility event reporting to PCF using Policy Control Request Triggers defined in TS 23503 45 535 Triggers for network analytics Triggers for the AMF to request for or subscribe to the analytics information from the NWDAF are internal logic in the AMF and may include for example - UE access and mobility related event subscription by other NFs eg SMF NEF - locally detected events - analytics information received The trigger conditions may depend on operator and implementation policy in the AMF When a trigger condition happens the AMF may decide if any analytics information is needed and if so request for or subscription to the analytics information from the NWDAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_253",
    "document_id": "23501-i80",
    "chunk_id": 253,
    "text": "The AMF may upon detection of certain local events eg frequent mobility re-registration of one or more UEs subscribe to mobility related abnormal behaviour analytics of the UEs as described in TS 23288 86 in order to trace UE mobility trend and take appropriate actions 54 3GPP access specific aspects 541 UE reachability in CM-IDLE 5411 General Reachability management is responsible for detecting whether the UE is reachable and providing UE location ie access node for the network to reach the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_254",
    "document_id": "23501-i80",
    "chunk_id": 254,
    "text": "This is done by paging UE and UE location tracking The UE location tracking includes both UE registration area tracking ie UE registration area update and UE reachability tracking ie UE periodic registration area update Such functionalities can be either located at 5GC in the case of CM-IDLE state or NG-RAN in the case of CM-CONNECTED state The UE and the AMF negotiate UE reachability characteristics for CM-IDLE state during Registration procedures Three UE reachability categories are negotiated between UE and AMF for CM-IDLE state 1 UE reachability allowing Mobile Terminated data while the UE is CM-IDLE state -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_255",
    "document_id": "23501-i80",
    "chunk_id": 255,
    "text": "The UE location is known by the network on a Tracking Area List granularity - Paging procedures apply to this category - Mobile originating and mobile terminated data apply in this category for both CM-CONNECTED and CM-IDLE state 2 Mobile Initiated Connection Only MICO mode - Mobile originated data applies in this category for both CM-CONNECTED and CM-IDLE state - Mobile terminated data is only supported when the UE is in CM-CONNECTED state 3 UE unreachability due to Unavailability Period - Mobile originated data and Mobile terminated data are not transmitted in this category handling of data by extending buffering may apply - Paging procedure is not applicable to this category Whenever a UE in RM-REGISTERED state enters CM-IDLE state it starts a periodic registration timer according to the periodic registration timer value received from the AMF during a Registration procedure The AMF allocates a periodic registration timer value to the UE based on local policies subscription information and information provided by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_256",
    "document_id": "23501-i80",
    "chunk_id": 256,
    "text": "After the expiry of the periodic registration timer the UE shall perform a periodic registration If the UE moves out of network coverage when its periodic registration timer expires the UE shall perform a Registration procedure when it next returns to the coverage The AMF runs a Mobile Reachable timer for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_257",
    "document_id": "23501-i80",
    "chunk_id": 257,
    "text": "The timer is started with a value longer than the UEs periodic registration timer whenever the CM state for the UE in RM-REGISTERED state changes to CM-IDLE If the AMF receives an elapsed time from RAN when RAN initiate UE context release indicating UE unreachable the AMF should deduce a Mobile Reachable timer value based on the elapsed time received from RAN and the normal Mobile Reachable timer value The AMF stops the Mobile Reachable timer if the UE CM state in the AMF moves to CM-CONNECTED state If the Mobile Reachable timer expires the AMF determines that the UE is not reachable However the AMF does not know for how long the UE remains not reachable thus the AMF shall not immediately de-register the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_258",
    "document_id": "23501-i80",
    "chunk_id": 258,
    "text": "Instead after the expiry of the Mobile Reachable timer the AMF should clear the PPF and shall start an Implicit De-registration timer with a relatively large value The AMF shall stop the Implicit De-registration timer and set the PPF if the AMF moves the UE CM state in the AMF to CM-CONNECTED state NOTE If the UE CM state in the AMF is CM-IDLE then AMF considers the UE always unreachable if the UE is in MICO mode refer to clause 5413 If the UE indicates an Unavailability Period Duration then AMF shall consider the UE as unreachable during the unreachability period as described in clause 5414 If the UE is unreachable ie the PPF is not set the AMF does not page the UE and shall reject any request for delivering DL signalling or data to this UE If the Implicit De-registration timer expires before the UE contacts the network the AMF implicitly de-register the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_259",
    "document_id": "23501-i80",
    "chunk_id": 259,
    "text": "As part of deregistration for a particular access 3GPP or non-3GPP the AMF shall request the UEs related SMF to release the PDU Sessions established on that access 5412 UE reachability allowing mobile terminated data while the UE is CM-IDLE The AMF considers a UE in RM-REGISTERED state to be reachable by CN paging if the UE CM state in the AMF is CM-IDLE state unless the UE applies MICO mode or the UE has indicated Unavailability Period Duration 5413 Mobile Initiated Connection Only MICO mode A UE may indicate preference for MICO mode during Initial Registration or Mobility Registration Update procedure The AMF based on local configuration Expected UE Behaviour andor Network Configuration parameters if available from the UDM UE indicated preferences UE subscription information and network policies or any combination of them determines whether MICO mode is allowed for the UE and indicates it to the UE during Registration procedure If NWDAF is deployed the AMF may also use analytics on UE mobility andor UE communication generated by NWDAF see TS 23288 86 to decide MICO mode parameters If the UE does not indicate preference for MICO mode during Registration procedure the AMF shall not activate MICO mode for this UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_260",
    "document_id": "23501-i80",
    "chunk_id": 260,
    "text": "The UE and the AMF re- negotiate the MICO mode at every subsequent Registration procedure When the UE is in CM-CONNECTED the AMF may deactivate MICO mode by triggering Mobility Registration Update procedure through UE Configuration Update procedure as described in clause 424 of TS 23502 3 The AMF assigns a registration area to the UE during the Registration procedure When the AMF indicates MICO mode to a UE the registration area is not constrained by paging area size If the AMF serving area is the whole PLMN based on local policy and subscription information may decide to provide an all PLMN registration area to the UE In that case re-registration to the same PLMN due to mobility does not apply If Mobility Restrictions are applied to a UE in MICO mode the AMF needs to allocate an Allowed AreaNon-Allowed Area to the UE as specified in clause 5341 When the AMF indicates MICO mode to a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_261",
    "document_id": "23501-i80",
    "chunk_id": 261,
    "text": "the AMF considers the UE always unreachable while the UE CM state in the AMF is CM-IDLE The AMF rejects any request for downlink data delivery for UE in MICO mode and whose UE CM state in the AMF is CM-IDLE with an appropriate cause For MT-SMS over NAS the AMF notifies the SMSF that UE is not reachable then the procedure of the unsuccessful Mobile terminating SMS delivery described in clause 41339 of TS 23502 3 is performed The AMF also defers location services etc The UE in MICO mode is only reachable for mobile terminated data or signalling when the UE is in CM-CONNECTED A UE in MICO mode need not listen to paging while in CM-IDLE A UE in MICO mode may stop any access stratum procedures in CM-IDLE until the UE initiates transition from CM-IDLE to CM-CONNECTED due to one of the following triggers - A change in the UE eg change in configuration requires an update of its registration with the network - Periodic registration timer expires - MO data pending - MO signalling pending eg SM procedure initiated If a registration area that is not the all PLMN registration area is allocated to a UE in MICO mode then the UE determines if it is within the registration area or not when it has MO data or MO signalling and the UE performs Mobility Registration Update before the UE initiates the MO data or MO signalling if it is not within the registration area A UE initiating emergency service shall not indicate MICO preference during Registration procedure When the MICO mode is already activated in the UE the UE and AMF shall locally disable MICO mode after PDU Session Establishment procedure for Emergency Services is completed successfully The UE and the AMF shall not enable MICO mode until the AMF accepts the use of MICO mode in the next registration procedure To enable an emergency call back the UE should wait for a UE implementation-specific duration of time before requesting the use of MICO mode after the release of the emergency PDU session In order to enable power saving for MT reachability eg for Cellular IoT enhancements to MICO mode are specified in clause 5317 - MICO mode with Extended Connected Time - MICO mode with Active Time - MICO mode and Periodic Registration Timer Control 5414 Support of Unavailability Period During Registration procedure the UE supporting the Unavailability Period feature provides Unavailability Period Support indication as part of 5GMM Core Network Capability in Registration Request message for initial registration and for every mobility registration The AMF indicates whether the corresponding feature is supported in the AMF by providing the Unavailability Period Support indication in Registration Accept message If the UE and network support Unavailability Period and an event is triggered in the UE that would make the UE unavailable or lose coverage see clause 54131 for a certain period of time the UE uses Support of Unavailability Period to inform the AMF of the expected unavailability and whether it is due to NR satellite access discontinuous coverage Use of Support of Unavailability Period for loss of coverage due to NR satellite access discontinuous coverage shall only be used if both UE and the AMF signalled Unavailability Period Support see clause 54131 If the use of Support of Unavailability Period procedure is not due to NR satellite access discontinuous coverage the UE may store its MM and SM context in the USIM or Non-Volatile memory in the ME to be able to reuse it after its unavailability period If the UE can store its contexts the UE may trigger Mobility Registration Update procedure otherwise the UE shall trigger UE-initiated Deregistration procedure NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_262",
    "document_id": "23501-i80",
    "chunk_id": 262,
    "text": "How and where the UE stores its contexts depends upon the UE implementation and the Unavailability Type The UE can store some or all of its contexts in the ME or USIM using existing ME or USIM functionality Before the start of an event that makes the UE unavailable the UE triggers either Mobility Registration Update or UE initiated Deregistration procedure a If the UE initiates Mobility Registration Update procedure 0 The UE includes an Unavailability Type to describe the cause of unavailability eg the unavailability caused by NR satellite access discontinuous coverage the Start of the Unavailability Period if known and the Unavailability Period Duration if known 1 If the UE did not include a Start of Unavailability Period the AMF considers implicitly the Start of Unavailability Period to be the time at which it has received the Registration Request message from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_263",
    "document_id": "23501-i80",
    "chunk_id": 263,
    "text": "If the UE included a Start of Unavailability Period the Start of Unavailability Period indicates the time at which the UE determines it expects to be unavailable ie time until which the UE determines it is available 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_264",
    "document_id": "23501-i80",
    "chunk_id": 264,
    "text": "The AMF may determine if not provided by the UE or update the Unavailability Period Duration andor the Start of Unavailability Period If unavailability is caused by NR satellite access discontinuous coverage and the AMF knows an Unavailability Period Duration andor the Start of Unavailability Period eg based on the Unavailability Type and other information available to the AMF as described in clause 54133 and the UE did not include an Unavailability Period Duration andor the Start of Unavailability Period or the UE included an Unavailability Period Duration andor the Start of Unavailability Period different to the Unavailability Period Duration andor the Start of Unavailability Period known to the AMF the AMF should include the Unavailability Period Duration andor the Start of Unavailability Period known to the AMF in the Registration Accept and use those values in subsequent steps of this procedure How the UE treats the AMF provided Unavailability Period Duration andor the Start of Unavailability Period is up to UE implementation eg to help to determine when to return to coverage after a discontinuous coverage period whether to listen to paging in eDRX not to initiate any NAS signalling including Service Request for MO data within the discontinuous coverage period in case of any UL signallingdata request or the UE may deactivate its Access Stratum functions for NR satellite access in order to optimise power consumption until coverage returns etc If unavailability is not caused due to NR satellite access discontinuous coverage then AMF uses the Unavailability Period Duration andor the Start of Unavailability Period as indicated by the UE in the subsequent steps of this procedure 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_265",
    "document_id": "23501-i80",
    "chunk_id": 265,
    "text": "The AMF indicates to the UE in the Registration Accept whether the UE is not required to perform a Registration procedure when the unavailability period has ended 4 The AMF may take the Unavailability Period Duration if available and Start of Unavailability Period into account when determining Periodic Registration Update timer value The AMF may provide a Periodic Registration Update so the timer does not expire during the Unavailability Period to avoid interfering with the UE dealing with the event that causes the unavailability 5 The AMF stores the information that the UE is unavailable at the Start of Unavailability Period in UE context and considers the UE is unreachable ie clear the PPF in AMF from then until the UE enters CM-CONNECTED state 6 While the UE is unreachable all high latency communication solutions see clause 5318 apply if supported in the network eg extended data buffering downlink data buffering status report etc and 7 If there is Loss of Connectivity event subscription for the UE by AF the AMF at the start of Unavailability Period considers the remaining time in the Unavailability Period if available when constructing the Loss of Connectivity event report towards the NEF and the remaining time in the Unavailability Period is reported to the respective subscribed AF b If the UE initiates UE-initiated Deregistration procedure 0",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_266",
    "document_id": "23501-i80",
    "chunk_id": 266,
    "text": "The UE includes Unavailability Period Duration if known 1 If there is Loss of Connectivity event subscription for the UE by AF the AMF considers the remaining time in the Unavailability Period when constructing the Loss of Connectivity event report towards the NEF and the Unavailability Period is reported to the respective subscribed AF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_267",
    "document_id": "23501-i80",
    "chunk_id": 267,
    "text": "Furthermore if the UE initiates Initial Registration procedure and indicates supporting the Unavailability Period feature by providing Unavailability Period Support indication as part of 5GMM Core Network Capability if the AMF is able to determine the Unavailability Period Duration andor the Start of Unavailability Period of a UE during the UEs initial Registration procedure the AMF should provide the Unavailability Period Duration andor the Start of Unavailability Period to the UE in the Registration Accept message and follow the procedure described in bullet a steps 2 to 7 above NOTE 2 The Unavailability Period Duration andor the Start of Unavailability Period when received in Registration Accept during the initial registration is for NR satellite access discontinuous coverage Unless the AMF indicated that the UE is not required to perform a Registration procedure when the unavailability period has ended then once the event which makes the UE unavailable is completed in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_268",
    "document_id": "23501-i80",
    "chunk_id": 268,
    "text": "the UE triggers a Registration procedure If the event which makes the UE unavailable is delayed to a future time or cancelled in the UE or unavailability period deviates from negotiated value the UE triggers Registration procedure The UE may also trigger a Registration procedure before the Unavailability Period has started for other reasons Depending on the UE state the Registration procedure can be Initial Registration procedure or Mobility Registration Update procedure While the UE is in 5GS and if the UE determines that an upcoming loss of coverage no longer applies or determines a new Start of Unavailability Period or Unavailability Period Duration related to the upcoming loss of coverage the UE sends a new Mobility Registration Update Request to the AMF to update the Start of Unavailability Period andor Unavailability Period Duration",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_269",
    "document_id": "23501-i80",
    "chunk_id": 269,
    "text": "The UE and the AMF re-negotiate unavailability at every Registration procedure if it is required If Start of Unavailability Period andor Unavailability Period Duration is not included in a Registration procedure any pending unavailability configuration stored in the UE context at AMF is discarded If the UE moves to EPS the UE performs Attach or Tracking Area update procedure depending on the interworking mechanisms defined in clause 5172 For discontinuous coverage in E-UTRAN satellite access in EPS the Unavailability Period is also supported see clause 41382 of TS 23401 26 NOTE 3 In this release of specification there is no transfer of unavailability period between AMF and MME and vice versa 542 UE reachability in CM-CONNECTED For a UE in CM-CONNECTED state - the AMF knows the UE location on a serving RAN node granularity - the NG-RAN notifies the AMF when UE becomes unreachable from RAN point of view UE RAN reachability management is used by RAN for UEs in RRC_INACTIVE state see TS 38300 27",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_270",
    "document_id": "23501-i80",
    "chunk_id": 270,
    "text": "The location of a UE in RRC_INACTIVE state is known by the RAN on a RAN Notification area granularity A UE in RRC_INACTIVE state is paged in cells of the RAN Notification area that is assigned to the UEs The RAN Notification area can be a subset of cells configured in UEs Registration Area or all cells configured in the UEs Registration Area UE in RRC_INACTIVE state performs RAN Notification Area Update when entering a cell that is not part of the RAN Notification area that is assigned to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_271",
    "document_id": "23501-i80",
    "chunk_id": 271,
    "text": "At transition into RRC_INACTIVE state RAN configures the UE with a periodic RAN Notification Area Update timer value and the timer is restarted in the UE with this initial timer value After the expiry of the periodic RAN Notification Area Update timer in the UE the UE in RRC_INACTIVE state performs periodic RAN Notification Area Update as specified in TS 38300 27 To aid the UE reachability management in the AMF RAN uses a guard timer with a value longer than the RAN Notification Area Update timer value provided to the UE Upon the expiry of the periodic RAN Notification Area Update guard timer in RAN the RAN shall initiate the AN Release procedure as specified in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_272",
    "document_id": "23501-i80",
    "chunk_id": 272,
    "text": "The RAN may provide the elapsed time since RANs last contact with the UE to AMF 543 Paging strategy handling 5431 General Based on operator configuration the 5GS supports the AMF and NG-RAN to apply different paging strategies for different types of traffic In the case of UE in CM-IDLE state the AMF performs paging and determines the paging strategy based on eg local configuration what NF triggered the paging and information available in the request that triggered the paging If NWDAF is deployed the AMF may also use analytics ie statistics or predictions on the UEs mobility as provided by NWDAF see TS 23288 86 In the case of UE in CM-CONNECTED with RRC_INACTIVE state the NG-RAN performs paging and determines the paging strategy based on eg local configuration and information received from AMF as described in clause 5463 and SMF as described in clause 5432",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_273",
    "document_id": "23501-i80",
    "chunk_id": 273,
    "text": "In the case of Network Triggered Service Request from SMF the SMF determines the 5QI and ARP based on the downlink packet if the SMF performs buffering or the Downlink Data Report received from UPF if the UPF performs buffering The SMF includes the 5QI and ARP corresponding to the QoS Flow of the received downlink PDU in the request sent to the AMF If the UE is in CM IDLE the AMF uses eg the 5QI and ARP to derive different paging strategies as described in clause 4233 of TS 23502 3 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_274",
    "document_id": "23501-i80",
    "chunk_id": 274,
    "text": "The 5QI is used by AMF to determine suitable paging strategies 5432 Paging Policy Differentiation Paging policy differentiation is an optional feature that allows the AMF based on operator configuration to apply different paging strategies for different traffic or service types provided within the same PDU Session In this Release of the specification this feature applies only to PDU Session of IP type When the 5GS supports the Paging Policy Differentiation PPD feature the DSCP value TOS in IPv4 TC in IPv6 is set by the application to indicate to the 5GS which Paging Policy should be applied for a certain IP packet For example as defined in TS 23228 15 the P-CSCF may support Paging Policy Differentiation by marking packets to be sent towards the UE that relate to a specific IMS services eg conversational voice as defined in IMS multimedia telephony service NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_275",
    "document_id": "23501-i80",
    "chunk_id": 275,
    "text": "This PPD feature may be used to determine the Paging Cause Indication for Voice Service as described in clause 5383 It shall be possible for the operator to configure the SMF in such a way that the Paging Policy Differentiation feature only applies to certain HPLMNs DNNs and 5QIs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_276",
    "document_id": "23501-i80",
    "chunk_id": 276,
    "text": "In the case of HR roaming this configuration is done in the SMF in the VPLMN NOTE 2 Support of Paging Policy Differentiation in the case of HR roaming requires inter operator agreements including on the DSCP value associated with this feature In the case of Network Triggered Service Request and UPF buffering downlink packets the UPF shall include the DSCP in TOS IPv4 TC IPv6 value from the IP header of the downlink packet and an indication of the corresponding QoS Flow in the Downlink Data Report sent to the SMF When PPD applies the SMF determines the Paging Policy Indicator PPI based on the DSCP received from the UPF In the case of Network Triggered Service Request and SMF buffering downlink packets when PPD applies the SMF determines the PPI based on the DSCP in TOS IPv4 TC IPv6 value from the IP header of the received downlink packet and identifies the corresponding QoS Flow from the QFI of the received downlink packet The SMF includes the PPI the ARP and the 5QI of the corresponding QoS Flow in the N11 message sent to the AMF If the UE is in CM IDLE the AMF uses this information to derive a paging strategy and sends paging messages to NG-RAN over N2 NOTE 3 Network configuration needs to ensure that the information used as a trigger for Paging Policy Indication is not changed within the 5GS NOTE 4 Network configuration needs to ensure that the specific DSCP in TOS IPv4 TC IPv6 value used as a trigger for Paging Policy Indication is managed correctly in order to avoid the accidental use of certain paging policies For a UE in RRC_INACTIVE state the NG-RAN may enforce specific paging policies in the case of NG-RAN paging based on 5QI ARP and PPI associated with an incoming DL PDU To enable this the SMF instructs the UPF to detect the DSCP in the TOS IPv4 TC IPv6 value in the IP header of the DL PDU by using a DL PDR with the DSCP for this traffic and to transfer the corresponding PPI in the CN tunnel header by using a QER with the PPI value The NG-RAN can then utilize the PPI received in the CN tunnel header of an incoming DL PDU in order to apply the corresponding paging policy for the case the UE needs to be paged when in RRC_INACTIVE state In the case of Home-Routed roaming the V-SMF is responsible of controlling UPF setting of the PPI In the case of PDU Session with I-SMF the I-SMF is responsible of controlling UPF setting of the PPI 5433 Paging Priority Paging Priority is a feature that allows the AMF to include an indication in the Paging Message sent to NG-RAN that the UE be paged with priority The decision by the AMF whether to include Paging Priority in the Paging Message is based on the ARP value in the message received from the SMF for an IP packet waiting to be delivered in the UPF If the ARP value is associated with select priority services eg MPS MCS the AMF includes Paging Priority in the Paging Message When the NG-RAN receives a Paging Message with Paging Priority it handles the page with priority The AMF while waiting for the UE to respond to a page sent without priority receives another message from the SMF with an ARP associated with select priority services eg MPS MCS the AMF sends another Paging message to the RAN including the Paging Priority For subsequent messages the AMF may determine whether to send the Paging message with higher Paging Priority based on local policy For a UE in RRC_INACTIVE state the NG-RAN determines Paging Priority based on the ARP associated with the QoS Flow as provisioned by the operator policy and the Core Network Assisted RAN paging information from AMF as described in clause 5463 544 UE Radio Capability handling 5441 UE radio capability information storage in the AMF This clause applies when no radio capability signalling optimisation is used between a UE and the network The UE Radio Capability information is defined in TS 38300 27 and contains information on RATs that the UE supports eg power class frequency bands etc",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_277",
    "document_id": "23501-i80",
    "chunk_id": 277,
    "text": "Consequently this information can be sufficiently large that it is undesirable to send it across the radio interface at every transition of UE CM state in the AMF from CM-IDLE to CM-CONNECTED To avoid this radio overhead the AMF shall store the UE Radio Capability information during CM-IDLE state for the UE and RM-REGISTERED state for the UE and the AMF shall if it is available send its most up to date UE Radio Capability information to the RAN in the N2 REQUEST message ie INITIAL CONTEXT SETUP REQUEST or UE RADIO CAPABILITY CHECK REQUEST NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_278",
    "document_id": "23501-i80",
    "chunk_id": 278,
    "text": "Due to issues with the handling of dynamic UMTS security parameters the UTRA UE Radio Capability information is excluded from the information that is uploaded and stored in the AMF see TS 38300 27 The AMF deletes the UE radio capability when the UE RM state in the AMF transitions to RM-DEREGISTERED When the AMF receives Registration Request with the Registration type set to Initial Registration or when it receives the first Registration Request after E-UTRAEPC Attach with Registration type set to Mobility Registration Update the AMF deletes the UE radio capability The UE Radio Capability is maintained in the core network even during AMF reselection NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_279",
    "document_id": "23501-i80",
    "chunk_id": 279,
    "text": "The UE Radio Capability is not transferred to EPC during the inter-system mobility If the UEs NG-RAN or E-UTRAN UE Radio Capability information changes while in CM-IDLE state the UE shall perform the Registration procedure with the Registration type set to Mobility Registration Update and it also includes UE Radio Capability Update For specific requirements for a UE operating in dual-registration mode see clause 51721 When the AMF receives Mobility Registration Update Request with UE Radio Capability Update requested by the UE it shall delete any UE Radio Capability information that it has stored for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_280",
    "document_id": "23501-i80",
    "chunk_id": 280,
    "text": "If the UEs NG-RAN UE Radio Capability information changes when the UE is in CM-IDLE with Suspend NAS shall trigger AS to establish a new RRC connection and not resume the existing one in order to perform the Registration procedure with the Registration type set to Mobility Registration Update including UE Radio Capability Update As a result of this the access stratum in the UE will discard the AS information and establish a new RRC connection as defined in TS 36331 51 If the trigger to change the UEs NG-RAN or E-UTRAN UE Radio Capability information happens when the UE is in CM-CONNECTED state the UE shall first enter CM-IDLE state and then perform the Registration procedure with the Registration type set to Mobility Registration Update and it also includes UE Radio Capability Update The RAN stores the UE Radio Capability information received in the N2 message or obtained from the UE for the duration of the UE staying in RRC_CONNECTED or RRC_INACTIVE state Before any 5G SRVCC handover attempt from NG-RAN to UTRAN the RAN retrieves the UEs UTRA UE Radio Capabilities from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_281",
    "document_id": "23501-i80",
    "chunk_id": 281,
    "text": "For specific requirements for a UE operating in dual-registration mode see clause 51721 If the AMF sends N2 REQUEST ie INITIAL CONTEXT SETUP REQUEST or UE RADIO CAPABILITY CHECK REQUEST message to NG-RAN without UE Radio Capability information in that message and there is no UE Radio Capability information available in RAN this triggers the RAN to request the UE Radio Capability from the UE and to upload it to the AMF in the N2 UE RADIO CAPABILITY INFO INDICATION message If a UE supports both NB-IoT and other RATs the UE handles the UE Radio capability information as follows - When the UE is camping on NB-IoT the UE provides only NB-IoT UE radio capabilities to the network - When the UE is not camping on NB-IoT the UE provides UE radio capabilities for the RAT but not NB-IoT UE radio capabilities to the network In order to handle the distinct UE radio capabilities the AMF stores a separate NB-IoT specific UE Radio Capability information when the UE provides the UE Radio Capability information while camping on NB-IoT When the UE is camping on NB-IoT the AMF sends if available the NB-IoT RAT specific UE Radio Capability information to the E-UTRAN When the UE is not camping on NB-IoT the AMF sends if available UE radio capabilities for the RAT but not NB-IoT radio capabilities 5441a UE radio capability signalling optimisation RACS With the increase of the size of UE radio capabilities driven eg by additional frequency bands and combinations thereof for E-UTRA and NR an efficient approach to signal UE Radio Capability Information over the radio interface and other network interfaces is defined with RACS In this Release of the specification RACS does not apply to NB-IOT RACS works by assigning an identifier to represent a set of UE radio capabilities This identifier is called UE Radio Capability ID A UE Radio Capability ID can be either UE manufacturer-assigned or PLMN-assigned as specified in clause 5910 The UE Radio Capability ID is an alternative to the signalling of the UE Radio Capability information over the radio interface within NG-RAN from NG-RAN to E-UTRAN from AMF to NG-RAN and between CN nodes supporting RACS PLMN-assigned UE Radio Capability ID is assigned to the UE using the UE Configuration Update Command or Registration Accept as defined in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_282",
    "document_id": "23501-i80",
    "chunk_id": 282,
    "text": "The UCMF shall be configured with a Version ID for PLMN-assigned UE Radio Capability IDs defined in clause 5910 The UCMF UE radio Capability Management Function stores all UE Radio Capability ID mappings in a PLMN and is responsible for assigning every PLMN-assigned UE Radio Capability ID in this PLMN see clause 6221 The UCMF stores the UE Radio Capability IDs alongside the UE Radio Capability information and the UE Radio Capability for Paging they map to Each UE Radio Capability ID stored in the UCMF can be associated to one or both UE radio capabilities formats specified in TS 36331 51 and TS 38331 28",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_283",
    "document_id": "23501-i80",
    "chunk_id": 283,
    "text": "The two UE radio capabilities formats shall be identifiable by the AMF and UCMF and the AMF shall store the TS 38331 28 format only An NG-RAN which supports RACS can be configured to operate with one of two modes of operation when providing the UE radio capabilities to the AMF when the NG-RAN executes a UE Radio Capability Enquiry procedure see TS 38331 28 to retrieve UE radio capabilities from the UE - Mode of operation A The NG-RAN provides to the AMF both formats ie the TS 38331 28 format and TS 36331 51 format The NG-RAN derives one of the UE Radio Capability formats using local transcoding of the other format it receives from the UE and extracts the E-UTRAN UE Radio Capability for Paging and NR UE Radio Capability for Paging from the UE Radio capabilities - Mode of operation B",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_284",
    "document_id": "23501-i80",
    "chunk_id": 284,
    "text": "The NG-RAN provides to the AMF the TS 38331 28 format only In a PLMN supporting RACS only in 5GS Mode of Operation B shall be configured If the PLMN supports RACS in both EPS and 5GS - If RAN nodes in the EPS and 5GS are configured in Mode of operation B then the UCMF shall be capable to transcode between TS 36331 51 and TS 38331 28 formats and the UCMF shall be able to generate the RAT-specific UE Radio Capability for Paging information from the UE Radio Capability - If the NG-RAN is configured to operate according to Mode A then also the E-UTRAN shall be configured to operate according to mode A and the UMCF is not required to transcode between TS 36331 51 and TS 38331 28 formats and the AMF shall provide the UE Radio Capability for Paging information When the NG-RAN updates the AMF with new UE radio capabilities information the AMF provides the information obtained from the NG-RAN to the UCMF even if the AMF already has a UE Radio Capability ID for that UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_285",
    "document_id": "23501-i80",
    "chunk_id": 285,
    "text": "The UCMF then returns a value of UE Radio Capability ID If the value is different from the one stored in the AMF the AMF updates the UE Radio Capability ID it stores and provides this new value to the NG-RAN if applicable and to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_286",
    "document_id": "23501-i80",
    "chunk_id": 286,
    "text": "In order to be able to interpret the UE Radio Capability ID a Network Function or node may store a local copy of the mapping between the UE Radio Capability ID and its corresponding UE Radio Capability information ie a dictionary entry When no mapping is available between a UE Radio Capability ID and the corresponding UE Radio Capability information in a Network Function or node this Network Function or node shall be able to retrieve this mapping and store it - An AMF which supports RACS shall store such UE Radio Capability ID mapping at least for all the UEs that it serves that have a UE Radio Capability ID assigned - The NG-RAN performs local caching of the UE Radio Capability information for the UE Radio Capability IDs for the UEs it is serving and potentially for other UE Radio Capability IDs according to suitable local policies - When the NG-RAN needs to retrieve the mapping of a UE Radio Capability ID to the corresponding UE Radio Capability information it queries the AMF using N2 signalling defined in TS 38413 34 - When the AMF needs to obtain a PLMN-assigned UE Radio Capability ID for a UE from the UCMF it provides the UE Radio Capability information it has for the current radio configuration of the UE and the IMEITAC for the UE and the UCMF returns a UE Radio Capability ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_287",
    "document_id": "23501-i80",
    "chunk_id": 287,
    "text": "The AMF shall provide to the UCMF the UE Radio Capability information and at least in Mode A the UE Radio Capability for Paging obtained from the NG-RAN in one or both the TS 36331 51 and TS 38331 28 formats depending on how the RAN is configured The UCMF stores the association of this IMEITAC with this UE Radio Capability ID and the UE Radio Capability information and the UE Radio Capability for Paging in all the formats it receives The UE Radio Capability information formats the AMF provides shall be identifiable at the UCMF - When the AMF needs to obtain the UE Radio Capability information and the UE Radio Capability for Paging associated to a UE Radio Capability ID it provides the UE Radio Capability ID to the UCMF with an indication that it is requesting the TS 38331 28 format and the UCMF returns a mapping of the UE Radio Capability ID to the corresponding UE Radio Capability information in TS 38331 28 format to the AMF - UEs AMFs and RAN nodes which support RACS learn the current value of the Version ID when a new PLMN-assigned UE Radio Capability ID is received from the UCMF and the Version ID it contains is different from the ones in their PLMN Assigned UE Radio Capability ID cache For a PLMN PLMN-assigned UE Radio Capability IDs related to old values ie not current value of the Version ID can be removed from cache but if so prior to removing any cached PLMN-assigned UE radio Capability IDs with the current value of the Version ID The AMF RAN and UE may continue to use the stored PLMN assigned UE Radio Capability IDs with old values of the Version ID until these are purged from cache If an out of date PLMN assigned UE Radio Capability ID is removed form an AMF cache the AMF shall proceed to assign a new PLMN assigned UE Radio Capability ID to all the UEs for which the UE context includes the removed PLMN-assigned UE Radio Capability ID using a UE Configuration Update procedure or when these UEs perform a Registration If the AMF attempts to resolve a PLMN assigned UE Radio capability ID with an old Version ID the UCMF shall return an error code indicating that the Version ID in the UE radio capability ID is no longer current and proceed to assign a new UE Radio Capability ID to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_288",
    "document_id": "23501-i80",
    "chunk_id": 288,
    "text": "If at any time the AMF has neither a valid UE Radio Capability ID nor any stored UE radio capabilities for the UE the AMF may trigger the RAN to provide the UE Radio Capability information and subsequently request the UCMF to allocate a UE Radio Capability ID - The RAN in order to support MOCN network sharing scenarios shall be capable to cache PLMN assigned UE Radio Capability IDs per PLMN ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_289",
    "document_id": "23501-i80",
    "chunk_id": 289,
    "text": "A network may utilise the PLMN-assigned UE Radio Capability ID without involving the UE eg for use with legacy UEs Mutual detection of the support of the RACS feature happens between directly connected NG-RAN nodes and between NG-RAN and AMF using protocol means as defined in TS 38413 34 and TS 38423 99 To allow for a mix of RACS-supporting and non-RACS-supporting RAN nodes over the Xn interfaces the UE Radio Capability ID should be included in the Path Switch signalling during Xn based handover and Handover Request during N2 based handover between AMF and NG-RAN In addition RACS-supporting RAN nodes can be discovered across inter-CN node boundaries by using the mechanism defined in TS 38413 34 that allows the source NG-RAN node to retrieve information on the level of support for a certain feature at the target NG-RAN side by means of information provided within the Source to Target and Target to Source transparent handover containers during handover procedure The support of RACS by peer AMFs or MMEs is based on configuration in a PLMN or across PLMNs A UE that supports WB-E-UTRA andor NR indicates its support for RACS to AMF using UE MM Core Network Capability as defined in clause 544a A UE that supports RACS and stores an applicable UE Radio Capability ID for the current UE Radio Configuration in the PLMN shall signal the UE Radio Capability ID in the Initial and Mobility Registration procedure as defined in TS 23502 3 and based on triggers defined in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_290",
    "document_id": "23501-i80",
    "chunk_id": 290,
    "text": "If both PLMN-assigned for the current PLMN and UE manufacturer-assigned UE Radio Capability IDs are stored in the UE and applicable in the PLMN the UE shall signal the PLMN-assigned UE Radio Capability ID in the Registration Request message When a PLMN decides to switch to request a particular type of UE to use UE manufacturer-assigned UE Radio Capability IDs - The UCMF sends a Nucmf_UECapabilityManagement_Notify message to the AMF including either a list of UE Radio Capability IDs if the UE was previously using any PLMN-assigned IDs or the IMEITAC values corresponding to UE types that are requested to use UE manufacturer-assigned UE Radio Capability ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_291",
    "document_id": "23501-i80",
    "chunk_id": 291,
    "text": "These values are stored in a UE Manufacturer Assigned operation requested list in the AMF - The AMF uses the Registration Accept message or the UE Configuration Update command message to request the UE to delete all the PLMN-assigned UE Radio Capability IDs for this PLMN if the UE is respectively registering or is registered with PLMN-assigned ID or IMEITAC values matching one value in the UE Manufacturer Assigned operation requested list NOTE 1 It is expected that in a given PLMN the UCMF and AMFs will be configured to either use a UE manufacturer-assigned operation requested list based on a list of PLMN-assigned UE Radio Capability IDs or a list of IMEITACs but not both NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_292",
    "document_id": "23501-i80",
    "chunk_id": 292,
    "text": "The strategy for triggering of the deletion of PLMN-assigned UE Radio Capability IDs in the UE by the AMF is implementation-specific eg can be used only towards UEs in CM-CONNECTED state - a UE that receives indication to delete all the PLMN-assigned UE Radio Capability IDs in the Registration Accept message or UE Configuration Update command message shall delete any PLMN-assigned UE Radio Capability IDs for this PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_293",
    "document_id": "23501-i80",
    "chunk_id": 293,
    "text": "The UE proceeds to register with a UE manufacturer-assigned UE Radio Capability ID that is applicable to the current UE Radio configuration - When the UE Manufacturer Assigned operation requested list contains PLMN-assigned UE Radio Capability IDs the UCMF shall avoid re-assigning PLMN-assigned UE Radio Capability IDs that were added to the UE Manufacturer Assigned operation requested list in the AMFs to any UE - The AMF stores a PLMN-assigned ID in the UE Manufacturer Assigned operation requested list for a time duration that is implementation specific but IMEITACs are stored until the UCMF require to remove certain TACs from the list ie the list of IMEITACs which are requested to use UE manufacturer-assigned IDs in the AMF and UCMF is synchronised at all times - The UCMF can request at any time the AMF to remove PLMN-assigned IDs or IMEITACs values from the UE manufacturer-assigned operation requested list NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_294",
    "document_id": "23501-i80",
    "chunk_id": 294,
    "text": "The AMF can decide to remove a UE Radio Capability ID from the UE Manufacturer Assigned operation requested list list eg because no UE with that UE Radio Capability ID has connected to the network for long time If later a UE with such UE Radio Capability ID connects to the network the AMF contacts the UCMF to resolve the UE Radio Capability ID and at this point the UCMF can trigger again the deletion of the UE Radio Capability ID by including this in the UE Manufacturer Assigned operation requested list of the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_295",
    "document_id": "23501-i80",
    "chunk_id": 295,
    "text": "The serving AMF stores the UE Radio Capability ID related to selected PLMN for a UE in the UE context and provides this UE Radio Capability ID to NG-RAN as part of the UE context information using N2 signalling During inter PLMN mobility the new AMF shall delete the UE Radio Capability ID received from the old AMF unless the operator policy indicates that all UE Radio Capability IDs used in the old PLMN is also valid in the new PLMN NOTE 4 If AMF decides to allocate TAIs of multiple PLMN IDs as part of Registration Area to the UE then AMF provides the UE Radio Capability ID of the new selected PLMN to the NG-RAN during UE mobility whether the UE Radio Capability ID is taken from stored UE context previously assigned by the same new selected PLMN or generated freshly each time a new PLMN is selected is up to AMF implementation The UE stores the PLMN-assigned UE Radio Capability ID in non-volatile memory when in RM-DEREGISTERED state and can use it again when it registers in the same PLMN NOTE 5 It is assumed that UE does not need to store the access stratum information ie UE-E-UTRA-Capability and UE-NR-Capability specified in TS 36331 51 and TS 38331 28 respectively that was indicated by the UE to the network when the PLMN-assigned UE Radio Capability ID was assigned by the network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_296",
    "document_id": "23501-i80",
    "chunk_id": 296,
    "text": "However it is assumed that the UE does store the related UE configuration eg whether or not GERAN or UTRAN or MBMS is enableddisabled At any given time at most one UE Radio Capability ID is used from the UE context in CN and RAN which is related to the selected PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_297",
    "document_id": "23501-i80",
    "chunk_id": 297,
    "text": "The number of PLMN-assigned UE Radio Capability IDs that the UE stores in non-volatile memory is left up to UE implementation However to minimise the load eg from radio signalling on the Uu interface and to provide smoother inter-PLMN mobility eg at land borders the UE shall be able to store at least the latest 16 PLMN-assigned UE Radio Capability IDs along with the PLMN that assigned them This number is independent of the UE manufacturer-assigned UE Radio Capability IDs the UE may store It shall be possible for a UE to change eg upon change in its usage settings the set of UE radio capabilities in time and signal the associated UE Radio Capability ID if available The UE stores the mapping between the UE Radio Capability ID and the corresponding UE Radio Capability Information for every UE Radio Capability ID it stores If the UEs Radio Capability Information changes and regardless of whether the UE has an associated UE Radio Capability ID for the updated UE Radio Capability information the UE shall perform the Registration procedure by sending a Registration Request message to the AMF with the Registration type set to Mobility Registration Update which includes UE Radio Capability Update and - If the UE has an associated UE Radio Capability ID for the updated UE Radio Capability information the UE shall include it in the Registration Request message so that the AMF upon receiving it shall update the UEs context with this UE Radio Capability ID - If the UE does not have an associated UE Radio Capability ID for the updated UE Radio Capability information the UE shall not include any UE Radio Capability ID in the Registration Request message so that the AMF upon receiving this Registration Request without any UE Radio Capability ID retrieves the UE radio capabilities from the UE as defined in clause 5441",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_298",
    "document_id": "23501-i80",
    "chunk_id": 298,
    "text": "The NG-RAN may apply RRC filtering of UE radio capabilities when it retrieves the UE Radio Capability Information from the UE as defined in TS 38331 28 NOTE 6 In a RACS supporting PLMN the filter of UE radio capabilities configured in NG-RAN is preferably as wide in scope as possible eg PLMN-wide",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_299",
    "document_id": "23501-i80",
    "chunk_id": 299,
    "text": "In this case it corresponds eg to the super-set of bands band-combinations and RATs the PLMN deploys and not only to the specific NG-RAN node or region NOTE 7 If the filter included in the UE Radio Capability information of UE radio capabilities configured in two NG-RAN nodes is different during handover between these two nodes it is possible that the target NG-RAN node might need to enquire the UE for its UE Radio Capability Information again and trigger re-allocation of a PLMN-assigned UE Radio Capability ID leading to extra signalling Additionally a narrow filter might reduce the list of candidate target nodes If a UE supports both NB-IoT and other RATs that do support RACS eg WB-E-UTRA andor NR then since there is no support for RACS in NB-IoT the UE handles the RACS procedures as follows - NB-IoT specific UE Radio Capability Information is handled in UE NG-RAN and AMF according to clause 5441 and in EPS according to TS 23401 26 - when the UE is not camping on NB-IoT the RAN provides UE radio capabilities for other RATs but not NB-IoT UE radio capabilities according to TS 38300 27 and TS 36300 30 As a result the UE Radio Capability ID that is assigned by the network corresponds only to the UE radio capabilities of the non-NB-IoT RATs The UE uses the UE Radio Capability IDs assigned only in Mobility Registration Update procedures performed over non-NB-IoT RATs Support for RACS in EPS is defined in TS 23401 26 5442 Void 5442a UE Radio Capability Match Request",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_300",
    "document_id": "23501-i80",
    "chunk_id": 300,
    "text": "If the AMF requires more information on the UE radio capabilities support to be able to set the IMS voice over PS Session Supported Indication see clause 5163 then the AMF may send a UE Radio Capability Match Request message to the NG-RAN This procedure is typically used during the Registration Procedure or when AMF has not received the Voice Support Match Indicator as part of the 5GMM Context NOTE During the Registration Procedure if the AMF does not already have the UEs radio capabilities and if the RAT where the UE is requires the establishment of AN security context prior to retrieval of radio capabilities the AMF needs to initiate Initial Context Setup procedure as defined in TS 38413 34 to provide the 5G-AN with security context before sending a UE Radio Capability Match Request message 5443 Paging assistance information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_301",
    "document_id": "23501-i80",
    "chunk_id": 301,
    "text": "The paging assistance information contains UE radio related information that assists the RAN for efficient paging The Paging assistance information contains a UE radio capability for paging information - The UE Radio Capability for Paging Information contains information derived by the NG-RAN node eg band support information from the UE Radio Capability information The AMF stores this information without needing to understand its contents As the AMF only infrequently eg at Initial Registration prompts the NG-RAN to retrieve and upload the UE radio capabilities ie UE Radio Capability information to the AMF and the AMF may be connected to more than one NG-RAN RAT it is the responsibility of the NG-RAN to ensure that UE Radio Capability for Paging Information which is derived by the NG-RAN node contains information on all NG-RAN RATs that the UE supports in that PLMN To assist the NG-RAN in this task as specified in TS 38413 34 the AMF provides its stored UE Radio Capability for Paging Information in every NG-AP INITIAL CONTEXT SETUP REQUEST message sent to the NG-RAN - The UE Radio Capability for Paging Information is maintained in the core network even during AMF reselection and is stored in the UCMF alongside the UE Radio Capability information associated to a UE Radio Capability ID b Information On Recommended Cells And RAN nodes For Paging - Information sent by the NG-RAN and used by the AMF when paging the UE to help determining the NG RAN nodes to be paged as well as to provide the information on recommended cells to each of these RAN nodes in order to optimize the probability of successful paging while minimizing the signalling load on the radio path - The RAN provides this information during N2 release 544a UE MM Core Network Capability handling The UE MM Core Network Capability is split into the S1 UE network capability mostly for E-UTRAN access related core network parameters and the UE 5GMM Core Network Capability mostly to include other UE capabilities related to 5GCN or interworking with EPS as defined in TS 24501 47 and contains non radio-related capabilities eg the NAS security algorithms etc The S1 UE network capability is transferred between all CN nodes at AMF to AMF AMF to MME MME to MME and MME to AMF changes The UE 5GMM Core Network Capability is transferred only at AMF to AMF changes In order to ensure that the UE MM Core Network Capability information stored in the AMF is up to date eg to handle the situation when the USIM is moved into a different device while out of coverage and the old device did not send the Detach message and the cases of inter-RAT Registration Area Update the UE shall send the UE MM Core Network Capability information to the AMF during the Initial Registration and Mobility Registration Update procedure within the NAS message The AMF shall store always the latest UE MM Core Network Capability received from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_302",
    "document_id": "23501-i80",
    "chunk_id": 302,
    "text": "Any UE MM Core Network Capability that an AMF receives from an old AMFMME is replaced when the UE provides the UE MM Core Network Capability with Registration signalling If the UEs UE MM Core Network Capability information changes in either CM-CONNECTED or in CM-IDLE state the UE shall perform a Mobility Registration Update procedure when it next returns to NG-RAN coverage See clause 422 of TS 23502 3 The UE shall indicate in the UE 5GMM Core Network Capability if the UE supports - Attach in EPC with Request type Handover in PDN CONNECTIVITY Request message clause 5321 of TS 23401 26 - EPC NAS - SMS over NAS - LCS - 5G SRVCC from NG-RAN to UTRAN as specified in TS 23216 88 - Radio Capabilities Signalling optimisation RACS - Network Slice-Specific Authentication and Authorization - Network Slice Replacement as described in clause 51519 - Parameters in Supported Network Behaviour for 5G CIoT as described in clause 5312 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_303",
    "document_id": "23501-i80",
    "chunk_id": 303,
    "text": "Receiving WUS Assistance Information E-UTRA see clause 549 - Paging Subgrouping Support Indication NR see clause 5412 - CAG see clause 53033 - CAG with validity information if UE supports CAG see clause 53033 - Subscription-based restrictions to simultaneous registration of network slices see clause 51512 - Support of NSAG see clause 51514 - Partial Network Slice support in a RA see clause 51517",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_304",
    "document_id": "23501-i80",
    "chunk_id": 304,
    "text": "- Minimization of Service Interruption MINT as described in clause 540 - Equivalent SNPNs see clause 530211 - Unavailability Period Support as described in clause 5414 - Support for network reconnection due to RAN timing synchronization status change see clauses 527112 and 5344 - UE Configuration of network-controlled Slice Usage Policy see clause 515152 - Temporarily available network slices see clause 51516 - Support of S-NSSAI location availability information as described in clause 515182 - Support of network verified UE location over NR NTN see clause 54114 If a UE operating two or more USIMs supports and intends to use one or more Multi-USIM features see clause 538 in a PLMN for a USIM it shall indicate in the UE 5GMM Core Network Capability for this USIM in this PLMN that it supports these one or more Multi-USIM features with the following indications - Connection Release Supported - Paging Cause Indication for Voice Service Supported - Reject Paging Request Supported - Paging Restriction Supported",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_305",
    "document_id": "23501-i80",
    "chunk_id": 305,
    "text": "Otherwise the UE with the capabilities of Multi-USIM features but does not intend to use them shall not indicate support of these one or more Multi-USIM features A UE not operating two or more USIMs shall indicate the Multi-USIM features are not supported NOTE It is not necessary for a UE operating two or more USIMs to use Multi-USIM features with all USIMs 544b UE 5GSM Core Network Capability handling The UE 5GSM Core Network Capability is included in PDU Session EstablishmentModification Request",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_306",
    "document_id": "23501-i80",
    "chunk_id": 306,
    "text": "The UE shall indicate in the UE 5GSM Core Network Capability whether the UE supports - Ethernet PDU Session Type supported in EPC as PDN Type Ethernet - Reflective QoS - Multi-homed IPv6 PDU Session only if the Requested PDU Type was set to IPv6 or IPv4v6 - ATSSS capability as referred to clause 5322 - Transfer of Port Management Information containers - Support for secondary DN authentication and authorization over EPC as referred to clause 51725 The 5GSM Core Network Capability is transferred if needed from V-SMF to H-SMF during PDU Session EstablishmentModification procedure After the first inter-system change from EPS to 5GS for a PDU session established in EPS the 5GSM Core Network Capability is also included in the PDU Session Modification if the Reflective QoS andor Multi-homed IPv6 PDU Session is present 545 DRX Discontinuous Reception framework The 5G System supports DRX architecture which allows Idle mode DRX cycle is negotiated between UE and the AMF The Idle mode DRX cycle applies in CM-IDLE state and in CM-CONNECTED with RRC_INACTIVE state If the UE wants to use UE specific DRX parameters the UE shall include its preferred values consistently in every Initial Registration and Mobility Registration procedure separately for NRWB-EUTRA and NB-IoT During Initial Registration and Mobility Registration procedures performed on NB-IoT cells the normal 5GS procedures apply For NB-IoT the cell broadcasts an indication of support of UE specific DRX for NB-IoT in that cell and the UE can request UE specific DRX for NB-IoT in the Registration procedure irrespective of whether the cell broadcasts that support indication The AMF shall determine Accepted DRX parameters based on the received UE specific DRX parameters and the AMF should accept the UE requested values but subject to operator policy the AMF may change the UE requested values The AMF shall respond to the UE with the Accepted DRX parameters separately for NRWB-EUTRA and NB-IoT For details of DRX parameters see TS 38331 28 and TS 36331 51",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_307",
    "document_id": "23501-i80",
    "chunk_id": 307,
    "text": "The UE shall apply the DRX cycle broadcast in the cell by the RAN unless it has received Accepted DRX parameters for the RAT from the AMF and for NB-IoT the cell supports UE specific DRX for NB-IoT in which case the UE shall apply either the DRX cycle broadcast in the cell or the Accepted DRX parameters for the RAT as defined in TS 38304 50 and TS 36304 52 The Periodic Registration procedure does not change the UEs DRX settings In CM-CONNECTED with RRC_INACTIVE state the UE applies either the DRX cycle negotiated with AMF or the DRX cycle broadcast by RAN or the UE specific DRX cycle configured by RAN as defined in TS 38300 27 and TS 38304 50 546 Core Network assistance information for RAN optimization 5461 General Core Network assistance information for RAN aids the RAN to optimize the UE state transition steering and the RAN paging strategy formulation in RRC_INACTIVE state The Core Network assistance information includes the information set Core Network assisted RAN parameters tuning which assist RAN optimize the UE RRC state transition and CM state transition decision It also includes the information set Core Network assisted RAN paging information which assist RAN to formulate an optimized paging strategy when RAN paging is triggered 5462 Core Network assisted RAN parameters tuning Core Network assisted RAN parameters tuning aids the RAN to minimize the UE state transitions and achieve optimum network behaviour How the RAN uses the CN assistance information is not defined in this specification Core Network assisted RAN parameters tuning may be derived by the AMF per UE in the AMF based on collection of UE behaviour statistics Expected UE Behaviour andor other available information about the UE such as subscribed DNN SUPI ranges or other information If the AMF maintains Expected UE Behaviour parameters Network Configuration parameters as described in clause 41563 or 41563a TS 23502 3 or SMF derived CN assisted RAN parameters tuning the AMF may use this information for selecting the CN assisted RAN parameter values If the AMF is able to derive the Mobility Pattern of the UE as described in clause 5342 the AMF may take the Mobility Pattern information into account when selecting the CN assisted RAN parameter values The SMF uses the SMF-Associated parameters eg Expected UE Behaviour parameters or Network Configuration parameters of the UE to derive the SMF derived CN assisted RAN parameters tuning The SMF sends the SMF derived CN assisted RAN parameters tuning to the AMF during the PDU Session establishment procedure and if the SMF-Associated parameters change the PDU Session modification procedure is applied The AMF stores the SMF derived CN assisted RAN parameters tuning in the PDU Session level context The AMF uses the SMF derived CN assisted RAN parameters tuning to determine a PDU Session level Expected UE activity behaviour parameters set which may be associated with a PDU Session ID as described below in this clause The Expected UE Behaviour parameters or the Network Configuration parameters can be provisioned by external party via the NEF to the AMF or SMF as described in clause 520 The CN assisted RAN parameters tuning provides the RAN with a way to understand the UE behaviour for these aspects - Expected UE activity behaviour ie the expected pattern of the UEs changes between CM-CONNECTED and CM-IDLE states or the duration of CM-CONNECTED state This may be derived eg from the statistical information or Expected UE Behaviour or from subscription information The AMF derives one or more sets of the Expected UE activity behaviour parameters for the UE as follows - AMF may derive and provide to the RAN a UE level of Expected UE activity behaviour parameters set considering the Expected UE Behaviour parameters or Network Configuration parameters received from the UDM see clauses 41563 or 41563a of TS 23502 3 and the SMF derived CN assisted RAN parameters tuning associated with a PDU Session using Control Plane CIoT 5GS Optimisation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_308",
    "document_id": "23501-i80",
    "chunk_id": 308,
    "text": "This set of Expected UE activity behaviour parameters is valid for the UE and - AMF may provide to the RAN a PDU Session level Expected UE activity behaviour parameters set eg considering the SMF derived CN assisted RAN parameters tuning per established PDU Session The PDU Session level Expected UE activity behaviour set of parameters is associated with and valid for a PDU Session ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_309",
    "document_id": "23501-i80",
    "chunk_id": 309,
    "text": "The RAN may consider the PDU Session level Expected UE activity behaviour parameters when the User Plane resources for the PDU Session are activated - Expected HO behaviour ie the expected interval between inter-RAN handovers This may be derived by the AMF eg from the Mobility Pattern information - Expected UE mobility ie whether the UE is expected to be stationary or mobile This may be derived eg from the statistical information or Expected UE Behaviour parameters or from subscription information - Expected UE moving trajectory which may be derived eg from the statistical information or Expected UE Behaviour parameters or from subscription information or - UE Differentiation Information including the Expected UE Behaviour parameters excluding the Expected UE moving trajectory see clause 41563 of TS 23502 3 to support Uu operation optimisation for NB-IoT UE differentiation if the RAT type is NB-IoT The AMF decides when to send this information to the RAN as Expected UE activity behaviour carried in N2 request over the N2 interface see TS 38413 34 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_310",
    "document_id": "23501-i80",
    "chunk_id": 310,
    "text": "The calculation of the CN assistance information ie the algorithms used and related criteria and the decision when it is considered suitable and stable to send to the RAN are vendor specific 5463 Core Network assisted RAN paging information Core Network assisted RAN paging information aids the RAN to formulate a RAN paging policy and strategy in RRC_INACTIVE state besides the PPI and QoS information associated to the QoS Flows as indicated in clause 543 CN assisted RAN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_311",
    "document_id": "23501-i80",
    "chunk_id": 311,
    "text": "paging information may be derived by the AMF per UE andor per PDU Session based on collection of UE behaviour statistics Expected UE Behaviour andor other available information about the UE such as subscribed DNN SUPI ranges Multimedia priority service andor information received from other network functions when downlink signalling is triggered The CN assisted RAN paging information consists of a service priority values 1 to 256 which provides AN with a way to understand how important the downlink signalling is The AMF derives this service priority based on available information as described above The method to derive the service priority is implementation depended and can be controlled by operator The Core Network may provide the CN assisted RAN paging information to RAN in different occasions eg during downlink N1 and N2 message delivery etc 547 NG-RAN location reporting NG-RAN supports the NG-RAN location reporting for the services that require accurate cell identification eg emergency services lawful intercept charging or for the UE mobility event notification service subscribed to the AMF by other NFs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_312",
    "document_id": "23501-i80",
    "chunk_id": 312,
    "text": "The NG-RAN location reporting may be used by the AMF when the target UE is in CM-CONNECTED state The NG-RAN location reporting may be used by the AMF to determine the geographically located TAI in the case of NR satellite access The AMF may request the NG-RAN location reporting with event reporting type eg UE location or UE presence in Area of Interest reporting mode and its related parameters eg number of reporting If the AMF requests UE location the NG-RAN reports the current UE location or last known UE location with time stamp if the UE is in RRC_INACTIVE state based on the requested reporting parameter eg one-time reporting or continuous reporting If the AMF requests UE location in the case of NR satellite access the NG-RAN provides all broadcast TAIs to the AMF as part of the ULI The NG-RAN also reports the TAI where the UE is geographically located if this TAI can be determined If the AMF requests UE presence in the Area Of Interest the NG-RAN reports the UE location and the indication ie IN OUT or UNKNOWN when the NG-RAN determines the change of UE presence in Area Of Interest After N2 based Handover if the NG-RAN location reporting information is required the AMF shall re-request the NG-RAN location reporting to the target NG-RAN node For Xn based Handover the source NG-RAN shall transfer the requested NG-RAN location reporting information to target NG-RAN node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_313",
    "document_id": "23501-i80",
    "chunk_id": 313,
    "text": "The AMF requests the location information of the UE either through independent N2 procedure ie NG-RAN location reporting as specified in clause 410 of TS 23502 3 or by including the request in some specific N2 messages as specified in TS 38413 34 548 Support for identification and restriction of using unlicensed spectrum Support for NG-RAN using unlicensed spectrum is defined in TS 38300 27 and TS 36300 30 For NG-RAN in the case of NR in stand-alone mode all cells are in unlicensed spectrum and the NR is used as primary RAT NR or E-UTRA cells in unlicensed spectrum can be used as secondary cells as specified in the Dual Connectivity architecture defined in clause 511 or in addition can be configured to support the Carrier Aggregation Architecture CA defined in TS 38300 27 and TS 36300 30 For either case the serving PLMN can enforce Access Restriction for Unlicensed Spectrum either signalled from the UDM or locally generated by VPLMN policy in the AMF with the following - To restrict the use of NR in unlicensed spectrum as primary RAT the AMF rejects the UE Registration procedure with appropriate cause code defined in TS 24501 47 if the UE performs initial access from NR using unlicensed spectrum If the UE is accessing through some other allowed RAT the AMF signals this access restriction to NG-RAN as part of Mobility Restriction List -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_314",
    "document_id": "23501-i80",
    "chunk_id": 314,
    "text": "To restrict the use of use of unlicensed spectrum with NR or E-UTRA as secondary RAT using Dual Connectivity or Carrier Aggregation Architecture CA defined in TS 38300 27 and TS 36300 30 the AMF signals this access restriction to NG-RAN as part of Mobility Restriction List An NG-RAN node supporting aggregation with unlicensed spectrum using either NR or E-UTRA checks whether the UE is allowed to use unlicensed spectrum based on received Mobility Restriction List If the UE is not allowed to use Unlicensed Spectrum the NG-RAN node shall restrict the using of unlicensed spectrum either NR or E-UTRA as secondary RATs when using either Dual Connectivity or Carrier Aggregation CA as defined in TS 38300 27 and TS 36300 30 At inter-RAT handover from E-UTRANEPS the Access Restriction for Unlicensed Spectrum is either already in the AMFs UE context or is obtained from the UDM during the subsequent Registration Area Update procedure ie not from the source MME or source RAN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_315",
    "document_id": "23501-i80",
    "chunk_id": 315,
    "text": "In both inter-RAT handover cases any Access Restriction for use of Unlicensed Spectrum is then signalled to NG-RAN or enforced in AMF NOTE This signalling of the Access Restriction during the Registration Area Update after the inter-RAT handover procedure means that there is a small risk that unlicensed spectrum resources are transiently allocated When the UE is accessing 5GS using unlicensed spectrum as primary RAT - The NG-RAN node shall provide an indication to the AMF in N2 interface that NR access is using unlicensed spectrum as defined in TS 38413 34 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_316",
    "document_id": "23501-i80",
    "chunk_id": 316,
    "text": "In order to restrict access to NR in unlicensed spectrum cells supporting NR in unlicensed spectrum have to be deployed in Tracking Areas different to cells supporting licensed spectrum - When the AMF receives an indication from NG-RAN over N2 whether NR in unlicensed spectrum is being used as defined in TS 38413 34 the AMF provides to the SMF an indication that the RAT type is NR with usage of unlicensed spectrum during PDU Session Establishment or as part of the UP activation and Handover procedures - The PCF can also receive the indication whether the UE is using NR in unlicensed spectrum when applicable from the AMF using the PCRT on Access Type change specified in clause 6125 of TS 23503 45 during AM Policy Association Establishment or AM Policy Association Modification procedure and from the SMF using the PCRT on Access Type change specified in clause 6135 of TS 23503 45 during SM Policy Association Establishment or SM Policy Association Modification procedure - The NFs generating CDRs shall include the indication that the UE is using NR in unlicensed spectrum in their CDRs When the UE is accessing NR or E-UTRA using unlicensed spectrum as secondary RAT procedures for Usage Data Reporting for Secondary RAT as defined in clause 5122 can apply 549 Wake Up Signal Assistance 5491 General The RAN and UE may use a Wake Up Signal WUS to reduce the UEs idle mode power consumption The RAN sends the WUS shortly before the UEs paging occasion The WUS feature enables UEs to determine that in the paging occasions immediately following their WUS occasion they will not be paged if their WUS is not transmitted or that they might be paged if their WUS is transmitted see TS 36304 52 To avoid waking up UEs due to an AMF paging other UEs across multiple cells eg due to frequent UE mobility andor for low paging latency services such as VoLTE the use of WUS by the ng-eNB and the UE is restricted to the last used cell ie the cell in which the UEs RRC connection was last released To support this a ng-eNBs should provide the Recommended Cells for Paging IE in the Information on Recommended Cells and RAN Nodes for Paging IE see TS 38413 34 to the AMF in the NGAP UE Context Release Complete UE Context Suspend Request and UE Context Resume Request messages b if received during the last NGAP UE Context Release Complete or UE Context Suspend Request message the AMF provides without modification the Recommended Cells for Paging as Assistance Data for Recommended Cells IE in the Assistance Data for Paging IE within the NGAP Paging message to the RAN see also TS 38413 34 and c the AMF shall delete or mark as invalid the Information On Recommended Cells And RAND nodes For Paging when a new NGAP association is established for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_317",
    "document_id": "23501-i80",
    "chunk_id": 317,
    "text": "In the NGAP Paging message the last used cell ID is sent in the Assistance Data for Recommended Cells IE in the Assistance Data for Paging IE see TS 38413 34 When receiving an NGAP Paging message for a WUS-capable UE that also includes the Assistance Data for Recommended Cells IE then a WUS-capable ng-eNB shall only broadcast the WUS on the cell that matches the last used cell ID 5492 Group Wake Up Signal To support the Wake Up Signal WUS the WUS Assistance Information is used by the ng-eNB to help determine the WUS group used when paging the UE see TS 36300 30 The content of the WUS Assistance Information consists of the paging probability information The paging probability information provides a metric on the probability of a UE receiving a paging message based on eg statistical information The UE may in the Registration Request message provide its capability to support receiving WUS Assistance Information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_318",
    "document_id": "23501-i80",
    "chunk_id": 318,
    "text": "If WUS Assistance Information is supported by the UE then the UE in the Registration Request message may provide the additional UE paging probability information The AMF may use the UE provided paging probability local configuration andor previous statistical information for the UE when determining the WUS Assistance Information If the UE supports WUS Assistance Information the AMF may assign WUS Assistance Information to the UE even when the UE has not provided the additional UE paging probability information If the AMF has determined WUS Assistance Information for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_319",
    "document_id": "23501-i80",
    "chunk_id": 319,
    "text": "the AMF provides it to the UE in every Registration Accept message The AMF stores the WUS Assistance Information parameter in the MM context and provides it to the ng-eNB when paging the UE UE and AMF shall not signal WUS Assistance Information in Registration Request Registration Accept messages when the UE has an active emergency PDU session 5410 Support for identification and restriction of using NR satellite access Support for NR satellite access is specified in TS 38300 27 Editors note TS 38300 27 not yet updated by RAN groups The AMF determines the RAT Type for NR satellite access ie NRLEO NRMEO NRGEO and NROTHERSAT When the UE is accessing NR using satellite access an indication is provided in N2 interface indicating the type of NR satellite access as defined in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_320",
    "document_id": "23501-i80",
    "chunk_id": 320,
    "text": "The PCF can receive the RAT Type for NR satellite access when applicable from the AMF using the PCRT on Access Type change specified in clause 6125 of TS 23503 45 during AM Policy Association Establishment or AM Policy Association Modification procedure and from the SMF using the PCRT on Access Type change specified in clause 6135 of TS 23503 45 during SM Policy Association Establishment or SM Policy Association Modification procedure Editors note Further details on what type of satellite platforms OTHERSAT includes is FFS and to be aligned with RAN WG3 The serving PLMN can enforce mobility restrictions for NR satellite access as specified in clause 5341 In order to enable efficient enforcement of Mobility Restrictions cells of each NR satellite RAT Type NRLEO NRMEO NRGEO or NROTHERSAT need to be deployed in TAs different from TAs for other NR satellite RAT Types as well as different from TAs supporting terrestrial access RAT Types",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_321",
    "document_id": "23501-i80",
    "chunk_id": 321,
    "text": "The AMF may initiate deregistration of the UE when an N2 UE Context Release Request is received with cause value indicating that the UE is not in PLMN serving area as specified in TS 38413 34 5411 Support for integrating NR satellite access into 5GS 54111 General This clause describes the specific aspects for NR satellite access 54112 Support of RAT types defined in 5GC for satellite access In case of NR satellite access the RAT Types values NRLEO NRMEO NRGEO and NROTHERSAT are used in 5GC to distinguish the different NR satellite access types see clause 5410 When a UE is accessing to the network via satellite access the AMF determines the RAT type as specified in clause 5410 54113 Void 54114 Verification of UE location In order to ensure that the regulatory requirements are met the network may be configured to enforce that the selected PLMN is allowed to operate in the current UE location by verifying the UE location during Mobility Management and Session Management procedures The UE that supports network verified UE location over NTN NR shall indicate this capability in UE 5GMM Core Network Capability and LPP as defined in TS 37355 191",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_322",
    "document_id": "23501-i80",
    "chunk_id": 322,
    "text": "In this case when the AMF receives a NGAP message containing User Location Information for a UE using NR satellite access the AMF takes into account the capability of the UE in UE 5GMM Core Network Capability for the support by the UE of network verified UE location over NR NTN and may decide to verify the UE location If the AMF determines based on the Selected PLMN ID and ULI including Cell ID received from the gNB that it is not allowed to operate at the present UE location the AMF should reject any NAS request with a suitable cause value If the UE is already registered to the network when the AMF determines that it is not allowed to operate at the present UE location the AMF may initiate deregistration of the UE The AMF should not reject the request or deregister the UE unless it has sufficiently accurate UE location information to determine that the UE is located in a geographical area where the PLMN is not allowed to operate NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_323",
    "document_id": "23501-i80",
    "chunk_id": 323,
    "text": "The area where the UE is allowed to operate can be determined based on the regulatory area where the PLMN is allowed to operate based on its licensing conditions If the AMF based on the ULI is not able to determine the UEs location with sufficient accuracy to make a final decision or if the received ULI is not sufficiently reliable the AMF takes into account the UE 5GMM Core Network Capability related to the UE support of network verified UE location over NR NTN and may proceed with the Mobility Management or Session Management procedure and may initiate UE location procedure after the Mobility Management or Session Management procedure is complete as specified in clause 6101 of TS 23273 87 to determine the UE location NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_324",
    "document_id": "23501-i80",
    "chunk_id": 324,
    "text": "In order to ensure that the regulatory requirements are met based on operator configuration the AMF can prevent the UE from accessing certain services eg services related with NAS messages initiated by UE or network except services related with UE location procedures or NAS procedures required for location verification while location determination is ongoing This can be done by for example the AMF providing a back-off time to the UE such as described in clause 51972 NAS level congestion control The AMF shall be prepared to deregister the UE if the information received from LMF indicates that the UE is registered to a PLMN that is not allowed to operate in the UE location In the case of a NAS procedure the AMF should either reject any NAS request targeted towards a PLMN that is not allowed to operate in the known UE location and indicate a suitable cause value or accept the NAS procedure and initiate deregistration procedure once the UE location is known In the deregistration message to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_325",
    "document_id": "23501-i80",
    "chunk_id": 325,
    "text": "the AMF shall include a suitable cause value For UE processing of the cause value indicating that the PLMN is not allowed to operate in the current UE location see TS 23122 17 and TS 24501 47 In the case of a handover procedure if the target AMF determines that it is not allowed to operate at the current UE location the AMF either rejects the handover or accepts the handover and later deregisters the UE 54115 Network selection for NR satellite access Network selection principles specified in clause 522 apply also for NR satellite access For NR satellite access a UE with location capability should use its awareness of its location to select a PLMN that is allowed to operate in the UE location as specified in TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_326",
    "document_id": "23501-i80",
    "chunk_id": 326,
    "text": "In order to ensure that the regulatory requirements are met the network may be configured to enforce this UE choice by verifying the UE location as described in clause 54114 54116 Support of Mobility Registration Update A moving radio cell for NR satellite access may indicate support for one or more TACs for each PLMN A UE that is registered with a PLMN may access a radio cell and does not need to perform a Mobility Registration Update procedure as long as at least one supported TAC for the RPLMN or equivalent to the RPLMN is part of the UE Registration Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_327",
    "document_id": "23501-i80",
    "chunk_id": 327,
    "text": "A UE shall perform a Mobility Registration Update procedure when accessing a radio cell where none of the supported TACs for the RPLMN or equivalent to the RPLMN are part of the UE Registration Area When indicating a last visited TAI in a Registration Update a UE may indicate any TAI supported in a radio cell for the RPLMN or equivalent to the RPLMN for the last UE access prior to the Registration Update that is part of the UE Registration Area 54117 Tracking Area handling for NR satellite access In the case of NR satellite access with moving cells in order to ensure that each TA is Earth-stationary even if the radio cells are moving across the Earths surface the NG-RAN may change the TAC values that are broadcast in a cells system information as the cell moves as described in TS 38300 27 and TS 38331 28 NG-RAN may broadcast in a cell a single TAC per PLMN and change that TAC value as the cell moves Alternatively the NG-RAN may broadcast in a cell more than one TAC for a PLMN and add or remove TAC values as the cell moves The NG-RAN provides either the single broadcast TAI or all broadcast TAIs corresponding to the Selected PLMN as described in TS 38413 34 to the AMF as part of the ULI whenever the ULI is included in the NGAP message as described in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_328",
    "document_id": "23501-i80",
    "chunk_id": 328,
    "text": "The NG-RAN indicates if known also the TAI where the UE is geographically located When supplying location information to another NF eg SMF PCF the AMF shall include the TAI where the UE is located if known and the broadcast TAIs excluding all forbidden TAIs NOTE The AMF may take the TAI where the UE is geographically located into account to generate a suitable Registration Area for the UE 54118 Support for mobility Forbidden Area and Service Area Restrictions for NR satellite access Forbidden Area functionality is supported as described in clause 53411 with the modifications described below - The AMF and the UE receive the broadcast TAI if a single TAI is broadcast or all broadcast TAIs if multiple TAIs are broadcast from the NG-RAN as described clause 54117",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_329",
    "document_id": "23501-i80",
    "chunk_id": 329,
    "text": "The AMF considers the UE to be in a Forbidden Area if the only received TAI is forbidden or if all received TAIs are forbidden based on subscription data The UE considers it is in a Forbidden Area if the only received TAI is forbidden or if all received TAIs are forbidden and is not within a Forbidden Area in the case that at least one broadcast TAI is not forbidden - If AMF receives multiple TAIs from the NG-RAN and determines that some but not all of them are forbidden by subscription or by operator policy the AMF shall send the forbidden TAIs to the UE as described in clauses 4222 and 423 in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_330",
    "document_id": "23501-i80",
    "chunk_id": 330,
    "text": "The UE stores the TAIs in the appropriate Forbidden Area list and removes the TAIs from Registration Area if present Service Area Restrictions functionality is supported as described in clause 53412 with the modifications described below - The AMF receives the broadcast TAI if a single TAI is broadcast or all broadcast TAIs if multiple TAIs are broadcast from the NG-RAN as described clause 54117 The AMF provides the UE with Service Area Restrictions which consist of either Allowed Areas or Non-Allowed Areas as described in clause 53412 The UE and AMF consider the UE to be in a Non-Allowed Area if none of the broadcast TAIs is Allowed The UE and AMF consider the UE to be in an Allowed Area if at least one broadcast TAI is allowed 5412 Paging Early Indication with Paging Subgrouping Assistance 54121 General The RAN and UE may use a Paging Early Indication with Paging Subgrouping PEIPS to reduce the UEs power consumption in RRC_IDLE and RRC_INACTIVE over NR see TS 38304 50",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_331",
    "document_id": "23501-i80",
    "chunk_id": 331,
    "text": "The paging subgrouping can be based on either the UEs temporary ID or a Paging Subgroup ID allocated by the AMF Paging subgrouping based on the UEs temporary ID is implemented within the NG-RAN For paging subgrouping based on UEs temporary ID the UEs support is included in the UE Radio Capability for Paging either derived by the NG-RAN from UE provided UE radio capability see clause 544 or based on UE Radio Capability ID if UE radio capability signalling optimisation is used see clause 5441a The AMF when determining its paging strategy see clause 543 should take into consideration whether a gNB is using Paging subgrouping based on the UEs temporary ID NOTE Paging messages sent to that gNB can increase UE power consumption for other UEs that support Paging Subgrouping based on the UEs temporary ID If paging subgroups are being allocated by the AMF then all AMFs connected to one gNB including the AMFs in different PLMNs using 5G MOCN network sharing shall use a consistent policy in allocating UEs to the paging subgroups The AMF may configure up to 8 different Paging Subgroup IDs NOTE Because the UE uses the AMF allocated paging subgroup across all cells in its TAI-list and different overlapping TAI lists can be allocated to different UEs then to avoid UE power consumption increasing it is likely to be necessary that all AMFs with an overlapping coverage area use a consistent policy in allocating UEs to the paging subgroups The NG-RAN node and the UE determine per cell which paging subgrouping method to use as defined in TS 38304 50 and TS 38331 28 54122 Core Network Assistance for PEIPS To support the Paging Early Indication with Paging Subgrouping PEIPS Paging Subgrouping Support Indication and the PEIPS Assistance Information is used by the AMF and NG-RAN to help determine whether PEIPS applies to the UE and which paging subgroup used when paging the UE see TS 38300 27 In the Registration Request message the Paging Subgrouping Support Indication indicates whether the UE supports PEIPS with AMF PEIPS Assistance Information If the UE includes Paging Subgrouping Support Indication the UE may also include the paging probability information to assist the AMF If the AMF supports PEIPS assistance and if the UE provided Paging Subgrouping Support Indication the AMF stores the indication in the UE context in AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_332",
    "document_id": "23501-i80",
    "chunk_id": 332,
    "text": "The AMF may use local configuration the UEs paging probability information if provided information provided by the RAN eg any of the Information On Recommended Cells And RAN nodes For Paging andor previous statistical information for the UE to determine the AMF PEIPS Assistance Information The AMF PEIPS Assistance Information includes the Paging Subgroup ID NOTE 1 To minimise MT voice call setup latency the AMF could allocate Paging Subgroup IDs taking into account whether or not the UE is likely to receive IMS voice over PS session calls NOTE 2 To avoid MT traffic for more mobile UEs causing more stationary UEs to be woken up the AMF could allocate Paging Subgroup IDs taking into account the UEs mobility pattern If the AMF has determined AMF PEIPS Assistance Information for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_333",
    "document_id": "23501-i80",
    "chunk_id": 333,
    "text": "the AMF stores it in the UE context in AMF and provides it to the UE in every Registration Accept message If the AMF has determined AMF PEIPS Assistance Information the AMF shall provide it to NG RAN when paging the UE In addition in order to support PEIPS for UEs in RRC_INACTIVE mode the AMF shall provide the AMF PEIPS Assistance Information to NG-RAN as part of the RRC Inactive Assistance Information The NG-RAN chooses on a per-cell basis whether to use PEIPS and which paging subgrouping mechanism to use When using AMF allocated subgroups both the UE and NG-RAN use the AMF PEIPS Assistance Information to determine the paging subgroup to apply as defined in TS 38300 27",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_334",
    "document_id": "23501-i80",
    "chunk_id": 334,
    "text": "The AMF may use the UE Configuration Update procedure as described in clause 424 of TS 23502 3 and N2 UE Context Modification procedure as described in clause 834 of TS 38413 34 to update the AMF PEIPS Assistance Information in the UE and NG-RAN When the UE has an active emergency PDU Session - The UE shall not signal Paging Subgrouping Support Indication in the Registration Request message 5413 Support of discontinuous network coverage for satellite access 54130 General The present clause 5413 provides optional enhancements to support discontinuous coverage - Mobility management and power saving optimization see clause 54131 and - Coverage availability information provisioning to the UE see clause 54132 and - Coverage availability information provisioning to the AMF see clause 54133 and - Paging see clause 54134 and - Overload control see clause 54135 NOTE In this Release there is no specified support for discontinuous coverage over NR in RAN specifications",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_335",
    "document_id": "23501-i80",
    "chunk_id": 335,
    "text": "54131 Mobility Management and Power Saving Optimization For NR satellite access that provides discontinuous network coverage the Mobility Management and Power Saving Optimization functionality may be used If both the UE and the network support Unavailability Period Support and if the UE determines it will lose coverage and will become unavailable and the UE decides to remain in no service during that time then - the UE triggers the Mobility Registration Update procedure to inform the network of its unavailability as described in clause 5414 - The UE may be able to determine including considering current and expected future locations of the UE a Start of Unavailability Period andor Unavailability Period Duration for when it expects to be out of coverage and include them in the Mobility Registration Update procedure as described in clause 5414 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_336",
    "document_id": "23501-i80",
    "chunk_id": 336,
    "text": "The UE should trigger the Mobility Registration Update procedure early enough such that the procedure under normal conditions is able to complete before the start of the unreachability period NOTE 1 A UE based on implementation can combine successive periods of no satellite coverage into a single continuous period that is notified to the network if the UE does not require network access during this period NOTE 2 UE informing the network of coverage gaps would increase signalling and UE power consumption if coverage gaps are more frequent than UEs communication period",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_337",
    "document_id": "23501-i80",
    "chunk_id": 337,
    "text": "In case the UE requests power saving features the AMF uses the procedures defined in other clauses to provide the UE with timers eg Periodic Registration Update timer extended DRX in CM-IDLE configuration see clause 53172 and MICO mode configuration see clause 5413 and to provide the NG-RAN with Extended Connected Time see clause 53173 and may also consider the Unavailability Period Duration and Start of Unavailability Period if available This is to keep UE in power saving mode and avoid the network attempting to page the UE if it is out of satellite network coverage",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_338",
    "document_id": "23501-i80",
    "chunk_id": 338,
    "text": "The AMF should adjust the mobile reachable timer or Implicit Deregistration timer or both such that the AMF does not implicitly deregister the UE while the UE is unavailable see clause 541 Features described for High latency communication in clause 5318 may be used to handle mobile terminated MT communication with UEs being unreachable due to NR satellite access discontinuous coverage and the Unavailability Period Duration if available and Start of Unavailability Period if available may be used when determining the Estimated Maximum Wait Time Tracking Area or RAT specific configuration in the AMF may be used to set timer values based on typical coverage periods of a satellite system NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_339",
    "document_id": "23501-i80",
    "chunk_id": 339,
    "text": "For example if a satellite system only provides coverage to a UE for 20 minutes when a satellite passes and the maximum time before a satellite passes any point on the earth is 10 hours the AMF could configure the periodic registration timer and Mobile Reachable timer to be just greater than 20 minutes and the Implicit Deregistration timer to be greater than 10 hours to avoid unintended implicit detach due to coverage gap Such configuration does not require AMF to be aware of detailed coverage times for each UE or for different locations The UE may send Mobility Registration Update procedure to inform the network of its UE unavailability period see clause 5414 even if Mobility Management back-off timer is running 54132 Coverage availability information provisioning to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_340",
    "document_id": "23501-i80",
    "chunk_id": 340,
    "text": "A UE may use satellite coverage availability information for satellite access to support discontinuous coverage operations Satellite coverage availability information can be provided to a UE by an external server via a PDU Session or SMS The protocol and format of satellite coverage availability information via PDU session or SMS is not defined in this release of the specification but some examples on possible information that constitutes the satellite coverage availability information is defined in Annex Q NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_341",
    "document_id": "23501-i80",
    "chunk_id": 341,
    "text": "The satellite coverage availability information provisioned to the UE describes when and where satellite coverage with both service link and feeder link connectivity is expected or not expected to be available in an area 54133 Coverage availability information provisioning to the AMF The AMF may use satellite coverage availability information to support satellite access by UEs with discontinuous coverage operation Satellite coverage availability information may be provisioned to the AMF by OM NOTE The satellite coverage availability information provisioned to the AMF describes when and where satellite coverage with both service link and feeder link connectivity is expected or not expected to be available in an area The satellite coverage availability information is not UE specific and can be applied by the AMF for any UE in the affected area 54134 Paging In the case of NR satellite access that provides discontinuous network coverage AMF may utilize sub-area paging as described in clause 4233 of TS 23502 3 eg first page in the last known cell-id or TA and retransmission in all registered TAs The AMF may utilize the location information as received at or before the AN release due to the discontinuous coverage for paging optimisation The AMF may eg receive UE location from NG-RAN during the Registration procedure eg triggered for Mobility Management and Power Saving Optimization for discontinuous network coverage as described in clause 54131 or the AMF may request NG-RAN location reporting when the UE is in CM-CONNECTED state as described in clause 547 54135 Overload control The AMF and UE may only use the procedure defined in this clause if both the UE and AMF indicate support for Unavailability Period Support see clause 54131 A UE indicating support for Unavailability Period Support shall support the procedures defined in this clause when leaving coverage and re-gaining coverage for an NR satellite access In order to avoid a large number of UEs causing excessive signalling load on the network when leaving coverage or re-gaining coverage after being out of coverage the AMF may determine a Maximum Time Offset controlling when UEs are allowed to initiate NAS signalling with the network as described in this clause",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_342",
    "document_id": "23501-i80",
    "chunk_id": 342,
    "text": "In this case the AMF determines this Maximum Time Offset based on network configuration high priority access and priority service as specified in TS 23122 17 and TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_343",
    "document_id": "23501-i80",
    "chunk_id": 343,
    "text": "The AMF sends this Maximum Time Offset to individual UEs during the Registration procedure or UE Configuration Update procedure If the UE receives a Maximum Time Offset from the network in a Registration Accept or UE Configuration Update Command message the UE shall replace any previously received Maximum Time Offset on the same RAT type and PLMN with this one When the UE knows a later time at which coverage will be lost and when the UE does not send Mobility Registration Update to the AMF in advance see clause 54131 the UE determines a random value up to the minimum of the latest Maximum Time Offset for this PLMN and RAT type and the time until coverage will be lost The UE shall send the Mobility Registration Update at the time when coverage will be lost less the random value to the AMF indicating the loss of coverage Upon returning to coverage after being out of coverage due to discontinuous coverage the UE sets the discontinuous coverage wait timer value to a random value up to and including the latest Maximum Time Offset for this PLMN and RAT type and starts this timer The UE shall not initiate any NAS signalling on that RAT Type and PLMN while the discontinuous coverage wait timer is running The UE shall stop the discontinuous coverage wait timer and initiate NAS signalling if the UE receives paging message has pending emergency services or when UE enters a TAI outside the registration area 55 Non-3GPP access specific aspects",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_344",
    "document_id": "23501-i80",
    "chunk_id": 344,
    "text": "550 General This clause describe the specific aspects for untrusted non-3GPP access trusted non-3GPP access and W-5GAN access 551 Registration Management This clause applies to Non-3GPP access network corresponding to the Untrusted Non-3GPP access network to the Trusted Non-3GPP access network and to the W-5GAN In the case of W-5GAN the UE mentioned in this clause corresponds to 5G-RG or to the W-AGF in the case of FN-RG In the case of N5CW devices access 5GC via trusted WLAN access networks the UE mentioned in this clause corresponds to TWIF The UE shall enter RM-DEREGISTERED state and the AMF shall enter RM-DEREGISTERED state for the UE on non-3GPP access as follows - at the UE and at the AMF after performing an Explicit Deregistration procedure - at the AMF after the Network non-3GPP Implicit Deregistration timer has expired - at the UE after the UE non-3GPP Deregistration timer has expired NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_345",
    "document_id": "23501-i80",
    "chunk_id": 345,
    "text": "This is assumed to leave sufficient time to allow the UE to re-activate UP connections for the established PDU Sessions over 3GPP or non-3GPP access Whenever a UE registered over non-3GPP access enters CM-IDLE state for the non-3GPP access it starts the UE non-3GPP Deregistration timer according to the value received from the AMF during a Registration procedure Over non-3GPP access the AMF runs the Network non-3GPP Implicit Deregistration timer The Network non-3GPP Implicit Deregistration timer is started with a value longer than the UEs non-3GPP Deregistration timer whenever the CM state for the UE registered over non-3GPP access changes to CM-IDLE for the non-3GPP access For a UE that is registered over Non-3GPP access a change of the point of attachment eg change of WLAN AP shall not lead the UE to perform a Registration procedure A UE that is registered over non-3GPP access may trigger a Mobility Registration Update procedure via a new non-3GPP AN node ie N3IWF or TNGF to switch traffic from an old non-3GPP access to a new non-3GPP access Traffic switching from an old non-3GPP access to and from a wireline access is not supported in this Release Traffic switching from an old non-3GPP access to new non-3GPP access is supported only when PLMN of the new non-3GPP access is the same PLMN of the old non-3GPP access A UE shall not provide 3GPP-specific parameters eg indicate a preference for MICO mode during registration over a non-3GPP access During registration procedure the AMF may determine whether the serving N3IWFTNGF is appropriate based on the slices supported by the N3IWFsTNGFs as specified in clause 636 and clause 6312 respectively 552 Connection Management",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_346",
    "document_id": "23501-i80",
    "chunk_id": 346,
    "text": "This clause applies to Non-3GPP access network corresponding to the Untrusted Non-3GPP access network to the Trusted Non-3GPP access network and to the W-5GAN The UE mentioned in this clause corresponds to the 5G-RG in the case of W-5GAN and to the W-AGF in the case of FN-RG In the case of N5CW devices access 5GC via trusted WLAN access networks the UE mentioned in this clause corresponds to TWIF A UE that successfully establishes a Non-3GPP Access Connection to the 5GC over a Non-3GPP access transitions to CM-CONNECTED state for the Non-3GPP access In the case of Untrusted Non-3GPP access to 5GC the Non-3GPP Access Connection corresponds to an NWu connection In the case of Trusted access to 5GC the Non-3GPP Access Connection corresponds to an NWt connection In the case of N5CW devices access 5GC via trusted WLAN access networks the Non-3GPP Access Connection corresponds to an Yt connection In the case of Wireline access to 5GC the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_347",
    "document_id": "23501-i80",
    "chunk_id": 347,
    "text": "Access Connection corresponds to a Y4 connection and to Y5 connection A UE does not establish multiple simultaneous Non-3GPP Access Connection to the 5GC The Non-3GPP Access Connection is released either as a result of an Explicit Deregistration procedure or an AN Release procedure In the case of Untrusted Non-3GPP access Trusted Non-3GPP access and W-5GAN access to 5GC the N3IWF TNGF TWIF and W-AGF may in addition explicitly release the NWu NWt Yt Y4 and Y5 signalling connection due to NWu NWt Yt Y4 and Y5 connection failure respectively In the case of NWu and NWt the release may be determined by the dead peer detection mechanism in IKEv2 defined in RFC 7296 60 In the case of Y4 and Y5 the release may be detected for example by lost of synchronisation of physical link lost of PPPoE session etc Further details on how NWu NWt",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_348",
    "document_id": "23501-i80",
    "chunk_id": 348,
    "text": "Yt Y4 and Y5 connection failure is detected is out of scope of 3GPP specifications For W-5GCAN the W-AGF explicitly releases the N2 connection due to Y4 or Y5 connection failure as determined by the dead peer detection mechanism in DOCSIS MULPI 89 The release of the Non-3GPP Access Connection between the UE and the N3IWF TNGF TWIF or W-AGF shall be interpreted as follows - By the N3IWF TNGF TWIF and W-AGF as a criterion to release the N2 connection - By the UE as a criterion for the UE to transition to CM-IDLE A UE registered over non-3GPP access remains in RM-REGISTERED state unless the Non-3GPP Access Connection release occurs as part of a Deregistration procedure over non-3GPP access in which case the UE enters the RM-DEREGISTERED state When the UE in RM-REGISTERED transitions to CM-IDLE the UE non-3GPP Deregistration timer starts running in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_349",
    "document_id": "23501-i80",
    "chunk_id": 349,
    "text": "The UE non-3GPP Deregistration timer stops when the UE moves to CM-CONNECTED state or to the RM-DEREGISTERED state NOTE 1 When moved to CM-IDLE state over one access the UE can attempt to re-activate UP connections for the PDU Sessions over other access per UE policies and depending on the availability of these accesses NOTE 2 The release of the NWu NWt Yt Y4 or Y5 at the UE can occur as a result of explicit signalling from the N3IWF TNGF TWIF or W-AGF respectively eg IKE INFORMATION EXCHANGE in the case of NWu or as a result of the UE detecting NWu NWt Yt Y4 or Y5 connection failure eg as determined by the dead peer detection mechanism in IKEv2 as defined in RFC 7296 60 for NWu NWt and Yt or W-5GAN access specific mechanism for Y4 and Y5 Further details on how the UE detects NWu NWt",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_350",
    "document_id": "23501-i80",
    "chunk_id": 350,
    "text": "Yt Y4 or Y5 connection failure is out of scope of 3GPP specifications In the case of Non-3GPP access when the AMF releases the N2 interface the N3IWF TNGF TWIF and W-AGF shall release all the resources associated with the UE including the Non-3GPP Access Connection with the UE and its corresponding N3 resources A release of the N2 connection by the AMF shall set the CM state for the UE in the AMF to CM-IDLE NOTE 3 It is assumed that a UE configured to receive services from a 5GC over non-3GPP access that is RM-DEREGISTERED or CM-IDLE over the non-3GPP access will attempt to establish Non-3GPP Access Connection and transition to CM-CONNECTED state whenever the UE successfully connects to a non-3GPP access unless prohibited by the network to make a N3GPP Access Connection eg due to network congestion",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_351",
    "document_id": "23501-i80",
    "chunk_id": 351,
    "text": "An UE cannot be paged on Non-3GPP access network When a UE registered simultaneously over a 3GPP access and a non-3GPP access moves all the PDU Sessions to one of the accesses whether the UE initiates a Deregistration procedure in the access that has no PDU Sessions is up to the UE implementation Release of PDU Sessions over the non-3GPP access does not imply the release of N2 connection When the UE has PDU Sessions routed over the non-3GPP access and the UE state becomes CM-IDLE for the non-3GPP access these PDU Sessions are not released to enable the UE to move the PDU Sessions over the 3GPP access based on UE policies The core network maintains the PDU Sessions but deactivates the N3 user plane connection for such PDU Sessions 553 UE Reachability 5531 UE reachability in CM-IDLE This clause applies to Non-3GPP access network corresponding to the Untrusted Non-3GPP access network to the Trusted Non-3GPP access network and to the W-5GAN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_352",
    "document_id": "23501-i80",
    "chunk_id": 352,
    "text": "The UE mentioned in this clause corresponds to 5G-RG in the case of W-5GAN or to W-AGF in the case of support of FN-RG In the case of N5CW devices access 5GC via trusted WLAN access networks the UE mentioned in this clause corresponds to TWIF An UE cannot be paged over Non-3GPP access network If the UE states in the AMF are CM-IDLE and RM-REGISTERED for the non-3GPP access there may be PDU Sessions that were last routed over the non-3GPP access and without user plane resources If the AMF receives a message with a Non-3GPP Access Type indication from an SMF for a PDU Session corresponding to a UE that is CM-IDLE for non-3GPP access and the UE is registered over 3GPP access in the same PLMN as the one registered over non-3GPP access a Network Triggered Service Request may be performed over the 3GPP access independently of whether the UE is CM-IDLE or CM-CONNECTED over the 3GPP access In this case the AMF provides an indication that the procedure is related to non-3GPP access as specified in clause 568 NOTE The UE behaviour upon such network triggered Service Request is specified in clause 568 5532 UE reachability in CM-CONNECTED This clause applies to Non-3GPP access network corresponding to the Untrusted Non-3GPP access network to the Trusted Non-3GPP access network and to the W-5GAN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_353",
    "document_id": "23501-i80",
    "chunk_id": 353,
    "text": "In the case of W-5GAN the UE mentioned in this clause corresponds to 5G-RG and to W-AGF in the case of support of FN-RG In the case of N5CW devices access 5GC via trusted WLAN access networks the UE mentioned in this clause corresponds to TWIF For a UE in CM-CONNECTED state - the AMF knows the UE location on a N3IWF TNGF TWIF and W-AGF node granularity - the N3IWF TNGF TWIF and W-AGF releases the N2 connection when UE becomes unreachable from N3IWF TNGF TWIF and W-AGF point of view ie upon Non-3GPP Access Connection release 56 Session Management 561 Overview The 5GC supports a PDU Connectivity Service ie a service that provides exchange of PDUs between a UE and a data network identified by a DNN The PDU Connectivity Service is supported via PDU Sessions that are established upon request from the UE The Subscription Information for each S-NSSAI may contain a Subscribed DNN list and one default DNN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_354",
    "document_id": "23501-i80",
    "chunk_id": 354,
    "text": "When the UE does not provide a DNN in a NAS Message containing PDU Session Establishment Request for a given S-NSSAI the serving AMF determines the DNN for the requested PDU Session by selecting the default DNN for this S-NSSAI if a default DNN is present in the UEs Subscription Information otherwise the serving AMF selects a locally configured DNN for this S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_355",
    "document_id": "23501-i80",
    "chunk_id": 355,
    "text": "The expectation is that the URSP in the UE is always up to date using the procedure defined in clause 416122 of TS 23502 3 and therefore the UE requested DNN will be up to date In order to cover cases that UE operates using local configuration but also other cases where operator policies can be used in order to replace an up to date UE requested DNN with another DNN used only internally in the network during UE Registration procedure the PCF may indicate to the AMF the operator policies to be used at PDU Session Establishment for DNN replacement of a UE requested DNN PCF may indicate a policy for DNN replacement of UE requested DNNs not supported by the network andor indicate a list of UE requested DNNs per S-NSSAI valid for the serving network that are subject for replacement details are described in TS 23503 45 If the DNN provided by the UE is not supported by the network and AMF cannot select an SMF by querying NRF the AMF shall reject the NAS Message containing PDU Session Establishment Request from the UE with a cause indicating that the DNN is not supported unless the PCF provided the policy to perform a DNN replacement of unsupported DNNs If the DNN requested by the UE is indicated for replacement or the DNN provided by the UE is not supported by the network and the PCF provided the policy to perform DNN replacement of UE requested DNNs not supported by the network the AMF shall interact with the PCF to perform a DNN replacement During PDU Session Establishment procedure and as a result of DNN replacement the PCF provides the selected DNN that is applicable for the S-NSSAI requested by the UE at the PDU Session Establishment",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_356",
    "document_id": "23501-i80",
    "chunk_id": 356,
    "text": "The AMF uses the selected DNN in the query towards the NRF for the SMF selection as specified in clause 632 and provides both requested and selected DNN to the selected SMF For PDU Session with Home-routed Roaming whether to perform DNN replacement is based on operator agreements NOTE 1 The selected DNN is determined based on operator preferences and can differ from subscribed DNNs The matching of selected DNN to S-NSSAI is assumed to be based on network configuration Each PDU Session supports a single PDU Session type ie supports the exchange of a single type of PDU requested by the UE at the establishment of the PDU Session The following PDU Session types are defined IPv4 IPv6 IPv4v6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_357",
    "document_id": "23501-i80",
    "chunk_id": 357,
    "text": "Ethernet Unstructured PDU Sessions are established upon UE request modified upon UE and 5GC request and released upon UE and 5GC request using NAS SM signalling exchanged over N1 between the UE and the SMF Upon request from an Application Server the 5GC is able to trigger a specific application in the UE When receiving that trigger message the UE shall pass it to the identified application in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_358",
    "document_id": "23501-i80",
    "chunk_id": 358,
    "text": "The identified application in the UE may establish a PDU Session to a specific DNN see clause 445 SMF may support PDU Sessions for LADN where the access to a DN is only available in a specific LADN service area This is further defined in clause 565 SMF may support PDU Sessions for a 5G VN group which offers a virtual data network capable of supporting 5G LAN-type service over the 5G system This is further defined in clause 58213 The SMF is responsible of checking whether the UE requests are compliant with the user subscription For this purpose it retrieves and requests to receive update notifications on SMF level subscription data from the UDM Such data may indicate per DNN and per S-NSSAI of the HPLMN - The allowed PDU Session Types and the default PDU Session Type - The allowed SSC modes and the default SSC mode - QoS Information refer to clause 57 the subscribed Session-AMBR Default 5QI and Default ARP - The IP Index information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_359",
    "document_id": "23501-i80",
    "chunk_id": 359,
    "text": "The static IP addressprefix - The subscribed User Plane Security Policy - the Charging Characteristics to be associated with the PDU Session Whether this information is provided by the UDM to a SMF in another PLMN for PDU Sessions in LBO mode is defined by operator policies in the UDMUDR NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_360",
    "document_id": "23501-i80",
    "chunk_id": 360,
    "text": "The content of the Charging Characteristics as well as the usage of the Charging Characteristics by the SMF are defined in TS 32255 68 A PDU Session may support a a single-access PDU Connectivity Service in which case the PDU Session is associated with a single access type at a given time ie either 3GPP access or non-3GPP access or b a multi-access PDU Connectivity Service in which case the PDU Session is simultaneously associated with both 3GPP access and non-3GPP access and simultaneously associated with two independent N3N9 tunnels between the PSA and RANAN A PDU Session supporting a single-access PDU Connectivity Service is also referred to as single-access PDU Session while a PDU Session supporting a multi-access PDU Connectivity Service is referred to as Multi-Access PDU MA PDU Session and it is used to support the ATSSS feature see clause 532 for details A UE that is registered over multiple accesses chooses over which access to establish a PDU Session As defined in TS 23503 45 the HPLMN may send policies to the UE to guide the UE selection of the access over which to establish a PDU Session NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_361",
    "document_id": "23501-i80",
    "chunk_id": 361,
    "text": "In this Release of the specification at any given time a PDU Session is routed over only a single access network unless it is an MA PDU Session in which case it can be routed over one 3GPP access network and one Non 3GPP access network concurrently A UE may request to move a single-access PDU Session between 3GPP and Non 3GPP accesses The decision to move single-access PDU Sessions between 3GPP access and Non 3GPP access is made on a per PDU Session basis ie the UE may at a given time have some PDU Sessions using 3GPP access while other PDU Sessions are using Non 3GPP access If the UE is attempting to move a single-access PDU session from 3GPP access to non-3GPP access and the PDU session is associated with control plane only indication then the AMF shall reject the PDU Session Establishment request as related CIoT 5GS optimisation features are not supported over non-3GPP access as described in clause 54525 of TS 24501 47 If the UE is attempting to move a single-access PDU session from non-3GPP access to NB-N1 mode of 3GPP access the PDU Session Establishment request would also be rejected by AMF when the UP resources for the UE exceed the maximum number of supported UP resources as described in clause 54524 of TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_362",
    "document_id": "23501-i80",
    "chunk_id": 362,
    "text": "In a PDU Session Establishment Request message sent to the network the UE shall provide a PDU Session ID The PDU Session ID is unique per UE and is the identifier used to uniquely identify one of a UEs PDU Sessions The PDU Session ID shall be stored in the UDM to support handover between 3GPP and non-3GPP access when different PLMNs are used for the two accesses The UE also provides as described in TS 24501 47 a PDU Session Type b S-NSSAI of the HPLMN that matches the application that is triggering the PDU Session Request within the NSSP in the URSP rules or within the UE Local Configuration as defined in clause 61221 of TS 23503 45 NOTE 4 If the UE cannot determine any S-NSSAI after performing the association of the application to a PDU Session then it does not indicate any S-NSSAI in the PDU Session Establishment procedure as defined in clause 51553 c S-NSSAI of the Serving PLMN from the Allowed NSSAI corresponding to the S-NSSAI of the HPLMN b NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_363",
    "document_id": "23501-i80",
    "chunk_id": 363,
    "text": "In non-roaming scenario the mapping of the Allowed NSSAI to HPLMN S-NSSAIs is not provided to the UE because the S-NSSAI of the Serving PLMN c has the same value of the S-NSSAI of the HPLMN b therefore the UE provides in the PDU Session Request only the S-NSSAI of the Serving PLMN c NOTE 6 In roaming scenarios the UE provides in the PDU Session Request both the S-NSSAI of the HPLMN b and the S-NSSAI of the VPLMN from the Allowed NSSAI c that maps to the S-NSSAI of the HPLMN d DNN Data Network Name e SSC mode Service and Session Continuity mode defined in clause 5692",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_364",
    "document_id": "23501-i80",
    "chunk_id": 364,
    "text": "Additionally if the UE supports ATSSS and wants to activate a MA PDU Session the UE shall provide Request Type as MA PDU Request and shall indicate the supported ATSSS capabilities see clause 532 for details Table 561-1 Attributes of a PDU Session Subscription Information may include a wildcard DNN per subscribed S-NSSAI when a wildcard DNN is associated with a subscribed S-NSSAI the subscription allows for this S-NSSAI the UE to establish a PDU Session using any DNN value NOTE 7 The SMF is made aware whether the DNN of a PDU Session being established corresponds to an explicitly subscribed DNN or corresponds to a wildcard DNN Thus the SMF can reject a PDU Session establishment if the DNN of the PDU Session is not part of explicitly subscribed DNNs and local policies in the SMF require UE to have a subscription to this DNN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_365",
    "document_id": "23501-i80",
    "chunk_id": 365,
    "text": "A UE may establish multiple PDU Sessions to the same data network or to different data networks via 3GPP and via and Non-3GPP access networks at the same time A UE may establish multiple PDU Sessions to the same Data Network and served by different UPF terminating N6 A UE with multiple established PDU Sessions may be served by different SMF The SMF shall be registered and deregistered on a per PDU Session granularity in the UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_366",
    "document_id": "23501-i80",
    "chunk_id": 366,
    "text": "The user plane paths of different PDU Sessions to the same or to different DNN belonging to the same UE may be completely disjoint between the AN and the UPF interfacing with the DN When the SMF cannot control the UPF terminating the N3 interface used by a PDU Session and SSC mode 23 procedures are not applied to the PDU Session an I-SMF is inserted between the SMF and the AMF and handling of PDU Sessions is described in clause 534 NOTE 8 User Plane resources for PDU Sessions of a UE except for regulatory prioritized service like Emergency Services and MPS can be deactivated by the SMF if the UE is only reachable for regulatory prioritized services The SMF serving a PDU session ie Anchor can be changed during lifetime of the PDU session either within the same SMF set or if the Context Transfer Procedures as specified in clause 426 of TS 23502 3 are supported between SMFs in different SMF sets 562 Interaction between AMF and SMF The AMF and SMF are separate Network Functions N1 related interaction with SMF is as follows - The single N1 termination point is located in AMF The AMF forwards SM related NAS information to the SMF based on the PDU Session ID in the NAS message Further SM NAS exchanges eg SM NAS message responses for N1 NAS signalling received by the AMF over an access eg 3GPP access or non-3GPP access are transported over the same access -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_367",
    "document_id": "23501-i80",
    "chunk_id": 367,
    "text": "The serving PLMN ensures that subsequent SM NAS exchanges eg SM NAS message responses for N1 NAS signalling received by the AMF over an access eg 3GPP access or non-3GPP access are transported over the same access - SMF handles the Session management part of NAS signalling exchanged with the UE - The UE shall only initiate PDU Session Establishment in RM-REGISTERED state - When a SMF has been selected to serve a specific PDU Session AMF has to ensure that all NAS signalling related with this PDU Session is handled by the same SMF instance - Upon successful PDU Session Establishment the AMF and SMF stores the Access Type that the PDU Session is associated N11 related interaction with SMF is as follows - The AMF reports the reachability of the UE based on a subscription from the SMF including - The UE location information with respect to the area of interest indicated by the SMF - The SMF indicates to AMF when a PDU Session has been released - Upon successful PDU Session Establishment AMF stores the identification of serving SMF of UE and SMF stores the identification of serving AMF of UE including the AMF set When trying to reach the AMF serving the UE the SMF may need to apply the behaviour described for the other CP NFs in clause 521 N2 related interaction with SMF is as follows - Some N2 signalling such as handover related signalling may require the action of both AMF and SMF In such case the AMF is responsible to ensure the coordination between AMF and SMF The AMF may forward the SM N2 signalling towards the corresponding SMF based on the PDU Session ID in N2 signalling - SMF shall provide PDU Session Type together with PDU Session ID to NG-RAN in order to facilitate NG-RAN to apply suitable header compression mechanism to packet of different PDU type Details refer to TS 38413 34 N3 related interaction with SMF is as follows - Selective activation and deactivation of UP connection of existing PDU Session is defined in clause 568 N4 related interaction with SMF is as follows - When it is made aware by the UPF that some DL data has arrived for a UE without downlink N3 tunnel information the SMF interacts with the AMF to initiate Network Triggered Service Request procedure In this case if the SMF is aware that the UE is unreachable or if the UE is reachable only for regulatory prioritized service and the PDU Session is not for regulatory prioritized service then the SMF shall not inform DL data notification to the AMF The AMF is responsible of selecting the SMF per procedures described in clause 632",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_368",
    "document_id": "23501-i80",
    "chunk_id": 368,
    "text": "For this purpose it gets subscription data from the UDM that are defined in that clause Furthermore it retrieves the subscribed UE-AMBR from the UDM and optionally dynamic serving network UE-AMBR from PCF based on operator local policy and sends to the RAN as defined in clause 572 AMF-SMF interactions to support LADN or LADN per DNN and S-NSSAI are defined in clause 565 and in clause 565a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_369",
    "document_id": "23501-i80",
    "chunk_id": 369,
    "text": "In order to support charging and to fulfil regulatory requirement in order to provide NPLI Network Provided Location Information as defined in TS 23228 15 related with the set-up modification and release of IMS Voice calls or with SMS transfer the following applies - At the time of the PDU Session Establishment the AMF provides the SMF with the PEI of the UE if the PEI is available at the AMF - When it forwards UL NAS or N2 signalling to a peer NF eg to SMF or to SMSF or during the UP connection activation of a PDU Session the AMF provides any User Location Information it has received from the 5G-AN as well as the Access Type 3GPP - Non 3GPP of the AN over which it has received the UL NAS or N2 signalling The AMF also provides the corresponding UE Time Zone",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_370",
    "document_id": "23501-i80",
    "chunk_id": 370,
    "text": "In addition in order to fulfil regulatory requirement ie providing Network Provided Location Information NPLI as defined in TS 23228 15 when the access is non-3GPP the AMF may also provide the last known 3GPP access User Location Information with its age if the UE is still attached to the same AMF for 3GPP access ie valid User Location Information The User Location Information the access type and the UE Time Zone may be further provided by SMF to PCF The PCF may get this information from the SMF in order to provide NPLI to applications such as IMS that have requested it The User Location Information may correspond to - In the case of 3GPP access TAI Cell-Id The AMF includes only the Primary Cell-Id even if it had received also the Cell-Id of the Primary cell in the Secondary RAN node from NG-RAN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_371",
    "document_id": "23501-i80",
    "chunk_id": 371,
    "text": "In the case of Untrusted non-3GPP access TAI the UE local IP address used to reach the N3IWF and optionally the UDP source port number if NAT is detected - In the case of Trusted non-3GPP access TAI TNAPTWAP Identifier the UEN5CW device local IP address used to reach the TNGFTWIF and optionally the UDP source port number if NAT is detected When the UE uses WLAN based on IEEE 80211 technology to reach the TNGF the TNAP Identifier shall include the SSID of the access point to which the UE is attached The TNAP Identifier shall include at least one of the following elements unless otherwise determined by the TWAN operators policies - the BSSID see IEEE Std 80211-2012 106 - civic address information of the TNAP to which the UE is attached The TWAP Identifier shall include the SSID of the access point to which the NC5W is attached The TWAP Identifier shall also include at least one of the following elements unless otherwise determined by the TWAN operators policies - the BSSID see IEEE Std 80211-2012 106 - civic address information of the TWAP to which the UE is attached NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_372",
    "document_id": "23501-i80",
    "chunk_id": 372,
    "text": "The SSID can be the same for several TNAPsTWAPs and SSID only cannot provide a location but it might be sufficient for charging NOTE 2 the BSSID associated with a TNAPTWAP is assumed to be static -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_373",
    "document_id": "23501-i80",
    "chunk_id": 373,
    "text": "In the case of W-5GAN access The User Location Information for W-5GAN is defined in TS 23316 84 When the SMF receives a request to provide Access Network Information reporting while there is no action to carry out towards the 5G-AN or the UE eg no QoS Flow to create Update modify the SMF may request User Location Information from the AMF The interaction between AMF and SMFs for the case of a I-SMF insertion relocation or removal for a PDU session is described in clause 534 563 Roaming In the case of roaming the 5GC supports following possible deployments scenarios for a PDU Session - Local Break Out LBO where the SMF and all UPFs involved by the PDU Session are under control of the VPLMN - Home Routed HR where the PDU Session is supported by a SMF function under control of the HPLMN by a SMF function under control of the VPLMN by at least one UPF under control of the HPLMN and by at least one UPF under control of the VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_374",
    "document_id": "23501-i80",
    "chunk_id": 374,
    "text": "In this case the SMF in HPLMN selects the UPFs in the HPLMN and the SMF in VPLMN selects the UPFs in the VPLMN This is further described in clause 63 Home Routed with Session Breakout in VPLMN HR-SBO is described in clause 67 of TS 23548 130 NOTE 1 The use of an UPF in the VPLMN eg enables VPLMN charging VPLMN LI and minimizes the impact on the HPLMN of the UE mobility within the VPLMN eg for scenarios where SSC mode 1 applies Different simultaneous PDU Sessions of an UE may use different modes Home Routed and LBO The HPLMN can control via subscription data per DNN and per S-NSSAI whether a PDU Session is to be set-up in HR or in LBO mode In the case of PDU Sessions per Home Routed deployment - NAS SM terminates in the SMF in VPLMN - The SMF in VPLMN forwards to the SMF in the HPLMN SM related information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_375",
    "document_id": "23501-i80",
    "chunk_id": 375,
    "text": "The SMF in the HPLMN receives the SUPI of the UE from the SMF in the VPLMN during the PDU Session Establishment procedure - The SMF in HPLMN is responsible to check the UE request with regard to the user subscription and to possibly reject the UE request in the case of mismatch The SMF in HPLMN obtains subscription data directly from the UDM - The SMF in HPLMN may send QoS requirements associated with a PDU Session to the SMF in VPLMN This may happen during the PDU Session Establishment procedure and after the PDU Session is established The interface between SMF in HPLMN and SMF in VPLMN is also able to carry N9 User Plane forwarding information exchanged between SMF in HPLMN and SMF in VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_376",
    "document_id": "23501-i80",
    "chunk_id": 376,
    "text": "The SMF in the VPLMN may check QoS requests from the SMF in HPLMN with respect to roaming agreements In home routed roaming case the AMF selects an SMF in the VPLMN and a SMF in the HPLMN as described in clause 632 and in clause 432233 of TS 23502 3 and provides the identifier of the selected SMF in the HPLMN to the selected SMF in the VPLMN In roaming with LBO the AMF selects a SMF in the VPLMN as described in clause 632 and in clause 432232 of TS 23502 3 In this case when handling a PDU Session Establishment Request message the SMF in the VPLMN may reject the N11 message related with the PDU Session Establishment Request message with a proper N11 cause This triggers the AMF to select both a new SMF in the VPLMN and a SMF in the HPLMN in order to handle the PDU Session using home routed roaming 564 Single PDU Session with multiple PDU Session Anchors 5641 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_377",
    "document_id": "23501-i80",
    "chunk_id": 377,
    "text": "In order to support selective traffic routing to the DN or to support SSC mode 3 as defined in clause 56923 the SMF may control the data path of a PDU Session so that the PDU Session may simultaneously correspond to multiple N6 interfaces The UPF that terminates each of these interfaces is said to support PDU Session Anchor functionality Each PDU Session Anchor supporting a PDU Session provides a different access to the same DN Further the PDU Session Anchor assigned at PDU Session Establishment is associated with the SSC mode of the PDU Session and the additional PDU Session Anchors assigned within the same PDU Session eg for selective traffic routing to the DN are independent of the SSC mode of the PDU Session When a PCC rule including the Application Function influence on traffic routing Enforcement Control information defined in clause 631 of TS 23503 45 is provided to the SMF the SMF can decide whether to apply traffic routing by using UL Classifier functionality or IPv6 multi-homing based on DNAIs included in the PCC rule NOTE 1 Application Function influence on traffic routing Enforcement Control information can be either determined by the PCF when requested by AF via NEF as described in clause 5671 or statically pre-configured in the PCF NOTE 2 Selective traffic routing to the DN supports for example deployments where some selected traffic is forwarded on an N6 interface to the DN that is close to the AN serving the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_378",
    "document_id": "23501-i80",
    "chunk_id": 378,
    "text": "This may correspond to - The Usage of UL Classifier functionality for a PDU Session defined in clause 5642 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_379",
    "document_id": "23501-i80",
    "chunk_id": 379,
    "text": "The Usage of an IPv6 multi-homing for a PDU Session defined in clause 5643 SMF may also take decision to apply traffic routing by using UL Classifier functionality or IPv6 multi-homing in EAS Discovery with EASDF procedure described in TS 23548 130 5642 Usage of an UL Classifier for a PDU Session In the case of PDU Sessions of type IPv4 or IPv6 or IPv4v6 or Ethernet the SMF may decide to insert in the data path of a PDU Session an UL CL Uplink classifier The UL CL is a functionality supported by an UPF that aims at diverting locally some traffic matching traffic filters provided by the SMF The insertion and removal of an UL CL is decided by the SMF and controlled by the SMF using generic N4 and UPF capabilities The SMF may decide to insert in the data path of a PDU Session a UPF supporting the UL CL functionality during or after the PDU Session Establishment or to remove from the data path of a PDU Session a UPF supporting the UL CL functionality after the PDU Session Establishment",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_380",
    "document_id": "23501-i80",
    "chunk_id": 380,
    "text": "The SMF may include more than one UPF supporting the UL CL functionality in the data path of a PDU Session The UE is unaware of the traffic diversion by the UL CL and does not involve in both the insertion and the removal of UL CL In the case of a PDU Session of IPv4 or IPv6 or IPv4v6 type the UE associates the PDU Session with either a single IPv4 address or a single IPv6 Prefix or both of them allocated by the network When an UL CL functionality has been inserted in the data path of a PDU Session there are multiple PDU Session Anchors for this PDU Session These PDU Session Anchors provide different access to the same DN In the case of a PDU Session of IPv4 or IPv6 or IPv4v6 type only one IPv4 address andor IPv6 prefix is provided to the UE The SMF may be configured with local policies for some DNN S-NSSAI combinations to release the PDU Session when there is a PSA associated with the IPv4 address allocated to the UE and this PSA has been removed NOTE 0",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_381",
    "document_id": "23501-i80",
    "chunk_id": 381,
    "text": "The use of only one IPv4 address andor IPv6 prefix with multiple PDU Session Anchors assumes that when needed appropriate mechanisms are in place to correctly forward packets on the N6 reference point The mechanisms for packet forwarding on the N6 reference point between the PDU Session Anchor providing local access and the DN are outside the scope of this specification The UL CL provides forwarding of UL traffic towards different PDU Session Anchors and merge of DL traffic to the UE ie merging the traffic from the different PDU Session Anchors on the link towards the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_382",
    "document_id": "23501-i80",
    "chunk_id": 382,
    "text": "This is based on traffic detection and traffic forwarding rules provided by the SMF The UL CL applies filtering rules eg to examine the destination IP addressPrefix of UL IP packets sent by the UE and determines how the packet should be routed The UPF supporting an UL CL may also be controlled by the SMF to support traffic measurement for charging traffic replication for LI and bit rate enforcement Session-AMBR per PDU Session NOTE 1 When N9 forwarding tunnel exists between source ULCL and target ULCL the Session-AMBR per PDU Session can be enforced by the source UL CL UPF NOTE 2 The UPF supporting an UL CL may also support a PDU Session Anchor for connectivity to the local access to the data network including eg support of tunnelling or NAT on N6 This is controlled by the SMF Additional UL CLs and thus additional PDU Session Anchors can be inserted in the data path of a PDU Session to create new data paths for the same PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_383",
    "document_id": "23501-i80",
    "chunk_id": 383,
    "text": "The way to organize the data path of all UL CLs in a PDU Session is up to operator configuration and SMF logic and there is only one UPF supporting UL CL connecting to the RAN via N3 interface except when session continuity upon UL CL relocation is used The insertion of an ULCL in the data path of a PDU Session is depicted in Figure 5642-1 Figure 5642-1 User plane Architecture for the Uplink Classifier NOTE 3 It is possible for a given UPF to support both the UL CL and the PDU Session Anchor functionalities Due to UE mobility the network may need to relocate the UPF acting as UL CL and establish a new PSA for local access to the DN To support session continuity during UL CL relocation the network may establish a temporary N9 forwarding tunnel between the source UL CL and target UL CL",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_384",
    "document_id": "23501-i80",
    "chunk_id": 384,
    "text": "The AF may influence the creation of the N9 forwarding tunnel as described in clause 5671 The N9 forwarding tunnel is maintained until - all active traffic flowing on it ceases to exist for - a configurable period of time or - a period of time indicated by the AF - until the AF informs the SMF that it can release the source PSA providing local access to the DN During the existence of the N9 forwarding tunnel the UPF acting as target UL CL is configured with packet filters that - force uplink traffic from existing data sessions between UE and the application in the source local part of the DN as defined in TS 23548 130 into the N9 forwarding tunnel towards the source UL CL - force any traffic related to the application in the target local part of the DN to go to the new local part of the DN via the target PSA SMF may send a Late Notification to AF to inform it about the DNAI change as described in clause 4363 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_385",
    "document_id": "23501-i80",
    "chunk_id": 385,
    "text": "This notification can be used by the AF eg to trigger mechanisms in the source local part of the DN to redirect the ongoing traffic sessions towards an application in the target local part of the DN SMF can also send late notification to the target AF instance if associated with this target local part of the DN The procedure for session continuity upon UL CL relocation is described in clause 4357 of TS 23502 3 When an I-SMF is inserted for a PDU Session the details of UL CL insertion which is controlled by an I-SMF is described in clause 5344 5643 Usage of IPv6 multi-homing for a PDU Session A PDU Session may be associated with multiple IPv6 prefixes This is referred to as multi-homed PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_386",
    "document_id": "23501-i80",
    "chunk_id": 386,
    "text": "The multi-homed PDU Session provides access to the Data Network via more than one PDU Session Anchor The different user plane paths leading to the different PDU Session Anchors branch out at a common UPF referred to as a UPF supporting Branching Point functionality The Branching Point provides forwarding of UL traffic towards the different PDU Session Anchors and merge of DL traffic to the UE ie merging the traffic from the different PDU Session Anchors on the link towards the UE The UPF supporting a Branching Point functionality may also be controlled by the SMF to support traffic measurement for charging traffic replication for LI and bit rate enforcement Session-AMBR per PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_387",
    "document_id": "23501-i80",
    "chunk_id": 387,
    "text": "The insertion and removal of a UPF supporting Branching Point is decided by the SMF and controlled by the SMF using generic N4 and UPF capabilities The SMF may decide to insert in the data path of a PDU Session a UPF supporting the Branching Point functionality during or after the PDU Session Establishment or to remove from the data path of a PDU Session a UPF supporting the Branching Point functionality after the PDU Session Establishment Multi homing of a PDU Session applies only for PDU Sessions of IPv6 type When the UE requests a PDU Session of type IPv4v6 or IPv6 the UE also provides an indication to the network whether it supports a Multi-homed IPv6 PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_388",
    "document_id": "23501-i80",
    "chunk_id": 388,
    "text": "The use of multiple IPv6 prefixes in a PDU Session is characterised by the following - The UPF supporting a Branching Point functionality is configured by the SMF to spread UL traffic between the PDU Session Anchors based on the Source Prefix of the PDU which may be selected by the UE based on routing information and preferences received from the network - IETF RFC 4191 8 is used to configure routing information and preferences into the UE to influence the selection of the source Prefix NOTE 1 This corresponds to Scenario 1 defined in IETF RFC 7157 7 IPv6 Multi-homing without Network Address Translation This allows to make the Branching Point unaware of the routing tables in the Data Network and to keep the first hop router function in the PDU Session Anchors - The multi-homed PDU Session may be used to support make-before-break service continuity to support SSC mode 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_389",
    "document_id": "23501-i80",
    "chunk_id": 389,
    "text": "This is illustrated in Figure 5643-1 - The multi-homed PDU Session may also be used to support cases where UE needs to access both a local service eg local server and a central service eg the internet illustrated in Figure 5643-2 - The UE shall use the method specified in clause 4353 of TS 23502 3 to determine if a multi-homed PDU Session is used to support the service continuity case shown in Figure 5643-1 or if it is used to support the local access to DN case shown in Figure 5643-2 Figure 5643-1 Multi-homed PDU Session service continuity case NOTE 2 It is possible for a given UPF to support both the Branching Point and the PDU Session Anchor functionalities Figure 5643-2 Multi-homed PDU Session local access to same DN NOTE 3 It is possible for a given UPF to support both the Branching Point and the PDU Session Anchor functionalities 565 Support for Local Area Data Network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_390",
    "document_id": "23501-i80",
    "chunk_id": 390,
    "text": "The access to a DN via a PDU Session for a LADN is only available in a specific LADN service area A LADN service area is a set of Tracking Areas LADN is a service provided by the serving PLMN or the serving SNPN It includes - LADN service applies only to 3GPP accesses and does not apply in Home Routed case - The usage of LADN DNN requires an explicit subscription to this DNN or subscription to a wildcard DNN - Whether a DNN corresponds to a LADN service is an attribute of a DNN and is per PLMN or per SNPN The UE is configured to know whether a DNN is a LADN DNN on a per-PLMN or per SNPN basis and an association between application and LADN DNN The configured association is considered to be a UE local configuration defined in TS 23503 45 Alternatively the UE gets the information whether a DNN is a LADN DNN from LADN Information during re-registration procedure as described in this clause NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_391",
    "document_id": "23501-i80",
    "chunk_id": 391,
    "text": "No other procedure for configuring the UE to know whether a DNN is a LADN DNN is defined in this release of the specifications NOTE 2 The procedure for configuring the UE to know an association between application and LADN DNN is not defined in this release of the specifications LADN service area and LADN DNN are configured in the AMF on a per DN basis ie for different UEs accessing the same LADN the configured LADN service area is the same regardless of other factors eg UEs Registration Area or UE subscription NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_392",
    "document_id": "23501-i80",
    "chunk_id": 392,
    "text": "If a LADN is not available in any TA of an AMFs service area the AMF is not required to be configured with any LADN related information for that DNN LADN Information ie LADN Service Area Information and LADN DNN is provided by AMF to the UE during the Registration procedure or UE Configuration Update procedure For each LADN DNN configured in the AMF the corresponding LADN Service Area Information includes a set of Tracking Areas that belong to the Registration Area that the AMF assigns to the UE ie the intersection of the LADN service area and the assigned Registration Area The AMF shall not create Registration Area based on the availability of LADNs NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_393",
    "document_id": "23501-i80",
    "chunk_id": 393,
    "text": "It is thus possible that the LADN Service Area Information sent by the AMF to the UE contains only a sub-set of the full LADN service area as the LADN service area can contain TAs outside of the registration area of the UE or outside of the area served by the AMF When the UE performs a successful re-registration procedure the AMF may provide to the UE based on local configuration eg via OAM about LADN on UE location and on UE subscription information received from the UDM about subscribed DNNs the LADN Information for the list of LADN available to the UE in that Registration Area in the Registration Accept message The UE may provide either the LADN DNNs to retrieve the LADN Information for the indicated LADN DNNs or an indication of Requesting LADN Information to retrieve the LADN Information for all LADNs available in the current Registration Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_394",
    "document_id": "23501-i80",
    "chunk_id": 394,
    "text": "The list of LADN is determined as follows - If neither LADN DNN nor an indication of requesting LADN Information is provided in the Registration Request message the list of LADN is the LADN DNNs in subscribed DNN list except for wildcard DNN - If the UE provides LADN DNNs in the Registration Request message the list of LADN is LADN DNNs the UE requested if the UE subscribed DNNs includes the requested LADN DNN or if a wildcard DNN is included in the UEs subscription data NOTE 5 It is assumed that an application can use only one LADN DNN at a time - If the UE provides an indication of requesting LADN Information in the Registration Request message the list of LADN is all the LADN DNNs configured in the AMF if the wildcard DNN is subscribed or the LADN DNNs which is in subscribed DNN list and no wildcard DNN is subscribed The UE considers the retrieved LADN Information valid only for the registered PLMN and the E-PLMNs if the LADN Service Area Information includes Tracking Areas that belong to E-PLMNs Additionally an LADN DNN discovered by the UE via the retrieved LADN Information is considered an LADN DNN also in the E-PLMNs of the Registered PLMN ie the UE can request LADN Information for the discovered LADN DNN in the E-PLMNs During the subsequent Registration procedure if the network does not provide LADN Information for a DNN the UE deletes any LADN Information for that DNN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_395",
    "document_id": "23501-i80",
    "chunk_id": 395,
    "text": "When the LADN Information for the UE in the 5GC is changed the AMF shall update LADN Information to the UE through UE Configuration UpdateRegistration procedure as described in clauses 424 42222 of TS 23502 3 When receiving PDU Session Establishment with LADN DNN or Service Request for the established PDU Session corresponding to LADN the AMF determines UE presence in LADN service area and forwards it to the SMF if the requested DNN is configured at the AMF as a LADN DNN Based on the LADN Service Area Information in the UE the UE determines whether it is in or out of a LADN service area If the UE does not have the LADN Service Area Information for a LADN DNN the UE shall consider it is out of the LADN service area The UE takes actions as follows a When the UE is out of a LADN service area the UE - shall not request to activate UP connection of a PDU Session for this LADN DNN - shall not attempt to send user data as payload of a NAS message see clause 53141 using a PDU Session for this LADN DNN - shall not establishmodify a PDU Session for this LADN DNN except for PS Data Off status change reporting for an established PDU Session - need not release any existing PDU Session for this LADN DNN unless UE receives explicit SM PDU Session Release Request message from the network b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_396",
    "document_id": "23501-i80",
    "chunk_id": 396,
    "text": "When the UE is in a LADN service area the UE - may request a PDU Session EstablishmentModification for this LADN DNN - may request to activate UP connection of the existing PDU Session for this LADN DNN - may attempt to send user data as payload of a NAS message see clause 53141 using a PDU Session for this LADN DNN NOTE 6 The evaluation of Service Area Restrictions will be performed before the evaluation of LADN service area if the UE has overlapping areas between Service Area Restrictions and LADN service area The SMF supporting a DNN is configured with information about whether this DNN is a LADN DNN or not When receiving SM request corresponding an LADN from the AMF the SMF determines whether the UE is inside LADN service area based on the indication ie UE Presence in LADN service area received from the AMF If the SMF does not receive the indication the SMF considers that the UE is outside of the LADN service area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_397",
    "document_id": "23501-i80",
    "chunk_id": 397,
    "text": "The SMF shall reject the request if the UE is outside of the LADN service area When the SMF receives a request for PDU Session Establishment with the LADN DNN it shall subscribe to UE mobility event notification for reporting UE presence in Area of Interest by providing LADN DNN to the AMF as described in clauses 5611 and 5344 Based on the notification about the UE presence in LADN service area notified by AMF ie IN OUT or UNKNOWN the SMF takes actions as follows based on operators policy a When SMF is informed that the UE presence in a LADN service area is OUT the SMF shall - release the PDU Session immediately or - deactivate the user plane connection for the PDU Session and it shall not attempt to send user data as payload of a NAS message see clause 53141 while maintaining the PDU Session and ensure the Data Notification is disabled and the SMF may release the PDU Session if the SMF is not informed that the UE moves into the LADN service area after a period b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_398",
    "document_id": "23501-i80",
    "chunk_id": 398,
    "text": "When SMF is informed that the UE presence a LADN service area is IN the SMF shall - ensure that Data Notification is enabled - trigger the Network triggered Service Request procedure for a LADN PDU Session to active the UP connection or send user data as payload of a NAS message see clause 53141 when the SMF receives downlink data or Data Notification from UPF c When the SMF is informed that the UE presence in a LADN service area is UNKNOWN the SMF may - ensure that Data Notification is enabled - trigger the Network triggered Service Request procedure for a LADN PDU Session to active the UP connection or send user data as payload of a NAS message see clause 53141 when the SMF receives downlink data or Data Notification from UPF SMF may make use of UE mobility analytics provided by NWDAF as described in clause 672 of TS 23288 86 to determine UE presence pattern in LADN service area and take a decision how to handle LADN PDN Session eg release the PDU Session immediately or deactivate the user plane connection for the PDU Session with maintaining the PDU Session 565a Supporting LADN per DNN and S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_399",
    "document_id": "23501-i80",
    "chunk_id": 399,
    "text": "The 5GS may support LADN per DNN and S-NSSAI and the functions specified in clause 565 are used with the extension to apply per DNN and S-NSSAI whenever applicable with the following enhancements - The UE indicates the support of LADN per DNN and S-NSSAI in the UE MM Core Network Capability of the Registration Request message - The LADN service area can be provisioned for a group eg 5G VN group or an individual subscriber using UDMNEF parameter provisioning service triggered by AF request as described in clause 4156 of TS 23502 3 - LADN service area per DNN and S-NSSAI may be configured in the AMF The LADN service area may also be provided to AMF as part of the subscription data from UDM - The LADN Service Area Information provided to the UE is determined by AMF based on the Registration Area that the AMF assigns to the UE and either the local configured LADN service area or the LADN service area received from UDM In case there is both a configured LADN service area and a LADN service area received from UDM the AMF decides based on operator configuration which one takes precedence - If the UE indicates support of LADN per DNN and S-NSSAI the AMF may provide the LADN Service Area Information per LADN DNN and S-NSSAI to the UE - When the UE has an ongoing PDU session and there is no LADN service area for the DNN and S-NSSAI of the PDU session the AMF will release the ongoing PDU session if the AMF determines to configure the LADN service area configured per LADN DNN and S-NSSAI for the associated DNN and S-NSSAI eg due to notification from UDM or local configuration update - When the UE has an ongoing PDU session subject to LADN per LADN DNN and S-NSSAI the AMF will release the ongoing PDU session if the AMF determines the LADN service area for the DNN and S-NSSAI is removed eg due to notification from UDM or local configuration update NOTE 1 After the UE receives the LADN Information per LADN DNN and S-NSSAI it is up to the UE implementation whether to re-establish the PDU session - If the UE does not indicate support of LADN per DNN and S-NSSAI and the AMF has a LADN service area for the DNN as well as a LADN service area for the DNN and S-NSSAI the AMF may determine the LADN Service Area Information per LADN DNN sent to UE using the LADN service area for the DNN as described in clause 565 - If the UE does not indicate support of LADN per DNN and S-NSSAI and the AMF has no LADN service area for the DNN but there is a LADN service area for the DNN and S-NSSAI then the AMF may determine the LADN Service Area Information per LADN DNN sent to UE using this LADN service area for the DNN and S-NSSAI as the LADN service area for that DNN as described in clause 565 if the UE is not subscribed to the same DNN for multiple S-NSSAIs ie the UE is subscribed to the DNN for a single S-NSSAI only NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_400",
    "document_id": "23501-i80",
    "chunk_id": 400,
    "text": "In order to serve the UEs that do not support LADN per DNN and S-NSSAIs the operator can avoid using the same DNN for multiple S-NSSAIs if LADN service area is configured per DNN and S-NSSAI - If the UE does not indicate support of LADN per DNN and S-NSSAI and the AMF neither has a LADN service area for the DNN nor has a LADN service area for the DNN and S-NSSAI the AMF shall not provide any LADN Information to the UE - The AMF enforces the LADN Service Area per LADN DNN and S-NSSAI in the same way as is described in clause 565 with the difference that the LADN service area is defined per DNN and S-NSSAI - The UE enforces the LADN Service Area per LADN DNN and S-NSSAI if received from the AMF in the same way as is described in clause 565 with the difference that the LADN service area is defined per DNN and S-NSSAI - If the AMF enforces the LADN Service Area per LADN DNN and S-NSSAI for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_401",
    "document_id": "23501-i80",
    "chunk_id": 401,
    "text": "the AMF indicates to the SMF during PDU Session Establishment that the PDU Session is subject to LADN per LADN DNN and S-NSSAI - If indicated by AMF at PDU Session Establishment that PDU Session is subject to LADN per LADN DNN and S-NSSAI the SMF configures the DNN of PDU Session as LADN DNN The SMF shall subscribe to UE mobility event notification for reporting UE presence in Area of Interest by providing LADN DNN and S-NSSAI to the AMF as described in clauses 5611 and 5344 The SMF handles the PDU session in the same way as described in clause 565 NOTE 3 If the UE has overlapping areas between LADN service area configured per DNN S-NSSAI Partial network slice support area or any combination of them then the evaluation of Partial network slice support area take precedence over the evaluation of LADN service area configured per DNN and S-NSSAI 566 Secondary authenticationauthorization by a DN-AAA server during the establishment of a PDU Session At PDU Session Establishment to a DN - The DN-specific identity TS 33501 29 of a UE may be authenticatedauthorized by the DN NOTE 1 the DN-AAA server may belong to the 5GC or to the DN - If the UE provides authenticationauthorization information corresponding to a DN-specific identity during the Establishment of the PDU Session and the SMF determines that Secondary authenticationauthorization of the PDU Session Establishment is required based on the SMF policy associated with the DN the SMF passes the authenticationauthorization information of the UE to the DN-AAA server via the UPF if the DN-AAA server is located in the DN If the SMF determines that Secondary authenticationauthorization of the PDU Session Establishment is required but the UE has not provided a DN-specific identity as part of the PDU Session Establishment request the SMF requests the UE to indicate a DN-specific identity using EAP procedures as described in TS 33501 29 If the Secondary authenticationauthorization of the PDU Session Establishment fails the SMF rejects the PDU Session Establishment NOTE 2 If the DN-AAA server is located in the 5GC and reachable directly then the SMF may communicate with it directly without involving the UPF - The DN-AAA server may authenticateauthorize the PDU Session Establishment - When DN-AAA server authorizes the PDU Session Establishment it may send DN Authorization Data for the established PDU Session to the SMF The DN authorization data for the established PDU Session may include one or more of the following - A DN Authorization Profile Index which is a reference to authorization data for policy and charging control locally configured in the SMF or PCF - a list of allowed MAC addresses for the PDU Session this shall apply only for PDU Session of Ethernet PDU type and is further described in clause 56102 - a list of allowed VLAN tags for the PDU Session this shall apply only for PDU Session of Ethernet PDU type and is further described in clause 56102 - DN authorized Session AMBR for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_402",
    "document_id": "23501-i80",
    "chunk_id": 402,
    "text": "The DN Authorized Session AMBR for the PDU Session takes precedence over the subscribed Session-AMBR received from the UDM - Framed Route information see clause 5614 for the PDU Session - L2TP information such as LNS IP address andor LNS host name as described in TS 29561 132 SMF policies may require DN authorization without Secondary authenticationauthorization In that case when contacting the DN-AAA server for authorization the SMF provides the GPSI of the UE if available Such Secondary authenticationauthorization takes place for the purpose of PDU Session authorization in addition to - The 5GC access authentication handled by AMF and described in clause 52 - The PDU Session authorization enforced by SMF with regards to subscription data retrieved from UDM Based on local policies the SMF may initiate Secondary authenticationauthorization at PDU Session Establishment",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_403",
    "document_id": "23501-i80",
    "chunk_id": 403,
    "text": "The SMF provides the GPSI if available in the signalling exchanged with the DN-AAA during Secondary authenticationauthorization After the successful Secondary authenticationauthorization a session is kept between the SMF and the DN-AAA The UE provides the authenticationauthorization information required to support Secondary authenticationauthorization by the DN over NAS SM If a UE is configured with DNNs which are subject to secondary authenticationauthorization the UE stores an association between the DNN and corresponding credentials for the secondary authenticationauthorization NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_404",
    "document_id": "23501-i80",
    "chunk_id": 404,
    "text": "How the UE is aware that a DNN is subject to secondary authenticationauthorization eg based on local configuration is out of scope of this specification The UE may support remote provisioning of credentials for secondary authenticationauthorization as specified in clause 539 A UE that supports to be provisioned with the credentials used for secondary authenticationauthorization over UP remote provisioning shall use connectivity over an S-NSSAIDNN which can access the provisioning server to establish a PDU session for remote provisioning as defined in clause 539 NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_405",
    "document_id": "23501-i80",
    "chunk_id": 405,
    "text": "The credentials for secondary authenticationauthorization are not specified SMF policies or subscription information such as defined in Table 52331 of TS 23502 3 may trigger the need for SMF to request the Secondary authenticationauthorization andor UE IP address Prefix from the DN-AAA server When SMF adds a PDU Session Anchor such as defined in clause 564 to a PDU Session Secondary authenticationauthorization is not carried out but SMF policies may require SMF to notify the DN when a new prefix or address has been added to or removed from a PDU Session or N6 traffic routing information has been changed for a PDU Session When SMF gets notified from UPF with the addition or removal of MAC addresses tofrom a PDU Session the SMF policies may require SMF to notify the DN-AAA server Indication of PDU Session Establishment rejection is transferred by SMF to the UE via NAS SM If the DN-AAA sends DN Authorization Data for the authorized PDU Session to the SMF and dynamic PCC is deployed the SMF sends the PCF the DN authorized Session AMBR andor DN Authorization Profile Index in the DN Authorization Data for the established PDU Session If the DN-AAA sends DN Authorization Profile Index in DN Authorization Data to the SMF and dynamic PCC is not deployed the SMF uses the DN Authorization Profile Index to refer the locally configured information NOTE 5 DN Authorization Profile Index is assumed to be pre-negotiated between the operator and the administrator of DN-AAA server If the DN-AAA does not send DN Authorization Data for the established PDU Session the SMF may use locally configured information At any time a DN-AAA server may revoke the authorization for a PDU Session or update DN Authorization Data for a PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_406",
    "document_id": "23501-i80",
    "chunk_id": 406,
    "text": "According to the request from DN-AAA server the SMF may release or update the PDU Session See clause 5614 when the update involves Framed Route information At any time a DN-AAA server or SMF may trigger Secondary Re-authentication procedure for a PDU Session established with Secondary Authentication as specified in clause 1113 of TS 33501 29 During Secondary Re-authenticationRe-authorization if the SMF receives from DN-AAA the DN authorized Session AMBR andor DN Authorization Profile Index the SMF shall report the received values to the PCF The procedure for secondary authenticationauthorization by a DN-AAA server during the establishment of a PDU Session is described in clause 4323 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_407",
    "document_id": "23501-i80",
    "chunk_id": 407,
    "text": "The support for L2TP on N6 is further specified in clause 58216 and the procedure for establishment of L2TP tunnelling on N6 for a PDU Session is described in clause 4324 of TS 23502 3 NOTE 6 The L2TP Tunnel information sent to the SMF can for example be provisioned in the DN-AAA server per DNNS-NSSAI or per SUPI or GPSI 567 Application Function influence on traffic routing 5671 General The content of this clause applies to non-roaming and to LBO deployments ie to cases where the involved entities AF PCF SMF UPF belong to the Serving PLMN or AF belongs to a third party with which the Serving PLMN has an SLA agreement AF influence on traffic routing may apply in the case of Home Routed deployments with Session Breakout HR SBO as defined in TS 23548 130",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_408",
    "document_id": "23501-i80",
    "chunk_id": 408,
    "text": "In that case when an AF belonging to the V-PLMN or with an offloading SLA with the V PLMN desires to provide Traffic Influence policies it may invoke at the V-NEF the API defined in this clause and provide the information listed in Table 567-1 below but the corresponding Traffic Influence information is provided directly from V-NEF to V-SMF bypassing the PCF This is further defined in TS 23548 130 clause 672 and the rest of the clause 5671 does not address how information related with AF influence on traffic routing may be provided to the SMF in the case of HR SBO PCF shall not apply AF requests to influence traffic routing to PDU Sessions established in Home Routed mode The AF may determine the common EASDNAI for the UE set in order to indicate a common EAS or common local part of DN and provide the common EASDNAI to the 5GS An AF may send requests to influence SMF routing decisions for traffic of PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_409",
    "document_id": "23501-i80",
    "chunk_id": 409,
    "text": "The AF requests may influence UPF reselection and I-SMF reselection and allow routing user traffic to a local access to a Data Network identified by a DNAI The AF may issue requests on behalf of applications not owned by the PLMN serving the UE If the operator does not allow an AF to access the network directly the AF shall use the NEF to interact with the 5GC as described in clause 6210 The AF may be in charge of the reselection or relocation of the applications within the local part of the DN as defined in TS 23548 130 Such functionality is not defined For this purpose the AF may request to get notified about events related with PDU Sessions In the case of AF instance change the AF may send request of AF relocation information The AF requests are sent to the PCF via N5 in the case of requests targeting specific on-going PDU Sessions of individual UEs for an AF allowed to interact directly with the 5GC NFs or via the NEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_410",
    "document_id": "23501-i80",
    "chunk_id": 410,
    "text": "The AF requests that target existing or future PDU Sessions of multiple UEs or of any UE are sent via the NEF and may target multiple PCFs as described in clause 6372 The PCFs transforms the AF requests into policies that apply to PDU Sessions When the AF has subscribed to UP path management event notifications from SMFs including notifications on how to reach a GPSI over N6 such notifications are sent either directly to the AF or via an NEF without involving the PCF For AF interacting with PCF directly or via NEF the AF requests may contain the information as described in the Table 567-1 Table 567-1 Information element contained in AF request For each information element mentioned above in the AF request the detailed description is as follows 1 Information to identify the traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_411",
    "document_id": "23501-i80",
    "chunk_id": 411,
    "text": "The traffic can be identified in the AF request by - Either a DNN and possibly slicing information S-NSSAI or an AF-Service-Identifier - When the AF provides an AF-Service-Identifier ie an identifier of the service on behalf of which the AF is issuing the request the 5G Core maps this identifier into a target DNN and slicing information S-NSSAI - When the NEF processes the AF request the AF-Service-Identifier may be used to authorize the AF request - An application identifier or traffic filtering information eg IP 5 Tuple The application identifier refers to an application handling UP traffic and is used by the UPF to detect the traffic of the application When the AF request is for influencing SMF routing decisions the information is to identify the traffic to be routed When the AF request is for subscription to notifications about UP path management events the information is to identify the traffic that the events relate to The AF request may include a PLMN ID of the PLMN that the DNN and S-NSSAI belong to as described in clause 4361 of TS 23502 3 2 Information about the N6 traffic routing requirements for traffic identified as defined in 1 This includes - Information about the N6 traffic routing requirements that is provided per DNAI for each DNAI the N6 traffic routing requirements may contain a routing profile ID andor N6 traffic routing information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_412",
    "document_id": "23501-i80",
    "chunk_id": 412,
    "text": "An optional indication of traffic correlation when the information in 4 identifies a group of UEs This implies the targeted PDU Sessions should be correlated by a common DNAI in the user plane for the traffic identified in 1 If this indication is provided by the AF the 5GC should select a common DNAI for the target PDU Sessions from the list of DNAIs specified in 3 NOTE 1 The N6 traffic routing requirements are related to the mechanism enabling traffic steering in the local access to the DN The routing profile ID refers to a pre-agreed policy between the AF and the 5GC This policy may refer to different steering policy IDs sent to SMF and eg based on time of the day etc NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_413",
    "document_id": "23501-i80",
    "chunk_id": 413,
    "text": "The mechanisms enabling traffic steering in the local access to the DN are not defined 3 Potential locations of applications towards which the traffic routing should apply The potential location of application is expressed as a list of DNAIs If the AF interacts with the PCF via the NEF the NEF may map the AF-Service-Identifier information to a list of DNAIs The DNAIs may be used for UPF reselection and I-SMF reselection When only one DNAI is included and the Indication of traffic correlation is available the DNAI is used as common DNAI for UEs identified by AF request The AF request may include a PLMN ID of the PLMN that the list of DNAIs belongs to as described in clause 4361 of TS 23502 3 4 Information on the set of target UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_414",
    "document_id": "23501-i80",
    "chunk_id": 414,
    "text": "This may correspond to - Individual UEs ie one or a list of UEs identified using GPSI or an IP addressPrefix or a MAC address - Groups of UEs identified by External Group Identifiers as defined in TS 23682 36 when the AF interacts via the NEF or Internal-Group Identifier see clause 597 when the AF interacts directly with the PCF - Any UE accessing the combination of DNN S-NSSAI and DNAIs - External Group IDs or any UE can both be complemented with External Subscriber Categorys for a more granular selection of UEs NEF may map this to Internal Group IDs or a combination of Internal Group IDs and Subscriber Categorys defined in TS 23503 45 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_415",
    "document_id": "23501-i80",
    "chunk_id": 415,
    "text": "Only NEF is aware of the External Subscriber Category As a user can be associated with multiple Subscriber Categorys some values of Subscriber Categorys can correspond to an SLA between an application provider represented by an AF and the 5GC operator In the NEF API the combination of application identifier and External Subscriber Category can also be used to refer to this SLA When the PDU Session type is IPv4 or IPv6 or IPv4v6 and the AF provides an IP address andor an IP Prefix or when the PDU Session type is Ethernet and the AF provides a MAC address this allows the PCF to identify the PDU Session for which this request applies and the AF request applies only to that specific PDU Session of the UE In this case additional information such as the UE identity may also be provided to help the PCF to identify the correct PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_416",
    "document_id": "23501-i80",
    "chunk_id": 416,
    "text": "Otherwise the request targets multiple UEs and shall apply to any existing or future PDU Sessions that match the parameters in the AF request When the AF request targets an individual or a list of UEs and GPSI is provided within the AF request the GPSI is mapped to SUPI according to the subscription information received from UDM When the AF request targets any UE or a group of UE the AF request is likely to influence multiple PDU Sessions possibly served by multiple SMFs and PCFs When the AF request targets a group of UE it provides one or several group identifiers in its request The group identifiers provided by the AF are mapped to Internal-Group identifiers Members of the group have Group Identifiers in their subscription The Internal-Group Identifiers isare stored in UDM retrieved by SMF from UDM and passed by SMF to PCF at PDU Session set-up The PCF can then map the AF request with user subscription and determine whether an AF request targeting a Group of users applies to a PDU Session When External Subscriber Categorys is provided the NEF maps External Subscriber Categorys into Subscriber Categorys the PCF can map the AF request with user subscription and then creates PCC rules for UEs that have the Subscriber Categorys in their subscription When the AF request is for influencing SMF routing decisions the information is to identify UEs whose traffic is to be routed When the AF request is for subscription to notifications about UP path management events the information is to identify UEs whose traffic the events relate to When the AF request is for traffic forwarding in a PDU Session serving for TSC the MAC address used by the PDU Session is determined by the AF to identify UE whose traffic is to be routed according to the previously stored binding relationship of the 5GS Bridge and the port number of the traffic forwarding information received from TSN network 5 Indication of application relocation possibility This indicates whether an application can be relocated once a location of the application is selected by the 5GC If application relocation is not possible the 5GC shall ensure that for the traffic related with an application no DNAI change takes place once selected for this application 6 Temporal validity condition This is provided in the form of time intervals or durations during which the AF request is to be applied When the AF request is for influencing SMF routing decisions the temporal validity condition indicates when the traffic routing is to apply When the AF request is for subscription to notifications about UP path management events the temporal validity condition indicates when the notifications are to be generated 7 Spatial validity condition on the UEs location This is provided in the form of validity areas If the AF interacts with the PCF via the NEF it may provide geographical area eg a civic address or shapes and the NEF maps the information to areas of validity based on pre-configuration The PCF in turn determines areas of interest based on validity areas When the AF request is for influencing SMF routing decisions the spatial validity condition indicates that the request applies only to the traffic of UEs located in the specified location When the AF request is for subscription to notifications about UP path management events the spatial validity condition indicates that the subscription applies only to the traffic of UEs located in the specified location 8 Information on AF subscription to corresponding SMF events The AF may request to be subscribed to change of UP path associated with traffic identified in the bullet 1 above The AF request contains - A type of subscription subscription for Early andor Late notifications",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_417",
    "document_id": "23501-i80",
    "chunk_id": 417,
    "text": "The AF subscription can be for Early notifications andor Late notifications In the case of a subscription for Early notifications the SMF sends the notifications before the new UP path is configured In the case of a subscription for Late notifications the SMF sends the notification after the new UP path has been configured - Notification target address for receiving event notification - Optionally an indication of AF acknowledgment to be expected The indication implies that the AF will provide a response to the notifications of UP path management events to the 5GC The SMF may according to this indication determine to wait for a response from the AF before the SMF configures in the case of early notification or activates in the case of late notification the new UP path as described in clause 5672 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_418",
    "document_id": "23501-i80",
    "chunk_id": 418,
    "text": "Optionally an immediate reporting flag The immediate reporting flag is included when AF subscribe for candidate DNAIs of UE for common EASDNAI selection With this flag SMF should immediately response AF with the candidate DNAIs using Notification of user plane management event as described in clause 4363 in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_419",
    "document_id": "23501-i80",
    "chunk_id": 419,
    "text": "The AF subscription can also request to receive information associating the GPSI of the UE with the IP addresses of the UE andor with actual N6 traffic routing to be used to reach the UE on the PDU Session in this case the corresponding information is sent by the SMF regardless of whether a DNAI applies to the PDU Session 9 An AF transaction identifier referring to the AF request This allows the AF to update or remove the AF request and to identify corresponding UP path management event notifications The AF transaction identifier is generated by the AF When the AF interacts with the PCF via the NEF the NEF maps the AF transaction identifier to an AF transaction internal identifier which is generated by the NEF and used within the 5GC to identify the information associated to the AF request The NEF maintains the mapping between the AF transaction identifier and the AF transaction internal identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_420",
    "document_id": "23501-i80",
    "chunk_id": 420,
    "text": "The relation between the two identifiers is implementation specific When the AF interacts with the PCF directly the AF transaction identifier provided by the AF is used as AF transaction internal identifier within the 5GC 10 Indication of UE IP address preservation This indicates UE IP address related to the traffic identified in bullet 1 should be preserved If this indication is provided by the AF the 5GC should preserve the UE IP address by preventing reselection of PSA UPF for the identified traffic once the PSA UPF is selected 11 Information for EAS IP Replacement in 5GC This indicates the Source EAS identifier and Target EAS identifier ie IP addresses and port numbers of the source and target EAS for a service subject to Edge Computing 12 User Plane Latency Requirement This includes AF requirements for User Plane latency see clause 636 of TS 23548 130 13 Information on AF change The AF relocation information includes - AF Identifier the identifier of the target AF instance NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_421",
    "document_id": "23501-i80",
    "chunk_id": 421,
    "text": "The AF relocation information is applicable for interaction with NEF only and it is not stored in UDR or transferred to PCF even for the case AF directly interacts with PCF 14 Indication for EAS relocation This indicates the applications are to be relocated 15 Indication for Simultaneous Connectivity over source and target PSA at Edge Relocation see clause 634 of TS 23548 130 Indicates that source and target PSA should coexist for some time at PSA relocation and may influence the establishment of a temporary N9 forwarding tunnel between the source UL CL and target UL CL",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_422",
    "document_id": "23501-i80",
    "chunk_id": 422,
    "text": "It may also provide guidance for the time interval after the described traffic ceases when the connectivity over the source PSA may be removed 16 Traffic Correlation ID Identification of a set of UEs subjecting to the AF request and accessing the application identified by the Traffic Description UEs associated with the same Traffic Correlation ID and accessing the application identified by the Traffic Description should connect to a common EAS or EASes corresponding to a common DNAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_423",
    "document_id": "23501-i80",
    "chunk_id": 423,
    "text": "The following attributes may be provided with the Traffic Correlation ID - EAS Correlation indication Indicates selecting a common EAS for a set of UEs identified by Traffic Correlation ID and accessing the application identified by the Traffic Description - Common EAS IP address IP address of the common EAS to be accessed by the UEs in the set of UEs subject to AF request for the application identified by the Traffic Description NOTE 5 In the case of common EAS selection if Traffic Correlation ID is provided either EAS Correlation indication or Common EAS will be included in AF request - FQDNs FQDNs corresponding to the application to be accessed by a set of UEs When FQDNs is included it is used for influencing EAS discovery procedure as defined in TS 23548 130 - Indication of traffic correlation as described in 2 NOTE 6 If both EAS Correlation indication and Indication of traffic correlation are included the set of UEs access the common EAS via the common DNAI An AF may send requests to influence SMF routing decisions for event subscription or for both The AF may request to be subscribed to notifications about UP path management events ie a UP path change occurs for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_424",
    "document_id": "23501-i80",
    "chunk_id": 424,
    "text": "The corresponding notification about a UP path change sent by the SMF to the AF may indicate the DNAI and or the N6 traffic routing information andor common EAS that has changed as described in clause 4363 of TS 23502 3 It may include the AF transaction internal identifier the type of notification ie early notification or late notification the Identity of the source andor target DNAI the IP addressprefix of the UE or the MAC address used by the UE the GPSI and the N6 traffic routing information related to the 5GC UP The AF may subscribe for notifications of candidate DNAIs for UE if AF selection of common EASDNAI for a set of UEs is used NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_425",
    "document_id": "23501-i80",
    "chunk_id": 425,
    "text": "The change from the UP path status where no DNAI applies to a status where a DNAI applies indicates the activation of this AF request the change from the UP path status where a DNAI applies to a status where no DNAI applies indicates the de-activation of this AF request In the case of IP PDU Session Type the IP addressprefix of the UE together with N6 traffic routing information indicates to the AF how to reach over the User Plane the UE identified by its GPSI N6 traffic routing information indicates any tunnelling that may be used over N6 The nature of this information depends on the deployment NOTE 8 N6 traffic routing information can eg correspond to the identifier of a VPN or to explicit tunnelling information such as a tunnelling protocol identifier together with a Tunnel identifier NOTE 9",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_426",
    "document_id": "23501-i80",
    "chunk_id": 426,
    "text": "In the case of Unstructured PDU Session type the nature of the N6 traffic routing information related to the 5GC UP is described in clause 56103 In the case of Ethernet PDU Session Type the MAC address of the UE together with N6 traffic routing information indicates to the AF how to reach over the User Plane the UE identified by its GPSI The UE MAC address es is reported by the UPF as described in clause 58212 The N6 traffic routing information can be eg a VLAN ID or the identifier of a VPN or a tunnel identifier at the UPF When notifications about UP path management events are sent to the AF via the NEF if required the NEF maps the UE identify information eg SUPI to the GPSI and the AF transaction internal identifier to the AF transaction identifier before sending the notifications to the AF The PCF based on information received from the AF operators policy optionally service experience analytics per UP path received from NWDAF etc authorizes the request received from the AF and determines for each DNAI a traffic steering policy ID derived from the routing profile ID provided by the AF andor the N6 traffic routing information as provided by the AF to be sent to the SMF as part of the PCC rules The traffic steering policy IDs are configured in the SMF or in the UPF The traffic steering policy IDs are related to the mechanism enabling traffic steering to the DN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_427",
    "document_id": "23501-i80",
    "chunk_id": 427,
    "text": "The DNAIs are related to the information considered by the SMF for UPF selection and I-SMF reselection eg for diverting locally some traffic matching traffic filters provided by the PCF The PCF acknowledges a request targeting an individual PDU Session to the AF or to the NEF For PDU Session that corresponds to the AF request the PCF provides the SMF with a PCC rule that is generated based on the AF request Local routing indication from the PDU Session policy control subscription information and taking into account UE location presence in area of interest ie Presence Reporting Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_428",
    "document_id": "23501-i80",
    "chunk_id": 428,
    "text": "The PCC rule contains the information to identify the traffic information about the DNAIs towards which the traffic routing should apply and optionally an indication of traffic correlation andor an indication of application relocation possibility andor indication of UE IP address preservation The PCC rule also contains per DNAI a traffic steering policy ID andor N6 traffic routing information if the N6 traffic routing information is explicitly provided in the AF request If Traffic Correlation ID is included in the AF request with EAS Correlation Indication or Common EAS and FQDNs parameters the Traffic Correlation ID and the EAS Correlation Indication or Common EAS and FQDNs will be included in the PCC rule sent to SMF The SMF can use the Traffic Correlation ID to determine that the UE belongs to a set of UEs identified by Traffic Correlation ID and a common EAS should be selected for the set of UE for the traffic identified by Traffic Descriptor as described in clause 62325 of TS 23548 130 If Traffic Correlation ID is included in the AF request NEF updates the AF influence data in the UDR with the NEF Notification Endpoint to indicate it as responsible of the set of UEs associated with the Traffic correlation ID and to be notified with 5GC determined information as described in clause 62327 of TS 23548 130 The PCF provides in the PCC rule with information including the NEF Notification Endpoint for the SMF to notify to the NEF with 5GC determined information related to the UE members of the set of UEs identified by traffic correlation ID If Traffic Correlation ID and traffic correlation indication and FQDNs is included in the AF request the Traffic Correlation ID and the traffic correlation indication will be included in the PCC rule sent to SMF The SMF can use the Traffic Correlation ID to determine that the UE belongs to a set of UEs identified by Traffic Correlation ID and the UE needs to connect to EASs corresponding to a common DNAI selected for the set of UE for the traffic identified by Traffic Descriptor as described in clause 62326 of TS 23548 130",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_429",
    "document_id": "23501-i80",
    "chunk_id": 429,
    "text": "The PCF may also provide in the PCC rule information to subscribe the AF or the NEF to SMF events UP path changes corresponding to the AF request in which case it provides the information on AF subscription to corresponding SMF events received in the AF request This is done by providing policies at PDU Session set-up or by initiating a PDU Session Modification procedure When initiating a PDU Session set-up or PDU Session Modification procedure the PCF considers the latest known UE location to determine the PCC rules provided to the SMF The PCF evaluates the temporal validity condition of the AF request and informs the SMF to activate or deactivate the corresponding PCC rules according to the evaluation result When policies specific to the PDU Session and policies general to multiple PDU Sessions exist the PCF gives precedence to the PDU Session specific policies over the general policies The PCF authorizes the AF request of User Plane Latency Requirements If the PCF determines that the requirements cant be authorized the PCF rejects the AF request The spatial validity condition is resolved at the PCF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_430",
    "document_id": "23501-i80",
    "chunk_id": 430,
    "text": "In order to do that the PCF subscribes to the SMF to receive notifications about change of UE location in an area of interest ie Presence Reporting Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_431",
    "document_id": "23501-i80",
    "chunk_id": 431,
    "text": "The subscribed area of interest may be the same as spatial validity condition or may be a subset of the spatial validity condition eg a list of TAs based on the latest known UE location When the SMF detects that UE entered the area of interest subscribed by the PCF the SMF notifies the PCF and the PCF provides to the SMF the PCC rules described above by triggering a PDU Session Modification When the SMF becomes aware that the UE left the area subscribed by the PCF the SMF notifies the PCF and the PCF provides updated PCC rules by triggering a PDU Session Modification SMF notifications to the PCF about UE location in or out of the subscribed area of interest are triggered by UE location change notifications received from the AMF or by UE location information received during a Service Request or Handover procedure When the PCC rules are activated the SMF may based on local policies take the information in the PCC rules and optionally the Service Experience analytics andor DN Performance analytics per UP path including UPF andor DNAI andor AS instance as defined in clause 643 and clause 6143 respectively of TS 23288 86 into account to - reselect UP paths including DNAIs for PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_432",
    "document_id": "23501-i80",
    "chunk_id": 432,
    "text": "The SMF is responsible for handling the mapping between the UE location TAI Cell-Id and DNAIs associated with UPF and applications and the selection of the UPFs that serve a PDU Session This is described in clause 633 If the PDU Session is of IP type and if Indication of UE IP address preservation is included in the PCC rules the SMF should preserve the UE IP address by not reselecting the related PSA UPF once the PSA UPF is selected for the traffic identified in the PCC rule If the user plane latency requirement is included in the PCC rules the SMF chooses the PSA UPF that satisfies the user plane latency requirement If the PCC rules are related to a 5G VN group served by the SMF and if the PCC rule includes an indication of traffic correlation the SMF should select a common DNAI for the PDU Sessions of the 5G VN group see clause 529 - configure traffic steering at UPF including activating mechanisms for traffic multi-homing or enforcement of an UL Classifier UL CL",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_433",
    "document_id": "23501-i80",
    "chunk_id": 433,
    "text": "Such mechanisms are defined in clause 564 This may include that the SMF is providing the UPF with packet handling instructions ie PDRs and FARs for steering traffic to the local access to the DN The packet handling instructions are generated by the SMF using the traffic steering policy ID andor the N6 traffic routing information in the PCC rules corresponding to the applied DNAI In the case of UP path reselection the SMF may configure the source UPF to forward traffic to the UL CLBP so that the traffic is steered towards the target UPF - if Information on AF subscription to corresponding SMF events has been provided in the PCC rule inform the AF of the reselection of the UP path UP path change If the information includes an indication of AF acknowledgment to be expected the SMF may decide to wait for a response from the AF before it activates the new UP path as described in clause 5672 When an I-SMF is inserted for a PDU Session the I-SMF insertion relocation or removal to a PDU session shall be transparent ie not aware to the PCF and to the AF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_434",
    "document_id": "23501-i80",
    "chunk_id": 434,
    "text": "The processing of the AF influence on traffic routing is described in clause 534 and detailed procedure is described in clause 4236 of TS 23502 3 5672 Enhancement of UP path management based on the coordination with AFs In order to avoid or minimize service interruption during PSA relocation for a PDU session of SSC mode 3 or a PDU session with UL CL or branch point according to the indication of AF acknowledgment to be expected on AF subscription to corresponding SMF events DNAI change that may be provided in PCC rules received from the PCF as defined in clause 5671 except in HR-SBO case or that may be provided directly by V-NEF to V-SMF as defined in TS 23548 130 clause 672 in case of HR-SBO or according to local configuration eg DN-related policies the SMF may wait for a response from the AF after sending a notification an early notification or a late notification to the AF In the case of late notification based on the indication of AF acknowledgment to be expected on AF subscription the SMF may send the notification before activating the UP path towards a new DNAI possibly through a new PSA NOTE 1 Before the UP path toward the new DNAI is activated application traffic data if any exists is still routed toward the old DNAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_435",
    "document_id": "23501-i80",
    "chunk_id": 435,
    "text": "The notification sent from the SMF to the AF indicates UP path management events DNAI change as described in clause 5671 The AF can confirm the DNAI change indicated in the notification with the SMF by sending a positive response to the notification to the SMF or reject the DNAI change by sending a negative response NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_436",
    "document_id": "23501-i80",
    "chunk_id": 436,
    "text": "The AF can determine whether application relocation is needed according to the notification of DNAI change If not the AF can send a positive response to the SMF immediately otherwise the AF sends the positive response after application relocation is completed or a negative response if the AF determines that the application relocation cannot be completed on time eg due to temporary congestion The AF decision and behaviours on application relocation are not defined However the new DNAI may be associated with a new AF In such cases the SMF and the old AF cancel earlier subscribed UP path management event notifications and the new AF subscribes to receive UP path management event notifications from the SMF The AF can include N6 traffic routing information related to the target DNAI in a positive response sent to the SMF The SMF configures the N6 traffic routing information from the AF response to the PSA on the UP path The AF can include the EAS relocation Indication to indicate the applications to be relocated In the case of early notification based on the indication of AF acknowledgment to be expected on AF subscription the SMF does not configure the UP path towards the new DNAI until it receives a positive AF response as specified in clause 4363 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_437",
    "document_id": "23501-i80",
    "chunk_id": 437,
    "text": "In the case of late notification based on the indication of AF acknowledgment to be expected on AF subscription the SMF does not activate the UP path towards the new DNAI until it receives a positive AF response as specified in clause 435 of TS 23502 3 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_438",
    "document_id": "23501-i80",
    "chunk_id": 438,
    "text": "After the UP path toward the new DNAI is activated data is routed toward the new DNAI If the SMF receives a negative response at any time the SMF keeps using the original DNAI and may cancel related PSA relocation or addition The SMF may perform DNAI reselection afterwards if needed The SMF can assume according to local policy a negative response if a response is expected and but not received from the AF within a certain time window When EarlyLate Notification happens the SMF notifies AF about the target DNAI and may indicate capability of supporting EAS IP replacement in 5GCWhen EAS relocation is performed the AF sends ana earlylate notification response to the SMF after the EAS relocation is completed which may include the Information for EAS IP Replacement in 5GC The SMF may instruct the local PSA to use the FAR that contains Information elements of IP Address and Port Number Replacement as described in clause 633 of TS 23548 130 If local PSA relocation is required the SMF may request the target local PSA to buffer uplink traffic as described in clause 635 of TS 23548 130 AF relocation may be triggered by SMF eg in relationship with DNAI change due to UE mobility",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_439",
    "document_id": "23501-i80",
    "chunk_id": 439,
    "text": "In the case of AF relocation involving different DNAIs it is possible that the source EHE is unaware of othertarget EHE specific deployment details In such cases when SMF selects a target DNAI eg based on current UE location the SMF may determine based on the EDI that the target DNAI is not supported by the source AF The SMF determines the target AF ID based on the target DNAI and the EDI Accordingly as part of EarlyLate Notification the SMF provides the target AF ID to the source AF as described in clause 4363 of TS 23502 3 568 Selective activation and deactivation of UP connection of existing PDU Session This clause applies to the case when a UE has established multiple PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_440",
    "document_id": "23501-i80",
    "chunk_id": 440,
    "text": "The activation of a UP connection of an existing PDU Session causes the activation of its UE-CN User Plane connection ie data radio bearer and N3 tunnel For the activation of a UP connection the service area restrictions as specified in clause 53411 apply For the UE in the CM-IDLE state in 3GPP access either UE or Network-Triggered Service Request procedure may support independent activation of UP connection of existing PDU Session For the UE in the CM-IDLE state in non-3GPP access UE-Triggered Service Request procedure allows the re-activation of UP connection of existing PDU Sessions and may support independent activation of UP connection of existing PDU Session A UE in the CM-CONNECTED state invokes a Service Request see clause 4232 of TS 23502 3 procedure to request the independent activation of the UP connection of existing PDU Sessions Network Triggered re-activation of UP connection of existing PDU Sessions is handled as follows - If the UE CM state in the AMF is already CM-CONNECTED on the access 3GPP non-3GPP associated to the PDU Session in the SMF the network may re-activate the UP connection of a PDU Session using a Network Initiated Service Request procedure Otherwise - If the UE is registered in both 3GPP and non-3GPP accesses and the UE CM state in the AMF is CM-IDLE in non-3GPP access the UE can be paged or notified through the 3GPP access for a PDU Session associated in the SMF ie last routed to the non-3GPP access - If the UE CM state in the AMF is CM-IDLE in 3GPP access the paging message may include the access type associated with the PDU Session in the SMF The UE upon reception of the paging message containing an access type shall reply to the 5GC via the 3GPP access using the NAS Service Request message which shall contain the list of PDU Sessions associated with the received access type and whose UP connections can be re-activated over 3GPP ie the list does not contain the PDU Sessions whose UP connections cannot be re-activated on 3GPP based on UE policies and whether the S-NSSAIs of these PDU Sessions are within the Allowed NSSAI for 3GPP access If the PDU Session for which the UE has been paged is in the list of the PDU Sessions provided in the NAS Service Request and the paging was triggered by pending DL data the 5GC shall re-activate the PDU Session UP connection over 3GPP access If the paging was triggered by pending DL signalling the Service Request succeeds without re-activating the PDU session UP connection over the 3GPP access and the pending DL signalling is delivered to the UE over the 3GPP access - If the UE CM state in the AMF is CM-CONNECTED in 3GPP access the notification message shall include the non-3GPP Access Type The UE upon reception of the notification message shall reply to the 5GC via the 3GPP access using the NAS Service Request message which shall contain the List of Allowed PDU Sessions that can be re-activated over 3GPP or an empty List of Allowed PDU Sessions if no PDU Sessions are allowed to be re-activated over 3GPP access NOTE A UE that is in a coverage of a non-3GPP access and has PDU Sessions that are associated in the UE ie last routed to non-3GPP access is assumed to attempt to connect to it without the need to be paged - If the UE is registered in both 3GPP and non-3GPP accesses served by the same AMF and the UE CM state in the AMF is CM-IDLE in 3GPP access and is in CM-CONNECTED in non 3GPP access the UE can be notified through the non-3GPP for a PDU Session associated in the SMF ie last routed to the 3GPP access The notification message shall include the 3GPP Access Type Upon reception of the notification message when 3GPP access is available the UE shall reply to the 5GC via the 3GPP access using the NAS Service Request message In addition to the above a PDU Session may be established as an always-on PDU Session as described in clause 5613 The deactivation of the UP connection of an existing PDU Session causes the corresponding data radio bearer and N3 tunnel to be deactivated The UP connection of different PDU Sessions can be deactivated independently when a UE is in CM-CONNECTED state in 3GPP access or non-3GPP access At the deactivation of the UP of a PDU Session using a N9 tunnel whose end-point is controlled by an I-SMF the N9 tunnel is preserved If a PDU Session is an always-on PDU Session the SMF should not deactivate a UP connection of this PDU Session due to inactivity 569 Session and Service Continuity 5691 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_441",
    "document_id": "23501-i80",
    "chunk_id": 441,
    "text": "The support for session and service continuity in 5G System architecture enables to address the various continuity requirements of different applicationsservices for the UE The 5G System supports different session and service continuity SSC modes defined in this clause The SSC mode associated with a PDU Session does not change during the lifetime of a PDU Session The following three modes are specified with further details provided in the next clause - With SSC mode 1 the network preserves the connectivity service provided to the UE For the case of PDU Session of IPv4 or IPv6 or IPv4v6 type the IP address is preserved - With SSC mode 2 the network may release the connectivity service delivered to the UE and release the corresponding PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_442",
    "document_id": "23501-i80",
    "chunk_id": 442,
    "text": "For the case of IPv4 or IPv6 or IPv4v6 type the release of the PDU Session induces the release of IP addresses that had been allocated to the UE - With SSC mode 3 changes to the user plane can be visible to the UE while the network ensures that the UE suffers no loss of connectivity A connection through new PDU Session Anchor point is established before the previous connection is terminated in order to allow for better service continuity For the case of IPv4 or IPv6 or IPv4v6 type the IP address is not preserved in this mode when the PDU Session Anchor changes NOTE In this Release of the specification the additionremoval procedure of additional PDU Session Anchor in a PDU Session for local access to a DN is independent from the SSC mode of the PDU Session 5692 SSC mode 56921 SSC Mode 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_443",
    "document_id": "23501-i80",
    "chunk_id": 443,
    "text": "For a PDU Session of SSC mode 1 the UPF acting as PDU Session Anchor at the establishment of the PDU Session is maintained regardless of the access technology eg Access Type and cells a UE is successively using to access the network In the case of a PDU Session of IPv4 or IPv6 or IPv4v6 type IP continuity is supported regardless of UE mobility events In this Release of the specification when IPv6 multihoming or UL CL applies to a PDU Session of in SSC mode 1 and the network allocates based on local policies additional PDU Session Anchors to such a PDU Session these additional PDU Session Anchors may be released or allocated and the UE does not expect that the additional IPv6 prefix is maintained during the lifetime of PDU Session SSC mode 1 may apply to any PDU Session type and to any access type A UE supporting PDU Connectivity shall support SSC mode 1 56922 SSC Mode 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_444",
    "document_id": "23501-i80",
    "chunk_id": 444,
    "text": "If a PDU Session of SSC mode 2 has a single PDU Session Anchor the network may trigger the release of the PDU Session and instruct the UE to establish a new PDU Session to the same data network immediately The trigger condition depends on operator policy eg request from Application Function based on load status etc At establishment of the new PDU Session a new UPF acting as PDU Session Anchor can be selected Otherwise if a PDU Session of SSC mode 2 has multiple PDU Session Anchors ie in the case of multi-homed PDU Sessions or in the case that UL CL applies to a PDU Session of SSC mode 2 the additional PDU Session Anchors may be released or allocated SSC mode 2 may apply to any PDU Session type and to any access type SSC mode 2 is optional to be supported in the UE NOTE 1 Features depending on SSC mode 2 will not work with the lack of support for SSC mode 2 in the UE NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_445",
    "document_id": "23501-i80",
    "chunk_id": 445,
    "text": "In UL CL mode the UE is not involved in PDU Session Anchor re-allocation so that the existence of multiple PDU Session Anchors is not visible to the UE 56923 SSC Mode 3 For PDU Session of SSC mode 3 the network allows the establishment of UE connectivity via a new PDU Session Anchor to the same data network before connectivity between the UE and the previous PDU Session Anchor is released When trigger conditions apply the network decides whether to select a PDU Session Anchor UPF suitable for the UEs new conditions eg point of attachment to the network In this Release of specification SSC mode 3 only applies to IP PDU Session type and to any access type In the case of a PDU Session of IPv4 or IPv6 or IPv4v6 type during the procedure of change of PDU Session Anchor the following applies a For a PDU Session of IPv6 type the new IP prefix anchored on the new PDU Session Anchor may be allocated within the same PDU Session relying on IPv6 multi-homing specified in clause 5643 or b The new IP address andor IP prefix may be allocated within a new PDU Session that the UE is triggered to establish After the new IP addressprefix has been allocated the old IP addressprefix is maintained during some time indicated to the UE via NAS signalling as described in clause 4352 of TS 23502 3 or via Router Advertisement as described in clause 4353 of TS 23502 3 and then released If a PDU Session of SSC mode 3 has multiple PDU Session Anchors ie in the case of multi-homed PDU Sessions or in the case that UL CL applies to a PDU Session of SSC mode 3 the additional PDU Session Anchors may be released or allocated SSC mode 3 is optional to be supported in the UE NOTE Features depending on SSC mode 3 will not work with the lack of support for SSC mode 3 in the UE 5693 SSC mode selection SSC mode selection is done by the SMF based on the allowed SSC modes -including the default SSC mode in the user subscription as well as the PDU Session type and",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_446",
    "document_id": "23501-i80",
    "chunk_id": 446,
    "text": "if present the SSC mode requested by the UE The operator may provision a SSC mode selection policy SSCMSP to the UE as part of the URSP rule -see clause 662 of TS 23503 45 The UE shall use the SSCMSP to determine the type of session and service continuity mode associated with an application or group of applications for the UE as described in clause 6623 of TS 23503 45 If the UE does not have SSCMSP the UE can select a SSC mode based on UE Local Configuration as described in TS 23503 45 if applicable If the UE cannot select a SSC mode the UE requests the PDU Session without providing the SSC mode NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_447",
    "document_id": "23501-i80",
    "chunk_id": 447,
    "text": "The UE can use the SSC Mode Selection component of the URSP rule with match-all traffic descriptor if there is no SSC mode in the UE local configuration The SSC mode selection policy rules provided to the UE can be updated by the operator by updating the URSP rule The SMF receives from the UDM the list of allowed SSC modes and the default SSC mode per DNN per S-NSSAI as part of the subscription information If a UE provides an SSC mode when requesting a new PDU Session the SMF selects the SSC mode by either accepting the requested SSC mode or rejecting the PDU Session Establishment Request message with the cause value and the SSC modes allowed to be used back to UE based on the PDU Session type subscription andor local configuration Based on that cause value and the SSC modes allowed to be used the UE may re-attempt to request the establishment of that PDU Session with the SSC mode allowed to be used or using another URSP rule If a UE does not provide an SSC mode when requesting a new PDU Session then the SMF selects the default SSC mode for the data network listed in the subscription or applies local configuration to select the SSC mode SSC mode 1 shall be assigned to the PDU Session when static IP addressprefix is allocated to the PDU Session based on the static IP addressprefix subscription for the DNN and S-NSSAI The SMF shall inform the UE of the selected SSC mode for a PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_448",
    "document_id": "23501-i80",
    "chunk_id": 448,
    "text": "The UE shall not request and the network shall not assign SSC mode 3 for the PDU Session of Unstructured type or Ethernet type NOTE 2 To avoid issues for UEs not supporting all SSC modes the operator can in the subscription data and local configuration include at least SSC mode 1 in the allowed SSC modes and set default SSC mode to 1 since all UEs supporting PDU sessions are mandated to support SSC mode 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_449",
    "document_id": "23501-i80",
    "chunk_id": 449,
    "text": "Still the 5GC can trigger PDU session release with a cause code indicating reactivation due to eg restoration or user plane path optimization purposes though this may cause interruption of the service 5610 Specific aspects of different PDU Session types 56101 Support of IP PDU Session type The IP address allocation is defined in clause 581 The UE may acquire following configuration information from the SMF during the lifetime of a PDU Session - Addresses of P-CSCFs - Addresses of DNS servers - If the UE indicates support of DNS with security as defined in TS 33501 29 to the network in PCO and the network wants to enforce the use of DNS with security the configuration information sent by the SMF via PCO may also include the corresponding DNS server security information as specified in TS 24501 47 and TS 33501 29 - the GPSI of the UE The UE may acquire from the SMF at PDU Session Establishment the MTU that the UE shall consider see clause 56104",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_450",
    "document_id": "23501-i80",
    "chunk_id": 450,
    "text": "The UE may provide following information to the SMF during the lifetime of a PDU Session - an indication of the support of P-CSCF re-selection based on procedures specified in TS 24229 62 clauses B221C and L221C - PS data off status of the UE NOTE 2 An operator can deploy NAT functionality in the network the support of NAT is not specified in this release of the specification though UPF can expose mapping between public and private IP addresses 56102 Support of Ethernet PDU Session type For a PDU Session set up with the Ethernet PDU Session type the SMF and the UPF acting as PDU Session Anchor PSA can support specific behaviours related with the fact the PDU Session carries Ethernet frames Depending on operator configuration related with the DNN different configurations for how Ethernet traffic is handled on N6 may apply for example - Configurations with a 1-1 relationship between a PDU Session and a N6 interface possibly corresponding to a dedicated tunnel established over N6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_451",
    "document_id": "23501-i80",
    "chunk_id": 451,
    "text": "In this case the UPF acting as PSA transparently forwards Ethernet frames between the PDU Session and its corresponding N6 interface and it does not need to be aware of MAC addresses used by the UE in order to route down-link traffic - Configurations where more than one PDU Session to the same DNN eg for more than one UE corresponds to the same N6 interface In this case the UPF acting as PSA needs to be aware of MAC addresses used by the UE in the PDU Session in order to map down-link Ethernet frames received over N6 to the appropriate PDU Session Forwarding behaviour of the UPF acting as PSA is managed by SMF as specified in clause 5825 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_452",
    "document_id": "23501-i80",
    "chunk_id": 452,
    "text": "The MAC addresses used by the UE correspond to any MAC address used by the UE or any device locally connected to the UE and using the PDU Session to communicate with the DN Based on operator configuration the SMF may request the UPF acting as the PDU Session Anchor to respond to ARPIPv6 Neighbour Solicitation requests based on local cache information ie the mapping between the UE MAC address to the UE IP address and the DN where the PDU Session is connected to or to redirect the ARP traffic from the UPF to the SMF Responding to ARPIPv6 ND based on local cache information applies to ARPIPv6 ND received in both UL and DL directions NOTE 2 Responding to ARPND from a local cache assumes the UE or the devices behind the UE acquire their IP address via in-band mechanisms that the SMFUPF can detect and by this link the IP address to the MAC address NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_453",
    "document_id": "23501-i80",
    "chunk_id": 453,
    "text": "This mechanism is intended to avoid broadcasting or multicasting the ARPIPv6 ND to every UE Ethernet Preamble and Start of Frame delimiter are not sent over 5GS - For UL traffic the UE strips the preamble and frame check sequence FCS from the Ethernet frame - For DL traffic the PDU Session Anchor strips the preamble and frame check sequence FCS from the Ethernet frame Neither a MAC nor an IP address is allocated by the 5GC to the UE for a PDU Session The PSA shall store the MAC addresses received from the UE and associate those with the appropriate PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_454",
    "document_id": "23501-i80",
    "chunk_id": 454,
    "text": "The SMF may receive a list of allowed VLAN tags from DN-AAA for a maximum of 16 VLAN tags or may be locally configured with allowed VLAN tags values The SMF may also be configured with instructions on VLAN handling eg the VLAN tag to be inserted or removed S-TAG to be inserted or removed Taking this into account the SMF determines the VLAN handling for the PDU Session and instructs the UPF to accept or discard the UE traffic based on the allowed VLAN tags as well as to handle VLAN tags additionremoval via PDR Outer header removal and FAR UPF applying Outer header creation of a Forwarding policy For example - The UPF may insert for uplink traffic and remove for downlink traffic a S-TAG on N6 or N19 or internal interface 5G VN internal for the traffic from and to the UE - The UPF may insert for uplink traffic and remove for downlink traffic a VLAN tag on the N6 interface while there is no VLAN in the traffic to and from the UE - The UPF may discard any UE traffic that does not contain any allowed VLAN tag when the UPF handles the UE uplink or downlink traffic NOTE 4 This can be used for traffic steering to N6-LAN but also for N6-based traffic forwarding related with 5G-VN service described in clause 5294 Apart from specific conditions related to the support of PDU sessions over W-5GAN defined in TS 23316 84 the UPF shall not remove VLAN tags sent by the UE and the UPF shall not insert VLAN tags for the traffic sent to the UE PDUs containing a VLAN tag shall be switched only within the same VLAN by a PDU Session Anchor The UE may acquire from the SMF at PDU Session Establishment the MTU of the Ethernet frames payload that the UE shall consider see clause 56104 NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_455",
    "document_id": "23501-i80",
    "chunk_id": 455,
    "text": "The UE may operate in bridge mode with regard to a LAN it is connecting to the 5GS thus different MAC addresses may be used as source address of different frames sent UL over a single PDU Session and destination MAC address of different frames sent DL over the same PDU Session NOTE 6 Entities on the LAN connected to the 5GS by the UE may have an IP address allocated by the DN but the IP layer is considered as an application layer which is not part of the Ethernet PDU Session NOTE 7 In this Release of the specification only the UE connected to the 5GS is authenticated not the devices behind such UE NOTE 8 5GS does not support the scenario where a MAC address or if VLAN applies a MAC address VLAN combination is used on more than one PDU Session for the same DNN and S-NSSAI NOTE 9 This Release of the specification does not guarantee that the Ethernet network remains loop-free Deployments need to be verified on an individual basis that loops in the Ethernet network are avoided NOTE 10",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_456",
    "document_id": "23501-i80",
    "chunk_id": 456,
    "text": "This Release of the specification does not guarantee that the Ethernet network properly and quickly reacts to topology changes Deployments need to be verified on an individual basis how they react to topology changes Different Frames exchanged on a PDU Session of Ethernet type may be served with different QoS over the 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_457",
    "document_id": "23501-i80",
    "chunk_id": 457,
    "text": "Thus the SMF may provide to the UPF Ethernet Packet Filter Set and forwarding rules based on the Ethernet frame structure and UE MAC addresses The UPF detects and forwards Ethernet frames based on the Ethernet Packet Filter Set and forwarding rules received from the SMF This is further defined in clauses 57 and 582 When a PDU Session of Ethernet PDU type is authorized by a DN as described in clause 566 the DN-AAA server may as part of authorization data provide the SMF with a list of allowed MAC addresses for this PDU Session the list is limited to a maximum of 16 MAC addresses When the list has been provided for a PDU Session the SMF sets corresponding filtering rules in the UPFs acting as PDU Session Anchor for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_458",
    "document_id": "23501-i80",
    "chunk_id": 458,
    "text": "The UPF discards any UL traffic that does not contain one of these MAC addresses as a source address if the list of allowed MAC addresses is provided In this Release of specification the PDU Session of Ethernet PDU Session type is restricted to SSC mode 1 and SSC mode 2 For a PDU Session established with the Ethernet PDU Session type the SMF may upon PCF request need to ensure reporting to the PCF of all Ethernet MAC addresses used as UE address in a PDU Session In this case as defined in clause 58212 the SMF controls the UPF to report the different MAC addresses used as source address of frames sent UL by the UE in the PDU Session NOTE 11 This relates to whether AF control on a per MAC address is allowed on the PDU Session as defined in clause 6112 of TS 23503 45 The PCF may activate or deactivate the reporting of the UE MAC address using the UE MAC address change Policy Control Request Trigger as defined in Table 6135-1 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_459",
    "document_id": "23501-i80",
    "chunk_id": 459,
    "text": "The SMF may relocate the UPF acting as the PDU Session Anchor for an Ethernet PDU Session as defined in clause 4358 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_460",
    "document_id": "23501-i80",
    "chunk_id": 460,
    "text": "The relocation may be triggered by a mobility event such as a handover or may be triggered independent of UE mobility eg due to load balancing reasons In order to relocate the PSA UPF the reporting of the UE MAC addresses needs to be activated by the SMF 56103 Support of Unstructured PDU Session type Different Point-to-Point PtP tunnelling techniques may be used to deliver Unstructured PDU Session type data to the destination eg application server in the Data Network via N6 Point-to-point tunnelling based on UDPIP encapsulation as described below may be used Other techniques may be supported Regardless of addressing scheme used from the UPF to the DN the UPF shall be able to map the address used between the UPF and the DN to the PDU Session When Point-to-Point tunnelling based on UDPIPv6 is used the following considerations apply - IPv6 prefix allocation for PDU Sessions are performed locally by the H-SMF without involving the UE - The UPFs acts as a transparent forwarding node for the payload between the UE and the destination in the DN - For uplink the UPF forwards the received Unstructured PDU Session type data to the destination in the data network over the N6 PtP tunnel using UDPIPv6 encapsulation -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_461",
    "document_id": "23501-i80",
    "chunk_id": 461,
    "text": "For downlink the destination in the data network sends the Unstructured PDU Session type data using UDPIPv6 encapsulation with the IPv6 address of the PDU Session and the 3GPP defined UDP port for Unstructured PDU Session type data The UPF acting as PDU Session Anchor decapsulates the received data ie removes the UDPIPv6 headers and forwards the data identified by the IPv6 prefix of the PDU Session for delivery to the UE - The H-SMF performs the IPv6 related operations but the IPv6 prefix is not provided to the UE ie Router Advertisements and DHCPv6 are not performed The SMF assigns an IPv6 Interface Identifier for the PDU Session The allocated IPv6 prefix identifies the PDU Session of the UE -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_462",
    "document_id": "23501-i80",
    "chunk_id": 462,
    "text": "For AF influence on traffic routing described in clause 567 when the N6 PtP tunnelling is used over the DNAI and the AF provides by value information about N6 traffic routing requirements in the AF request the AF provides N6 PtP tunnelling requirements IPv6 address and UDP port of the tunnel end in the DN as the N6 traffic routing information associated to the DNAI when the SMF notifies the AF of UP path management events it includes the N6 PtP tunnel information related to the UP the IPv6 address and the 3GPP defined UDP port of the tunnel end at the UPF as N6 traffic routing information in the notification In this Release of the specification there is support for maximum one 5G QoS Flow per PDU Session of Type Unstructured In this Release of specification the PDU Session of Unstructured PDU Session type is restricted to SSC mode 1 and SSC mode 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_463",
    "document_id": "23501-i80",
    "chunk_id": 463,
    "text": "The UE may acquire from the SMF at PDU Session Establishment the MTU that the UE shall consider see clause 56104 56104 Maximum Transfer Unit size considerations In order to avoid data packet fragmentation between the UE and the UPF acting as PSA the link MTU size in the UE should be set to the value provided by the network as part of the IP configuration The link MTU size for IPv4 is sent to the UE by including it in the PCO see TS 24501 47 The link MTU size for IPv6 is sent to the UE by including it in the IPv6 Router Advertisement message see RFC 4861 54 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_464",
    "document_id": "23501-i80",
    "chunk_id": 464,
    "text": "Ideally the network configuration ensures that for PDU Session type IPv4v6 the link MTU values provided to the UE via PCO and in the IPv6 Router Advertisement message are the same In cases where this condition cannot be met the MTU size selected by the UE is unspecified When using a PDU Session type Unstructured the maximum uplink packet size and when using Ethernet the Ethernet frames payload that the UE should use may be provided by the network as a part of the session management configuration by encoding it within the PCO see TS 24501 47 When using a PDU Session type Unstructured to provide a consistent environment for application developers the network shall use a maximum packet size of at least 128 octets this applies to both uplink and downlink When the MT and the TE are separated the TE may either be pre-configured to use a specific default MTU size or the TE may use an MTU size provided by the network via the MT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_465",
    "document_id": "23501-i80",
    "chunk_id": 465,
    "text": "Thus it is not always possible to set the MTU value by means of information provided by the network NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_466",
    "document_id": "23501-i80",
    "chunk_id": 466,
    "text": "In network deployments that have MTU size of 1500 octets in the transport network providing a link MTU value of 1358 octets as shown in Figure J-1 to the UE as part of the IP configuration information from the network will prevent the IP layer fragmentation within the transport network between the UE and the UPF For network deployments that uniformly support transport with larger MTU size than 1500 octets for example with ethernet jumbo frames of MTU size up to 9216 octets providing a link MTU value of MTU minus 142 octets to the UE as part of the IP configuration information from the network will prevent the IP layer fragmentation within the transport network between the UE and the UPF Link MTU considerations are discussed further in Annex J NOTE 3 As the link MTU value is provided as a part of the session management configuration information a link MTU value can be provided during each PDU Session establishment In this release dynamic adjustment of link MTU for scenarios where MTU is not uniform across transport are not addressed 5611 UE presence in Area of Interest reporting usage by SMF When a PDU Session is established or modified or when the user plane path has been changed eg UPF re-allocationadditionremoval SMF may determine an Area of Interest eg based on UPF Service Area subscription by PCF for reporting UE presence in Presence Reporting Area etc For 3GPP access the Area of Interest corresponds - either to Presence Information that may correspond to - a list of Tracking Areas or - a list of Presence Reporting Area IDs and optionally the elements comprising TAs andor NG-RAN nodes andor cells identifiers corresponding to the PRA IDs or - a LADN DNN or - a LADN DNN and a S-NSSAI or - a S-NSSAI For Non-3GPP access the Area of Interest corresponds to - N3GPP TAI see clause 5323 For UE location change into or out of an area of interest the SMF subscribes to UE mobility event notification service provided by AMF for reporting of UE presence in Area of Interest as described in clause 5344",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_467",
    "document_id": "23501-i80",
    "chunk_id": 467,
    "text": "The AMF may send the UE location to the SMF along with the notification eg for UPF selection Upon reception of a notification from AMF the SMF determines how to deal with the PDU Session eg reallocate UPF In the case of LADN the SMF provides the LADN DNN to the AMF to subscribe to UE mobility event notification for reporting UE presence in LADN service area Upon reception of a notification from the AMF the SMF determines how to deal with the PDU Session as described in clause 565",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_468",
    "document_id": "23501-i80",
    "chunk_id": 468,
    "text": "In the case of Partial Network Slice Support and Support for Network Slices with Network Slice Area of Service not matching deployed Tracking Areas as described in clauses 51517 and 51518 the SMF provides the S-NSSAI to the AMF to UE mobility event notification for reporting UE presence in slice restriction area Upon reception of a notification from the AMF the SMF determines how to deal with the PDU Session as described in clauses 51517 and 51518 For use cases related to policy control and charging decisions the PCF may subscribe to event reporting from the SMF or the AMF for UE presence in a Presence Reporting Area A Presence Reporting Area can be - A UE-dedicated Presence Reporting Area defined in the subscriber profile and composed of a short list of TAs andor NG-RAN nodes andor cells identifiers in a PLMN or derived from the Area of Interest provided by the Application Function to the PCF see clause 567 and composed of a short list of TAs andor NG-RAN nodes andor cells identifiers in a PLMN or - A Core Network predefined Presence Reporting Area predefined in the AMF and composed of a short list of TAs andor NG-RAN nodes andor cells identifiers in a PLMN In the case of Change of UE Presence in Presence Reporting Area for core network predefined Presence Reporting Area the AMF determines the area of interest corresponding to the Presence Reporting Area Identifiers provided by the PCF or the SMF as a list of TAIs andor cell identifiers andor NG-RAN node identifiers based on local configuration For UE-dedicated Presence Reporting Areas the subscription for UE location change notification for an area of interest shall contain the PRA Identifiers and the lists of TAs or NG-RAN Node identifier andor cell identifiers composing the Presence Reporting Areas For Core Network predefined Presence Reporting Areas the subscription for UE location change notification for an area of interest shall contain the PRA identifiers NOTE 1 If the Presence Reporting Area PRA and RAN Notification Area RNA are partially overlapping the PCF will not get notified for the change of PRA when UE enters or leaves the PRA but remains in the RNA in CM-CONNECTED with RRC_INACTIVE state because AMF is not informed Each Core Network predefined Presence Reporting Area can be configured with a priority level in the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_469",
    "document_id": "23501-i80",
    "chunk_id": 469,
    "text": "In order to prevent overload the AMF may set the reporting for one or more of the received Presence Reporting Areas to inactive under consideration of the priority configured for each of Core Network predefined Presence Reporting Areas while storing the reporting request for this Presence Reporting Area in the UE context NOTE 2 Change of UE presence in Presence Reporting Area reporting does not apply to home routed roaming The AMF may be configured with a PRA identifier which refers to a Set of Core Network predefined Presence Reporting Areas",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_470",
    "document_id": "23501-i80",
    "chunk_id": 470,
    "text": "If the PCF subscribes to change of UE location for an area of interest for a Set of Presence reporting areas and provides a PRA identifier then the SMF may subscribe for event reporting for this Set of Presence Reporting Areas by only indicating this PRA Identifier in the area of interest When the Presence Reporting Areas to be reported belong to a set of Core Network predefined Presence Reporting Areas in which the AMF is requested to report on change of UE presence the AMF shall additionally add to the report the PRA Identifier of the Set of Core Network predefined Presence Reporting Areas Upon change of AMF the PRA identifiers and if provided the lists of Presence Reporting Area elements are transferred for all PDU sessions as part of MM Context information to the target AMF during the mobility procedure If one or more Presence Reporting Areas was set to inactive the target AMF may decide to reactivate one or more of the inactive Presence Reporting Areas",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_471",
    "document_id": "23501-i80",
    "chunk_id": 471,
    "text": "The target AMF indicates per PDU session to the corresponding SMFPCF the PRA identifiers and whether the UE is inside or outside the Presence Reporting Areas as well as the inactive Presence Reporting Areas if any NOTE 3 The target AMF cannot set the Presence Reporting Areas received from the source serving node to inactive The subscription may be maintained during the life of PDU Session regardless of the UP activation state of PDU Session ie whether UP connection of the PDU Session is activated or not SMF may determine a new area of interest and send a new subscription to the AMF with the new area of interest SMF un-subscribes to UE mobility event notification service when PDU Session is released 5612 Use of Network Instance The SMF may provide a Network Instance to the UPF in FAR andor PDR via N4 Session Establishment or N4 Modification procedures NOTE 1 a Network Instance can be defined eg to separate IP domains eg when a UPF is connected to 5G-ANs in different IP domains overlapping UE IP addresses assigned by multiple Data Networks transport network isolation in the same PLMN etc NOTE 2 As the SMF can provide over N2 the Network Instance it has selected for the N3 CN Tunnel Info the 5G AN does not need to provide Network Instance to the 5GC The SMF determines the Network Instance based on local configuration The SMF may determine the Network Instance for N3 and N9 interfaces taking into account eg UE location registered PLMN ID of UE S-NSSAI of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_472",
    "document_id": "23501-i80",
    "chunk_id": 472,
    "text": "The SMF may determine the Network Instance for N6 interface taking into account eg DNN S-NSSAI of the PDU Session The SMF may determine the Network Instance for N19 interface taking into account eg the DNN S-NSSAI identifying a 5G VN group NOTE 3 As an example the UPF can use the Network Instance included in the FAR together with other information such as Outer header creation IP address part and Destination interface in the FAR to determine the interface in UPF eg VPN or Layer 2 technology for forwarding of the traffic 5613 Always-on PDU session An always-on PDU Session is a PDU Session for which User Plane resources have to be activated during every transition from CM-IDLE mode to CM-CONNECTED state Based on an indication from upper layers a UE may request to establish a PDU Session as an always-on PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_473",
    "document_id": "23501-i80",
    "chunk_id": 473,
    "text": "The SMF decides whether the PDU Session can be established as an always-on PDU Session In Home Routed roaming case based on local policies the V-SMF shall be involved to determine whether the PDU Session can be established as an always-on PDU Session If the UE requests the 5GC to modify a PDU Session which was established in EPS to an always-on PDU Session after the first inter-system change from EPS to 5GS the SMF decides whether the PDU Session can be established as an always-on PDU Session based on the procedure described above The UE shall request activation of User Plane resources for always-on PDU Sessions even if there are no pending uplink data for this PDU Session or when the Service Request is triggered for signalling only or when the Service Request is triggered for paging response only If the UE has one or more established PDU Sessions which are not accepted by the network as always-on PDU Sessions and the UE has no uplink user data pending to be sent for those PDU Sessions the UE shall not request for activating User Plane resources for those PDU sessions 5614 Support of Framed Routing Framed Routing is only defined for PDU Sessions of the IP type IPv4 IPv6 IPv4v6 and allows to support an IP network behind a UE such that a range of IPv4 addresses or IPv6 prefixes is reachable over a single PDU Session eg for enterprise connectivity Framed Routes are IP routes behind the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_474",
    "document_id": "23501-i80",
    "chunk_id": 474,
    "text": "A PDU Session may be associated with multiple Framed Routes Each Framed Route refers to a range of IPv4 addresses ie an IPv4 address and an IPv4 address mask or a range of IPv6 Prefixes ie an IPv6 Prefix and an IPv6 Prefix length The set of one or more Framed Routes associated to a PDU Session is contained in the Framed Route information The network does not send Framed Route information to the UE devices in the networks behind the UE get their IP address by mechanisms out of the scope of 3GPP specifications See RFC 2865 73 RFC 3162 74 Framed Route information is provided by the SMF to the UPF acting as PSA as part of Packet Detection Rule PDR see clause 5853 related with the network side N6 of the UPF NOTE SMF can take the UPF capabilities into account when selecting PSA UPF to ensure that the SMF chooses PSA UPFs that support Framed Routing for PDU Sessions to DNN andor slices deemed to support Framed Routing eg DNN andor slices intended to support RG or if Framed Route information has been received as part of Session Management Subscription data The Framed Route information may be provided to the SMF by - the DN-AAA server as part of PDU Session Establishment authenticationauthorization by a DN-AAA server as defined in clause 566 or by - Session Management Subscription data associated with DNN and S-NSSAI sent by UDM as defined in clause 52331 of TS 23502 3 If the SMF receives Framed Route information both from DN-AAA and from UDM the information received from DN-AAA takes precedence and supersedes the information received from UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_475",
    "document_id": "23501-i80",
    "chunk_id": 475,
    "text": "The IPv4 address IPv6 Prefix allocated to the UE as part of the PDU Session establishment eg delivered in NAS PDU Session Establishment Accept may belong to one of the Framed Routes associated with the PDU Session or may be dynamically allocated outside of such Framed Routes If PCC applies to the PDU Session at PDU Session establishment the SMF reports to the PCF the Framed Route information corresponding to the PDU Session as described in clause 6135 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_476",
    "document_id": "23501-i80",
    "chunk_id": 476,
    "text": "In this case in order to support session binding the PCF may further report to the BSF the Framed Route information corresponding to the PDU Session as described in clause 6122 of TS 23503 45 If the UDM or DN-AAA updates the Framed Route information during the lifetime of the PDU Session the SMF releases the PDU Session and may include in the release request an indication for the UE to re-establish the PDU Session 5615 Triggers for network analytics Triggers for the SMF to request for or subscribe to the analytics information from the NWDAF are internal logic may include for example - UE PDU Session related event subscription by other NFs eg AMF NEF - UE access and mobility event reports from the AMF - locally detected events - analytics information received The trigger conditions may depend on operator and implementation policy in the SMF When a trigger condition happens the SMF may decide if any analytics information is needed and if so request for or subscription to the analytics information from the NWDAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_477",
    "document_id": "23501-i80",
    "chunk_id": 477,
    "text": "The SMF may upon detection of certain local events eg number of PDU sessions establishment or released reaches a threshold in a specific area request for or subscribe to network analytics related to Abnormal behaviour as described in TS 23288 86 to detect whether there are any exceptional UE behaviours in this area 5616 Support for Service Function Chaining 56161 General Service Function Chaining also called N6-LAN Traffic Steering refers to the steering of subscribers traffic flows to appropriate operator or 3rd party Service Functions eg NAT antimalware parental control DDoS protection in the N6-LAN The content of this clause applies to non-roaming and to Home Routed roaming scenario ie to cases where the involved entities AF PCF SMF UPF belong to the Home PLMN and the AF has an agreement with the Home PLMN The PCF controls Service Function Chaining by provisioning and modifying traffic steering control information for N6-LAN Traffic Steering as described in TS 23503 45 eg clause 61314",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_478",
    "document_id": "23501-i80",
    "chunk_id": 478,
    "text": "The traffic steering control information for N6-LAN Traffic Steering consists of a traffic description and a reference to a traffic steering policy that is configured in the SMFUPF The PCF derives the TSP IDs that can be different for uplink and downlink directions based on operator configuration and sends the TSP IDs to the SMF as part of the N6-LAN Traffic Steering Enforcement Control information in the PCC rule as described in clause 631 of TS 23503 45 When the PCC rule is activated or updated with N6-LAN Traffic Steering Enforcement Control information the SMF sets the Forwarding Policy uplink andor downlink within the FARs based on the authorized TSP IDs in the PCC rule and under consideration of the direction",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_479",
    "document_id": "23501-i80",
    "chunk_id": 479,
    "text": "In case that Application Function influence on traffic routing Enforcement Control information and N6-LAN Traffic Steering Enforcement Control information are both provided for the uplink direction the SMF shall derive N4 rules which instruct the UPF to pass the traffic through the relevant Service Functions deployed in the N6-LAN before steering the traffic to the local data network The SMF provides instructions to UPF for N6-LAN traffic steering as further detailed in clause 5856 The UPF applies traffic steering mechanism based on Forwarding Policy ie the UPF performs deployment specific actions as configured for the Forwarding Policy NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_480",
    "document_id": "23501-i80",
    "chunk_id": 480,
    "text": "It is assumed that all UPFs in the operator network serving as PSA for the DNNS-NSSAIDNAI subject to N6-LAN traffic steering need to be configured with the same traffic steering information for N6-LAN traffic steering When performing deployment specific actions configured for the Forwarding Policy the UPF may support traffic steering related functionality and user plane encapsulation protocols that are out of 3GPP scope eg as defined by other standards organizations NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_481",
    "document_id": "23501-i80",
    "chunk_id": 481,
    "text": "The existing user plane mechanisms eg VXLAN NSH GENEVE GRE VLAN etc defined at IETF are reused as applicable by the PSA UPF to support N6-LAN traffic steering The mechanism used for forwarding the traffic between the Service Functions within the N6-LAN is out of 3GPP scope 56162 Application Function influence on Service Function Chaining An AF may request the steering of user plane traffic to a pre-configured chain of Service Functions on N6-LAN In the non-roaming scenario Application Function influence on Service Function Chaining and Application Function influence on traffic routing as defined in clause 567 can be applicable to the same traffic simultaneously It is assumed that a service level agreement exists between the operator and a third party that includes a list of authorized predefined Service Function Chains SFCs each SFC being identified based on a Service Function Chaining identifier SFC ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_482",
    "document_id": "23501-i80",
    "chunk_id": 482,
    "text": "The AF may request the selected traffic flows to be steered towards a specific SFC either at PDU Session establishment or any time after PDU Session establishment The AF requests may be sent to the PCF via the NEF When SFC ID is included in the AF request the parameters listed in Table 56162-1 may be included in the AF request Table 56162-1 Information element contained in AF request The PCF checks whether the SFC ID received from the AF corresponds to an authorized predefined SFC according to the service level agreement with this AF Based on the SFC ID received from the AF the PCF derives the TSP IDs that can be different for uplink and downlink directions and sends the TSP IDs and optionally Metadata as provided by the AF to the SMF as part of the PCC rules as described in clause 631 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_483",
    "document_id": "23501-i80",
    "chunk_id": 483,
    "text": "The SMF behaves in the same way it is described in clause 56161 If the SMF has received Metadata in the N6-LAN Traffic Steering Enforcement Control information of the PCC rule the SMF forwards the Metadata to the UPF via N4 in the corresponding FAR as described in clause 5856 57 QoS model 571 General Overview 5711 QoS Flow The 5G QoS model is based on QoS Flows The 5G QoS model supports both QoS Flows that require guaranteed flow bit rate GBR QoS Flows and QoS Flows that do not require guaranteed flow bit rate Non-GBR QoS Flows The 5G QoS model also supports Reflective QoS see clause 575 The QoS Flow is the finest granularity of QoS differentiation in the PDU Session A QoS Flow ID QFI is used to identify a QoS Flow in the 5G System User Plane traffic with the same QFI within a PDU Session receives the same traffic forwarding treatment eg scheduling admission threshold",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_484",
    "document_id": "23501-i80",
    "chunk_id": 484,
    "text": "The QFI is carried in an encapsulation header on N3 and N9 ie without any changes to the e2e packet header QFI shall be used for all PDU Session Types The QFI shall be unique within a PDU Session The QFI may be dynamically assigned or may be equal to the 5QI see clause 5721 Within the 5GS a QoS Flow is controlled by the SMF and may be preconfigured or established via the PDU Session Establishment procedure see clause 432 of TS 23502 3 or the PDU Session Modification procedure see clause 433 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_485",
    "document_id": "23501-i80",
    "chunk_id": 485,
    "text": "Any QoS Flow is characterised by - A QoS profile provided by the SMF to the AN via the AMF over the N2 reference point or preconfigured in the AN - One or more QoS rules and optionally QoS Flow level QoS parameters as specified in TS 24501 47 associated with these QoS rules which can be provided by the SMF to the UE via the AMF over the N1 reference point andor derived by the UE by applying Reflective QoS control and - One or more UL and DL PDRs provided by the SMF to the UPF Within the 5GS a QoS Flow associated with the default QoS rule is required to be established for a PDU Session and remains established throughout the lifetime of the PDU Session This QoS Flow should be a Non-GBR QoS Flow further details are described in clause 5727 A QoS Flow is associated with QoS requirements as specified by QoS parameters and QoS characteristics NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_486",
    "document_id": "23501-i80",
    "chunk_id": 486,
    "text": "The QoS Flow associated with the default QoS rule provides the UE with connectivity throughout the lifetime of the PDU Session Possible interworking with EPS motivates the recommendation for this QoS Flow to be of type Non-GBR A QoS Flow may be enabled with PDU Set based QoS handling as described in clause 5375 For such QoS Flows PDU Set QoS Parameters see clause 577 are determined by the PCF and provided by SMF to the NG-RAN as part of the QoS profile 5712 QoS Profile A QoS Flow may either be GBR or Non-GBR depending on its QoS profile The QoS profile of a QoS Flow is sent to the RAN and it contains QoS parameters as described below details of QoS parameters are described in clause 572 - For each QoS Flow the QoS profile shall include the QoS parameters - 5G QoS Identifier 5QI and - Allocation and Retention Priority ARP - For each QoS Flow the QoS profile may also include the QoS parameters - PDU Set QoS Parameters described in clause 577 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_487",
    "document_id": "23501-i80",
    "chunk_id": 487,
    "text": "For each Non-GBR QoS Flow only the QoS profile may also include the QoS parameter - Reflective QoS Attribute RQA - For each GBR QoS Flow only the QoS profile shall also include the QoS parameters - Guaranteed Flow Bit Rate GFBR - UL and DL and - Maximum Flow Bit Rate MFBR - UL and DL and - In the case of a GBR QoS Flow only the QoS profile may also include one or more of the QoS parameters - Notification control - Maximum Packet Loss Rate - UL and DL NOTE In this Release of the specification the Maximum Packet Loss Rate UL DL is only provided for a GBR QoS Flow belonging to voice media",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_488",
    "document_id": "23501-i80",
    "chunk_id": 488,
    "text": "Each QoS profile has one corresponding QoS Flow identifier QFI which is not included in the QoS profile itself The usage of a dynamically assigned 5QI for a QoS Flow requires in addition the signalling of the complete 5G QoS characteristics described in clause 573 as part of the QoS profile When a standardized or pre-configured 5QI is used for a QoS Flow some of the 5G QoS characteristics may be signalled as part of the QoS profile as described in clause 573 5712a Alternative QoS Profile The Alternative QoS Profiles can be optionally provided for a GBR QoS Flow with Notification control enabled If the corresponding PCC rule contains the related information as described in TS 23503 45 the SMF shall provide in addition to the QoS profile a prioritized list of Alternative QoS Profiles to the NG-RAN If the SMF provides a new prioritized list of Alternative QoS Profiles to the NG-RAN if the corresponding PCC rule information changes the NG-RAN shall replace any previously stored list with it An Alternative QoS Profile represents a combination of QoS parameters PDB PER Averaging Window and GFBR to which the application traffic is able to adapt NOTE 1 There is no requirement that the GFBR monotonically decreases nor that the PDB or PER monotonically increase as the Alternative QoS Profiles become less preferred For a GBR QoS Flow using the Delay-critical resource type an Alternative QoS Profile may also include the QoS parameter MDBV For the NG-RAN determination whether the GFBR the PDB and the PER can be fulfilled ie for all Notification control scenarios described in clause 5724 the NG-RAN shall also apply the value of the optional QoS parameter present in an Alternative QoS Profile instead of the corresponding QoS parameters value in the QoS Profile which is either provided explicitly or implicitly via the standardized 5QI QoS characteristics defined in clause 574 for every optional QoS parameter present in an Alternative QoS Profile eg MDBV NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_489",
    "document_id": "23501-i80",
    "chunk_id": 489,
    "text": "For the NG-RAN behaviour related to the mandatory QoS parameters in the Alternative QoS Profile ie GFBR PDB PER see clause 5724 When the NG-RAN sends a notification to the SMF that the QoS profile is not fulfilled the NG-RAN shall if the currently fulfilled values match an Alternative QoS Profile include also the reference to the Alternative QoS Profile to indicate the QoS that the NG-RAN currently fulfils see clause 5724 The NG-RAN shall enable the SMF to determine when an NG-RAN node supports the Alternative QoS Profile feature but cannot fulfil even the least preferred Alternative QoS Profile NOTE 3 To reduce the risk that GBR QoS Flows are released in case of RAN resource limitations and then experience difficulties in being re-established Application Functions can set the least preferred Alternative Service Requirement to an undemanding level 5713 Control of QoS Flows",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_490",
    "document_id": "23501-i80",
    "chunk_id": 490,
    "text": "The following options are supported to control QoS Flows 1 For Non-GBR QoS Flows and when standardized 5QIs or pre-configured 5QIs are used and when the 5QI is within the range of the QFI ie a value less than 64 the 5QI value may be used as the QFI of the QoS Flow a A default ARP shall be pre-configured in the AN or b The ARP and the QFI shall be sent to RAN over N2 at PDU Session Establishment or at PDU Session Modification and when NG-RAN is used every time the User Plane of the PDU Session is activated and 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_491",
    "document_id": "23501-i80",
    "chunk_id": 491,
    "text": "For all other cases including GBR and Non-GBR QoS Flows a dynamically assigned QFI shall be used The 5QI value may be a standardized pre-configured or dynamically assigned The QoS profile and the QFI of a QoS Flow shall be provided to the RAN over N2 at PDU Session EstablishmentModification and when NG-RAN is used every time the User Plane of the PDU Session is activated Only options 1b and 2 may apply to 3GPP ANs Options 1a 1b and 2 may apply to Non-3GPP access NOTE Pre-configured 5QI values can be used when the UE is roaming if allowed by SLA between the operators 5714 QoS Rules The UE performs the classification and marking of UL User plane traffic ie the association of UL traffic to QoS Flows based on QoS rules These QoS rules may be explicitly provided to the UE ie explicitly signalled QoS rules using the PDU Session EstablishmentModification procedure pre-configured in the UE or implicitly derived by the UE by applying Reflective QoS see clause 575 A QoS rule contains the QFI of the associated QoS Flow a Packet Filter Set see clause 576 and a precedence value see clause 5719",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_492",
    "document_id": "23501-i80",
    "chunk_id": 492,
    "text": "An explicitly signalled QoS rule contains a QoS rule identifier which is unique within the PDU Session and is generated by SMF There can be more than one QoS rule associated with the same QoS Flow ie with the same QFI When the UE informs the network about the number of supported Packet Filters for signalled QoS rules for the PDU Session during the PDU Session Establishment procedure or using the PDU Session Modification procedure as described in clause 517222 after the first inter-system change from EPS to 5GS for a PDU Session established in EPS and transferred from EPS with N26 interface the SMF shall ensure that the sum of the Packet Filters used by all signalled QoS rules for a PDU Session does not exceed the number indicated by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_493",
    "document_id": "23501-i80",
    "chunk_id": 493,
    "text": "A default QoS rule is required to be sent to the UE for every PDU Session establishment and it is associated with a QoS Flow For IP type PDU Session or Ethernet type PDU Session the default QoS rule is the only QoS rule of a PDU Session which may contain a Packet Filter Set that allows all UL packets and in this case the highest precedence value shall be used for the QoS rule NOTE 2 How the UE evaluates UL packets against the Packet Filter Set in a QoS rule is described in clause 5715 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_494",
    "document_id": "23501-i80",
    "chunk_id": 494,
    "text": "The QoS rule pre-configured in the UE is only used together with option 1a for control QoS Flows as described in clause 5713 How to keep the consistency of QFI and Packet Filter Set between UE and network is out of scope in this release of the specification For Unstructured type PDU Session the default QoS rule does not contain a Packet Filter Set and in this case the default QoS rule defines the treatment of all packets in the PDU Session As long as the default QoS rule does not contain a Packet Filter Set or contains a Packet Filter Set that allows all UL packets Reflective QoS should not be applied for the QoS Flow which the default QoS rule is associated with and the RQA should not be sent for this QoS Flow 5715 QoS Flow mapping The SMF performs the binding of PCC rules to QoS Flows based on the QoS and service requirements as defined in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_495",
    "document_id": "23501-i80",
    "chunk_id": 495,
    "text": "The SMF assigns the QFI for a new QoS Flow and derives its QoS profile corresponding UPF instructions and QoS Rules from the PCC rules bound to the QoS Flow and other information provided by the PCF When applicable the SMF provides the following information for the QoS Flow to the RAN - QFI - QoS profile as described in clause 5712 - optionally Alternative QoS Profiles as described in clause 5712a For each PCC rule bound to a QoS Flow the SMF provides the following information to the UPF enabling classification bandwidth enforcement and marking of User Plane traffic the details are described in clause 58 - a DL PDR containing the DL part of the SDF template - an UL PDR containing the UL part of the SDF template NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_496",
    "document_id": "23501-i80",
    "chunk_id": 496,
    "text": "If a DL PDR for an bidirectional SDF is associated with a QoS Flow other than the one associated with the default QoS rule and the UE has not received any instruction to use this QoS Flow for the SDF in uplink direction ie neither a corresponding QoS rule is sent to the UE nor the Reflective QoS Indication is set in the PCC rule it means that the UL PDR for the same SDF has to be associated with the QoS Flow associated with the default QoS rule - the PDR precedence value see clause 5719 for both PDRs is set to the precedence value of the PCC rule - QoS related information eg MBR for an SDF GFBR and MFBR for a GBR QoS Flow as described in clause 582 - the corresponding packet marking information eg the QFI the transport level packet marking value eg the DSCP value of the outer IP header - optionally the Reflective QoS Indication is included in the QER associated with the DL PDR as described in clause 5753",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_497",
    "document_id": "23501-i80",
    "chunk_id": 497,
    "text": "For each PCC rule bound to a QoS Flow when applicable the SMF generates an explicitly signalled QoS rule see clause 5714 according to the following principles and provides it to the UE together with an add operation - A unique for the PDU Session QoS rule identifier is assigned - The QFI in the QoS rule is set to the QFI of the QoS Flow to which the PCC rule is bound - The Packet Filter Set of the QoS rule is generated from the UL SDF filters and optionally the DL SDF filters of the PCC rule but only from those SDF filters that have an indication for being signalled to the UE as defined in TS 23503 45 - The QoS rule precedence value is set to the precedence value of the PCC rule for which the QoS rule is generated - for a dynamically assigned QFI the QoS Flow level QoS parameters eg 5QI GFBR MFBR Averaging Window see TS 24501 47 are signalled to UE in addition to the QoS rules associated to the QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_498",
    "document_id": "23501-i80",
    "chunk_id": 498,
    "text": "The QoS Flow level QoS parameters of an existing QoS Flow may be updated based on the MBR and GBR information received in the PCC rule MBR and GBR per SDF are however not provided to UE over N1 in the case of more than one SDF or if the PCF has not indicated differently when Notification control or handover related signalling indicates that the QoS parameter the NG-RAN is currently fulfilling for the QoS Flow have changed see clause 5724 Changes in the binding of PCC rules to QoS Flows as well as changes in the PCC rules or other information provided by the PCF can require QoS Flow changes which the SMF has to provide to RAN UPF andor UE In the case of changes in the explicitly signalled QoS rules associated to a QoS Flow the SMF provides the explicitly signalled QoS rules and their operation ie addmodifydelete to the UE NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_499",
    "document_id": "23501-i80",
    "chunk_id": 499,
    "text": "The SMF cannot provide update or remove pre-configured QoS rules or UE derived QoS rules The principle for classification and marking of User Plane traffic and mapping of QoS Flows to AN resources is illustrated in Figure 5715-1 Figure 5715-1 The principle for classification and User Plane marking for QoS Flows and mapping to AN Resources In DL incoming data packets are classified by the UPF based on the Packet Filter Sets of the DL PDRs in the order of their precedence without initiating additional N4 signalling The UPF conveys the classification of the User Plane traffic belonging to a QoS Flow through an N3 and N9 User Plane marking using a QFI The AN binds QoS Flows to AN resources ie Data Radio Bearers of in the case of 3GPP RAN There is no strict 11 relation between QoS Flows and AN resources It is up to the AN to establish the necessary AN resources that QoS Flows can be mapped to and to release them The AN shall indicate to the SMF when the AN resources onto which a QoS Flow is mapped are released If no matching DL PDR is found the UPF shall discard the DL data packet In UL -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_500",
    "document_id": "23501-i80",
    "chunk_id": 500,
    "text": "For a PDU Session of Type IP or Ethernet the UE evaluates UL packets against the UL Packet Filters in the Packet Filter Set in the QoS rules based on the precedence value of QoS rules in increasing order until a matching QoS rule ie whose Packet Filter matches the UL packet is found - If no matching QoS rule is found the UE shall discard the UL data packet - For a PDU Session of Type Unstructured the default QoS rule does not contain a Packet Filter Set and allows all UL packets NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_501",
    "document_id": "23501-i80",
    "chunk_id": 501,
    "text": "Only the default QoS rule exist for a PDU Session of Type Unstructured The UE uses the QFI in the corresponding matching QoS rule to bind the UL packet to a QoS Flow The UE then binds QoS Flows to AN resources 5716 DL traffic The following characteristics apply for processing of DL traffic - UPF maps User Plane traffic to QoS Flows based on the PDRs - UPF performs Session-AMBR enforcement as specified in clause 5718 and performs counting of packets for charging - UPF transmits the PDUs of the PDU Session in a single tunnel between 5GC and RAN the UPF includes the QFI in the encapsulation header",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_502",
    "document_id": "23501-i80",
    "chunk_id": 502,
    "text": "In addition UPF may include an indication for Reflective QoS activation in the encapsulation header - UPF performs transport level packet marking in DL on a per QoS Flow basis The UPF uses the transport level packet marking value provided by the SMF as described in clause 5827 - RAN maps PDUs from QoS Flows to access-specific resources based on the QFI and the associated 5G QoS profile also taking into account the N3 tunnel associated with the DL packet NOTE Packet Filters are not used for the mapping of QoS Flows onto access-specific resources in RAN - If Reflective QoS applies the UE creates a new derived QoS rule as defined in clause 5752 5717 UL Traffic Following characteristics apply for processing of UL traffic - UE uses the stored QoS rules to determine mapping between UL User Plane traffic and QoS Flows UE marks the UL PDU with the QFI of the QoS rule containing the matching Packet Filter and transmits the UL PDUs using the corresponding access specific resource for the QoS Flow based on the mapping provided by RAN For NG-RAN the UL behaviour is specified in clause 1052 of TS 38300 27 - RAN transmits the PDUs over N3 tunnel towards UPF When passing an UL packet from RAN to CN the RAN includes the QFI value in the encapsulation header of the UL PDU and selects the N3 tunnel - RAN performs transport level packet marking in the UL on a per QoS Flow basis with a transport level packet marking value that is determined based on the 5QI the Priority Level if explicitly signalled and the ARP priority level of the associated QoS Flow - UPF verifies whether QFIs in the UL PDUs are aligned with the QoS Rules provided to the UE or implicitly derived by the UE in the case of Reflective QoS - UPF and UE perform Session-AMBR enforcement as specified in clause 5718 and the UPF performs counting of packets for charging 5718 AMBRMFBR enforcement and rate limitation UL and DL Session-AMBR see clause 5726 shall be enforced by the UPF if the UPF receives the Session-AMBR values from the SMF as described in clause 5827 and clause 5854 For UL Classifier PDU Sessions UL and DL Session-AMBR see clause 5726 shall be enforced in the SMF selected UPF that supports the UL Classifier functionality",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_503",
    "document_id": "23501-i80",
    "chunk_id": 503,
    "text": "In addition the DL Session-AMBR shall be enforced separately in every UPF that terminates the N6 interface ie without requiring interaction between the UPFs see clause 564",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_504",
    "document_id": "23501-i80",
    "chunk_id": 504,
    "text": "For multi-homed PDU Sessions UL and DL Session-AMBR shall be enforced in the UPF that supports the Branching Point functionality In addition the DL Session-AMBR shall be enforced separately in every UPF that terminates the N6 interface ie without requiring interaction between the UPFs see clause 564 NOTE The DL Session-AMBR is enforced in every UPF terminating the N6 interface to reduce unnecessary transport of traffic which may be discarded by the UPF performing the UL ClassifierBranching Point functionality due to the amount of the DL traffic for the PDU Session exceeding the DL Session-AMBR Discarding DL packets in the UL ClassifierBranching Point could cause erroneous PDU counting for support of charging For HR-SBO PDU Sessions if the DL Session AMBR for Offloading is provided as described see clause 67 of TS 23548 130 the DL Session AMBR for Offloading is enforced by UPF that supports the UL ClassifierBranching Point functionality in the VPLMN and additionally separately in every PSA UPF that terminates the N6 interface toward the local part of DN in the VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_505",
    "document_id": "23501-i80",
    "chunk_id": 505,
    "text": "The RAN shall enforce UE-AMBR see clause 5726 in UL and DL per UE for Non-GBR QoS Flows The UE shall perform UL rate limitation on PDU Session basis for Non-GBR traffic using Session-AMBR if the UE receives a Session-AMBR MBR per SDF is mandatory for GBR QoS Flows but optional for Non-GBR QoS Flows The MBR is enforced in the UPF The MFBR is enforced in the UPF in the Downlink for GBR QoS Flows The MFBR is enforced in the RAN in the Downlink and Uplink for GBR QoS Flows For non-3GPP access the UE should enforce MFBR in the Uplink for GBR QoS Flows The QoS control for Unstructured PDUs is performed at the PDU Session level and in this Release of the specification there is only support for maximum of one 5G QoS Flow per PDU Session of Type Unstructured When a PDU Session is set up for transferring unstructured PDUs SMF provides the QFI which will be applied to any packet of the PDU Session to the UPF and UE 5719",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_506",
    "document_id": "23501-i80",
    "chunk_id": 506,
    "text": "Precedence Value The QoS rule precedence value and the PDR precedence value determine the order in which a QoS rule or a PDR respectively shall be evaluated The evaluation of the QoS rules or PDRs is performed in increasing order of their precedence value 57110 UE-Slice-MBR enforcement and rate limitation If a supporting NG-RAN receives for a UE a UE-Slice-MBR see clause 5726 for an S-NSSAI from the AMF the NG-RAN shall apply this UE-Slice-MBR for all PDU Sessions of that UE corresponding to the S-NSSAI which have an active user plane if feasible In particular the NG-RAN shall enforce this UE-Slice-MBR as follows 1 Whenever a request for a GBR QoS Flow establishment or modification is received the NG-RAN admission control shall ensure that the sum of the GFBR values of the admitted GBR QoS Flows is not exceeding the UE-Slice-MBR and if the QoS Flow cannot be admitted the NG-RAN shall reject the establishmentmodification of the QoS Flow NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_507",
    "document_id": "23501-i80",
    "chunk_id": 507,
    "text": "If the UE-Slice-MBR would be exceeded by a newmodified GBR QoS Flow the NG-RAN determines whether the newmodified GBR QoS Flow can pre-empt any existing GBR QoS Flow of the UEs PDU Sessions corresponding to the same S-NSSAI based on their ARP values as per clause 5722 eg to support certain priority services eg MPS If this is not possible the NG-RAN can reject the establishmentmodification of the QoS Flow 2 The NG-RAN shall ensure that the aggregated bitrate across all GBR and Non-GBR QoS Flows belonging to those PDU Sessions is not exceeding the UE-Slice-MBR while always guaranteeing the GFBR of every GBR QoS Flow of those PDU Sessions as described in clause 5725 57111 QoS aspects of home-routed roaming In the case of home-routed roaming the V-SMF may apply VPLMN policies related with the SLA negotiated with the HPLMN or with QoS values supported by the VPLMN Such policies may result in a situation that the V-SMF does not accept the PDU Session or does not accept some of the QoS Flows requested by the H-SMF QoS constraints represent the QoS that the VPLMN can accept for the QoS Flow associated with the default QoS rule and the PDU Session based on SLA or based on QoS values supported by the VPLMN The QoS constraints may contain 5QI 5QI Priority Level and ARP for the QoS Flow associated with the default QoS rule and highest Session-AMBR accepted by the VPLMN NOTE 1 For this Release of the specification QoS constraints apply only to the non-GBR default QoS Flow NOTE 2 Additionally at inter-PLMN scenarios the VPLMN policies can result in re-mapping of QoS values of non-default QoS Flows eg in case the V-SMF receives an operator-specific 5QI value whetherhow the remapping is done is implementation specific according to the local policy and according to an inter-PLMN agreement between the involved operators NOTE 3 If remapping at inter-PLMN mobility between HPLMN and VPLMN is to be performed the V-SMF chooses a 5QI value based on inter-PLMN agreement between the VPLMN and the HPLMN and updates the QoS Flows accordingly The remapping can result in service degradation At inter-PLMN mobility between two VPLMNs the source V-SMF provides the 5QI values used in the source VPLMN to the target VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_508",
    "document_id": "23501-i80",
    "chunk_id": 508,
    "text": "If the source VPLMN provides a 5QI value which is not part of the inter-PLMN agreement between the target VPLMN and the HPLMN the target VPLMN can choose a 5QI value based on local policy and updates the QoS Flows accordingly using the procedure in clause 4333 of TS 23502 3 NOTE 4 If remapping at session management procedure in roaming case is to be performed the V-SMF chooses a 5QI value based on inter-PLMN agreement between the VPLMN and the HPLMN and updates the QoS Flows accordingly The remapping can result in service degradation At PDU Session Establishment for home-routed roaming to reduce the risk of PDU Session establishment failure due to QoS from the HPLMN not being compliant with SLA the V-SMF may provide the VPLMN local policy in QoS constraints to the H-SMF as specified in clause 43222 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_509",
    "document_id": "23501-i80",
    "chunk_id": 509,
    "text": "For intra-5GS mobility with V-SMF insertion or V-SMF change eg inter-PLMN mobility as specified in clause 423 of TS 23502 3 the newtarget V-SMF may validate the currently applied QoS against the QoS constraints The newtarget V-SMF provides QoS constraints to the H-SMF during the mobility procedure The newtarget V-SMF may temporarily accept a higher QoS even if the currently applied QoS exceeds the QoS constraints Alternatively for the QoS parameters related with the QoS constraints the V-SMF may locally downgrade these values before providing the corresponding QoS profiles to 5G AN The V-SMF may decide to release the PDU Session if the HPLMN does not provide updated QoS compliant with the QoS constraints after the mobility procedure For IMS voice service eg the IMS DNN defined by the GSMA the V-SMF based on local policy may override the ARP received from HPLMN over N16 if the ARP indicates priority not in line with the local policy in VPLMN The ARP override in the serving PLMN applies to both the QoS Flow associated with the default QoS rule and the QoS Flows for IMS voice to apply the same allocation and retention priority for all users ie roamers and non-roamers For MPS clause 5165 the same allocation and retention priority is applied to all MPS service users ie roamers and non-roamers when roaming agreements are in place and where regulatory requirements apply 572 5G QoS Parameters 5721 5QI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_510",
    "document_id": "23501-i80",
    "chunk_id": 510,
    "text": "A 5QI is a scalar that is used as a reference to 5G QoS characteristics defined in clause 574 ie access node-specific parameters that control QoS forwarding treatment for the QoS Flow eg scheduling weights admission thresholds queue management thresholds link layer protocol configuration etc Standardized 5QI values have one-to-one mapping to a standardized combination of 5G QoS characteristics as specified in Table 574-1 The 5G QoS characteristics for pre-configured 5QI values are pre-configured in the AN Standardized or pre-configured 5G QoS characteristics are indicated through the 5QI value and are not signalled on any interface unless certain 5G QoS characteristics are modified as specified in clauses 5733 5734 5736 and 5737 The 5G QoS characteristics for QoS Flows with dynamically assigned 5QI are signalled as part of the QoS profile NOTE On N3 each PDU ie in the tunnel used for the PDU Session is associated with one 5QI via the QFI carried in the encapsulation header 5722 ARP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_511",
    "document_id": "23501-i80",
    "chunk_id": 511,
    "text": "The QoS parameter ARP contains information about the priority level the pre-emption capability and the pre-emption vulnerability This allows deciding whether a QoS Flow establishmentmodificationhandover may be accepted or needs to be rejected in the case of resource limitations typically used for admission control of GBR traffic It may also be used to decide which existing QoS Flow to pre-empt during resource limitations ie which QoS Flow to release to free up resources The ARP priority level defines the relative importance of a QoS Flow The range of the ARP priority level is 1 to 15 with 1 as the highest priority The ARP priority levels 1-8 should only be assigned to QoS Flows for services that are authorized to receive prioritized treatment within an operator domain ie that are authorized by the serving network The ARP priority levels 9-15 may be assigned to QoS Flows for services that are authorized by the home network and thus applicable when a UE is roaming NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_512",
    "document_id": "23501-i80",
    "chunk_id": 512,
    "text": "This ensures that future releases may use ARP priority level 1-8 to indicate eg emergency and other priority services within an operator domain in a backward compatible manner This does not prevent the use of ARP priority level 1-8 in roaming situation in the case that appropriate roaming agreements exist that ensure a compatible use of these priority levels The ARP pre-emption capability defines whether a QoS Flow may get resources that were already assigned to another QoS Flow with a lower priority The ARP pre-emption vulnerability defines whether a QoS Flow may lose the resources assigned to it in order to admit a QoS Flow with higher priority The ARP pre-emption capability and the ARP pre-emption vulnerability shall be either set to enabled or disabled The ARP pre-emption vulnerability of the QoS Flow which the default QoS rule is associated with should be set appropriately to minimize the risk of a release of this QoS Flow The details of how the SMF sets the ARP for a QoS Flow are further described in clause 5727 5723 RQA The Reflective QoS Attribute RQA is an optional parameter which indicates that certain traffic not necessarily all carried on this QoS Flow is subject to Reflective QoS Only when the RQA is signalled for a QoS Flow the RAN enables the transfer of the RQI for AN resource corresponding to this QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_513",
    "document_id": "23501-i80",
    "chunk_id": 513,
    "text": "The RQA may be signalled to NG-RAN via the N2 reference point at UE context establishment in NG-RAN and at QoS Flow establishment or modification 5724 Notification control 57241 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_514",
    "document_id": "23501-i80",
    "chunk_id": 514,
    "text": "The QoS Parameter Notification control indicates to the NG-RAN that notifications of GFBR can no longer or can again be guaranteed are requested when the NG-RAN determines that the GFBR the PDB or the PER of the QoS profile cannot be fulfilled or can be fulfilled again for a QoS Flow during the lifetime of the QoS Flow and that the QoS Flow should be kept while the NG-RAN is not fulfilling the requested QoS profile Notification control may be used for a GBR QoS Flow if the application traffic is able to adapt to the change in the QoS eg if the AF is capable to trigger rate adaptation The NG-RAN determination whether the GFBR the PDB and the PER can be fulfilled or not is done under consideration of the QoS parameters Averaging Window and MDBV for a GBR QoS Flow using the Delay-critical resource type which are either provided explicitly as part of the QoS profile or implicitly via the standardized 5QI QoS characteristics defined in clause 574",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_515",
    "document_id": "23501-i80",
    "chunk_id": 515,
    "text": "The SMF shall only enable Notification control when the QoS Notification Control parameter is set in the PCC rule received from the PCF that is bound to the QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_516",
    "document_id": "23501-i80",
    "chunk_id": 516,
    "text": "The Notification control parameter is signalled to the NG-RAN as part of the QoS profile 57241a Notification Control without Alternative QoS Profiles If for a given GBR QoS Flow Notification control is enabled and the NG-RAN determines that the GFBR the PDB or the PER of the QoS profile cannot be fulfilled NG-RAN shall send a notification towards SMF that the GFBR can no longer be guaranteed Furthermore the NG-RAN shall keep the QoS Flow ie while the NG-RAN is not fulfilling the requested QoS profile for this QoS Flow unless specific conditions at the NG-RAN require the release of the NG-RAN resources for this GBR QoS Flow eg due to Radio link failure or RAN internal congestion The NG-RAN should try to fulfil the GFBR the PDB and the PER of the QoS profile again NOTE 1 NG-RAN can decide that the GFBR can no longer be guaranteed based on eg measurements like queuing delay or system load Upon receiving a notification from the NG-RAN that the GFBR can no longer be guaranteed the SMF may forward the notification to the PCF see TS 23503 45 When the NG-RAN determines that the GFBR the PDB and the PER of the QoS profile can be fulfilled again for a QoS Flow for which a notification that the GFBR can no longer be guaranteed has been sent the NG-RAN shall send a notification informing the SMF that the GFBR can again be guaranteed and the SMF may forward the notification to the PCF see TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_517",
    "document_id": "23501-i80",
    "chunk_id": 517,
    "text": "The NG-RAN shall send a subsequent notification that the GFBR can no longer be guaranteed whenever necessary NOTE 2 It is assumed that NG-RAN implementation will apply some hysteresis before determining that the GFBR can again be guaranteed and therefore a frequent signalling of GFBR can again be guaranteed followed by GFBR can no longer be guaranteed is not expected NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_518",
    "document_id": "23501-i80",
    "chunk_id": 518,
    "text": "If the QoS Flow is modified the NG-RAN restarts the check whether the GFBR can no longer be guaranteed according to the updated QoS profile If the Notification control parameter is not included in the updated QoS profile the Notification control is disabled During a handover the Source NG-RAN does not inform the Target NG-RAN about whether the Source NG-RAN has sent a notification for a QoS Flow that the GFBR can no longer be guaranteed The Target NG-RAN performs admission control rejecting any QoS Flows for which resources cannot be permanently allocated The accepted QoS Flows are included in the N2 Path Switch Request or N2 Handover Request Acknowledge message from the NG-RAN to the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_519",
    "document_id": "23501-i80",
    "chunk_id": 519,
    "text": "The SMF shall interpret the fact that a QoS Flow is listed as transferred QoS Flow in the Nsmf_PDUSession_UpdateSMContext Request received from the AMF as a notification that GFBR can again be guaranteed for this QoS Flow unless the SMF is also receiving a reference to an Alternative QoS Profile for this QoS Flow which is described in clause 57242 After the handover is successfully completed the Target NG-RAN shall send a subsequent notification that the GFBR can no longer be guaranteed for such a QoS Flow whenever necessary If the SMF has previously notified the PCF that the GFBR can no longer be guaranteed and the SMF does not receive an explicit notification that the GFBR can no longer be guaranteed for that QoS Flow from the Target NG-RAN within a configured time the SMF shall notify the PCF that the GFBR can again be guaranteed 57241b Notification control with Alternative QoS Profiles If for a given GBR QoS Flow Notification control is enabled and the NG-RAN has received a list of Alternative QoS Profiles for this QoS Flow and supports the Alternative QoS Profile handling the following shall apply 1 If the NG-RAN determines that the GFBR the PDB or the PER of the QoS profile cannot be fulfilled NG-RAN shall send a notification towards SMF that the GFBR can no longer be guaranteed Before sending a notification that the GFBR can no longer be guaranteed towards the SMF the NG-RAN shall check whether the GFBR the PDB and the PER that the NG-RAN currently fulfils match any of the Alternative QoS Profiles in the indicated priority order If there is a match the NG-RAN shall indicate the reference to the matching Alternative QoS Profile with the highest priority together with the notification to the SMF If there is no match the NG-RAN shall send a notification that the GFBR can no longer be guaranteed towards the SMF indicating that the lowest Alternative QoS Profile cannot be fulfilled unless specific conditions at the NG-RAN require the release of the NG-RAN resources for this GBR QoS Flow eg due to Radio link failure or RAN internal congestion 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_520",
    "document_id": "23501-i80",
    "chunk_id": 520,
    "text": "If a notification that the GFBR can no longer be guaranteed has been sent to the SMF and the NG-RAN determines that the currently fulfilled GFBR PDB or PER are different better or worse from the situation indicated in the last notification the NG-RAN shall send a notification ie GFBR can no longer be guaranteed or GFBR can again be guaranteed to the SMF and indicate the current situation unless specific conditions at the NG-RAN require the release of the NG-RAN resources for this GBR QoS Flow eg due to Radio link failure or RAN internal congestion NOTE 1 The current situation is either that the QoS Profile can be fulfilled which is implicitly indicated by the GFBR can again be guaranteed notification itself that a different Alternative QoS Profile can be fulfilled or that the lowest priority Alternative QoS Profile cannot be fulfilled 3- The NG-RAN should always try to fulfil the QoS profile and if this is not possible any Alternative QoS Profile that has higher priority NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_521",
    "document_id": "23501-i80",
    "chunk_id": 521,
    "text": "In order to avoid a too frequent signalling to the SMF it is assumed that NG-RAN implementation can apply hysteresis eg via a configurable time interval before notifying the SMF that the currently fulfilled values match the QoS Profile or a different Alternative QoS Profile of higher priority It is also assumed that the PCF has ensured that the QoS values within the different Alternative QoS Profiles are not too close to each other 4 Upon receiving a notification from the NG-RAN the SMF may inform the PCF If it does so the SMF shall indicate the currently fulfilled situation to the PCF See TS 23503 45 5 If the PCF has not indicated differently the SMF uses NAS signalling that is sent transparently through the RAN to inform the UE about changes in the QoS parameters ie 5QI GFBR MFBR that the NG-RAN is currently fulfilling for the QoS Flow after Notification control has occurred 57242 Usage of Notification control with Alternative QoS Profiles at handover During handover the prioritized list of Alternative QoS Profiles if available is provided to the Target NG-RAN per QoS Flow in addition to the QoS profile If the Target NG-RAN is not able to guarantee the GFBR the PDB and the PER included in the QoS profile and if Alternative QoS Profiles are provided to the Target NG-RAN and the Target NG-RAN supports Alternative QoS Profiles the Target NG-RAN checks whether the GFBR the PDB and the PER values that it can fulfil match any of the Alternative QoS Profiles taking the priority order into account If there is a match between one of the Alternative QoS Profiles and the GFBR the PDB and the PER values that Target NG-RAN can fulfil the Target NG-RAN shall accept the QoS Flow and indicate the reference to that Alternative QoS Profile to the Source NG-RAN If there is no match to any Alternative QoS Profile the Target NG-RAN rejects QoS Flows for which the Target NG-RAN is not able to guarantee the GFBR the PDB and the PER included in the QoS profile After the handover is completed and a QoS Flow has been accepted by the Target NG-RAN based on an Alternative QoS Profile the Target NG-RAN shall treat this QoS Flow in the same way as if it had sent a notification that the GFBR can no longer be guaranteed with a reference to that Alternative QoS Profile to the SMF as described in clause 57241b If a QoS Flow has been accepted by the Target NG-RAN based on an Alternative QoS Profile the reference to the matching Alternative QoS Profile is provided from the Target NG-RAN to the AMF which forwards the message to the SMF during the Xn and N2 based handover procedures as described in TS 23502 3 After the handover is completed successfully the SMF shall send a notification to the PCF that the GFBR can no longer be guaranteed for a QoS Flow see TS 23503 45 for details if the SMF has received a reference to an Alternative QoS Profile and this reference indicates a change in the previously notified state of this QoS Flow If the PCF has not indicated differently the SMF shall also use NAS signalling that is sent transparently through the RAN to inform the UE about the QoS parameters ie 5QI GFBR MFBR corresponding to the new state of the QoS Flow NOTE A state change for the QoS Flow comprises a change from QoS profile fulfilled to Alternative QoS Profile fulfilled as well as the state change between fulfilled Alternative QoS Profiles If a QoS Flow has been accepted by the Target NG-RAN based on the QoS Profile the SMF shall interpret the fact that a QoS Flow is listed as transferred QoS Flow in the message received from the AMF as a notification that GFBR can again be guaranteed for this QoS Flow After the handover is successfully completed the Target NG-RAN performs as described in clause 57241b If the SMF has previously notified the PCF that the GFBR can no longer be guaranteed and the SMF does not receive an explicit notification that the GFBR can no longer be guaranteed for that QoS Flow from the Target NG-RAN within a configured time the SMF shall notify the PCF that the GFBR can again be guaranteed If a QoS Flow has been accepted by the Target NG-RAN and SMF did not receive from the Target NG-RAN a reference to any Alternative QoS Profile and the SMF has previously informed the UE about QoS parameters corresponding to any of the Alternative QoS Profiles the SMF shall use NAS signalling to inform the UE about the QoS parameters corresponding to the QoS Profile 57243 Usage of Notification control with Alternative QoS Profiles during QoS Flow establishment and modification During QoS Flow establishment and modification a prioritized list of Alternative QoS Profiles can be provided to the NG-RAN for the QoS Flow in addition to the QoS profile If the NG-RAN is not able to guarantee the GFBR the PDB and the PER included in the QoS profile and if Alternative QoS Profiles are provided to the NG-RAN and the NG-RAN supports Alternative QoS Profiles the NG-RAN shall check whether the GFBR the PDB and the PER values that it can fulfil match at least one of the Alternative QoS Profiles taking the priority order into account If there is a match between one of the Alternative QoS Profiles and the GFBR the PDB and the PER values that the NG-RAN can fulfil the NG-RAN shall accept the QoS Flow and indicate the reference to that Alternative QoS Profile to the SMF If there is no match to any Alternative QoS Profile the NG-RAN shall reject the QoS Flow establishment or modification After a successful QoS Flow establishment or modification during which the NG-RAN indicated that the currently fulfilled QoS matches one of the Alternative QoS Profiles the NG-RAN shall treat this QoS Flow in the same way as if it had sent a notification that the GFBR can no longer be guaranteed with a reference to that Alternative QoS Profile to the SMF as described in clause 57241b If the SMF has received a reference to an Alternative QoS Profile during QoS Flow establishment and modification the SMF may inform the PCF about it as described in TS 23503 45 If the PCF has not indicated differently the SMF shall use NAS signalling that is sent transparently through the RAN to inform the UE about the QoS parameters ie 5QI GFBR MFBR corresponding to the referenced Alternative QoS Profile 5725 Flow Bit Rates For GBR QoS Flows only the following additional QoS parameters exist - Guaranteed Flow Bit Rate GFBR - UL and DL - Maximum Flow Bit",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_522",
    "document_id": "23501-i80",
    "chunk_id": 522,
    "text": "Rate MFBR -- UL and DL The GFBR denotes the bit rate that is guaranteed to be provided by the network to the QoS Flow over the Averaging Time Window The MFBR limits the bit rate to the highest bit rate that is expected by the QoS Flow eg excess traffic may get discarded or delayed by a rate shaping or policing function at the UE RAN UPF Bit rates above the GFBR value and up to the MFBR value may be provided with relative priority determined by the Priority Level of the QoS Flows see clause 5733 GFBR and MFBR are signalled to the RAN in the QoS Profile and signalled to the UE as QoS Flow level QoS parameter as specified in TS 24501 47 for each individual QoS Flow NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_523",
    "document_id": "23501-i80",
    "chunk_id": 523,
    "text": "The GFBR is recommended as the lowest acceptable service bitrate where the service will survive NOTE 2 For each QoS Flow of Delay-critical GBR resource type the SMF can ensure that the GFBR of the QoS Flow can be achieved with the MDBV of the QoS Flow using the QoS Flow binding functionality described in clause 61324 of TS 23503 45 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_524",
    "document_id": "23501-i80",
    "chunk_id": 524,
    "text": "The network can set MFBR larger than GFBR for a particular QoS Flow based on operator policy and the knowledge of the end point capability ie support of rate adaptation at application service level 5726 Aggregate Bit Rates Each PDU Session of a UE is associated with the following aggregate rate limit QoS parameter - per Session Aggregate Maximum Bit Rate Session-AMBR The Session-AMBR is signalled to the appropriate UPF entityies to the UE and to the RAN to enable the calculation of the UE-AMBR The Session-AMBR limits the aggregate bit rate that can be expected to be provided across all Non-GBR QoS Flows for a specific PDU Session The Session-AMBR is measured over an AMBR averaging window which is a standardized value The Session-AMBR is not applicable to GBR QoS Flows Each UE is associated with the following aggregate rate limit QoS parameter - per UE Aggregate Maximum Bit Rate UE-AMBR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_525",
    "document_id": "23501-i80",
    "chunk_id": 525,
    "text": "The UE-AMBR limits the aggregate bit rate that can be expected to be provided across all Non-GBR QoS Flows of a UE Each RAN shall set its UE-AMBR to the sum of the Session-AMBR of all PDU Sessions with active user plane to this RAN up to the value of the UE-AMBR received from AMF The UE-AMBR is a parameter provided to the RAN by the AMF based on the value of the subscribed UE-AMBR retrieved from UDM or the dynamic serving network UE-AMBR retrieved from PCF eg for roaming subscriber The AMF provides the UE-AMBR provided by PCF to RAN if available The UE-AMBR is measured over an AMBR averaging window which is a standardized value The UE-AMBR is not applicable to GBR QoS Flows Each group of PDU Sessions of the UE for the same slice S-NSSAI may be associated with the following aggregate rate limit QoS parameter - per UE per Slice-Maximum Bit Rate UE-Slice-MBR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_526",
    "document_id": "23501-i80",
    "chunk_id": 526,
    "text": "The UE-Slice-MBR limits the aggregate bit rate that can be expected to be provided across all GBR and Non-GBR QoS Flows corresponding to PDU Sessions of the UE for the same slice S-NSSAI which have an active user plane Each supporting NG-RAN shall set its UE-Slice-MBR to the sum of the Session-AMBR and MFBR for GBR QoS Flows of all PDU Sessions corresponding to the slice S-NSSAI with active user plane to this NG-RAN up to the value of the UE-Slice-MBR corresponding to the slice S-NSSAI received from AMF The UE-Slice-MBR is measured over an AMBR averaging window which is a standardized value The UE-Slice-MBR is an optional parameter provided to the NG-RAN by the AMF as described in clause 51513 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_527",
    "document_id": "23501-i80",
    "chunk_id": 527,
    "text": "The AMBR averaging window is only applied to Session-AMBR UE-AMBR and UE-Slice-MBR measurement and the AMBR averaging windows for Session-AMBR and UE-AMBR are standardised to the same value 5727 Default values For each PDU Session Setup the SMF retrieves the subscribed Session-AMBR values as well as the subscribed default values for the 5QI and the ARP and optionally the 5QI Priority Level from the UDM The subscribed default 5QI value shall be a Non-GBR 5QI from the standardized value range NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_528",
    "document_id": "23501-i80",
    "chunk_id": 528,
    "text": "The 5QI Priority Level can be added to the subscription information to achieve an overwriting of the standardized or pre-configured 5QI Priority Level eg in scenarios where dynamic PCC is not deployed or the PCF is unavailable or unreachable The SMF may change the subscribed values for the default 5QI and the ARP and if received the 5QI Priority Level based on interaction with the PCF as described in TS 23503 45 or if dynamic PCC is not deployed based on local configuration to set QoS parameters for the QoS Flow associated with the default QoS rule For QoS Flows of the PDU Session other than the QoS Flow associated with the default QoS rule the SMF shall set the ARP priority level the ARP pre-emption capability and the ARP pre-emption vulnerability to the respective values in the PCC rules bound to that QoS Flow as described in TS 23503 45 If dynamic PCC is not deployed the SMF shall set the ARP priority level the ARP pre-emption capability and the ARP pre-emption vulnerability based on local configuration NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_529",
    "document_id": "23501-i80",
    "chunk_id": 529,
    "text": "The local configuration in the SMF can eg make use of the subscribed value for the ARP priority level and apply locally configured values for the ARP pre-emption capability and ARP pre-emption vulnerability If dynamic PCC is not deployed the SMF can have a DNN based configuration to enable the establishment of a GBR QoS Flow as the QoS Flow that is associated with the default QoS rule This configuration contains a standardized GBR 5QI as well as GFBR and MFBR for UL and DL NOTE 3 Interworking with EPS is not possible for a PDU Session with a GBR QoS Flow as the QoS Flow that is associated with the default QoS rule The SMF may change the subscribed Session-AMBR values for UL andor DL based on interaction with the PCF as described in TS 23503 45 or if dynamic PCC is not deployed based on local configuration to set the Session-AMBR values for the PDU Session 5728 Maximum Packet Loss Rate The Maximum Packet Loss Rate UL DL indicates the maximum rate for lost packets of the QoS Flow that can be tolerated in the uplink and downlink direction This is provided to the QoS Flow if it is compliant to the GFBR NOTE In this Release of the specification the Maximum Packet Loss Rate UL DL can only be provided for a GBR QoS Flow belonging to voice media 5729 Wireline access network specific 5G QoS parameters QoS parameters that are applicable only for or wireline access networks W-5GAN are specified in TS 23316 84 573 5G QoS characteristics 5731 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_530",
    "document_id": "23501-i80",
    "chunk_id": 530,
    "text": "This clause specifies the 5G QoS characteristics associated with 5QI The characteristics describe the packet forwarding treatment that a QoS Flow receives edge-to-edge between the UE and the UPF in terms of the following performance characteristics 1 Resource type Non-GBR GBR Delay-critical GBR 2 Priority Level 3 Packet Delay Budget including Core Network Packet Delay Budget 4 Packet Error Rate 5 Averaging window for GBR and Delay-critical GBR resource type only 6 Maximum Data Burst Volume for Delay-critical GBR resource type only The 5G QoS characteristics should be understood as guidelines for setting node specific parameters for each QoS Flow eg for 3GPP radio access link layer protocol configurations Standardized or pre-configured 5G QoS characteristics are indicated through the 5QI value and are not signalled on any interface unless certain 5G QoS characteristics are modified as specified in clauses 5733 5734 5736 and 5737 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_531",
    "document_id": "23501-i80",
    "chunk_id": 531,
    "text": "As there are no default values specified pre-configured 5G QoS characteristics have to include all of the characteristics listed above Signalled 5G QoS characteristics are provided as part of the QoS profile and shall include all of the characteristics listed above 5732 Resource Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_532",
    "document_id": "23501-i80",
    "chunk_id": 532,
    "text": "The resource type determines if dedicated network resources related to a QoS Flow-level Guaranteed Flow Bit Rate GFBR value are permanently allocated eg by an admission control function in a radio base station GBR QoS Flows are therefore typically authorized on demand which requires dynamic policy and charging control A GBR QoS Flow uses either the GBR resource type or the Delay-critical GBR resource type The definition of PDB and PER are different for GBR and Delay-critical GBR resource types and the MDBV parameter applies only to the Delay-critical GBR resource type A Non-GBR QoS Flow may be pre-authorized through static policy and charging control A Non-GBR QoS Flow uses only the Non-GBR resource type 5733 Priority Level The Priority Level associated with 5G QoS characteristics indicates a priority in scheduling resources among QoS Flows The lowest Priority Level value corresponds to the highest priority The Priority Level shall be used to differentiate between QoS Flows of the same UE and it shall also be used to differentiate between QoS Flows from different UEs In the case of congestion when all QoS requirements cannot be fulfilled for one or more QoS Flows the Priority Level shall be used to select for which QoS Flows the QoS requirements are prioritised such that a QoS Flow with Priority Level value N is priorized over QoS Flows with higher Priority Level values ie N1 N2 etcIn the case of no congestion the Priority Level should be used to define the resource distribution between QoS Flows In addition the scheduler may prioritize QoS Flows based on other parameters eg resource type radio condition in order to optimize application performance and network capacity Every standardized 5QI is associated with a default value for the Priority Level -specified in QoS characteristics Table 5741 Priority Level may also be signalled together with a standardized 5QI to the -RAN and if it is received it shall be used instead of the default value Priority Level may also be signalled together with a pre-configured 5QI to the RAN and if it is received it shall be used instead of the pre-configured value 5734 Packet Delay Budget The Packet Delay Budget PDB defines an upper bound for the time that a packet may be delayed between the UE and the N6 termination point at the UPF The PDB applies to the DL packet received by the UPF over the N6 interface and to the UL packet sent by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_533",
    "document_id": "23501-i80",
    "chunk_id": 533,
    "text": "For a certain 5QI the value of the PDB is the same in UL and DL",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_534",
    "document_id": "23501-i80",
    "chunk_id": 534,
    "text": "In the case of 3GPP access the PDB is used to support the configuration of scheduling and link layer functions eg the setting of scheduling priority weights and HARQ target operating points For GBR QoS Flows using the Delay-critical resource type a packet delayed more than PDB is counted as lost if the data burst is not exceeding the MDBV within the period of PDB and the QoS Flow is not exceeding the GFBR For GBR QoS Flows with GBR resource type not exceeding GFBR 98 percent of the packets shall not experience a delay exceeding the 5QIs PDB The 5G Access Network Packet Delay Budget 5G-AN PDB is determined by subtracting a static value for the Core Network Packet Delay Budget CN PDB which represents the delay between any N6 termination point at the UPF for any UPF that may possibly be selected for the PDU Session and the 5G-AN from a given PDB NOTE 1 For a standardized 5QI the static value for the CN PDB is specified in the QoS characteristics Table 574-1 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_535",
    "document_id": "23501-i80",
    "chunk_id": 535,
    "text": "For a non-standardized 5QI the static value for the CN PDB is homogeneously configured in the network For GBR QoS Flows using the Delay-critical resource type in order to obtain a more accurate delay budget PDB available for the NG-RAN a dynamic value for the CN PDB which represents the delay between the UPF terminating N6 for the QoS Flow and the 5G-AN can be used If used for a QoS Flow the NG-RAN shall apply the dynamic value for the CN PDB instead of the static value for the CN PDB which is only related to the 5QI Different dynamic value for CN PDB may be configured per uplink and downlink direction NOTE 3 The configuration of transport network on CN tunnel can be different per UL and DL which can be different value for CN PDB per UL and DL NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_536",
    "document_id": "23501-i80",
    "chunk_id": 536,
    "text": "It is expected that the UPF deployment ensures that the dynamic value for the CN PDB is not larger than the static value for the CN PDB This avoids that the functionality that is based on the 5G-AN PDB eg MDBV NG-RAN scheduler has to handle an unexpected value The dynamic value for the CN PDB of a Delay-critical GBR 5QI may be configured in the network in two ways - Configured in each NG-RAN node based on a variety of inputs such as different IP addresses or TEID range of UPF terminating the N3 tunnel and based on different combinations of PSA UPF to NG-RAN under consideration of any potential I-UPF etc - Configured in the SMF based on different combinations of PSA UPF to NG-RAN under consideration of any potential I-UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_537",
    "document_id": "23501-i80",
    "chunk_id": 537,
    "text": "The dynamic value for the CN PDB for a particular QoS Flow shall be signalled to NG-RAN during PDU Session Establishment PDU Session Modification XnN2 handover and the Service Request procedures when the QoS Flow is established or the dynamic value for the CN PDB of a QoS Flow changes eg when an I-UPF is inserted by the SMF If the NG-RAN node is configured locally with a dynamic value for the CN PDB for a Delay-critical GBR 5QI and receives a different value via N2 signalling for a QoS Flow with the same 5QI local configuration in RAN node determines which value takes precedence Services using a GBR QoS Flow and sending at a rate smaller than or equal to the GFBR can in general assume that congestion related packet drops will not occur NOTE 5 Exceptions eg transient link outages can always occur in a radio access system which may then lead to congestion related packet drops Packets surviving congestion related packet dropping may still be subject to non-congestion related packet losses see PER below Services using Non-GBR QoS Flows should be prepared to experience congestion-related packet drops and delays In uncongested scenarios 98 percent of the packets should not experience a delay exceeding the 5QIs PDB The PDB for Non-GBR and GBR resource types denotes a soft upper bound in the sense that an expired packet eg a link layer SDU that has exceeded the PDB does not need to be discarded and is not added to the PER However for a Delay-critical GBR resource type packets delayed more than the PDB are added to the PER and can be discarded or delivered depending on local decision 5735 Packet Error Rate",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_538",
    "document_id": "23501-i80",
    "chunk_id": 538,
    "text": "The Packet Error Rate PER defines an upper bound for the rate of PDUs eg IP packets that have been processed by the sender of a link layer protocol eg RLC in RAN of a 3GPP access but that are not successfully delivered by the corresponding receiver to the upper layer eg PDCP in RAN of a 3GPP access Thus the PER defines an upper bound for a rate of non-congestion related packet losses The purpose of the PER is to allow for appropriate link layer protocol configurations eg RLC and HARQ in RAN of a 3GPP access For every 5QI the value of the PER is the same in UL and DL For GBR QoS Flows with Delay-critical GBR resource type a packet which is delayed more than PDB is counted as lost and included in the PER unless the data burst is exceeding the MDBV within the period of PDB or the QoS Flow is exceeding the GFBR 5736 Averaging Window Each GBR QoS Flow shall be associated with an Averaging window",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_539",
    "document_id": "23501-i80",
    "chunk_id": 539,
    "text": "The Averaging window represents the duration over which the GFBR and MFBR shall be calculated eg in the RAN UPF UE Every standardized 5QI of GBR and Delay-critical GBR resource type is associated with a default value for the Averaging window specified in QoS characteristics Table 5741",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_540",
    "document_id": "23501-i80",
    "chunk_id": 540,
    "text": "The averaging window may also be signalled together with a standardized 5QI to the RAN and UPF and if it is received it shall be used instead of the default value The Averaging window may also be signalled together with a pre-configured 5QI to the RAN and if it is received it shall be used instead of the pre-configured value 5737 Maximum Data Burst Volume Each GBR QoS Flow with Delay-critical resource type shall be associated with a Maximum Data Burst Volume MDBV MDBV denotes the largest amount of data that the 5G-AN is required to serve within a period of 5G-AN PDB Every standardized 5QI of Delay-critical GBR resource type is associated with a default value for the MDBV specified in QoS characteristics Table 5741",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_541",
    "document_id": "23501-i80",
    "chunk_id": 541,
    "text": "The MDBV may also be signalled together with a standardized 5QI to the RAN and if it is received it shall be used instead of the default value The MDBV may also be signalled together with a pre-configured 5QI to the RAN and if it is received it shall be used instead of the pre-configured value 574 Standardized 5QI to QoS characteristics mapping Standardized 5QI values are specified for services that are assumed to be frequently used and thus benefit from optimized signalling by using standardized QoS characteristics Dynamically assigned 5QI values which require a signalling of QoS characteristics as part of the QoS profile can be used for services for which standardized 5QI values are not defined The one-to-one mapping of standardized 5QI values to 5G QoS characteristics is specified in table 574-1 Table 574-1 Standardized 5QI to QoS characteristics mapping NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_542",
    "document_id": "23501-i80",
    "chunk_id": 542,
    "text": "It is preferred that a value less than 64 is allocated for any new standardised 5QI of Non-GBR resource type This is to allow for option 1 to be used as described in clause 5713 as the QFI is limited to less than 64 575 Reflective QoS 5751 General Reflective QoS enables the UE to map UL User Plane traffic to QoS Flows without SMF provided QoS rules and it applies for IP PDU Session and Ethernet PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_543",
    "document_id": "23501-i80",
    "chunk_id": 543,
    "text": "This is achieved by creating UE derived QoS rules in the UE based on the received DL traffic It shall be possible to apply Reflective QoS and non-Reflective QoS concurrently within the same PDU Session For a UE supporting Reflective QoS functionality the UE shall create a UE derived QoS rule for the uplink traffic based on the received DL traffic if Reflective QoS function is used by the 5GC for some traffic flows The UE shall use the UE derived QoS rules to determine mapping of UL traffic to QoS Flows If the 3GPP UE supports Reflective QoS functionality the UE should indicate support of Reflective QoS to the network ie SMF for every PDU Session For PDU Sessions established in EPS and PDU Sessions transferred from EPS without N26 interface the UE indicates Reflective QoS support using the PDU Session Establishment procedure After the first inter-system change from EPS to 5GS for PDU Sessions established in EPS and transferred from EPS with N26 interface the UE indicates Reflective QoS support using the PDU Session Modification procedure as described in clause 517222",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_544",
    "document_id": "23501-i80",
    "chunk_id": 544,
    "text": "The UE as well as the network shall apply the information whether or not the UE indicated support of Reflective QoS throughout the lifetime of the PDU Session NOTE The logic driving a supporting UE under exceptional circumstances to not indicate support of Reflective QoS for a PDU Session is implementation dependent Under exceptional circumstances which are UE implementation dependent the UE may decide to revoke previously indicated support for Reflective QoS using the PDU Session Modification procedure In such a case the UE shall delete all derived QoS rules for this PDU Session and the network shall stop any user plane enforcement actions related to Reflective QoS for this PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_545",
    "document_id": "23501-i80",
    "chunk_id": 545,
    "text": "In addition the network may provide signalled QoS rules for the SDFs for which Reflective QoS was used before The UE shall not indicate support for Reflective QoS for this PDU Session for the remaining lifetime of the PDU Session If under the same exceptional circumstances mentioned above and while NAS level MM or SM congestion control timer is running the UE needs to revoke a previously indicated support for Reflective QoS the UE performs PDU Session Release procedure that is exempt from MM and SM congestion control as defined in clause 5197 5752 UE Derived QoS Rule The UE derived QoS rule contains following parameters - One UL Packet Filter in the Packet Filter Set as defined in clause 576 - QFI - Precedence value see clause 5719 Upon receiving DL packet one UL Packet Filter derived from the received DL packet as described in this clause is used to identify a UE derived QoS rule within a PDU Session For PDU Session of IP type the UL Packet Filter is derived based on the received DL packet as follows - When Protocol ID Next Header is set to TCP or UDP by using the source and destination IP addresses source and destination port numbers and the Protocol ID Next Header field itself -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_546",
    "document_id": "23501-i80",
    "chunk_id": 546,
    "text": "When Protocol ID Next Header is set to UDP if the received DL packet is UDP-encapsulated IPSec protected packet by using the source and destination IP addresses source and destination port numbers the Security Parameter Index and the Protocol ID Next Header field itself In this case if an uplink IPSec SA corresponding to a downlink IPSec SA of the SPI in the DL packet exists and the SPI of the uplink IPSec SA is known to the NAS layer then the UL Packet Filter contains an SPI of the uplink IPSec SA - When Protocol ID Next Header is set to ESP by using the source and destination IP addresses the Security Parameter Index and the Protocol ID Next Header field itself If the received DL packet is an IPSec protected packet and an uplink IPSec SA corresponding to a downlink IPSec SA of the SPI in the DL packet exists and the SPI of the uplink IPSec SA is known to the NAS layer then the UL Packet Filter contains an SPI of the uplink IPSec SA NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_547",
    "document_id": "23501-i80",
    "chunk_id": 547,
    "text": "In this Release of the specification for PDU Sessions of IP type the use of Reflective QoS is restricted to service data flows for which Protocol ID Next Header is set to TCP UDP or ESP NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_548",
    "document_id": "23501-i80",
    "chunk_id": 548,
    "text": "The UE does not verify whether the downlink packets with RQI indication match the restrictions on Reflective QoS NOTE 3 How to determine the received DL packet is UDP-encapsulated IPSec protected packet is defined in RFC 3948 138 UDP encapsulation for ESP is used when a NAT is detected and there can be different Security Parameter Indexes within the same IP-tuples NOTE 4 Despite the indication of support for Reflective QoS the UE might not be able to derive QoS Rules for ESP IPSec packets and UDP-encapsulated IPSec packets if uplink IPSec SA corresponding to a downlink IPSec SA of the SPI in the DL packet exists and the SPI of the uplink IPSec SA is not known to the NAS layer For PDU Session of Ethernet type the UL Packet Filter is derived based on the received DL packet by using the source and destination MAC addresses the Ethertype on received DL packet is used as Ethertype for UL packet In the case of presence of IEEE Std 8021Q 98 the VID and PCP in IEEE Std 8021Q 98 headers of the received DL packet is also used as the VID and PCP field for the UL Packet Filter When double IEEE Std 8021Q 98 tagging is used only the outer S-TAG is taken into account for the UL Packet Filter derivation NOTE 5 In this Release of the specification for PDU Sessions of Ethernet type the use of Reflective QoS is restricted to service data flows for which 8021Q 98 tagging is used The QFI of the UE derived QoS rule is set to the value received in the DL packet When Reflective QoS is activated the precedence value for all UE derived QoS rules is set to a standardised value 5753 Reflective QoS Control Reflective QoS is controlled on per-packet basis by using the Reflective QoS Indication RQI in the encapsulation header on N3 and N9 reference point together with the QFI and together with a Reflective QoS Timer RQ Timer value that is either signalled to the UE upon PDU Session Establishment or upon PDU Session Modification as described in clause 517222 or set to a default value The RQ Timer value provided by the core network is at the granularity of PDU Session the details are specified in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_549",
    "document_id": "23501-i80",
    "chunk_id": 549,
    "text": "When the 5GC determines that Reflective QoS has to be used for a specific SDF belonging to a QoS Flow the SMF shall provide the RQA Reflective QoS Attribute within the QoS Flows QoS profile to the NG-RAN on N2 reference point unless it has been done so before When the RQA has been provided to the NG-RAN for a QoS Flow and the 5GC determines that the QoS Flow carries no more SDF for which Reflective QoS has to be used the SMF should signal the removal of the RQA Reflective QoS Attribute from the QoS Flows QoS profile to the NG-RAN on N2 reference point NOTE 1 The SMF could have a timer to delay the sending of the removal of the RQA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_550",
    "document_id": "23501-i80",
    "chunk_id": 550,
    "text": "This would avoid signalling to the RAN in the case of new SDFs subject to Reflective QoS are bound to this QoS Flow in the meantime When the 5GC determines to use Reflective QoS for a specific SDF the SMF shall ensure that the UPF applies the RQI marking eg by setting the indication to use Reflective QoS in the QER associated with the DL PDR if not already set for this SDF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_551",
    "document_id": "23501-i80",
    "chunk_id": 551,
    "text": "The SMF shall also ensure that the uplink packets for this SDF can be received by the UPF from the QoS Flow to which the DL PDR of the SDF is associated with as specified in TS 29244 65 eg by generating a new UL PDR for this SDF for that QoS Flow and providing it to the UPF When the UPF is instructed by the SMF to apply RQI marking the UPF shall set the RQI in the encapsulation header on the N3 or N9 reference point for every DL packet corresponding to this SDF When an RQI is received by RAN in a DL packet on N3 reference point the RAN shall indicate to the UE the QFI and the RQI of that DL packet Upon reception of a DL packet with RQI - if a UE derived QoS rule with a Packet Filter corresponding to the DL packet does not already exist - the UE shall create a new UE derived QoS rule with a Packet Filter corresponding to the DL packet as described in clause 5752 and - the UE shall start for this UE derived QoS rule a timer set to the RQ Timer value - otherwise - the UE shall restart the timer associated to this UE derived QoS rule and - if the QFI associated with the downlink packet is different from the QFI associated with the UE derived QoS rule the UE shall update this UE derived QoS rule with the new QFI NOTE 2 Non-3GPP ANs does not need N2 signalling to enable Reflective QoS Non 3GPP accesses are expected to send transparently the QFI and RQI to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_552",
    "document_id": "23501-i80",
    "chunk_id": 552,
    "text": "If the UPF does not include the RQI no UE derived QoS rule will be generated If RQI is included to assist the UE to trigger an update of the UE derived QoS rule the reception of PDU for a QFI restarts the RQ Timer Upon timer expiry associated with a UE derived QoS rule the UE deletes the corresponding UE derived QoS rule When the 5GC determines not to use Reflective QoS for a specific SDF any longer - The SMF shall ensure that the UPF stops applying RQI marking as specified in TS 29244 65 eg by removing the indication to use Reflective QoS from the QER associated with the DL PDR for this SDF - When the UPF receives this instruction to stop applying RQI marking the UPF shall no longer set the RQI in the encapsulation header on the N3 or N9 reference point DL packets corresponding to this SDF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_553",
    "document_id": "23501-i80",
    "chunk_id": 553,
    "text": "The SMF shall also ensure that after an operator configurable time the uplink packets for this SDF will not be accepted by the UPF over the QoS Flow on which Reflective QoS was applied for this SDF as specified in TS 29244 65 eg by removing the UL PDR for this SDF from that QoS Flow NOTE 3 The operator configurable time has to be at least as long as the RQ Timer value to ensure that no UL packet would be dropped until the UE derived QoS rule is deleted by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_554",
    "document_id": "23501-i80",
    "chunk_id": 554,
    "text": "When the 5GC determines to change the binding of the SDF while Reflective QoS is used for this SDF the SMF shall ensure that the uplink packets for this SDF are accepted over the newly bound QoS Flow and for an operator configurable time over the previously bound QoS Flow 576 Packet Filter Set 5761 General The Packet Filter Set is used in the QoS rule and the PDR to identify one or more packet IP or Ethernet flows NOTE 1 A QoS Flow is characterised by PDRs and QoS rules as described in clause 5711 NOTE 2 DL Packet Filter in a Packet Filter Set of a QoS rule may be needed by the UE eg for the purpose of IMS precondition The Packet Filter Set may contain one or more Packet Filters Every Packet Filter is applicable for the DL direction the UL direction or both directions NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_555",
    "document_id": "23501-i80",
    "chunk_id": 555,
    "text": "The Packet Filter in the Packet Filter Set of the default QoS rule that allows all UL traffic also known as match-all Packet Filter is described in TS 24501 47 There are two types of Packet Filter Set ie IP Packet Filter Set and Ethernet Packet Filter Set corresponding to those PDU Session Types 5762 IP Packet Filter Set For IP PDU Session Type the Packet Filter Set shall support Packet Filters based on at least any combination of - Sourcedestination IP address or IPv6 prefix - Source destination port number - Protocol ID of the protocol above IPNext header type - Type of Service TOS IPv4 Traffic class IPv6 and Mask - Flow Label IPv6 - Security parameter index - Packet Filter direction NOTE 1 A value left unspecified in a Packet Filter matches any value of the corresponding information in a packet NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_556",
    "document_id": "23501-i80",
    "chunk_id": 556,
    "text": "An IP address or Prefix can be combined with a prefix mask NOTE 3 Port numbers can be specified as port ranges NOTE 4 Type of Service IPv4Traffic class IPv6 can be used to define packet filters for DSCP and ECN as described in RFC 3168 193 5763 Ethernet Packet Filter Set For Ethernet PDU Session Type the Packet Filter Set shall support Packet Filters based on at least any combination of - Sourcedestination MAC address - Ethertype as defined in IEEE 8023 131 - Customer-VLAN tag C-TAG andor Service-VLAN tag S-TAG VID fields as defined in IEEE Std 8021Q 98 - Customer-VLAN tag C-TAG andor Service-VLAN tag S-TAG PCPDEI fields as defined in IEEE Std 8021Q 98 - IP Packet Filter Set in the case that Ethertype indicates IPv4IPv6 payload - Packet Filter direction NOTE 1 The MAC address can be specified as address ranges NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_557",
    "document_id": "23501-i80",
    "chunk_id": 557,
    "text": "A value left unspecified in a Packet Filter matches any value of the corresponding information in a packet 577 PDU Set QoS Parameters 5771 General PDU Set QoS Parameters are used to support PDU Set based QoS handling in the NG-RAN The following PDU Set QoS Parameters are specified 1 PDU Set Delay Budget PSDB 2 PDU Set Error Rate PSER 3 PDU Set Integrated Handling Information PSIHI At least one of the following shall be sent to the NG-RAN to enable PDU Set based handling 1 a PSIHI andor 2 both PSDB and PSER For a given QoS Flow the values of PSDB PSER and PSIHI can be different for UL and DL The QoS Profile may include the PDU Set QoS Parameters described in this clause see clause 5712 for UL andor DL direction The PCF determines the PDU Set QoS Parameters based on information provided by AF andor local configuration The PDU Set QoS parameters are sent to the SMF as part of PCC rule The SMF sends them to NG-RAN as part of the QoS Profile If the NG-RAN receives PDU Set QoS Parameters it enables the PDU Set based QoS handling and applies PDU Set QoS Parameters as described in TS 38300 27 TS 38413 34 and TS 38331 51 5772 PDU Set Delay Budget The PDU Set Delay Budget PSDB defines an upper bound for the delay that a PDU Set may experience for the transfer between the UE and the N6 termination point at the UPF ie the duration between the reception time of the first PDU at the N6 termination point for DL or the UE for UL and the time when all PDUs of a PDU Set have been successfully received at the UE for DL or N6 termination point for UL The DL PSDB applies to the DL PDU Set received by the PSA UPF over the N6 interface and the UL PSDB applies to the UL PDU Set sent by the UE NOTE 1 To enable support for PSDB it is required that a maximum inter arrival time between the first received PDU and the last received PDU of a PDU Set complies with SLA This maximum inter arrival time does not exceed PSDB NG-RAN behaviour when the SLA is not fulfilled is out of scope of this specification A QoS Flow is associated with at most one PSDB value per direction PSDB is an optional parameter that may be provided by the PCF The provided PSDB can be used by the NG-RAN to support the configuration of scheduling and link layer functions When the PSDB is available the UL andor DL PSDB supersedes the PDB in the respective direction for the given QoS Flow in the NG-RAN NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_558",
    "document_id": "23501-i80",
    "chunk_id": 558,
    "text": "See clause 5771 for dependency between PDU Set QoS parameters The AN PSDB is derived at NG-RAN by subtracting CN PDB as described in clause 5734 from the PSDB 5773 PDU Set Error Rate The PDU Set Error Rate PSER defines an upper bound for the rate of PDU Sets that have been processed by the sender of a link layer protocol eg RLC in RAN of a 3GPP access but that are not successfully delivered by the corresponding receiver to the upper layer eg PDCP in RAN of a 3GPP access Thus the PSER defines an upper bound for a rate of non-congestion related PDU Set losses The purpose of the PSER is to allow for appropriate link layer protocol configurations eg RLC and HARQ in RAN of a 3GPP access NOTE 1 In this Release a PDU Set is considered as successfully delivered only when all PDUs of a PDU Set are delivered successfully NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_559",
    "document_id": "23501-i80",
    "chunk_id": 559,
    "text": "How RAN enforces PSER is up to RAN implementation A QoS Flow is associated with at most one PSER value per direction PSER is an optional parameter If the PSER is available the UL andor DL PSER supersedes the PER in the respective direction in the NG-RAN NOTE 3 See clause 5771 for dependency between PDU Set QoS parameters 5774 PDU Set Integrated Handling Information The PDU Set Integrated Handling Information PSIHI indicates whether all PDUs of the PDU Set are needed for the usage of the PDU Set by the application layer in the receiver side PSIHI is an optional parameter A QoS Flow is associated with at most one PSIHI value per direction 58 User Plane Management 581 General User Plane Functions handle the user plane path of PDU Sessions 3GPP specifications support deployments with a single UPF or multiple UPFs for a given PDU Session UPF selection is performed by SMF The details of UPF selection is described in clause 633",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_560",
    "document_id": "23501-i80",
    "chunk_id": 560,
    "text": "The number of UPFs supported for a PDU Session is unrestricted For an IPv4 type PDU Session or an IPv6 type PDU Session without multi-homing or an IPv4v6 type PDU Session when multiple PDU Session Anchors are used due to UL CL being inserted only one IPv4 address andor IPv6 prefix is allocated for the PDU Session For an IPv6 multi-homed PDU Session there are multiple IPv6 prefixes allocated for the PDU Session as described in clause 5643 If the SMF had requested the UPF to proxy ARP or IPv6 Neighbour Solicitation for an Ethernet DNN the UPF should respond to the ARP or IPv6 Neighbour Solicitation Request itself Deployments with one single UPF used to serve a PDU Session do not apply to the Home Routed case and may not apply to the cases described in clause 564 Deployments where a UPF is controlled either by a single SMF or multiple SMFs for different PDU Sessions are supported UPF traffic detection capabilities may be used by the SMF in order to control at least following features of the UPF - Traffic detection eg classifying traffic of IP type Ethernet type or unstructured type - Traffic reporting eg allowing SMF support for charging - QoS enforcement",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_561",
    "document_id": "23501-i80",
    "chunk_id": 561,
    "text": "The corresponding requirements are defined in clause 57 - Traffic routing eg as defined in clause 564 for UL CL or IPv6 multi-homing 582 Functional Description 5821 General This clause contains detailed functional descriptions for some of the functions provided by the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_562",
    "document_id": "23501-i80",
    "chunk_id": 562,
    "text": "It is described how the SMF instructs its corresponding UP function and which control parameters are used 5822 UE IP Address Management 58221 General The UE IP address management includes allocation and release of the UE IP address as well as renewal of the allocated IP address where applicable The UE shall perform the association of the application to a new PDU Session described in clause 61221 of TS 23503 45 with the following considerations - If there is a matching URSP rule except the URSP rule with the match all Traffic descriptor or a matching UE Local Configuration containing a PDU Session Type of IPv4 IPv6 or IPv4v6 then the UE shall set the requested PDU Session Type to the PDU Session Type contained in the matching URSP rule or in the matching UE Local Configuration if this PDU Session Type is supported by the UEs IP stack capabilities Detailed operation is described in TS 24526 110 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_563",
    "document_id": "23501-i80",
    "chunk_id": 563,
    "text": "Otherwise if a URSP Rule with the match all Traffic descriptor exists the UE shall set the requested PDU Session Type to the PDU Session Type contained in the match all URSP Rule if this PDU Session Type is supported by the UEs IP stack capabilities Detailed operation is described in TS 24526 110 - Otherwise the UE shall set the requested PDU Session Type during the PDU Session Establishment procedure based on its IP stack capabilities as follows - A UE which supports IPv6 and IPv4 shall set the requested PDU Session Type IPv4v6 - A UE which supports only IPv4 shall request for PDU Session Type IPv4 - A UE which supports only IPv6 shall request for PDU Session Type IPv6 - When the IP version capability of the UE is unknown in the UE as in the case when the MT and TE are separated and the capability of the TE is not known in the MT the UE shall request for PDU Session Type IPv4v6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_564",
    "document_id": "23501-i80",
    "chunk_id": 564,
    "text": "The SMF selects PDU Session Type of the PDU Session as follows - If the SMF receives a request with PDU Session Type set to IPv4v6 the SMF selects either PDU Session Type IPv4 or IPv6 or IPv4v6 based on DNN configuration subscription data and operator policies - If the SMF receives a request for PDU Session Type IPv4 or IPv6 and the requested IP version is supported by the DNN the SMF selects the requested PDU Session type In its answer to the UE the SMF may indicate the PDU Session Types not allowed for the combination of DNN S-NNSAI In this case the UE shall not request another PDU Session to the same DNN S-NNSAI for PDU Session Types indicated as not allowed by the network In the case that the initial PDU Session was established with a PDU Session Type and the UE needs another single IP version PDU Session Type the UE may initiate another PDU Session Establishment procedure to this DNN S-NNSAI in order to activate a second PDU session with that PDU Session Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_565",
    "document_id": "23501-i80",
    "chunk_id": 565,
    "text": "An SMF shall ensure that the IP address management procedure is based on the selected PDU Session Type If IPv4 PDU Session Type is selected an IPv4 address is allocated to the UE Similarly if IPv6 PDU Session type is selected an IPv6 prefix is allocated If IPv4v6 PDU Session Type is selected both an IPv4 address and an IPv6 prefix are allocated For Roaming case the SMF in this clause refers to the SMF controlling the UPFs acting as PDU Session Anchor ie H-SMF in home routed case and V-SMF in local breakout case For home routed case V-SMF forwards the PDU Session Type requested by UE to H-SMF without interpreting it V-SMF sends back to UE the PDU Session Type selected by H-SMF The SMF shall process the UE IP address management related messages maintain the corresponding state information and provide the response messages to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_566",
    "document_id": "23501-i80",
    "chunk_id": 566,
    "text": "The 5GC and UE support the following mechanisms a During PDU Session Establishment procedure the SMF sends the IP address to the UE via SM NAS signalling The IPv4 address allocation andor IPv4 parameter configuration via DHCPv4 according to RFC 2131 9 can also be used once PDU Session is established b 64 IPv6 prefix allocation shall be supported via IPv6 Stateless Auto-configuration according to RFC 4862 10 if IPv6 is supported The details of Stateless IPv6 Address Autoconfiguration are described in clause 58223 IPv6 parameter configuration via Stateless DHCPv6 according to RFC 8415 182 may also be supported IPv6 Prefix Delegation using DHCPv6 may be supported for allocating additional IPv6 prefixes for a PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_567",
    "document_id": "23501-i80",
    "chunk_id": 567,
    "text": "The details of Prefix Delegation are described in clause 58224 For scenarios with RG connecting to 5GC additional features for IPv6 address allocation and IPv6 prefix delegation are supported as described in TS 23316 84 To allocate the IP address via DHCPv4 the UE may indicate to the network within the Protocol Configuration Options that the UE requests to obtain the IPv4 address with DHCPv4 or obtain the IP address during the PDU Session Establishment procedure This implies the following behaviour both for static and dynamic address allocation -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_568",
    "document_id": "23501-i80",
    "chunk_id": 568,
    "text": "The UE may indicate that it requests to obtain an IPv4 address as part of the PDU Session Establishment procedure In such a case the UE relies on the 5GC network to provide IPv4 address to the UE as part of the PDU Session Establishment procedure - The UE may indicate that it requests to obtain the IPv4 address after the PDU Session Establishment procedure by DHCPv4 That is when the 5GC network supports DHCPv4 and allows that it does not provide the IPv4 address for the UE as part of the PDU Session Establishment procedure The network may respond to the UE by setting the allocated IPv4 Address to 0000 After the PDU Session Establishment procedure is completed the UE uses the connectivity with the 5GC and initiates the IPv4 address allocation on its own using DHCPv4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_569",
    "document_id": "23501-i80",
    "chunk_id": 569,
    "text": "However if the 5GC network provides IPv4 address to the UE as part of the PDU Session Establishment procedure the UE should accept the IPv4 address indicated in the PDU Session Establishment procedure - If the UE sends no IP Address Allocation request the SMF determines whether DHCPv4 is used between the UE and the SMF or not based on per DNN configuration If dynamic policy provisioning is deployed and the PCF was not informed of the IPv4 address at PDU Session Establishment procedure the SMF shall inform the PCF about an allocated IPv4 address If the IPv4 address is released the SMF shall inform the PCF about the de-allocation of an IPv4 address In order to support DHCP based IP address configuration the SMF shall act as the DHCP server towards the UE The PDU Session Anchor UPF does not have any related DHCP functionality",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_570",
    "document_id": "23501-i80",
    "chunk_id": 570,
    "text": "The SMF instructs the PDU Session Anchor UPF serving the PDU Session to forward DHCP packets between the UE and the SMF over the user plane When DHCP is used for external data network assigned addressing and parameter configuration the SMF shall act as the DHCP client towards the external DHCP server The UPF does not have any related DHCP functionality In the case of DHCP server on the external data network the SMF instructs a UPF with N6 connectivity to forward DHCP packets between the UE and the SMF and the external DHCP server over the user plane",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_571",
    "document_id": "23501-i80",
    "chunk_id": 571,
    "text": "The 5GC may also support the allocation of a static IPv4 address andor a static IPv6 prefix based on subscription information in the UDM or based on the configuration on a per-subscriber per-DNN basis and per-S-NSSAI If the static IP addressprefix is stored in the UDM during PDU Session Establishment procedure the SMF retrieves this static IP addressprefix from the UDM If the static IP addressprefix is not stored in the UDM subscription record it may be configured on a per-subscriber per-DNN and per-S-NSSAI basis in the DHCPDN-AAA server and the SMF retrieves the IP addressprefix for the UE from the DHCPDN-AAA server This IP addressprefix is delivered to the UE in the same way as a dynamic IP addressprefix It is transparent to the UE whether the PLMN or the external data network allocates the IP address and whether the IP address is static or dynamic For IPv4 or IPv6 or IPv4v6 PDU Session Type during PDU Session Establishment procedure the SMF may receive a Subscribers IP Index from the UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_572",
    "document_id": "23501-i80",
    "chunk_id": 572,
    "text": "If the UE IP addressprefix was not already allocated and provided to PCF when SMF initiates the SM policy association the SMF may receive a Subscribers IP Index from the PCF If the SMF received a Subscribers IP index from both UDM and PCF the SMF shall apply the Subscribers IP Index received from the PCF The SMF may use the Subscribers IP Index to assist in selecting how the IP address is to be allocated when multiple allocation methods or multiple instances of the same method are supported In the case of Home Routed roaming the H-SMF may receive the IP index from the H-PCF NOTE The IP Index can eg be used to select between different IP pools including between IP pools with overlapping private address range To support deployments with overlapping private IPv4 address the IP domain corresponding to IP index can also be provided from UDM to SMF as part of the subscription data and then provided to PCF When Static IP addresses for a PDU session are not used the actual allocation of the IP Addresses for a PDU Session may use any of the following mechanisms - The SMF allocates the IP address from a pool that corresponds to the PDU Session Anchor UPF that has been selected - The UE IP address is obtained from the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_573",
    "document_id": "23501-i80",
    "chunk_id": 573,
    "text": "In that case the SMF shall interact with the UPF via N4 procedures to obtain a suitable IP address The SMF provides the UPF with the necessary information allowing the UPF to derive the proper IP address eg the network instance - In the case that the UE IP address is obtained from the external data network additionally the SMF shall also send the allocation renewal and release related request messages to the external data network ie DHCPDN-AAA server and maintain the corresponding state information The IP address allocation request sent to DHCPDN-AAA server may include the IP address pool ID to identify which range of IP address is to be allocated In this case the SMF is provisioned with separate IP address pool IDs and the mapping between IP address pool ID and UPF Id DNN S-NSSAI IP version",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_574",
    "document_id": "23501-i80",
    "chunk_id": 574,
    "text": "The provision is done by OAM or during the N4 Association Setup procedure A given IP address pool is controlled by a unique entity either the SMF or the UPF or an external server The IP address managed by the UPF can be partitioned into multiple IP address pool partitions ie associated with multiple IP address pool IDs When the SMF is configured to obtain UE IP addresses from the UPF the SMF may select a UPF based upon support of this feature The SMF determines whether the UPF supports this feature via NRF or via N4 capability negotiation during N4 Association Setup If no appropriate UPF support the feature the SMF may allocate UE IP addresses if configured to do",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_575",
    "document_id": "23501-i80",
    "chunk_id": 575,
    "text": "so The IP addressprefix is released by the SMF eg upon release of the PDU Session likewise the UPF considers that any IP address it has allocated within a N4 session are released when this N4 session is released UPF may use NAT between the UE and the Data Network and thus the 5GC allocated private UE IP address may not be visible on the N6 reference point 58222 Routing rules configuration When the UE has an IPv6 multi-homed PDU Session the UE selects the source IPv6 prefix according to IPv6 multi-homed routing rules pre-configured in the UE or received from network IPv6 multi-homed routing rules received from the network have a higher priority than IPv6 multi-homed routing rules pre-configured in the UE The SMF can generate the IPv6 multi-homed routing rules for a UE based on local configuration or dynamic PCC rules received from the PCF as defined in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_576",
    "document_id": "23501-i80",
    "chunk_id": 576,
    "text": "If dynamic PCC is deployed the SMF generates the IPv6 multi-home routing rules for a source IPv6 prefix based on the SDF Templates of those PCC rules which contain the DNAI corresponding to the newly assigned IPv6 prefix The SMF can send IPv6 multi-homed routing rules to the UE to influence the source IPv6 prefix selection in IPv6 Router Advertisement RA messages according to RFC 4191 8 at any time during the lifetime of the IPv6 multi-homed PDU Session Such messages are sent via the UPF NOTE For multiple IPv4 PDU Session and multiple IPv6 PDU Session cases routing rule based PDU Session selection is not specified in this Release of the specification 58223",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_577",
    "document_id": "23501-i80",
    "chunk_id": 577,
    "text": "The procedure of Stateless IPv6 Address Autoconfiguration If Stateless IPv6 Address Autoconfiguration is used for IPv6 address allocation to the UE after PDU Session Establishment the UE may send a Router Solicitation message to the SMF to solicit a Router Advertisement message The SMF sends a Router Advertisement message solicited or unsolicited to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_578",
    "document_id": "23501-i80",
    "chunk_id": 578,
    "text": "The Router Advertisement messages shall contain the IPv6 prefix After the UE has received the Router Advertisement message it constructs a full IPv6 address via IPv6 Stateless Address Autoconfiguration in accordance with RFC 4862 10 To ensure that the link-local address generated by the UE does not collide with the link-local address of the UPF and the SMF the SMF shall provide an interface identifier see RFC 4862 10 to the UE and the UE shall use this interface identifier to configure its link-local address For Stateless Address Autoconfiguration however the UE can choose any interface identifier to generate IPv6 addresses other than link-local without involving the network However the UE shall not use any identifiers defined in TS 23003 19 as the basis for generating the interface identifier For privacy the UE may change the interface identifier used to generate full IPv6 address as defined in TS 23221 23 without involving the network Any prefix that the SMF advertises to the UE is globally unique The SMF shall also record the relationship between the UEs identity SUPI and the allocated IPv6 prefix Because any prefix that the SMF advertises to the UE is globally unique there is no need for the UE to perform Duplicate Address Detection for any IPv6 address configured from the allocated IPv6 prefix Even if the UE does not need to use Neighbor Solicitation messages for Duplicate Address Detection the UE may for example use them to perform Neighbor Unreachability Detection towards the SMF as defined in RFC 4861 54",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_579",
    "document_id": "23501-i80",
    "chunk_id": 579,
    "text": "Therefore the SMF shall respond with a Neighbor Advertisement upon receiving a Neighbor Solicitation message from the UE In IPv6 multi-homing PDU session SMF shall not allocate an interface identifier when a new IPv6 prefix allocated corresponding to the new PDU Session Anchor The above IPv6 related messages eg Router Solicitation Router Advertisement Neighbor Solicitation Neighbor Advertisement are transferred between the SMF and UE via the UPFs If the Control Plane CIoT 5GS Optimisation is enabled for a PDU session the above IPv6 related messages are transferred between the SMF and UE via the AMF after PDU Session Establishment see clauses 43221 and 43222 of TS 23502 3 using the Mobile Terminated Data Transport in Control Plane CIoT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_580",
    "document_id": "23501-i80",
    "chunk_id": 580,
    "text": "5GS Optimisation procedures 58224 IPv6 Prefix Delegation via DHCPv6 Optionally a single network prefix shorter than the default 64 prefix may be assigned to a PDU Session In this case the 64 default prefix used for IPv6 stateless autoconfiguration will be allocated from this network prefix the remaining address space from the network prefix can be delegated to the PDU Session using prefix delegation after the PDU Session establishment and IPv6 prefix allocation via IPv6 stateless address autoconfiguration as defined in clause 58223 Depending on configuration the SMF may obtain the prefix from a locally provisioned pool from the PSA UPF or from the external DN The address space provided is maintained as an IPv6 address space pool available to the PDU Session for DHCPv6 IPv6 prefix requests with the exclusion of the IPv6 prefix that is allocated to the PDU Session during PDU Session establishment as defined in clause 58223",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_581",
    "document_id": "23501-i80",
    "chunk_id": 581,
    "text": "The total IPv6 address space available for the PDU Session UE PDU Session prefix and UE PDU Session IPv6 address space pool shall be possible to aggregate into one IPv6 prefix that will represent all IPv6 addresses that the UE may use If the UE had indicated that it supports prefix exclusion and the prefix to be delegated to the UE includes the 64 prefix that was allocated to the PDU Session the SMF shall utilise the prefix exclusion feature as specified for DHCPv6 Prefix Delegation in IETF RFC 6603 162 NOTE Support of the IPv6 prefix delegation in the SMF is assumed to be ensured by the operator eg by configuring specific DNNS-NSSAI for PDU Sessions that are used by UEs that utilize IPv6 prefix delegation The UE uses DHCPv6 to request additional IPv6 prefixes ie prefixes in addition to the default prefix from the SMF after completing stateless IPv6 address autoconfiguration procedures The UE acts as a Requesting Router as described in IETF RFC 8415 163 and inserts one or more IA_PD options into a DHCPv6 Solicit message sent from the UE to the SMF via the user plane and the UPF The SMF acts as the DHCP server and fulfils the role of a Delegating Router according to IETF RFC 8415 163",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_582",
    "document_id": "23501-i80",
    "chunk_id": 582,
    "text": "The UE optionally includes the RAPID_COMMIT option in the DHCPv6 Solicit message to trigger two-message DHCPv6 procedure instead of the four-message DHCPv6 procedure The UE shall include OPTION_PD_EXCLUDE option code in an OPTION_ORO option to indicate support for prefix exclusion In response to the DHCPv6 Solicit message the UE receives a DHCPv6 Reply message with one or more IA_PD prefixes for every IA_PD option that it sent in the DHCPv6 Solicit message The SMF delegates a prefix excluding the default prefix with help of OPTION_PD_EXCLUDE Prefix exclusion procedures shall follow IETF RFC 6603 162 For scenarios with RG connecting to 5GC additional feature for IPv6 Prefix Delegation via DHCPv6 is defined in TS 23316 84 5823 Management of CN Tunnel Info 58231 General CN Tunnel Info is the Core Network address of a N3N9 tunnel corresponding to the PDU Session It comprises the TEID and the IP address which is used by the UPF on the N3N9 tunnel for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_583",
    "document_id": "23501-i80",
    "chunk_id": 583,
    "text": "The CN Tunnel Info allocation and release is performed by the UPF The SMF shall indicate to the UPF when the UPF is required to allocaterelease CN Tunnel Info 58232 Void 58233 Management of CN Tunnel Info in the UPF The UPF shall manage the CN Tunnel Info space When a new CN Tunnel Info is needed the SMF shall request over N4 the UPF to allocate CN Tunnel Info for the applicable N3N9 reference point In response the UPF provides CN Tunnel Info to the SMF In the case of PDU Session Release or a UPF is removed from the user plane path of an existing PDU Session the SMF shall request UPF to release CN Tunnel Info for the PDU Session If the corresponding N4 Session is released the UPF releases the associated CN Tunnel Info 5824 Traffic Detection 58241 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_584",
    "document_id": "23501-i80",
    "chunk_id": 584,
    "text": "This clause describes the detection process at the UPF that identifies the packets belonging to a session or a service data flow The SMF is responsible for instructing the UP function about how to detect user data traffic belonging to a Packet Detection Rule PDR The other parameters provided within a PDR describe how the UP function shall treat a packet that matches the detection information 58242 Traffic Detection Information The SMF controls the traffic detection at the UP function by providing detection information for every PDR For IPv4 or IPv6 or IPv4v6 PDU Session type detection information is a combination of - CN tunnel info - Network instance - QFI - IP Packet Filter Set as defined in clause 5762 - Application Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_585",
    "document_id": "23501-i80",
    "chunk_id": 585,
    "text": "The Application Identifier is an index to a set of application detection rules configured in UPF - FQDN Filter for DNS Query message For Ethernet PDU Session type detection information is a combination of - CN tunnel info - Network instance - QFI - Ethernet Packet Filter Set as defined in clause 5763 In this Release of the specification for Unstructured PDU Session Type the UPF does not perform-QoS Flow level traffic detection for QoS enforcement Traffic detection information sent by the SMF to the UPF for a PDU Session may be associated with Network instance for detection and routing of traffic over N6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_586",
    "document_id": "23501-i80",
    "chunk_id": 586,
    "text": "In the case of IP PDU Session Type Network Instances can eg be used by the UPF for traffic detection and routing in the case of different IP domains or overlapping IP addresses In the case of Ethernet PDU Session Type different Network Instances can eg be configured in the UPF with different ways to handle the association between N6 and the PDU Sessions 5825 Control of User Plane Forwarding 58251 General The SMF controls user-plane packet forwarding for traffic detected by a PDR by providing a FAR with instructions to the UPF including - Forwarding operation information - Forwarding target information The details of the forwarding target and operation will depend on the scenario and is described below The following forwarding functionality is required by the UPF - Apply N3 N9 tunnel related handling ie encapsulation -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_587",
    "document_id": "23501-i80",
    "chunk_id": 587,
    "text": "Forward the traffic tofrom the SMF eg as described in Table 58252-1 - Forward the SM PDU DN Request Container from SMF to DN-AAA server - Forward the traffic according to locally configured policy for traffic steering -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_588",
    "document_id": "23501-i80",
    "chunk_id": 588,
    "text": "Forward the traffic according to N4 rules of a 5G VN group for 5G VN group communication - Forward the traffic tofrom the EASDF Data forwarding between the SMF and UPF is transmitted on the user plane tunnel established on N4 interface defined in TS 29244 65 58252 Data forwarding between the SMF and UPF Scenarios for data forwarding between the SMF and UPF are defined as below Table 58252-1 Scenarios for data forwarding between the SMF and UPF 58253 Support of Ethernet PDU Session type When configuring an UPF acting as PSA for an Ethernet PDU Session Type the SMF may instruct the UPF to route the traffic based on detected MAC addresses as follows - The UPF learns the MAC addresses connected via N6 based on the source MAC addresses of the DL traffic received on a N6 Network Instance - The UPF learns the MAC addresses of UEs and devices connected behind if any based on the source MAC address contained within the UL traffic received on a PDU Session N3N9 interface - The UPF forwards DL unicast traffic with a known destination address on a PDU Session determined based on the source MAC addresses used by the UE for the UL traffic - The UPF forwards UL unicast traffic with a known destination address on a port PDU Session or N6 interface determined based on the source MAC addresses learned beforehand -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_589",
    "document_id": "23501-i80",
    "chunk_id": 589,
    "text": "In the case of multicast and broadcast traffic if the destination MAC address is a broadcast or multicast address - for DL traffic received by UPF on a N6 Network Instance the UPF should forward the traffic to every DL PDU Session corresponding to any N4 Session associated with this Network Instance - for uplink traffic received by UPF over a PDU session on a N3N9 interface the UPF should forward the traffic to the N6 interface and downlink to every PDU session except toward the one of the incoming traffic associated with the same N6 Network Instance - for uplink and downlink unicast traffic received by UPF if the destination MAC has not been learnt the UPF should forward the traffic to every PDU session associated with the same N6 Network Instance and towards the N6 interface In any case the traffic is not replicated on the PDU Session or the N6 interface of the incoming traffic NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_590",
    "document_id": "23501-i80",
    "chunk_id": 590,
    "text": "The UPF can consider a PDU Session or a N6 interface to be active or inactive in order to avoid forwarding loops User data traffic is not sent on inactive PDU sessions or inactive N6 interface This release of the specification does not further specify how the UPF determines whether a PDU Session or N6 interface is considered active or inactive NOTE 2 This release of the specification supports only a single N6 interface in a UPF associated with the N6 Network Instance - if the traffic is received with a VLAN ID the above criteria apply only towards the N6 interface or PDU session matching the same VLAN ID unless the UPF is instructed to remove the VLAN ID in the incoming traffic NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_591",
    "document_id": "23501-i80",
    "chunk_id": 591,
    "text": "This release of the specification supports Independent VLAN Learning IVL and does not support Shared VLAN Learning SVL as described in IEEE Std 8021Q 98 - if the destination MAC address of traffic refers to the same N6 interface or PDU session on which the traffic has been received the frame shall be dropped In order to handle scenarios where a device behind a UE is moved from a source UE to a target UE a MAC address is considered as no longer associated with a UPF interface source UEs PDU session when the MAC address has not been detected as Source MAC address in UL traffic for a pre-defined period of time or the MAC address has been detected under a different interface target UEs PDU Session or N6 NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_592",
    "document_id": "23501-i80",
    "chunk_id": 592,
    "text": "The UPFNW-TT may also be provided with static filtering entries as described in clause 5283 How the UPF uses the static filtering entry to achieve forwarding of Ethernet frames to one or more egress ports is up to UPF implementation The externally observable behaviour of 5GS Bridge needs to comply with IEEE Std 8021Q 98",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_593",
    "document_id": "23501-i80",
    "chunk_id": 593,
    "text": "For ARPIPv6 Neighbour Solicitation traffic a SMFs request to respond to ARPIPv6 Neighbour Solicitation based on local cache information or to redirect such traffic from the UPF to the SMF overrules the traffic forwarding rules described above NOTE 5 Local policies in UPF associated with the Network Instance can prevent local traffic switching in the UPF between PDU Sessions either for unicast traffic only or for any traffic In the case where UPF policies prevent local traffic switching for any traffic thus for broadcastmulticast traffic some mechanism such as responding to ARPND based on local cache information or local multicast group handling is needed to ensure that upper layer protocol can run on the Ethernet PDU sessions The SMF may ask to get notified with the source MAC addresses used by the UE eg if the PCF has subscribed to UE MAC address change notifications as described in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_594",
    "document_id": "23501-i80",
    "chunk_id": 594,
    "text": "In order to request the UPF to act as defined above the SMF may for each PDU Session corresponding to a Network Instance set an Ethernet PDU Session Information in a DL PDR that identifies all DL Ethernet packets matching the PDU session Alternatively for unicast traffic the SMF may provide UPF with dedicated forwarding rules related with MAC addresses notified by the UPF 5826 Charging and Usage Monitoring Handling 58261 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_595",
    "document_id": "23501-i80",
    "chunk_id": 595,
    "text": "The SMF shall support interfaces towards CHF and PCF The SMF interacts with CHF and PCF based on information received from other control plane NFs and user plane related information received from the UPF QoS Flow level PDU Session level and subscriber related information remain at the SMF and only usage information is requested from the UPF 58262 Activation of Usage Reporting in UPF Triggered by the PCC rules received from the PCF or preconfigured information available at SMF as well as from the CHF for online charging method via quota management mechanisms the SMF shall provide Usage Reporting Rules to the UPF for controlling how usage reporting is performed The SMF shall request the report of the relevant usage information for Usage Monitoring based on Monitoring Keys and triggers which are specified in TS 23503 45 Each Usage Reporting Rule requested for usage monitoring control is associated with the PDRs whose traffic is to be accounted under this rule The SMF shall generate the Usage Reporting Rule for each Monitoring-key within the active PCC Rules either preconfigured or received from the PCF and also shall keep the mapping between them Multiple Usage Reporting Rules may be associated with the same PDR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_596",
    "document_id": "23501-i80",
    "chunk_id": 596,
    "text": "The SMF shall request the report of the relevant usage information for offline and online charging based on Charging keys and additional triggers which are specified in TS 32255 68 Each Usage Reporting Rule requested for offline or online charging is associated with the PDRs whose traffic is to be accounted under this rule The SMF shall generate the Usage Reporting Rule for each Charging key and Sponsor Identity if applicable within the active PCC Rules either preconfigured or received from the PCF and also shall keep the mapping between them Multiple Usage Reporting Rules may be associated with the same PDR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_597",
    "document_id": "23501-i80",
    "chunk_id": 597,
    "text": "The SMF function shall also provide reporting trigger events to the UPF for when to report usage information The reporting trigger events eg triggers threshold information etc shall be supported for the PDU Session level reporting as well as on Rule level basis as determined by the SMF The triggers may be provided as a volume time or event to cater for the different chargingusage monitoring models supported by the TS 23503 45 for usage monitoring and by TS 32255 68 for converged offline and online charging The SMF shall decide on the thresholds values based on allowance received from PCF CHF or based on local configuration Other parameters for instructing the UPF to report usage information are defined in TS 29244 65 When the PCC Rule attribute Service Data flow handling while requesting credit specified in TS 23503 45 indicates non-blocking the SMF shall request the report of the relevant usage information for the Charging key and Sponsor Identity if applicable and provide a default threshold value to the UPF while waiting for the quota from the CHF In some cases the same Usage Reporting Rule can be used for different purposes for both usage monitoring and charging eg in the case that the same set of PDRs measurement method trigger event threshold etc apply Similarly a reported measurement can be used for different purposes by the SMF 58263 Reporting of Usage Information towards SMF The UPF shall support reporting of usage information to the SMF The UPF shall be capable to support reporting based on different triggers including - Periodic reporting with period defined by the SMF - Usage thresholds provided by the SMF - Report on demand received from the SMF The SMF shall make sure that the multiple granularity levels required by the reporting keys in the Usage Reporting rules satisfy the following aggregation levels without requiring a knowledge of the granularity levels by the UPF - PDU Session level reporting - Traffic flow for both charging and usage monitoring level reporting as defined by the reporting keys in the Usage Reporting Rule see the description above Based on the mapping between Monitoring key and PCC rule stored at the SMF the SMF shall combine the reported information with session and subscriber related information which is available at the SMF for Usage Monitoring reporting over the corresponding Npcf interface N7 reference point Based on the mapping between Charging key and Sponsor Identity if applicable and PCC rule stored at the SMF the SMF shall combine the reported information with session and subscriber related information which is available at the SMF for offline and online charging reporting over the corresponding charging interfaces This functionality is specified in TS 32255 68",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_598",
    "document_id": "23501-i80",
    "chunk_id": 598,
    "text": "The usage information shall be collected in the UPF and reported to the SMF as defined in 5826 based on Monitoring Keys and triggers which are specified in TS 23503 45 5827 PDU Session and QoS Flow Policing ARP is used for admission control ie retention and pre-emption of the new QoS Flow The value of ARP is not required to be provided to the UPF For every QoS Flow the SMF shall determine the transport level packet marking value eg the DSCP in the outer IP header based on the 5QI the Priority Level if explicitly signalled and optionally the ARP priority level and provide the transport level packet marking value to the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_599",
    "document_id": "23501-i80",
    "chunk_id": 599,
    "text": "The SMF shall provide the Session-AMBR values of the PDU Session to the UPF so that the UPF can enforce the Session-AMBR of the PDU Session across all Non-GBR QoS Flows of the PDU Session SMF shall provide the GFBR and MFBR value for each GBR QoS Flow of the PDU Session to the UPF SMF may also provide the Averaging window to the UPF if Averaging window is not configured at the UPF or if it is different from the default value configured at the UPF SMF may decide to activate ECN marking for L4S by PSA UPF for the QoS Flow see clause 537 In this case the SMF shall send an ECN marking for L4S indicator to PSA UPF 5828 PCC Related Functions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_600",
    "document_id": "23501-i80",
    "chunk_id": 600,
    "text": "58281 ActivationDeactivation of predefined PCC rules A predefined PCC rule is configured in the SMF The traffic detection filters eg IP Packet Filter required in the UP function can be configured either in the SMF and provided to the UPF as service data flow filters or be configured in the UPF as the application detection filter identified by an application identifier For the latter case the application identifier has to be configured in the SMF and the UPF The traffic steering policy information can be only configured in the UPF together with traffic steering policy identifiers while the SMF has to be configured with the traffic steering policy identifiers Policies for traffic handling in the UPF which are referred by some identifiers corresponding to the parameters of a PCC rule can be configured in the UPF These traffic handling policies are configured as predefined QERs FARs and URRs When a predefined PCC rule is activateddeactivated by the PCF SMF shall decide what information has to be provided to the UPF to enforce the rule based on where the traffic detection filters ie service data flow filters or application detection filter traffic steering policy information and the policies used for the traffic handling in the UPF are configured and where they are enforced - If the predefined PCC rule contains an application identifier for which corresponding application detection filters are configured in the UPF the SMF shall provide a corresponding application identifier to the UPF - If the predefined PCC rule contains traffic steering policy identifiers the SMF shall provide a corresponding traffic steering policy identifiers to the UPF - If the predefined PCC rule contains service data flow filters the SMF shall provide them to the UPF - If the predefined PCC rule contains some parameters for which corresponding policies for traffic handling in the UPF are configured in the UPF the SMF shall activate those traffic handling policies via their rule IDs The SMF shall maintain the mapping between a PCC rule received over Npcf and the flow level PDR rules used on N4 interface 58282 Enforcement of Dynamic PCC Rules",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_601",
    "document_id": "23501-i80",
    "chunk_id": 601,
    "text": "The application detection filters required in the UPF can be configured either in the SMF and provided to the UPF as the service data flow filter or be configured in the UP function identified by an application identifier When receiving a dynamic PCC rule from the PCF which contains an application identifier andor parameters for traffic handling in the UPF - if the application detection filter is configured in the SMF the SMF shall provide it in the service data flow filter to the UPF as well as parameters for traffic handling in the UPF received from the dynamic PCC rule - otherwise the application detection filters is configured in UPF the SMF shall provide to UPF with the application identifier and the parameters for traffic handling in the UPF as required based on the dynamic PCC rule The SMF shall maintain the mapping between a PCC rule received over Npcf and the flow level PDRs used on N4 interface 58283 Redirection",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_602",
    "document_id": "23501-i80",
    "chunk_id": 602,
    "text": "The uplink applications traffic redirection may be enforced either in the SMF as specified in 5825 Control of user plane forwarding or directly in the UPF The redirect destination may be provided in the dynamic PCC rule or be preconfigured either in the SMF or in the UPF When receiving redirect information redirection enableddisabled and redirect destination within a dynamic PCC rule or being activateddeactivated by the PCF for the predefined redirection policies SMF shall decide whether to provide and what information to be provided to the UPF based on where the redirection is enforced and where the redirect destination is acquiredpreconfigured When redirection is enforced in the UPF and the redirect destination is acquired from the dynamic PCC rule or is configured in the SMF SMF shall provide the redirect destination to the UPF When redirection is enforced in the SMF SMF shall instruct the UPF to forward applicable user plane traffic to the SMF 58284 Support of PFD Management",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_603",
    "document_id": "23501-i80",
    "chunk_id": 603,
    "text": "The NEF PFDF shall provide PFDs to the SMF on the request of SMF pull mode or on the request of PFD management from NEF push mode as described in TS 23503 45 In addition the NEF PFDF may subscribe to NWDAF to be notified or request to get PFD Determination analytics for known applications as specified in TS 23288 86 and may decide whether to create update or delete PFDs based on the NWDAF analytics as specified in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_604",
    "document_id": "23501-i80",
    "chunk_id": 604,
    "text": "The SMF shall provide the PFDs to the UPF which have active PDRs with the application identifier corresponding to the PFDs The SMF supports the procedures in clause 4435 of TS 23502 3 for management of PFDs PFDs is cached in the SMF and the SMF maintains a caching timer associated to the PFDs When the caching timer expires and theres no active PCC rule that refers to the corresponding application identifier the SMF informs the UPF to remove the PFDs identified by the application identifier using the PFD management message When a PDR is provided for an application identifier corresponding to the PFDs that are not already provided to the UPF the SMF shall provide the PFDs to the UPF if there are no PFDs cached the SMF retrieves them from the NEF PFDF as specified in TS 23503 45 When any update of the PFDs is received from NEF PFDF by SMF using push or pull mode and there are still active PDRs in UPF for the application identifier the SMF shall provision the updated PFD set corresponding to the application identifier to the UPF using the PFD management message NOTE 1 SMF can assure not to overload N4 signalling while managing PFDs to the UPF eg forwarding the PFDs to the right UPF where the PFDs is enforced When the UPF receives the updated PFDs from either the same or different SMF for the same application identifier the latest received PFDs shall overwrite any existing PFDs stored in the UPF NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_605",
    "document_id": "23501-i80",
    "chunk_id": 605,
    "text": "For the case a single UPF is controlled by multiple SMFs the conflict of PFDs corresponding to the same application identifier provided by different SMF can be avoided by operator enforcing a well-planned NEF PFDF and SMFUPF deployment When a PFD is removedmodified and this PFD was used to detect application traffic related to an application identifier in a PDR of an N4 session and the UPF has reported the application start to the SMF as defined in clause 4422 of TS 23502 3 for the application instance corresponding to this PFD the UPF shall report the application stop to the SMF for the corresponding application instance identifier if the removedmodified PFD in UPF results in that the stop of the application instance is not being able to be detected If the PFDs are managed by local OM procedures PFD retrieval is not used otherwise the PFDs retrieved from NEF PFDF override any PFDs pre-configured in the SMF When all the PFDs retrieved from the NEF PFDF for an application identifier are removed the pre-configured PFDs are used The SMF shall provide either the PFDs retrieved from NEF PFDF or the pre-configured PFDs for an application identifier to the UPF 5829 Functionality of Sending of End marker",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_606",
    "document_id": "23501-i80",
    "chunk_id": 606,
    "text": "58290 Introduction Sending of end marker is a functionality which involve SMF and UPF in order to assist the reordering function in the Target RAN As part of the functionality constructing of end marker packets can either be done in the SMF or in the UPF as described in clauses 58291 and 58292 Whether constructing of end marker packets is performed by SMF or UPF is determined by network configuration 58291",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_607",
    "document_id": "23501-i80",
    "chunk_id": 607,
    "text": "UPF Constructing the End marker Packets In the case of inter NG-RAN Handover procedure without UPF change SMF shall indicate the UPF to switch the N3 paths by sending an N4 Session Modification Request message with the new AN Tunnel Info of NG RAN and in addition provide an indication to the UPF to send the end marker packets on the old N3 user plane path On receiving this indication the UPF shall construct end marker packets and send it for each N3 GTP-U tunnel towards the source NG RAN after sending the last PDU on the old path In the case of inter NG-RAN Handover procedure with change of the UPF terminating N3 the SMF shall request the UPF with N9 reference point to the UPF terminating N3 to switch the N9 user plane paths by sending an N4 Session Modification Request message N4 session ID new CN Tunnel Info of the UPF terminating N3 and in addition provide an indication to this UPF to send the end marker packets on the old path On receiving this indication the UPF shall construct end marker packets and send it for each N9 GTP-U tunnel towards the source UPF after sending the last PDU on the old path On receiving the end marker packets on N9 GTP-U tunnel source UPF shall forward the end marker packets and send it for each N3 GTP-U tunnel towards the source NG RAN 58292 SMF Constructing the End marker Packets UPF referred in this clause is the UPF terminates N3 reference point",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_608",
    "document_id": "23501-i80",
    "chunk_id": 608,
    "text": "It is assumed that the PDU Session for the UE comprises of an UPF that acts as a PDU Session Anchor and an intermediate UPF terminating N3 reference point at the time of this Handover procedure In the case of inter NG-RAN Handover procedure without UPF change SMF shall indicate the UPF to switch the N3 paths by sending an N4 Session Modification Request message N4 session ID new AN Tunnel Info of NG RAN After sending the last PDU on the old path UPF shall replace the old AN Tunnel Info with the new one and responds with an N4 Session Modification Response message to acknowledge the success of path switch When the path switch is finished SMF constructs the end marker packets and sends it to the UPF UPF then forwards the packets to the source NG RAN In the case of inter NG-RAN Handover procedure with UPF change SMF shall indicate the PSA UPF to switch the N9 user plane paths by sending an N4 Session Modification Request message N4 session ID new CN Tunnel Info of UPF After sending the last PDU on the old N9 path PSA UPF shall replace the old CN Tunnel Info with the new one and responds with an N4 Session Modification Response message to acknowledge the success of path switch When the path switch is finished SMF constructs the end marker packets and sends it to PSA UPF PSA UPF then forwards the packets to the source UPF 58210 UP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_609",
    "document_id": "23501-i80",
    "chunk_id": 609,
    "text": "Tunnel Management 5GC shall support per PDU Session tunnelling on N3 between RAN and UPF and N9 between UPFs If there exist more than one UPF involved for the PDU Session any tunnels between UPFs eg in the case of two UPFs between the UPF that is an N3 terminating point and the UPF for PDU Session Anchor remains established when a UE enters CM-IDLE state In the case of downlink data buffering by UPF when mobile terminated MT traffic arrives at the PDU Session Anchor UPF it is forwarded to the UPF which buffer the data packet via N9 tunnel See clause 583 for more details on UPF buffering In the case of Home Routed roaming the SMF in HPLMN is not aware of the UP activation state of a PDU Session When the UP connection of the PDU Session is deactivated the SMF may release the UPF of N3 terminating point In that case the UPF eg the Branching PointUL CL or PDU Session Anchor connecting to the released UPF of N3 terminating point will buffer the DL packets Otherwise when the UPF with the N3 connection is not released this UPF will buffer the DL packets When the UP connection of the PDU Session is activated due to a down-link data arrived and a new UPF is allocated to terminate the N3 connection a data forwarding tunnel between the UPF that has buffered packets and the newly allocated UPF is established so that the buffered data packets are transferred from the old UPF that has buffered packets to the newly allocated UPF via the data forwarding tunnel For a PDU Session whose the UP connection is deactivated and the SMF has subscribed the location change notification when the SMF is notified of UEs new location from the AMF and detects that the UE has moved out of the service area of the existing intermediate UPF the SMF may decide to maintain the intermediate UPF remove the established tunnel between UPFs in the case of removal of the intermediate UPF or reallocate the tunnel between UPFs in the case of reallocation of the intermediate UPF 58211 Parameters for N4 session management moved The parameters used by SMF to control the functionality of the UPF as well as to inform SMF about events occurring at the UPF are described in clause 585 58212 Reporting of the UE MAC addresses used in a PDU Session For Ethernet PDU Session type the SMF may control the UPF to report the different MAC Ethernet addresses used as source address of frames sent UL by the UE in a PDU Session These MAC addresses are called UE MAC addresses This control and the corresponding reporting takes place over N4 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_610",
    "document_id": "23501-i80",
    "chunk_id": 610,
    "text": "This is eg used to support reporting of all UE MAC addresses in a PDU Session to the PCF as described in clause 56102 The UPF reports the removal of a UE MAC address based on the detection of absence of traffic during an inactivity time The inactivity time value is provided by the SMF to the UPF 58213 Support for 5G VN group communication 582130 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_611",
    "document_id": "23501-i80",
    "chunk_id": 611,
    "text": "The SMF may configure the UPFs to apply different traffic forwarding methods to route traffic between PDU Sessions for a single 5G VN group For example depending on the destination address some packet flows may be forwarded locally while other packet flows are forwarded via N19 and other packet flows are forwarded to N6 If a single SMF serves the DNNS-NSSAI of the 5G VN group the UPF local switching N6-based forwarding and N19-based forwarding methods described in clause 5294 are coordinated by the SMF If an SMF set serves the DNNS-NSSAI of the 5G VN group implementation based mechanisms can be used between SMFs that are part of the SMF set for controlling the connectivity between the PSA UPFs of the UE members of the 5G VN group When a 5G VN group communication is extended in a wide area bigger than the service area of any SMF set serving the DNNS-NSSAI of the 5G VN group multiple SMF sets might control the PDU Sessions of the UE members of the 5G VN group In this case N6N19 connectivity between PSA UPFs of the UE members of the 5G VN group controlled by different SMF sets is achieved via OAM configuration As a deployment option a subset of the UPFs controlled by an SMF Set may be configured with the N6N19 connectivity to enable 5G VN group communication across SMF Sets N6 connectivity between PSA UPFs via a DN may also exist 5G VN group communication includes one to one communication and one to many communication One to one communication supports forwarding of unicast traffic between two UEs within a 5G VN or between a UE and a device on the DN One to many communication supports forwarding of multicast traffic and broadcast traffic from one UE or device on the DN to manyall UEs within a 5G VN and devices on the DN Traffic forwarding within the 5G VN group is realized by using a UPF internal interface 5G VN internal and a two-step detection and forwarding process In the first step the packets received from any 5G VN group member via its PDU Session via N6 or via N19 are forwarded to the UPF internal interface ie Destination Interface set to 5G VN internal In the second step PDRs installed at the UPF internal interface ie Source Interface set to 5G VN internal detect the packet and forward it to the respective 5G VN group member via its PDU Session via N6 or via N19",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_612",
    "document_id": "23501-i80",
    "chunk_id": 612,
    "text": "The details of the PDR and FAR configuration are described in the following clauses For UEs belonging to the same 5G VN group and having PDU Sessions that correspond to N4 Sessions in the same PSA UPF the following applies for traffic that is sent from one of these UEs to another one of these UEs using local switching The incoming traffic for one PDU Session will match the corresponding N4 Sessions PDRs of the source PDU Session based on GTP-U header information The traffic is then sent back to classification in that UPF via the internal interface and will match another N4 Session corresponding to the destination PDU Session based on destination address in the PDU The PDU is then forwarded to the target UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_613",
    "document_id": "23501-i80",
    "chunk_id": 613,
    "text": "If 5G VN group members PDU Sessions are served by different PSA UPFs and N19-based forwarding is applied the SMF creates a group-level N4 Session with each involved UPF to enable N19-based forwarding and N6-based forwarding When the traffic is then sent back to classification in that UPF via the internal interface it may match group-level N4 Session corresponding to the 5G VN group based on destination address in the PDU or a default PDR rule with match-all packet filter The PDU is then forwarded to N6 or to the UPF indicated in the group-level N4 Session via corresponding N19 tunnel This enables the PDU to be sent to the target group member in the other UPF or to the device in the DN In the case of N19-based forwarding is not applied for a 5G VN group group level N4 session is not required If more than one 5G VN group has to be supported in the PLMN the N4 rule attribute Network Instance is used in addition to the UPF internal interface and set to a value representing the 5G VN group This keeps the traffic of different 5G VN groups separate from each other and thus enables isolation of the 5G VN group communication during the packet detection and forwarding process The SMF shall provide the PDRs and FARs related to the UPF internal interface as follows whenever more than one 5G VN group has to be supported in the PLMN - The FAR with Destination Interface set to 5G VN internal shall also contain the Network Instance set to the value representing the 5G VN group - The PDR with Source Interface set to 5G VN internal shall also contain the Network Instance set to the value representing the 5G VN group Forwarding Ethernet unicast traffic towards the PDU Session corresponding to the Destination MAC address of an Ethernet frame may correspond - either to the SMF explicitly configuring DL PDRs with the MAC addresses detected by the UPF on PDU Sessions and reported to the SMF this is further described in clause 582131 - or to the SMF relying on MAC address learning in UPF as defined in clause 58253 To request this UPF behaviour the SMF sets the Ethernet PDU Session Information indication in the DL PDR of the 5G VN internal interface related with a 5G VN group This may apply in the case that all PDU Sessions related with this 5G VN group are served by the same PSA or by multiple PSAs not inter-connected via N19",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_614",
    "document_id": "23501-i80",
    "chunk_id": 614,
    "text": "For Ethernet traffic on 5G-VN in the former case above where SMF explicitly configures DL PDR with the MAC addresses detected on PDU Sessions supporting a 5G VN group the SMF acts as a central controller which is responsible for setting up the forwarding rules in the UPFs so that it avoids forwarding loops The SMF becomes aware of the MAC addresses in use within a 5G VN group by the UPFs reporting of the MAC addresses The SMF is responsible to react to topology changes in the Ethernet network Local switching without SMF involvement is not specified for a 5G-VN when different PDU Sessions related with this 5G VN group may be served by different PSAs connected over N19 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_615",
    "document_id": "23501-i80",
    "chunk_id": 615,
    "text": "The mechanisms described above implies signalling on N4 Sessions related with a VN group each time a new MAC address is detected as used or no more used within a PDU Session related with this 5G VN group Hence the usage of the solution with SMF explicitly configuring DL PDR with the MAC addresses defined in this release can raise signalling scalability issues for large VN groups with lots of devices MAC addresses served by PDU sessions related with this VN group 582131 Support for unicast traffic forwarding of a 5G VN To enable unicast traffic forwarding in a UPF the following applies - The SMF provides for each 5G VN group members N4 Session ie N4 Session corresponding to PDU Session the following N4 rules that enable the processing of packets received from this UE - in order to detect the traffic a PDR containing Source Interface set to access side and CN Tunnel Information set to PDU Session tunnel header ie N3 or N9 GTP-U F-TEID and - in order to forward the traffic a FAR containing Destination Interface set to 5G VN internal -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_616",
    "document_id": "23501-i80",
    "chunk_id": 616,
    "text": "The SMF provides for each 5G VN group members N4 Session ie N4 session corresponding to PDU Session the following N4 rules that enable the processing of packets towards this UE - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal and Destination Address set to the IPMAC address es of this 5G VN group member and - in order to forward the traffic a FAR containing Outer Header Creation indicating the N3N9 tunnel information and Destination Interface set access side - If N19-based forwarding is applied the SMF configures the group-level N4 Session for processing packets received from a N19 tunnel with the following N4 rules for each N19 tunnel - in order to detect the traffic a PDR containing Source Interface set to core side and CN Tunnel Information set to N19 tunnel header ie N19 GTP-U F-TEID and - in order to forward the traffic a FAR containing Destination Interface set to 5G VN internal - If N19-based forwarding is applied the SMF configures the group-level N4 Session for processing packets towards 5G VN group members anchored at other UPFs with the following N4 rules for each N19 tunnel - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal and Destination Address set to the IPMAC address es of UEs anchored at the peer UPF of this N19 tunnel eg based on the IP address range supported by the peer UPF and - in order to forward the traffic to a 5G VN group member anchored at another UPF via the N19 tunnel a FAR containing Outer Header Creation indicating the N19 tunnel information Destination Interface set to core side - The SMF configures the group-level N4 Session for processing packets received from a 5G VN group member connected via N6 with the following N4 rules - in order to detect the traffic a PDR containing Source Interface set to core side and Source Address set to the IPMAC address es of this 5G VN group member and - in order to forward the traffic a FAR containing Destination Interface set to 5G VN internal - The SMF configures the group-level N4 Session for processing packets towards a 5G VN group member connected via N6 or packets towards a device residing in DN with the following N4 rules - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal and Destination Address set to the IPMAC address es of this 5G VN group member and - in order to forward the traffic to the 5G VN group member or device via N6 a FAR containing Destination Interface set to core side -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_617",
    "document_id": "23501-i80",
    "chunk_id": 617,
    "text": "The SMF shall update N4 rules for group-level N4 Session to enable correct forwarding of packets towards UE whos PSA UPF has been reallocated and address is unchanged - The SMF may also configure the following N4 rules for the group-level N4 Session to process packets with an unknown destination address - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal a match-all Packet Filter and a Precedence set to the lowest precedence value and - in order to process the traffic a FAR containing Destination Interface set to core side to route the traffic via N6 by default or in the case of local SMF configuration that N6-based forwarding is not applied a FAR instructing the UPF to drop the traffic 582132 Support for unicast traffic forwarding update due to UE mobility To enable the service continuity when the PSA UPF serving the UE changed the following applies - Keep the UE address unchanged if N6-based forwarding is not used - Configure the UEs N4 Session with N4 rules PDR FAR to detect and forward the traffic to this UE via its PDU Session tunnelie N3 tunnel on the target PSA UPF - If N19-based forwarding is applied To switch the traffic towards this UE from the source PSA UPF to the target PSA UPF for N19-based forwarding the SMF deletes the N4 rule PDR that detects the traffic towards this UE in the group-level N4 Session at UPFs involved in the 5G VN group except the source PSA UPF then adds or updates the PDR that detects the traffic towards this UE with the FAR containing the N19 tunnel information of the target PSA UPF in the group-level N4 Session at UPFs involved in the 5G VN group except the target PSA UPF 582133 Support for user plane traffic replication in a 5G VN 5821331 User plane traffic replication based on UPF internal functionality For Ethernet PDU Sessions the SMF may instruct the UPF to route traffic to be replicated as described in clause 5825",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_618",
    "document_id": "23501-i80",
    "chunk_id": 618,
    "text": "For IP PDU Session types the SMF may instruct the UPF to manage IP multicast traffic as described in clauses 466 and 771 of TS 23316 84",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_619",
    "document_id": "23501-i80",
    "chunk_id": 619,
    "text": "The UPF replicates the IP multicast traffic received from PDU Sessions or N6 interface and sends the packets over other PDU Sessions and other N6 interface subscribed to the IP Multicast groups Mechanisms described in clauses 466 and 771 of TS 23316 84 apply to support 5G VN group communication with following clarifications - These mechanisms are not limited to Wireline access and can apply on any access - IP Multicast traffic allowed for a PDU Session is not meant for IPTV services reachable over N6 - IGMP MLD signalling does not relate with STB or 5G-RG Clauses 466 and 771 of TS 23316 84 apply to UE members of a 5G VN group instead of 5G-RG and - Clauses 77112 and 77114 of TS 23316 84 are not applicable to 5G VN groups members of the 5G VN groups may receive any multicast traffic associated with the DNN S-NSSAI of the 5G VN group - UPF exchange of signalling such as PIM Protocol-Independent Multicast may apply as defined in TS 23316 with following clarification - PIM signalling is generally exchanged over N6 but may be sent towards the PDU Session supporting the source address of multicast traffic identified by IGMP MLD signalling for Source Specific Multicast",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_620",
    "document_id": "23501-i80",
    "chunk_id": 620,
    "text": "In the case of IGMP MLD signalling not related with Source Specific Multicast no PIM signalling is sent towards any PDU Session 5821332 User plane traffic replication based on PDRs with replication instructions Alternatively for IP or Ethernet type data communication the SMF instructs the UPF via PDRs and FARs how to replicate user plane traffic The mechanism is supported in the following conditions - When N19 is used there is a full mesh of N19 tunnels between UPFs controlled by each SMF Set serving the 5G VN group - There is no support for forwarding a broadcastmulticast packet with source address not known to SMFUPF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_621",
    "document_id": "23501-i80",
    "chunk_id": 621,
    "text": "Each UPF supports one N6 interface instance towards the data network or only supports N19-based forwarding without N6 - Multicast group formation of selected members of a 5G VN for Ethernet type data communication is not described in this release of the specification In this case when the UPF receives a broadcast packet of a 5G VN group from N19 or N6 it shall distribute it to all 5G VN group members connected to this UPF When the UPF receives a broadcast packet from a UE source UE via PDU Session associated with a 5G VN group it shall distribute it to - All 5G VN group members except the source UE connected to this UPF via local switch and - All 5G VN group members connected to other UPFs via N19-based forwarding or N6-based forwarding and - The devices on the DN via N6-based forwarding To enable broadcast traffic forwarding of a 5G VN group in a UPF the following applies - The SMF provides group-level N4 Session and each 5G VN group member N4 Session with the PDR that detect the broadcast packet sent via internal interface When UPF receives the broadcast packets sent via internal interface it matches the broadcast packet against all PDRs installed at the internal interface A successful matching with a PDR that detect the broadcast packet instructs the UPF to continue the lookup of the other PDRs A matching PDR that detects the broadcast packet shall instruct the UPF to duplicate the broadcast packet and perform processing using associated FAR URR QER on the copy instead of the original packet if the broadcast packet does not satisfy the packet replication skip information otherwise the PDR instructs the UPF to skip the processing of the broadcast packet - The broadcast packets received from N19 or N6 are forwarded to the UPF internal interface together with a N19 or N6 indication -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_622",
    "document_id": "23501-i80",
    "chunk_id": 622,
    "text": "The SMF provides for each 5G VN group member N4 Session ie N4 session corresponding to PDU Session the following N4 rules that enable the processing of broadcast packets towards this UE - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal Destination Address set to the broadcast address the Packet replication skip information set to the IPMAC address es of this 5G VN group member and the indication to carry on matching and - in order to forward the traffic a FAR containing Outer Header Creation indicating the PDU Session tunnel information and Destination Interface set access side - The SMF configures the group-level N4 Session for processing packets received from a N19 tunnel with the following N4 rules for each N19 tunnel - in order to detect the traffic a PDR containing Source Interface set to core side Destination Address set to the broadcast address and CN Tunnel Information set to N19 tunnel header ie N19 GTP-U TEID and - in order to forward the traffic a FAR containing Destination Interface set to 5G VN internal Outer Header Creation with the N19 indication -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_623",
    "document_id": "23501-i80",
    "chunk_id": 623,
    "text": "The SMF provides for the group-level N4 Session the following N4 rules that enable the processing of broadcast packets towards the other UPFs - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal Destination Address set to the broadcast address the Packet replication skip information set to the N19 indication and the indication to carry on matching and - in order to forward the traffic to each involved UPF via the corresponding N19 tunnel a FAR containing Duplication instruction Outer Header Creation indicating the N19 tunnel information Destination Interface set to core side - The SMF configures the group-level N4 Session for processing packets received from N6 with the following N4 rules - in order to detect the traffic a PDR containing Source Interface set to core side and Destination Address set to the broadcast address and - in order to forward the traffic a FAR containing Destination Interface set to 5G VN internal Outer Header Creation with the N6 indication -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_624",
    "document_id": "23501-i80",
    "chunk_id": 624,
    "text": "The SMF provides for the group-level N4 Session the following N4 rules that enable the processing of broadcast packets towards N6 - in order to detect the traffic a PDR containing Source Interface set to 5G VN internal and Destination Address set to the broadcast address and the Packet replication skip information set to the N6 indication and - in order to forward the traffic to N6 a FAR containing Destination Interface set to core side In this case to enable multicast traffic forwarding of a 5G VN group in a UPF broadcast traffic forwarding of a 5G VN applies to multicast traffic forwarding of a 5G VN with the following modifications - The SMF installs PDRs for the multicast address instead of the broadcast address - The PDRs and FARs are installed for PDU Sessions corresponding to the members of the multicast group -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_625",
    "document_id": "23501-i80",
    "chunk_id": 625,
    "text": "In addition the SMF installs the PDR identifying IGMPMLD signalling for each 5G VN group member N4 Session and a URR with a Reporting Trigger set to IGMP reporting for IGMP or set to MLD reporting for MLD Based on the IP Multicast address in IP multicast join or IP multicast leave reports received from UPF the SMF manipulates delete or add the PDR identifying the multicast traffic for the reported IP Multicast address at the corresponding 5G VN group member N4 Session and if required at the group-level N4 Session at the UPFs of the 5G VN group 58214 Inter PLMN User Plane Security functionality Operators can deploy UPFs supporting the Inter PLMN User Plane Security IPUPS functionality at the border of their network to protect their networks from invalid inter PLMN N9 traffic The IPUPS functionality forwards GTP-U packets received via the N9 interface only if they belong to an active PDU Session and are not malformed as described in TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_626",
    "document_id": "23501-i80",
    "chunk_id": 626,
    "text": "The SMF can activate the IPUPS functionality together with other UP functionality in the same UPF or insert a separate UPF in the UP path for the IPUPS functionality In both cases the UPF with IPUPS functionality is controlled by the SMF via the N4 interface 58215 Void 58216 Support for L2TP tunnelling on N6 If requested by the SMF during N4 Session Establishment the UPF PSA may setup L2TP towards an L2TP network server LNS in the DN and tunnel the PDU Session user plane traffic in this L2TP tunnel In this case the UPF acts as a L2TP access concentrator LAC To enable this the SMF may provide L2TP information to the UPF such as LNS IP address andor LNS host name as described in TS 29244 65 This L2TP information may be configured on the SMF as part of the DNN configuration or received from the DN-AAA Server during secondary authenticationauthorization as described in clause 566",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_627",
    "document_id": "23501-i80",
    "chunk_id": 627,
    "text": "Alternatively the L2TP tunnel parameters may be configured in the UPF Function The L2TP tunnel parameters include necessary parameters for setting up L2TP tunnel towards the LNS eg LNS address tunnel password etc In addition the SMF may provide PAPCHAP authentication information to the UPF for use in L2TP session establishment in case it was received from the UE in the PDU Session Establishment Request When L2TP is to be used for a PDU Session the SMF may select a UPF based upon support of this feature The SMF determines whether the UPF supports this feature via N4 capability negotiation during N4 Association Setup or via NRF discovery If SMF requests the UPF to allocate UE IP address as described in clause 58221 the UPF LAC may retrieve this IP address from the LNS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_628",
    "document_id": "23501-i80",
    "chunk_id": 628,
    "text": "In addition if the SMF requests the UPF to provide DNS addresses the UPF LAC may request the LNS to provide DNS addresses and report such DNS addresses to the SMF 58217 Data exposure via Service Based interface The UPF may expose information by means of UPF Event Exposure service as described in TS 23502 3 clause 52262 via a service-based interface directly The NF consumers which may receive UPF event notifications are AFNEF TSNAFTSCTSF and NWDAFDCCFMFAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_629",
    "document_id": "23501-i80",
    "chunk_id": 629,
    "text": "When the UPF supports the data exposure via the service based interface it may register its NF profile to the NRF including the UPF Event Exposure services and the related Event IDs For data collection from UPF see clause 41545 of TS 23502 3 NF consumers can do the subscription to the UPF either directly or indirectly via SMF An NF consumer may subscribe to the UPF Event Exposure service directly only for data collected for any UE eg to collect user data usage information for NWDAF NF Load analytics see clause 65 of TS 23288 86 and if the subscription is not including any of the following parameters AoI BSSIDSSID and DNAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_630",
    "document_id": "23501-i80",
    "chunk_id": 630,
    "text": "Otherwise the NF consumer shall subscribe indirectly via SMF To alleviate the load of UPF due to frequent event notification for data collection related events the event subscription may include Reporting suggestion information The Reporting suggestion information includes Report urgency and Reporting window information Reporting urgency information represents whether this event report can be delay tolerant ie the event report can be delayed If the Reporting urgency information indicates delay tolerant the Reporting window is also provided which defines the last valid reporting time and UPF shall report the event before that time If the Reporting suggestion information allows this the UPF can concatenate several event reports of the same event to the same notification endpoint into one notification message The UPF may also expose UE information by means of the Nupf_GetUEPrivateIPaddrAndIdentifiers service as described in TS 23502 3 clause 52263 An UPF which is deployed with NAPT Network Address Port Translation functionality may support to provide the 5GC UE IP address to NEF based on NEF request containing public IP address and port number using the Nupf_GetUEPrivateIPaddrAndIdentifiers service as described in clause 41510 of TS 23502 3 for AF specific UE ID retrieval 58218 QoS Flow related QoS monitoring and reporting The SMF may configure the UPF to perform QoS monitoring for a QoS Flow and to report the monitoring results with the help of the following parameters provided in the Session Reporting Rule SRR described in clause 58511 - QoS monitoring parameters indicating the subject of the QoS monitoring as defined in clause 545 - Reporting period indicating the time interval in which a new measurement result and a potential report has to be available",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_631",
    "document_id": "23501-i80",
    "chunk_id": 631,
    "text": "Generally if no measurement result is available to the UPF within the Reporting period the UPF shall report a measurement failure however for some QoS monitoring parameters eg congestion information PDV and data rate the measurement failure report is not applicable - Reporting frequency indicating the type of the reporting as periodic or event triggered - If the Reporting frequency indicates periodic the UPF shall send a report each time the reporting period is over - If the Reporting frequency indicates event triggered a Reporting threshold for each parameter in the QoS monitoring parameters and a Minimum waiting time are provided as well The UPF shall send a report when the measurement result matches or exceeds the indicated Reporting threshold Subsequent reports should not be sent by the UPF during the Minimum waiting time The UPF shall continue to report a measurement result that matches or exceeds the indicated Reporting Threshold when the Minimum waiting time is over NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_632",
    "document_id": "23501-i80",
    "chunk_id": 632,
    "text": "As an implementation option the UPF can be configured to send subsequent reports during the Minimum waiting time eg if the UPF determines that this report is considerably different from the previous report - Optional Target of the reporting and Indication of direct event notification indicating that the UPF shall send the reports to a different NF than the SMF eg to the NEFAF or the NWDAFDCCFMFAF The NF is identified by a Notification Target Address and a Notification Correlation ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_633",
    "document_id": "23501-i80",
    "chunk_id": 633,
    "text": "The SMF can also indicate that the UPF shall send the reports to both the NF indicated by the Target of reporting and to the SMF If so the UPF shall send the reports to the SMF as well If the Indication of direct event notification is not provided the UPF shall send the reports to the SMF - Optional Reporting suggestion information as defined in clause 58217 applicable to Target of the reporting to reduce the UPF performance impacts - Optional Indication of QoS Flow associated with the default QoS Rule see clause 415451 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_634",
    "document_id": "23501-i80",
    "chunk_id": 634,
    "text": "The UPF shall forward this indication that the QoS monitoring report is for the QoS Flow associated with the default QoS Rule in the Nupf_EventExposure_Notify service operation when sending reports The UPF shall send the QoS Monitoring Report as follows - when the UPF sends reports to the SMF the UPF shall use QoS Monitoring Reports as described in clause 58512 andor - When the UPF sends reports to a different NF than the SMF eg the NEFAF or the NWDAFDCCFMFAF the UPF shall use the Nupf_EventExposure_Notify service operation described in clause 522622 of TS 23502 3 58219 Explicit Buffer Management 582191 General 5GC supports buffering of UEs downlink packets for deactivated PDU Sessions Support for buffering in the UPF is mandatory and optional in the SMF When the UP connection of a PDU Session is deactivated buffering in UPF can be activated by the SMF If the SMF supports buffering capability the SMF can decide to activate buffering in SMF instead of buffering in UPF 582192 Buffering at UPF When the SMF decided to activate buffering in UPF the SMF shall inform the UPF to start buffering packets for this PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_635",
    "document_id": "23501-i80",
    "chunk_id": 635,
    "text": "The SMF provides instructions to the UPF for at least the following behaviour - buffer downlink packets with the following additional options - reporting the arrival of first downlink packet for a QoS Flow or a service data flow andor - reporting the first discarded downlink packet for a service data flow or - drop downlink packets with the following additional options - reporting the first discarded downlink packet for a service data flow - buffer uplink packets When the SMF instructs the UPF for a service data flow to buffer downlink packets and to report the first discarded downlink packet the SMF shall also instruct the UPF to report the arrival of the first downlink packet for this service data flow to enable the SMF check if this is also the first report for the QoS Flow as described below Based on local policy andor an indication from the AMF eg the RAT type of REDCAP or the CN based MT handling indication the SMF may also instruct the UPF to report the DL data size in case of arrival of the first downlink packet Buffering in the UPF may be configured based on timers or the amount of downlink data to be buffered The SMF decides whether buffering timers or amount of downlink data are handled by the UPF or SMF After starting buffering when the first downlink packet of a QoS Flow or a service data flow arrives UPF shall inform the SMF if it is setup to report UPF sends a Downlink Data Report to the SMF via N4 unless specified otherwise and indicates the PDR by which the downlink packet was received If the SMF receives a Downlink Data Report for a service data flow the SMF shall also check if this is the first report for the QoS Flow corresponding to the PDR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_636",
    "document_id": "23501-i80",
    "chunk_id": 636,
    "text": "If so the SMF shall also proceed as described in clause 5431 After starting buffering when the first downlink packet of a service data flow in a configured period of time that has been buffered is discarded by the UPF because the configured buffering time or amount of downlink data to be buffered is exceeded the UPF shall inform the SMF if it is setup to report UPF sends a Downlink Data Report to the SMF via N4 and indicates the PDR by which the discarded downlink packet was received A new report is sent if the SMF terminates and subsequently re-activates the buffering action at the UPF and the UPF again receives downlink packets NOTE For the notification about the downlink data delivery status buffered or discarded related to packets from a particular AF as part of the Nsmf_EventExposure service it is expected that a PDR with a traffic filter identifying that AF as source and a Forwarding Action rule with action buffer is installed When the UP connection of the PDU Session is activated the SMF updates the UPF of the change in buffering state The buffered downlink packets if any are then forwarded to the RAN by the UPF If the UP connection of the PDU Session has been deactivated for a long time the SMF may indicate the UPF to stop buffering for this PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_637",
    "document_id": "23501-i80",
    "chunk_id": 637,
    "text": "The SMF may indicate to the UPF to start or stop the buffering of uplink packets of an application associated to the PCC rule as described in clause 635 of TS 23548 130 When the buffering of uplink packets is stopped the UPF shall forward all buffered uplink packets before it forwards any new uplink packets 582193 Buffering at SMF When the SMF supports buffering capability and the SMF decided to activate buffering in SMF for the PDU Session the SMF shall inform the UPF to start forwarding the downlink packets towards the SMF When the UP connection of the PDU Session is activated if there are buffered downlink packets available and their buffering duration has not expired the SMF shall forward those packets to the UPF to relay them to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_638",
    "document_id": "23501-i80",
    "chunk_id": 638,
    "text": "These packets are then forwarded by the UPF to the RAN 58220 SMF Pause of Charging The SMF Pause of Charging functionality is supported with the purpose that the charging and usage monitoring data in the core network more accurately reflects the downlink traffic actually sent to the RAN When the amount of downlink data incoming at the UPF for a PDU Session that is in deactivated state goes above a pre-configured threshold the pause of charging functionality ensures that data that dropped in the core network is not included in charging and usage monitoring records The procedures for SMF Pause of Charging are described in TS 23502 3 583 Explicit Buffer Management moved The Explicit Buffer Management is described in clause 58219 584 SMF Pause of Charging moved The SMF Pause of Charging is described in clause 58220 585 Parameters for N4 session management 5851 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_639",
    "document_id": "23501-i80",
    "chunk_id": 639,
    "text": "These parameters are used by SMF to control the functionality of the UPF as well as to inform SMF about events occurring at the UPF The N4 session management procedures defined in clause 441 of TS 23502 3 will use the relevant parameters in the same way for all N4 reference points the N4 Session Establishment procedure as well as the N4 Session Modification procedure provide the control parameters to the UPF the N4 Session Release procedure removes all control parameters related to an N4 session and the N4 Session Level Reporting procedure informs the SMF about events related to the PDU Session that are detected by the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_640",
    "document_id": "23501-i80",
    "chunk_id": 640,
    "text": "The parameters over N4 reference point provided from SMF to UPF comprises an N4 Session ID and may also contain - Packet Detection Rules PDR that contain information to classify traffic PDUs arriving at the UPF - Forwarding Action Rules FAR that contain information on whether forwarding dropping or buffering is to be applied to a traffic identified by PDRs - Multi-Access Rules MAR that contain information on how to handle traffic steering switching and splitting for a MA PDU Session - Usage Reporting Rules URR contains information that defines how traffic identified by PDRs shall be accounted as well as how a certain measurement shall be reported - QoS Enforcement Rules QER that contain information related to QoS enforcement of traffic identified by PDRs - Session Reporting Rules SRR that contain information to request the UP function to detect and report events for a PDU session that are not related to specific PDRs of the PDU session or that are not related to traffic usage measurement - Trace Requirements - Port Management Information Container in 5GS - BridgeRouter Information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_641",
    "document_id": "23501-i80",
    "chunk_id": 641,
    "text": "The N4 Session ID is assigned by the SMF and uniquely identifies an N4 session If the UPF indicated support of Trace the SMF may activate a trace session during a N4 Session Establishment or a N4 Session Modification procedure In that case it provides Trace Requirements to the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_642",
    "document_id": "23501-i80",
    "chunk_id": 642,
    "text": "The SMF may deactivate an on-going trace session using a N4 Session Modification procedure There shall be at most one trace session activated per N4 Session at a time For the MA PDU Session the SMF may add an additional access tunnel information during an N4 Session Modification procedure by updating MAR with addition of an FAR ID which refers to an FAR containing the additional access tunnel information for the MA PDU session for traffic steering in the UPF For the MA PDU Session the SMF may request Access Availability report per N4 Session during N4 Session Establishment procedure or N4 Session Modification procedure A N4 Session may be used to control both UPF and NW-TT behaviour in the UPF A N4 session support and enable exchange of bridgerouter configuration between the SMF and the UPF - Information that the SMF needs for bridgerouter management clause 5859 - Information that 5GS transparently relays between the TSN AF or TSCTSF and the NW-TT transparent Port Management Information Container along with the associated NW-TT port number - Information that 5GS transparently relays between the TSN AF or TSCTSF and the NW-TT transparent user plane node Management Information Container clause 58514 When a N4 Session related with bridgerouter management is established the UPF allocates a dedicated port number for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_643",
    "document_id": "23501-i80",
    "chunk_id": 643,
    "text": "The UPF then provides to the SMF following configuration parameters for the N4 Session - port number - user-plane node ID To support TSN the user-plane node ID is Bridge ID To support integration with IETF DetNet the user-plane node ID can be Router ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_644",
    "document_id": "23501-i80",
    "chunk_id": 644,
    "text": "The User Plane Node ID may be pre-configured in the UPF based on deployment After the N4 session has been established the SMF and UPF may at any time exchange transparent user plane node and Port Management Information Container over a N4 session 5852 N4 Session Context N4 Session Context is identified by an N4 Session ID An N4 Session Context is generated by SMF and UPF respectively to store the parameters related to an N4 session including the N4 session ID and following information see TS 29244 65 for an exhaustive list 1 general session related parameters such as S-NSSAI PDU Session Type Trace Information APNDNN ATSSS Control Information 2 the PDRs URRs QERs BARs FARs MARs used for this N4 session 3 parameters sent to support UPF statistics The UPF may use parameters listed above in bullets 1 eg S-NSSAI and 2 eg Network Instance in PDRFARs for determining internal UPF resources 5853 Packet Detection Rule",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_645",
    "document_id": "23501-i80",
    "chunk_id": 645,
    "text": "The following table describes the Packet Detection Rule PDR containing information required to classify a packet arriving at the UPF Every PDR is used to detect packets in a certain transmission direction eg UL direction or DL direction Table 5853-1 Attributes within Packet Detection Rule 5854 QoS Enforcement Rule The following table describes the QoS Enforcement Rule QER that defines how a packet shall be treated in terms of bit rate limitation and packet marking for QoS purposes All Packet Detection Rules that refer to the same QER share the same QoS resources eg MFBR Table 5854-1 Attributes within QoS Enforcement Rule 5855 Usage Reporting Rule The following table describes the Usage Reporting Rule URR that defines how a packet shall be accounted as well as when and how to report the measurements Table 5855-1 Attributes within Usage Reporting Rule 5856 Forwarding Action Rule",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_646",
    "document_id": "23501-i80",
    "chunk_id": 646,
    "text": "The following table describes the Forwarding Action Rule FAR that defines how a packet shall be buffered dropped or forwarded including packet encapsulationdecapsulation and forwarding destination Table 5856-1 Attributes within Forwarding Action Rule 5857 Usage Report generated by UPF The UPF sends the Usage Report to inform the SMF about the measurement of an active URR or about the detection of application traffic of an active Packet Detection Rule For each URR the Usage Report may be generated repeatedly ie as long as any one of the valid event triggers applies A final Usage Report is sent for a URR when it is no longer active ie either the URR is removed or all the references to this URR in any of the Packet Detection Rules belonging to the N4 session The following attributes can be included Table 5857-1 Attributes within Usage Report 5858 Multi-Access Rule",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_647",
    "document_id": "23501-i80",
    "chunk_id": 647,
    "text": "The following table describes the Multi-Access Rule MAR that includes the association to the two FARs for both 3GPP access and non-3GPP access in the case of supporting ATSSS Table 5858-1 Attributes within Multi-Access Rule 5859 BridgeRouter Information The following table describes the User plane node Information UI that includes the information required to configure a 5GS logical bridgerouter for TSC or Deterministic Networking PDU Sessions Table 5859-1 User plane node Information 58510 Void 58511 Session Reporting Rule",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_648",
    "document_id": "23501-i80",
    "chunk_id": 648,
    "text": "The following table describes the Session Reporting Rule SRR that defines the detection and reporting events that the UPF shall report that are not related to specific PDRs of the PDU Session as follows - Per QoS Flow per UE QoS Monitoring Report as specified in clause 53332 - Change of 3GPP or non-3GPP access availability for an MA PDU session - Per QoS Flow N6 Traffic Parameter Measurement Report Table 58511-1 Attributes within Session Reporting Rule 58512 Session reporting generated by UPF The UPF sends the session report to inform the SMF the detected events for a PDU Session that are related to an SRR The UPF may support notification to the AF possibly via local NEF as described in clause 64 of TS 23548 130 Table 58512-1 Attributes within Session Reporting 58513 Void 58514 TSC Management Information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_649",
    "document_id": "23501-i80",
    "chunk_id": 649,
    "text": "The following table describes the TSC Management Information Container TSC MIC that includes UMIC PMIC and the associated NW-TT port number The SMF may include the notification target address for PMICUMIC UPF event provided by the PCF in the TSC Management Information sent to UPF if the UPF supports the related redirect reporting via Nupf If the notification target address for PMICUMIC UPF event is provided by the SMF the UPF may directly report TSC management information to the TSNAF or TSCTSF using Nupf_EventExposure_Notify service operation described in clause 7229 Table 58514-1 TSC Management Information Container 58515 Downlink Data Report generated by UPF The UPF sends the Downlink Data Report to inform the SMF about the events related to receiving or discarding of downlink packets The SMF controls this type of UPF report by providing instructions in the Buffer Action Rule of a FAR Following attributes can be included Table 58515-1 Attributes within Downlink Data Report 59 Identifiers 591 General Each subscriber in the 5G System shall be allocated one 5G Subscription Permanent Identifier SUPI for use within the 3GPP system The 5G System supports identification of subscriptions independently of identification of the user equipment Each UE accessing the 5G System shall be assigned a Permanent Equipment Identifier PEI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_650",
    "document_id": "23501-i80",
    "chunk_id": 650,
    "text": "The 5G System supports allocation of a temporary identifier 5G-GUTI in order to support user confidentiality protection 592 Subscription Permanent Identifier A globally unique 5G Subscription Permanent Identifier SUPI shall be allocated to each subscriber in the 5G System and provisioned in the UDMUDR The SUPI is used only inside 3GPP system and its privacy is specified in TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_651",
    "document_id": "23501-i80",
    "chunk_id": 651,
    "text": "The SUPI may contain - an IMSI as defined in TS 23003 19 or - a network-specific identifier used for private networks as defined in TS 22261 2 - a GLI and an operator identifier of the 5GC operator used for supporting FN-BRGs as further described in TS 23316 84 - a GCI and an operator identifier of the 5GC operator used for supporting FN-CRGs and 5G-CRG as further described in TS 23316 84 A SUPI containing a network-specific identifier shall take the form of a Network Access Identifier NAI using the NAI RFC 7542 20 based user identification as defined in TS 23003 19 When UE needs to indicate its SUPI to the network eg as part of the Registration procedure the UE provides the SUPI in concealed form as defined in TS 23003 19",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_652",
    "document_id": "23501-i80",
    "chunk_id": 652,
    "text": "In order to enable roaming scenarios the SUPI shall contain the address of the home network eg the MCC and MNC in the case of an IMSI based SUPI For interworking with the EPC the SUPI allocated to the 3GPP UE shall always be based on an IMSI to enable the UE to present an IMSI to the EPC The usage of SUPI for W-5GAN is further specified in TS 23316 84 592a Subscription Concealed Identifier The Subscription Concealed Identifier SUCI is a privacy preserving identifier containing the concealed SUPI It is specified in TS 33501 29 The usage of SUCI for W-5GAN access is further specified in TS 23316 84 593 Permanent Equipment Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_653",
    "document_id": "23501-i80",
    "chunk_id": 653,
    "text": "A Permanent Equipment Identifier PEI is defined for the 3GPP UE accessing the 5G System The PEI can assume different formats for different UE types and use cases The UE shall present the PEI to the network together with an indication of the PEI format being used If the UE supports at least one 3GPP access technology ie NG-RAN E-UTRAN UTRAN or GERAN the UE must be allocated a PEI in the IMEI or IMEISV format If a UE has registered with a network by using a network subscription and a PEI of the UE then the UE shall keep the PEI to be used with the network subscription and shall not use that PEI with another network subscription while the UE is in registered state in the network In the scope of this release the PEI may be one of the following - for UEs that support at least one 3GPP access technology an IMEI or IMEISV as defined in TS 23003 19 - PEI used in the case of W-5GAN access as further specified in TS 23316 84 - for UEs not supporting any 3GPP access technologies the IEEE Extended Unique Identifier EUI-64 113 of the access technology the UE uses to connect to the 5GC 594 5G Globally Unique Temporary Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_654",
    "document_id": "23501-i80",
    "chunk_id": 654,
    "text": "The AMF shall allocate a 5G Globally Unique Temporary Identifier 5G-GUTI to the UE that is common to both 3GPP and non-3GPP access It shall be possible to use the same 5G-GUTI for accessing 3GPP access and non-3GPP access security context within the AMF for the given UE An AMF may re-assign a new 5G-GUTI to the UE at any time The AMF provides a new 5G-GUTI to the UE under the conditions specified in clause 6123 of TS 33501 29 When the UE is in CM-IDLE the AMF may delay providing the UE with a new 5G-GUTI until the next NAS transaction The 5G-GUTI shall be structured as 5G-GUTI GUAMI 5G-TMSI where GUAMI identifies one or more AMFs When the GUAMI identifies only one AMF the 5G-TMSI identifies the UE uniquely within the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_655",
    "document_id": "23501-i80",
    "chunk_id": 655,
    "text": "However when AMF assigns a 5G-GUTI to the UE with a GUAMI value used by more than one AMF the AMF shall ensure that the 5G-TMSI value used within the assigned 5G-GUTI is not already in use by the other AMFs sharing that GUAMI value The Globally Unique AMF ID GUAMI shall be structured as GUAMI MCC MNC AMF Region ID AMF Set ID AMF Pointer where AMF Region ID identifies the region AMF Set ID uniquely identifies the AMF Set within the AMF Region and AMF Pointer identifies one or more AMFs within the AMF Set NOTE 1 The AMF Region ID addresses the case that there are more AMFs in the network than the number of AMFs that can be supported by AMF Set ID and AMF Pointer by enabling operators to re-use the same AMF Set IDs and AMF Pointers in different regions NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_656",
    "document_id": "23501-i80",
    "chunk_id": 656,
    "text": "In the case of SNPNs the PLMN IDs may be shared among SNPNs such that the constructed GUAMIs are not globally unique However PLMN ID and NID are provided together separate from the GUAMI to uniquely identify selected or supported SNPN in RRC and N2 NOTE 3 See TS 23003 19 for details on the structure of the fields of GUAMI The 5G-S-TMSI is the shortened form of the GUTI to enable more efficient radio signalling procedures eg during Paging and Service Request and is defined as 5G-S-TMSI AMF Set ID AMF Pointer 5G-TMSI As specified in TS 38304 50 and TS 36304 52 for 3GPP access the NG-RAN uses the 10 Least Significant Bits of the 5G-TMSI in the determination of the time at which different UEs are paged Hence the AMF shall ensure that the 10 Least Significant Bits of the 5G-TMSI are evenly distributed As specified in TS 38331 28 and TS 36331 51 for 3GPP access the NG-RANs RRC Connection Establishments contention resolution process assumes that there is a low probability of the same 5G-TMSI being allocated by different AMFs to different UEs The AMFs process for allocating the 5G-TMSI should take this account NOTE 4 To achieve this the AMF could for example use a random seed number for any process it uses when choosing the UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_657",
    "document_id": "23501-i80",
    "chunk_id": 657,
    "text": "5G-TMSI 595 AMF Name An AMF is identified by an AMF Name AMF Name is a globally unique FQDN the structure of AMF Name FQDN is defined in TS 23003 19 An AMF can be configured with one or more GUAMIs At a given time GUAMI with distinct AMF Pointer value is associated to one AMF name only 596 Data Network Name DNN A DNN is equivalent to an APN as defined in TS 23003 19 Both identifiers have an equivalent meaning and carry the same information The DNN may be used eg to - Select a SMF and UPFs for a PDU Session - Select N6 interfaces for a PDU Session - Determine policies to apply to this PDU Session The wildcard DNN is a value that can be used for the DNN field of Subscribed DNN list of Session Management Subscription data defined in clause 5233 of TS 23502 3 The wildcard DNN can be used with an S-NSSAI for operator to allow the subscriber to access any Data Network supported within the Network Slice associated with the S-NSSAI 597 Internal-Group Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_658",
    "document_id": "23501-i80",
    "chunk_id": 658,
    "text": "The subscription data for an UE in UDR may associate the subscriber with groups A group is identified by an Internal-Group Identifier NOTE 1 A UE can belong to a limited number of groups the exact number is defined in stage 3 specifications NOTE 2 In this Release of the specification the support of groups is only defined in non-roaming case The Internal-Group Identifiers corresponding to an UE are provided by the UDM to the SMF as part Session Management Subscription data and when PCC applies to a PDU Session by the SMF to the PCF The SMF may use this information to apply local policies and to store this information in CDR The PCF may use this information to enforce AF requests as described in clause 567",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_659",
    "document_id": "23501-i80",
    "chunk_id": 659,
    "text": "The Internal-Group Identifiers corresponding to an UE are provided by the UDM to the AMF as part of Access and Mobility Subscription data The AMF may use this information to apply local policies such as Group specific NAS level congestion control defined in clause 51975 598 Generic Public Subscription Identifier Generic Public Subscription Identifier GPSI is needed for addressing a 3GPP subscription in different data networks outside of the 3GPP system The 3GPP system stores within the subscription data the association between the GPSI and the corresponding SUPI GPSIs are public identifiers used both inside and outside of the 3GPP system The GPSI is either an MSISDN or an External Identifier see TS 23003 19 If MSISDN is included in the subscription data it shall be possible that the same MSISDN value is supported in both 5GS and EPS NOTE There is no implied 1-to-1 relationship between GPSI and SUPI 599 AMF UE NGAP ID An AMF UE NGAP ID is an identifier used to identify the UE in AMF on N2 reference point AMF allocates the AMF UE NGAP ID and send it to the 5G-AN For the following N2 signalling interaction sent from 5G-AN to AMF AMF UE NGAP ID is used to identify the UE at the AMF AMF UE NGAP ID is unique per AMF set AMF UE NGAP ID may be updated without AMF change or with AMF change as specified at clause 52122 5910 UE Radio Capability ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_660",
    "document_id": "23501-i80",
    "chunk_id": 660,
    "text": "The UE Radio Capability ID is a short pointer with format defined in TS 23003 19 that is used to uniquely identify a set of UE Radio Capabilities excluding UTRAN and NB-IoT capabilities The UE Radio Capability ID is assigned either by the serving PLMN or by the UE manufacturer as follows - UE manufacturer-assigned The UE Radio Capability ID may be assigned by the UE manufacturer in which case it includes a UE manufacturer identification ie a Vendor ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_661",
    "document_id": "23501-i80",
    "chunk_id": 661,
    "text": "In this case the UE Radio Capability ID uniquely identifies a set of UE radio capabilities and the UE Radio Capability for Paging for a UE by this manufacturer in any PLMN - PLMN-assigned If a UE manufacturer-assigned UE Radio Capability ID is not used by the UE or the serving network or it is not recognised by the serving PLMN UCMF the UCMF may allocate UE Radio Capability IDs for the UE corresponding to each different set of UE radio capabilities the PLMN may receive from the UE at different times In this case the UE Radio Capability IDs the UE receives are applicable to the serving PLMN and uniquely identify the corresponding sets of UE radio capabilities and and the UE Radio Capability for Pagings in this PLMN The PLMN assigned UE Radio Capability ID includes a Version ID in its format The value of the Version ID is the one configured in the UCMF at time the UE Radio Capability ID value is assigned The Version ID value makes it possible to detect whether a UE Radio Capability ID is current or outdated NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_662",
    "document_id": "23501-i80",
    "chunk_id": 662,
    "text": "For the case the PLMN is configured to store PLMN assigned IDs in the UE manufacturer-assigned operation requested list defined in clause 5441a then the algorithm for assignment of PLMN-assigned UE Radio Capability ID shall assign different UE Radio Capability IDs for UEs with different TAC value The type of UE Radio Capability ID UE manufacturer-assigned or PLMN-assigned is distinguished when a UE Radio Capability ID is signalled 510 Security aspects 5101 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_663",
    "document_id": "23501-i80",
    "chunk_id": 663,
    "text": "The security features in the 5G System include - Authentication of the UE by the network and vice versa mutual authentication between UE and network - Security context generation and distribution - User Plane data confidentiality and integrity protection - Control Plane signalling confidentiality and integrity protection - User identity confidentiality - Support of LI requirements as specified in TS 33126 35 subject to regionalnational regulatory requirements including protection of LI data eg target list that may be stored or transferred by an NF Detailed security related network functions for 5G are described in TS 33501 29 5102 Security Model for non-3GPP access 51021 Signalling Security When a UE is connected via a NG-RAN and via a standalone non-3GPP accesses the multiple N1 instances are secured using independent NAS security contexts each created based on the security context in the corresponding SEAF eg in the common AMF when the UE is served by the same AMF derived from the UE authentication 5103 PDU Session User Plane Security The User Plane Security Enforcement information provides the NG-RAN with User Plane security policies for a PDU session It indicates - whether UP integrity protection is - Required for all the traffic on the PDU Session UP integrity protection shall apply - Preferred for all the traffic on the PDU Session UP integrity protection should apply - Not Needed UP integrity protection shall not apply on the PDU Session - whether UP confidentiality protection is - Required for all the traffic on the PDU Session UP confidentiality protection shall apply - Preferred for all the traffic on the PDU Session UP confidentiality protection should apply - Not Needed UP confidentiality shall not apply on the PDU Session User Plane Security Enforcement information applies only over 3GPP access Once determined at the establishment of the PDU Session the User Plane Security Enforcement information applies for the life time of the PDU Session NOTE 1 Applicability of UP integrity protection of UP Security Enforcement is defined in TS 33501 29 and TS 38300 27 The SMF determines at PDU session establishment a User Plane Security Enforcement information for the user plane of a PDU session based on - subscribed User Plane Security Policy which is part of SM subscription information received from UDM and - User Plane Security Policy locally configured per DNN S-NSSAI in the SMF that is used when the UDM does not provide User Plane Security Policy information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_664",
    "document_id": "23501-i80",
    "chunk_id": 664,
    "text": "The maximum supported data rate per UE for integrity protection for the DRBs provided by the UE in the Integrity protection maximum data rate IE during PDU Session Establishment The UE supporting NR as primary RAT ie NG-RAN access via Standalone NR shall set the Integrity protection maximum data rate IE for Uplink and Downlink to full rate at PDU Session Establishment as defined in TS 24501 47 A UE not supporting NR as primary RAT and supporting E-UTRA connected to 5GC shall set the Integrity protection maximum data rate IE for Uplink and Downlink to NULL at PDU Session Establishment as defined in TS 24501 47 The User Plane Security Enforcement information provides the MME with User Plane integrity protection policies for the PDU session PDN Connection",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_665",
    "document_id": "23501-i80",
    "chunk_id": 665,
    "text": "The information indicates whether UP integrity protection is - Required for all the traffic on the PDU Session PDN Connection UP integrity protection shall apply - Preferred for all the traffic on the PDU Session PDN Connection UP integrity protection should apply - Not Needed UP integrity protection shall not apply on the PDU Session PDN Connection In turn the MME provides per EPS bearer User Plane Security Enforcement information to the E-UTRAN All the bearers within a PDN Connection share the same User Plane integrity protection policies The UE capability to support user plane integrity protection with EPS is indicated to AMF in the S1 UE network capability information If the UE supports user plane integrity protection with EPS and the AMF supports the associated functionality the AMF indicates this to SMF at PDU Session Establishment using NG-RAN If the UE and AMF support user plane integrity protection with EPS for PDU Sessions with UP integrity protection of UP Security Enforcement Information set to Required the SMF may perform the EPS bearer ID allocation procedure as described in TS 23502 3 clause 41114 If the UE does not support user plane integrity protection with EPS or the AMF does not support the associated functionality the SMF shall not trigger the EPS bearer ID allocation procedure in clause 41114 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_666",
    "document_id": "23501-i80",
    "chunk_id": 666,
    "text": "Unless the UE the serving eNB and the MME support user plane integrity protection with EPS the SMFPGW-C shall reject a PDN Connection Establishment using EPS if the UP Security Enforcement Information has UP integrity protection set to Required The SMFPGW-C shall eg based on the received RAT Type reject a PDN Connection Establishment using GERANUTRAN if the UP Security Enforcement Information has UP integrity protection set to Required NOTE 2 This assumes that the optional user plane integrity protection for GPRS specified in Release 13 has not been deployed The SMF may based on local configuration reject the PDU Session Establishment request depending on the value of the maximum supported data rate per UE for integrity protection NOTE 3 Reasons to reject a PDU Session Establishment request can eg be that the UP Integrity Protection is determined to be Required while the maximum supported data rate per UE for integrity protection is less than the expected required data rate for the DN NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_667",
    "document_id": "23501-i80",
    "chunk_id": 667,
    "text": "The operator can take care to reduce the risk of such rejections when configuring the subscribed User Plane Security Policy for a DNN For example the operator may apply integrity protection Required only in scenarios where it can be assumed that the UE maximum supported data rate per UE for integrity protection is likely to be adequate for the DN The User Plane Security Policy provide the same level of information than User Plane Security Enforcement information User Plane Security Policy from UDM takes precedence over locally configured User Plane Security Policy",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_668",
    "document_id": "23501-i80",
    "chunk_id": 668,
    "text": "The User Plane Security Enforcement information may include the maximum supported data rate for integrity protection provided by the UE is communicated from SMF to the NG-RAN for enforcement as part of PDU session related information If the UP Integrity Protection is determined to be Required or Preferred the SMF also provides the maximum supported data rate per UE for integrity protection as received in the Integrity protection maximum data rate IE This takes place at establishment of a PDU Session or at activation of the user plane of a PDU Session The NG-RAN rejects the establishment of UP resources for the PDU Session when it cannot fulfil User Plane Security Enforcement information with a value of Required The NG-RAN may also take the maximum supported data rate per UE for integrity protection into account in its decision on whether to accept or reject the establishment of UP resources In this case the SMF releases the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_669",
    "document_id": "23501-i80",
    "chunk_id": 669,
    "text": "The NG-RAN notifies the SMF when it cannot fulfil a User Plane Security Enforcement with a value of Preferred NOTE 5 For example the NG-RAN cannot fulfil requirements in User Plane Security Enforcement information with UP integrity protection set to Required when it cannot negotiate UP integrity protection with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_670",
    "document_id": "23501-i80",
    "chunk_id": 670,
    "text": "It is responsibility of the NG-RAN to enforce that the maximum UP integrity protection data rate delivered to the UE in downlink is not exceeding the maximum supported data rate for integrity protection It is expected that generally the UP integrity protection data rate applied by the UE in uplink will not exceed the indicated maximum supported data rate but the UE is not required to perform strict rate enforcement User Plane Security Enforcement information and the maximum supported data rate per UE for integrity protection is communicated from source to target NG-RAN node at handover If the target RAN node cannot support requirements in User Plane Security Enforcement information the target RAN node rejects the request to set up resources for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_671",
    "document_id": "23501-i80",
    "chunk_id": 671,
    "text": "In this case the PDU Session is not handed over to the target RAN node and the PDU Session is released If the UE or the new eNB or the MME does not indicate support of user plane integrity protection with EPS PDU Sessions with UP integrity protection of the User Plane Security Enforcement information set to Required are not transferred to EPS as follows - In the case of mobility without N26 the SMFPGW-C shall reject a PDN connectivity request in EPS with handover indication if the UP integrity protection of the User Plane Security Enforcement is set to Required NOTE 6 As described in clause 517233 the UE does not know before trying to move a given PDU Session to EPC whether that PDU session can be transferred to EPC -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_672",
    "document_id": "23501-i80",
    "chunk_id": 672,
    "text": "In the case of idle mode and connected mode mobility with N26 to EPS or mobility without N26 the SMFPGW-C ensures that the PDU session is released If the UE target eNB and the target MME indicate support of User Plane Integrity Protection with EPS PDU Sessions with UP integrity protection of the User Plane Security Enforcement information set to Required are transferred from 5GS to EPS according to existing procedures For the bearers of PDN Connections with UP integrity protection set to Required at both idle mode and connected mode mobility including intra-TA mobility to an eNB that does not support User Plane Integrity Protection with EPS the MME shall inform the SMFPGW-C and the SMFPGW-C ensures that the PDU session is released At connected mode mobility from EPS to GERANUTRAN or to a part of the EPS that does not support User Plane Integrity Protection the source E-UTRAN shall ensure that EPS bearers with UP integrity protection of the User Plane Security Enforcement information set to Required are not handed over In the case of idle mode mobility from an MME that supports User Plane Integrity Protection to an MME that does not support User Plane Integrity Protection the home SMFPGW-C shall trigger eg based on the lack of MME UPIP capability information the release of the bearers of PDN Connections with UP integrity protection set to Required At any eg idle mode mobility from EPS to GERANUTRAN the home SMFPGW-C shall trigger eg based on the received RAT Type the release of the bearers of PDN Connections with UP integrity protection set to Required PDU Sessions with UP confidentiality protection of the User Plane Security Enforcement information set to Required and UP integrity protection of the User Plane Security Enforcement information not set to Required are allowed to be handed over to EPS regardless of how UP confidentiality protection applies in EPS In the case of dual connectivity the Integrity Protection is set to Preferred the Master RAN node may notify the SMF when it cannot fulfil a User Plane Security Enforcement with a value of Preferred The SMF handling of the PDU session with respect to the Integrity Protection status is up to SMF implementation decision 511 Support for Dual Connectivity Multi-Connectivity 5111 Support for Dual Connectivity Dual Connectivity involves two radio network nodes in providing radio resources to a given UE with active radio bearers while a single N2 termination point exists for the UE between an AMF and the RAN The RAN architecture and related functions to support Dual Connectivity is further described in RAN specifications eg TS 37340 31",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_673",
    "document_id": "23501-i80",
    "chunk_id": 673,
    "text": "In this Release of the specification the Dual Connectivity function does not apply to the NR RedCap UE The RAN node at which the N2 terminates performs all necessary N2 related functions such as mobility management relaying of NAS signalling etc and manages the handling of user plane connection eg transfer over N3 It is called the Master RAN Node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_674",
    "document_id": "23501-i80",
    "chunk_id": 674,
    "text": "It may use resources of another RAN node the Secondary RAN node to exchange User Plane traffic of an UE Master RAN node takes into account the RSN andor PDU Session Pair ID to determine if dual connectivity shall be set up and ensure appropriate PDU session handling ensures fully redundant user plane path as described in clause 53321 If the UE has Mobility Restriction either signalled from the UDM or locally generated by the Serving PLMN policy in the AMF the AMF signals these restrictions to the Master RAN Node as Mobility Restriction List This may prevent the Master RAN node from setting up a Dual Connectivity for an UE NOTE 1 Subject to policies in the NG-RAN configuration of Dual Connectivity for a Data Radio Bearer can also be based on the Network Slice that the PDU Session belongs to Dual Connectivity provides the possibility for the Master RAN node to request SMF - For some or all PDU Sessions of an UE Direct all the DL User Plane traffic of the PDU Session to the either the Master RAN Node or to the Secondary RAN Node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_675",
    "document_id": "23501-i80",
    "chunk_id": 675,
    "text": "In this case there is a single N3 tunnel termination at the RAN for such PDU Session NOTE 2 The terminating RAN Node can decide to keep traffic for specific QFIs in a PDU Session for a UE on a single RAT or split them across the two RATs - For some other PDU Sessions of an UE Direct the DL User Plane traffic of some QoS Flows of the PDU Session to the Secondary respectively Master RAN Node while the remaining QoS Flows of the PDU Session are directed to the Master respectively Secondary RAN Node In this case there are irrespective of the number of QoS Flows two N3 tunnel terminations at the RAN for such PDU Session The Master RAN node may create and change this assignment for the user plane of a PDU Session at any time during the life time of the PDU Session In both cases a single PDU Session Id is used to identify the PDU Session Additional functional characteristics are - User location information is based on the identity of the cell that is serving the UE in the Master RAN node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_676",
    "document_id": "23501-i80",
    "chunk_id": 676,
    "text": "The cell identity of the Primary cell in the secondary RAN node may also be included NG-RAN includes the user location information in NGAP messages where the contents of the user location information may change during the corresponding procedure - Path update signalling related with Dual Connectivity and UPF re-allocation cannot occur at the same time 512 Charging 5121 General 5GC supports interactions towards CHF for network resource usage as defined in TS 32240 41 The CHF and the Nchf service are defined in TS 32290 67 The SMF supports the interactions towards the CHF as defined in TS 32255 68 The UPF supports functionality to collect and report usage data to SMF The N4 reference point supports the SMF control of the UPF collection and reporting of usage data The AMF supports interactions towards the CHF as defined in TS 32256 114 The SMSF supports interactions towards the CHF as defined in TS 32274 118",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_677",
    "document_id": "23501-i80",
    "chunk_id": 677,
    "text": "The NEF supports interactions towards the CHF as defined in TS 32254 123 5122 Usage Data Reporting for Secondary RAT When NG-RAN is deployed in dual connectivity configuration the HPLMN or VPLMN operator may wish to record the data volume sent and received on the Secondary RAT In order to reduce the complexity of this procedure the following principles are used in this release a The PLMN locally activates the Secondary RAT Usage Data Reporting by NG-RAN OAM The activation is based on configuration in NG-RAN and NG-RAN determines whether the data volume report will contain data volumes consumed for the whole PDU Session or for selected QoS Flows or both as described in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_678",
    "document_id": "23501-i80",
    "chunk_id": 678,
    "text": "The activation can happen separately for Data Volume Reporting of NR in licensed or unlicensed spectrum and E-UTRA in licensed or unlicensed spectrum If the PLMN uses this feature it should ensure that this functionality is supported by all NG-RAN nodes that support NR or E-UTRA as a Secondary RAT b Depending on its configuration the NG-RAN reports uplink and downlink data volumes to the 5GC for the Secondary RAT including the using of unlicensed spectrum for NR or E-UTRA for the PDU Session or for selected QoS Flows or both and per time interval c During Xn handover and N2 handover the source NG-RAN node reports the data volume to the 5GC The reported data volume excludes data forwarded to the target RAN node d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_679",
    "document_id": "23501-i80",
    "chunk_id": 679,
    "text": "At the time of NG connection release Secondary RAN Node changerelease deactivation of UP connection for a PDU Session the NG-RAN node reports the data volumes to the 5GC e To assist partial CDR generation NG-RAN OAM can instruct the NG-RAN to also make periodic reports as described in clause 5123 if no event has triggered a report before the period expires NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_680",
    "document_id": "23501-i80",
    "chunk_id": 680,
    "text": "The timing of these periodic NG-RAN reports is not expected to align with the timing of partial CDR generation Hence the frequency of NG-RAN reports might be greater than that of partial CDR generation NOTE 3 RAN needs to be able to partition the measurements in a report to indicate usage that occurred before and after an absolute time An example of the absolute time is that RAN is configured to partition data usage reports that occurred before and after midnight 5123 Secondary RAT Periodic Usage Data Reporting Procedure Periodic reporting of the Secondary RAT usage data is an optional function When NG-RAN as defined in bullet e of clause 51212 is configured with a time interval for Secondary RAT usage data reporting the NG-RAN shall send a RAN Usage Data Report message for periodic reporting purposes to the SMF only when the timer expires for a UE for which Secondary RAT usage data reporting is ongoing The timer runs from the last usage reporting for the UE 513 Support for Edge Computing Edge computing enables operator and 3rd party services to be hosted close to the UEs access point of attachment so as to achieve an efficient service delivery through the reduced end-to-end latency and load on the transport network Edge Computing support by 5GC is specified in this specification and in TS 23548 130 NOTE Edge Computing typically applies to non-roaming and LBO roaming scenarios For HR roaming scenarios Edge Computing applies only for Home Routed with Session Breakout in VPLMN HR-SBO which is described in clause 67 of TS 23548 130 The 5G Core Network selects a UPF close to the UE and forwards traffic to enable the local access to the DN via a N6 interface according to the provided traffic steering rules to the UPF This may be based on the UEs subscription data UE location the information from Application Function AF as defined in clause 567 the EAS information reported from EASDF as defined in TS 23548 130 policy or other related traffic rules Due to user or Application Function mobility the service or session continuity may be required based on the requirements of the service or the 5G network The 5G Core Network may expose network information and capabilities to an Edge Computing Application Function NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_681",
    "document_id": "23501-i80",
    "chunk_id": 681,
    "text": "Depending on the operator deployment certain Application Functions can be allowed to interact directly with the Control Plane Network Functions with which they need to interact while the other Application Functions need to use the external exposure framework via the NEF see clause 6210 for details Edge computing can be supported by one or a combination of the following enablers - User plane reselection the 5G Core Network reselects UPF to route the user traffic to the local part of the DN as described in clause 633 - Local Routing and Traffic Steering the 5G Core Network selects the traffic to be routed to the applications in the local part of the DN - this includes the use of a single PDU Session with multiple PDU Session Anchors UL CL IP v6 multi-homing as described in clause 564 and the use of a PDU Session with Distributed Anchor Point using SSC mode 23 - Session and service continuity to enable UE and application mobility as described in clause 569 - An Application Function may influence UPF reselection and traffic routing via PCF or NEF as described in clause 567 - Network capability exposure 5G Core Network and Application Function to provide information to each other via NEF as described in clause 520 or directly as described in clause 415 of TS 23502 3 or from the UPF as described in clause 64 of TS 23548 130 - QoS and Charging PCF provides rules for QoS Control and Charging for the traffic routed to the local part of the DN - Support of Local Area Data Network 5G Core Network provides support to connect to the LADN in a certain area where the applications are deployed as described in clause 565 - Discovery and re-discovery of Edge Applications Servers as described in TS 23548 130 - Support of Edge Relocation as described in TS 23548 130 and the case of involving AF change as described in clauses 4362 4363 and 4364 of TS 23502 3 Support of 5GC triggered Edge relocation within the same hosting PLMNs EHEs - Support of I-SMF reselection based on DNAI as described in clauses 4351 4352 and 42351 of TS 23502 3 - Support of finer sets of UEs - Support of common EAS discovery and common DNAI determination for set of UEs as described in clause 62 of TS 23548 130 - Support of mapping information between EAS IPIP range and DNAI as described in clause 68 of TS 23548 130 - Support of AF request for DNAI as described in clause 68 of TS 23548 130 514 Policy Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_682",
    "document_id": "23501-i80",
    "chunk_id": 682,
    "text": "The policy and charging control framework for the 5G System is defined in TS 23503 45 515 Network slicing 5151 General A Network Slice instance is defined within a PLMN or within an SNPN and shall include - the Core Network Control Plane and User Plane Network Functions as described in clause 42 and in the serving PLMN at least one of the following - the NG-RAN described in TS 38300 27 - the N3IWF or TNGF functions to the non-3GPP Access Network described in clause 4282 or the TWIF functions to the trusted WLAN in the case of support of N5CW devices described in clause 4285 - the W-AGF function to the Wireline Access Network described in clause 4284 The 5G System deployed in a PLMN shall always support the procedures information and configurations specified to support Network Slice instance selection in the present document TS 23502 3 and TS 23503 45 NOTE 1 Management of network slices are described in TS 28530 175 the procedures for provisioning of networks and network slices are described in TS 28531 176 and TS 28541 149 describes the resource model for managing the resources Network slicing support for roaming is described in clause 5156 Network slices may differ for supported features and network functions optimisations in which case such Network Slices may have eg different S-NSSAIs with different SliceService Types see clause 51521",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_683",
    "document_id": "23501-i80",
    "chunk_id": 683,
    "text": "The operator can deploy multiple Network Slices delivering exactly the same features but for different groups of UEs eg as they deliver a different committed service andor because they are dedicated to a customer in which case such Network Slices may have eg different S-NSSAIs with the same SliceService Type but different Slice Differentiators see clause 51521 The network may serve a single UE with one or more Network Slice instances simultaneously via a 5G-AN regardless of the access types over which the UE is registered ie 3GPP Access andor N3GPP Access The AMF instance serving the UE logically belongs to each of the Network Slice instances serving the UE ie this AMF instance is common to the Network Slice instances serving a UE NOTE 2 Number of simultaneous connection of Network Slice instances per UE is limited by the number of S-NSSAIs in the RequestedAllowed NSSAI as described in clause 51521 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_684",
    "document_id": "23501-i80",
    "chunk_id": 684,
    "text": "In this Release of the specification it is assumed that in any home or visited PLMN it is always possible to select an AMF that can serve any combination of S-NSSAIs that will be provided as an Allowed NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_685",
    "document_id": "23501-i80",
    "chunk_id": 685,
    "text": "The selection of the set of Network Slice instances for a UE is triggered by the first contacted AMF in a Registration procedure normally by interacting with the NSSF and can lead to a change of AMF This is further described in clause 5155 A PDU Session belongs to one and only one specific Network Slice instance per PLMN Different Network Slice instances do not share a PDU Session though different Network Slice instances may have slice-specific PDU Sessions using the same DNN During the Handover procedure the source AMF selects a target AMF by interacting with the NRF as specified in clause 635 Network Slice-Specific Authentication and Authorization NSSAA enables Network Slice specific authentication as described in clause 51510 Network Slice Admission Control NSAC controls the number of registered UEs per network slice the number of UEs with at least one PDU SessionPDN Connection per network slice in the case of EPC interworking and the number of PDU Sessions per network slice as described in clause 51511 Support of subscription-based restrictions to simultaneous registration of network slices uses Network Slice Simultaneous Registration Group NSSRG information to enable control of which Network Slices that can be registered simultaneously by a UE as described in clause 51512 Support of data rate limitation per Network Slice for a UE enables enforcement of Maximum Bit Rate per Network Slice for a UE as described in clause 51513",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_686",
    "document_id": "23501-i80",
    "chunk_id": 686,
    "text": "The selection of N3IWFTNGF supporting a set of slices is described in clause 636 and clause 6312 respectively",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_687",
    "document_id": "23501-i80",
    "chunk_id": 687,
    "text": "The support of Network Slice usage control is described in clause 51515 Support of Optimized handling of temporarily available network slices is described in clause 51516 It also covers aspects related to graceful release of network slices connectivity during slice decommissioning The Partial Network Slice support in a Registration Area is described in clause 51517 Support for Network Slices with Network Slice Area of Service not matching deployed Tracking Areas is described in clause 51518 Support of Network Slice Replacement is described in clause 51519 5152 Identification and selection of a Network Slice the S-NSSAI and the NSSAI 51521 General An S-NSSAI identifies a Network Slice An S-NSSAI is comprised of - A SliceService type SST which refers to the expected Network Slice behaviour in terms of features and services - A Slice Differentiator SD which is optional information that complements the SliceService types to differentiate amongst multiple Network Slices of the same SliceService type An S-NSSAI can have standard values ie such S-NSSAI is only comprised of an SST with a standardised SST value see clause 51522 and no SD or non-standard values ie such S-NSSAI is comprised of either both an SST and an SD or only an SST without a standardised SST value and no SD An S-NSSAI with a non-standard value identifies a single Network Slice within the PLMN with which it is associated An S-NSSAI with a non-standard value shall not be used by the UE in access stratum procedures in any PLMN other than the one to which the S-NSSAI is associated The S-NSSAIs in the NSSP of the URSP rules see clause 662 of TS 23503 45 and in the Subscribed S-NSSAIs see clause 5153 contain only HPLMN S-NSSAI values The S-NSSAIs in the Configured NSSAI the Allowed NSSAI see clause 51541 the Requested NSSAI see clause 515521 the Rejected S-NSSAIs contain only values from the Serving PLMN The Serving PLMN can be the HPLMN or a VPLMN The S-NSSAIs in the PDU Session Establishment contain one Serving PLMN S-NSSAI value and in addition may contain a corresponding HPLMN S-NSSAI value to which this first value is mapped see clause 51553 Further information for slice replacement is described in clause 51519",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_688",
    "document_id": "23501-i80",
    "chunk_id": 688,
    "text": "The optional mapping of Serving PLMN S-NSSAIs to HPLMN S-NSSAIs contains Serving PLMN S-NSSAI values and corresponding mapped HPLMN S-NSSAI values The NSSAI is a collection of S-NSSAIs An NSSAI may be a Configured NSSAI a Requested NSSAI Allowed NSSAI or a Partially Allowed NSSAI There can be at most eight S-NSSAIs in Allowed NSSAI and Requested NSSAI sent in signalling messages between the UE and the Network There can be at most seven S-NSSAIs in the Partially Allowed NSSAI and at most seven S-NSSAIs rejected partially in the RA and the sum of S-NSSAIs in the Allowed NSSAI and the Partially Allowed NSSAI shall be at most eight The Requested NSSAI signalled by the UE to the network allows the network to select the Serving AMF Network Slices and Network Slice instances for this UE as specified in clause 5155 NOTE 1 There can be at most a maximum of seven S-NSSAIs in the Partially Allowed NSSAI since there will always be an Allowed NSSAI allocated Based on the operators operational or deployment needs a Network Slice instance can be associated with one or more S-NSSAIs and an S-NSSAI can be associated with one or more Network Slice instances Multiple Network Slice instances associated with the same S-NSSAI may be deployed in the same or in different Tracking Areas When multiple Network Slice instances associated with the same S-NSSAI are deployed in the same Tracking Areas the AMF instance serving the UE may logically belong to ie be common to more than one Network Slice instance associated with this S-NSSAI In a PLMN when an S-NSSAI is associated with more than one Network Slice instance one of these Network Slice instances as a result of the Network Slice instance selection procedure defined in clause 5155 serves a UE that is allowed to use this S-NSSAI For any S-NSSAI the network may at any one time serve the UE with only one Network Slice instance associated with this S-NSSAI until cases occur where eg this Network Slice instance is no longer valid in a given Registration Area or a change in UEs Allowed NSSAI occurs etc In such cases procedures mentioned in clause 515522 or clause 515523 apply Based on the Requested NSSAI if any and the Subscription Information the 5GC is responsible for selection of a Network Slice instances to serve a UE including the 5GC Control Plane and User Plane Network Functions corresponding to this Network Slice instances The Subscription Information may contain restrictions to the simultaneous registration of network slices This is provided to the serving AMF as part of the UE subscription in the form of Network Slice Simultaneous Registration Group NSSRG information see clause 51512",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_689",
    "document_id": "23501-i80",
    "chunk_id": 689,
    "text": "The RAN may use Requested NSSAI in access stratum signalling to handle the UE Control Plane connection before the 5GC informs the RAN of the Allowed NSSAI The Requested NSSAI is used by the RAN for AMF selection as described in clause 635 The UE shall not include the Requested NSSAI in the RRC Resume when the UE asks to resume the RRC connection and is CM-CONNECTED with RRC_INACTIVE state When a UE is successfully registered over an Access Type the CN informs the RAN by providing the Allowed NSSAI for the corresponding Access Type NOTE 2 The details of how the RAN uses NSSAI information are described in TS 38300 27 51522 Standardised SST values Standardized SST values provide a way for establishing global interoperability for slicing so that PLMNs can support the roaming use case more efficiently for the most commonly used SliceService Types The SSTs which are standardised are in the following Table 51522-1 Table 51522-1 Standardised SST values NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_690",
    "document_id": "23501-i80",
    "chunk_id": 690,
    "text": "The support of all standardised SST values is not required in a PLMN Services indicated in this table for each SST value can also be supported by means of other SSTs NOTE 2 A mapping of GSMA defined Network Slice Types NEST to standard SST values is defined in GSMA NG116 137 5153 Subscription aspects The Subscription Information shall contain one or more S-NSSAIs ie Subscribed S-NSSAIs The subscription information shall include at least one default S-NSSAI The UDM sends at the most 16 Subscribed S-NSSAIs to AMF ie the number that can fit in a Configured NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_691",
    "document_id": "23501-i80",
    "chunk_id": 691,
    "text": "The subscription information the UDM sends to the AMF shall include at least one default S-NSSAI If an S-NSSAI is marked as default then the network is expected to serve the UE with a related applicable Network Slice instance when the UE does not send any permitted S-NSSAI to the network in a Registration Request message as part of the Requested NSSAI The Subscription Information for each S-NSSAI may contain - a Subscribed DNN list and one default DNN and - the indication whether the S-NSSAI is marked as default Subscribed S-NSSAI and - the indication whether the S-NSSAI is subject to Network Slice-Specific Authentication and Authorization and - Network Slice Simultaneous Usage Group NSSRG information see clause 51512 The network verifies the Requested NSSAI the UE provides in the Registration Request against the Subscription Information For the S-NSSAIs subject to Network Slice-Specific Authentication and Authorization the clause 51510 applies NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_692",
    "document_id": "23501-i80",
    "chunk_id": 692,
    "text": "It is recommended that at least one of the Subscribed S-NSSAIs marked as default S-NSSAI is not subject to Network Slice-specific Authentication and Authorization in order to ensure access to services even when Network Slice-specific Authentication and Authorization fails NOTE 2 It is recommended to minimize the number of Subscribed S-NSSAIs in subscriptions for NB-IoT or NR RedCap capable UEs to minimize overhead for signalling a large number of S-NSSAIs in Requested NSSAI in RRC and NAS via NB-IoT or NR RedCap In roaming case the UDM shall provide to the VPLMN only the S-NSSAIs from the Subscribed S-NSSAIs the HPLMN allows for the UE in the VPLMN If the UE is subject to restrictions of simultaneous registration of network slices ie if the Subscription Information for the S-NSSAIs contains NSSRG information the UDM provides to the VPLMN a subscribed S-NSSAIs and if applicable NSSRG information as described in clause 51512 NOTE 3 Network slice instances supporting an S-NSSAI subject to Network Slice-Specific Authentication and Authorization need to be deployed with AMFs supporting Network Slice-Specific Authentication and Authorization otherwise S-NSSAIs requiring Network Slice-Specific Authentication and Authorization would be incorrectly allowed without execution of Network Slice-Specific Authentication and Authorization NOTE 4 Network slice instances supporting an S-NSSAI subject to Network Slice Admission Control NSAC for number of registered UE per network slice need to be deployed with AMFs supporting NSAC otherwise S-NSSAIs requiring NSAC would be incorrectly allowed without execution of NSAC When the UDM updates the Subscribed S-NSSAIs to the serving AMF based on configuration in this AMF the AMF itself or the NSSF determines the mapping of the Configured NSSAI for the Serving PLMN andor Allowed NSSAI to the Subscribed S-NSSAIs The serving AMF then updates the UE with the above information as described in clause 5154 5154 UE NSSAI configuration and NSSAI storage aspects 51541 General 515411 UE Network Slice configuration The Network Slice configuration information contains one or more Configured NSSAIs A Configured NSSAI may either be configured by a Serving PLMN and apply to the Serving PLMN or may be a Default Configured NSSAI configured by the HPLMN and that applies to any PLMNs for which no specific Configured NSSAI has been provided to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_693",
    "document_id": "23501-i80",
    "chunk_id": 693,
    "text": "There is at most one Configured NSSAI per PLMN NOTE 1 The values used in the Default Configured NSSAI are expected to be commonly decided by all roaming partners eg by the use of values standardized by 3GPP or other bodies The Default Configured NSSAI if it is configured in the UE is used by the UE in a Serving PLMN only if the UE has no Configured NSSAI for the Serving PLMN The Configured NSSAI of a PLMN may include S-NSSAIs that have standard values or PLMN-specific values The Configured NSSAI for the Serving PLMN includes the S-NSSAI values which can be used in the Serving PLMN and may be associated with mapping of each S-NSSAI of the Configured NSSAI to one or more corresponding HPLMN S-NSSAI values The following applies - In the non-roaming case and if the Serving PLMN ID is the same as the PLMN ID of the SUPI the network shall not provide any mapped S-NSSAI to the UE with the Configured NSSAI -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_694",
    "document_id": "23501-i80",
    "chunk_id": 694,
    "text": "In the non-roaming case and if the Serving PLMN ID is not the same as the PLMN ID of the SUPI when the Configured NSSAI of Serving PLMN is provided to the UE the network shall provide the mapped S-NSSAIs of the HPLMN to the UE if different values are used for S-NSSAI in Serving PLMN and mapped S-NSSAI in HPLMN NOTE 2 It is recommended that the Serving PLMN and the HPLMN use the same S-NSSAI values in this case - In the roaming case the AMF shall provide to the UE the mapping of each S-NSSAI of the Configured NSSAI for the Serving PLMN to the corresponding S-NSSAI values of the HPLMN when providing NSSAI information as described in TS 24501 47 A UE subscription may contain Network Slice Simultaneous Registration Group NSSRG information If so the UE configuration is performed as described in clause 515122 The UE may be pre-configured with the Default Configured NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_695",
    "document_id": "23501-i80",
    "chunk_id": 695,
    "text": "The UE may be provisionedupdated with the Default Configured NSSAI determined by the UDM in the HPLMN using the UE Parameters Update via UDM Control Plane procedure defined in clause 420 of TS 23502 3 Each S-NSSAI in the Default Configured NSSAI may have a corresponding S-NSSAI as part of the Subscribed S-NSSAIs Consequently if the Subscribed S-NSSAIs which are also present in the Default Configured NSSAI are updated the UDM should update the Default Configured NSSAI in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_696",
    "document_id": "23501-i80",
    "chunk_id": 696,
    "text": "In the HPLMN the S-NSSAIs in the Configured NSSAI provided as described in clause 51542 at the time when they are provided to the UE shall match the Subscribed S-NSSAIs for the UE except a case when Alternative S-NSSAIs that are not subscribed S-NSSAIs are temporarily used and provided to the UE in the Configured NSSAI as described in clause 51519 When the Subscribed S-NSSAIs are updated ie some existing S-NSSAIs are removed andor some new S-NSSAIs are added and one or more are applicable to the Serving PLMN the UE is registered in as described in clause 5153 or when the associated mapping is updated the AMF shall update the UE with the Configured NSSAI for the Serving PLMN andor Allowed NSSAI and Partially Allowed NSSAI andor the associated mapping to HPLMN S-NSSAIs see clause 51542",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_697",
    "document_id": "23501-i80",
    "chunk_id": 697,
    "text": "When there is the need to update the Allowed NSSAI or Partially Allowed NSSAI the AMF shall provide the UE with the new Allowed NSSAI or Partially Allowed NSSAI and the associated mapping to HPLMN S-NSSAIs unless the AMF cannot determine the new Allowed NSSAI eg all S-NSSAIs in the old Allowed NSSAI have been removed from the Subscribed S-NSSAIs in which case the AMF shall not send any Allowed NSSAI to the UE but indicate to the UE to perform a Registration procedure If the UE is in a CM-IDLE state the AMF may trigger Network Triggered Service Request or wait until the UE is in a CM-CONNECTED state as described in clause 4242 TS 23502 3 When providing a Requested NSSAI to the network upon registration the UE in a given PLMN only includes and uses S-NSSAIs applying to this PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_698",
    "document_id": "23501-i80",
    "chunk_id": 698,
    "text": "The mapping of S-NSSAIs of the Requested NSSAI to HPLMN S-NSSAIs may also be provided see clause 515412 for when this is needed The S-NSSAIs in the Requested NSSAI are part of the Configured andor Allowed NSSAIs applicable for this PLMN when they are available If the UE has received NSSRG information together with the Configured NSSAI it only includes in the Requested NSSAI S-NSSAIs that all share a common NSSRG If the UE has stored Pending NSSAI and the UE is still interested in the Pending NSSAI then all the S-NSSAIs in the Requested NSSAI and the Pending S-NSSAI shall share a common NSSRG",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_699",
    "document_id": "23501-i80",
    "chunk_id": 699,
    "text": "If no Configured NSSAI and Allowed NSSAI for the PLMN are available the S-NSSAIs in the Requested NSSAI correspond to the Default Configured NSSAI if configured in the UE Upon successful completion of a UEs Registration procedure over an Access Type the UE obtains from the AMF an Allowed NSSAI or Partially Allowed NSSAI for this Access Type which includes one or more S-NSSAIs and if needed see clause 515412 for when this is needed their mapping to the HPLMN S-NSSAIs These S-NSSAIs are valid for the current Registration Area and Access Type provided by the AMF the UE has registered with and can be used simultaneously by the UE up to the maximum number of simultaneous Network Slice instances or PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_700",
    "document_id": "23501-i80",
    "chunk_id": 700,
    "text": "The UE might also obtain from the AMF one or more rejected S-NSSAIs with cause and validity of rejection An S-NSSAI may be rejected - for the entire PLMN - for the current Registration Area or - partially in the current Registration Area Such S-NSSAI rejected partially in the current Registration area is associated with a list of TAs where the S-NSSAI is not supported The AMF may also reject the use of an S-NSSAI due to congestion as described in clause 51974 While the UE remains RM-REGISTERED in the PLMN and regardless of the Access Type the UE shall not re-attempt to register to an S-NSSAI rejected for the entire PLMN until this rejected S-NSSAI is deleted as specified below While the UE remains RM-REGISTERED in the PLMN the UE shall not re-attempt to register to an S-NSSAI rejected in the current Registration Area until it moves out of the current Registration Area While the UE remains RM-REGISTERED in the PLMN the UE shall not re-attempt to register to an S-NSSAI rejected partially in the RA until the UE moves into a TA which is not part of the list of TAs associated with the S-NSSAI NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_701",
    "document_id": "23501-i80",
    "chunk_id": 701,
    "text": "The details and more cases of S-NSSAI rejection are described in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_702",
    "document_id": "23501-i80",
    "chunk_id": 702,
    "text": "The S-NSSAIs that the UE provides in the Requested NSSAI which are neither in the Allowed NSSAI nor in the Partially Allowed NSSAI nor provided as a rejected S-NSSAI shall by the UE not be regarded as rejected ie the UE may request to register these S-NSSAIs again next time the UE sends a Requested NSSAI The UE stores S-NSSAIs as follows - When provisioned with a Configured NSSAI for a PLMN andor a mapping of Configured NSSAI to HPLMN S-NSSAIs and possibly NSSRG information for each S-NSSAI in the Configured NSSAI if applicable and supported by the UE or when requested to remove the configuration due to network slicing subscription change the UE shall - replace any stored old Configured NSSAI for this PLMN with the new Configured NSSAI for this PLMN if applicable and - delete any stored associated mapping of this old Configured NSSAI for this PLMN to HPLMN S-NSSAIs and if present and applicable store the mapping of Configured NSSAI to HPLMN S-NSSAIs and - delete any stored associated NSSRG information for each S-NSSAI of the Configured NSSAI and if present store the associated NSSRG information for each S-NSSAI of the Configured NSSAI and - delete any stored rejected S-NSSAI for this PLMN - keep the received Configured NSSAI for a PLMN if applicable and associated mapping to HPLMN S-NSSAIs if applicable and associated NSSRG information for each S-NSSAI of the Configured NSSAI if applicable and supported by the UE stored in the UE even when registering in another PLMN until a new Configured NSSAI for this PLMN andor associated mapping are provisioned in the UE or until the network slicing subscription changes as described in clause 51542",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_703",
    "document_id": "23501-i80",
    "chunk_id": 703,
    "text": "The number of Configured NSSAIs and associated mapping to be kept stored in the UE for PLMNs other than the HPLMN is up to UE implementation A UE shall at least be capable of storing a Configured NSSAI for the serving PLMN including any necessary mapping of the Configured NSSAI for the Serving PLMN to HPLMN S-NSSAIs and the Default Configured NSSAI - The Allowed NSSAI received in a Registration Accept message or a UE Configuration Update Command applies to a PLMN when at least a TAI of this PLMN is included in the RATAI list included in this Registration Accept message or UE Configuration Update Command If the UE Configuration Update Command contains an Allowed NSSAI but not a TAI List then the last received RATAI list applies for the decision on which PLMNs the Allowed NSSAI is applicable If received the Allowed NSSAI for a PLMN and Access Type and any associated mapping of this Allowed NSSAI to HPLMN S-NSSAIs shall be stored in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_704",
    "document_id": "23501-i80",
    "chunk_id": 704,
    "text": "The UE should store this Allowed NSSAI and any associated mapping of this Allowed NSSAI to HPLMN S-NSSAIs also when the UE is turned off or until the network slicing subscription changes as described in clause 51542 NOTE 4 Whether the UE stores the Allowed NSSAI and any associated mapping of the Allowed NSSAI to HPLMN S-NSSAIs also when the UE is turned off is left to UE implementation -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_705",
    "document_id": "23501-i80",
    "chunk_id": 705,
    "text": "When a new Allowed NSSAI for a PLMN and any associated mapping of the Allowed NSSAI to HPLMN S-NSSAIs are received over an Access Type the UE shall - replace any stored old Allowed NSSAI and any associated mapping for these PLMN and Access Type with this new Allowed NSSAI and - delete any stored associated mapping of this old Allowed NSSAI for this PLMN to HPLMN S-NSSAIs and if present store the associated mapping of this new Allowed NSSAI to HPLMN S-NSSAIs - If received a Partially Allowed NSSAI received in a Registration Accept message or a UE Configuration Update Command message applies to the current Registration Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_706",
    "document_id": "23501-i80",
    "chunk_id": 706,
    "text": "The UE stores the Partially Allowed NSSAI in the same way as described for the Allowed NSSAI see also clause 51517 - If received an S-NSSAI rejected for the entire PLMN shall be stored in the UE while RM-REGISTERED in this PLMN regardless of the Access Type or until it is deleted - If received an S-NSSAI rejected for the current Registration Area shall be stored in the UE while RM-REGISTERED until the UE moves out of the current Registration Area or until the S-NSSAI is deleted - If received an S-NSSAI rejected partially in the RA shall be stored in the UE while RM-REGISTERED until the UE moves out of the current Registration Area or until the S-NSSAI is deleted see also clause 51517 NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_707",
    "document_id": "23501-i80",
    "chunk_id": 707,
    "text": "The storage aspects of rejected S-NSSAIs are described in TS 24501 47 - If received the Pending NSSAI shall be stored in the UE as described in TS 24501 47 - If received the S-NSSAI validity time information shall be stored in the UE in the UE as described in TS 24501 47 - If received the S-NSSAI location availability information shall be stored in the UE as described in TS 24501 47 - If received the mapping of old S-NSSAI to the Alternative S-NSSAI and associated Access Type shall be stored in the UE as described in TS 24501 47 UE configuration to guide UE selection of a N3IWFTNGF that supports the S-NSSAIs needed by the UE is defined in clause 636 and clause 6312 respectively 515412 Mapping of S-NSSAIs values in the Allowed NSSAI and in the Requested NSSAI to the S-NSSAIs values used in the HPLMN For the roaming case one or more S-NSSAIs in an Allowed NSSAI provided to the UE can have values which are not part of the UEs current Network Slice configuration information for the Serving PLMN In this case the network provides the Allowed NSSAI together with the mapping of each S-NSSAI of the Allowed NSSAI to the corresponding S-NSSAI of the HPLMN This mapping information allows the UE to associate Applications to S-NSSAIs of the HPLMN as per NSSP of the URSP rules or as per the UE Local Configuration as defined in clause 61221 of TS 23503 45 and to the corresponding S-NSSAI from the Allowed NSSAI In the non-roaming case and if the Serving PLMN ID is the same as the PLMN ID of the SUPI the network shall not provide any mapped S-NSSAI to the UE with the Allowed NSSAI In the non-roaming case and if the Serving PLMN ID is not the same as the PLMN ID of the SUPI the network shall provide the mapped S-NSSAI of the HPLMN to the UE with the Allowed NSSAI if different values are used for S-NSSAI in Serving PLMN and mapped S-NSSAI in HPLMN NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_708",
    "document_id": "23501-i80",
    "chunk_id": 708,
    "text": "It is recommended that the Serving PLMN and the HPLMN use the same S-NSSAI values in this case The UE shall provide in the Requested NSSAI the mapping of S-NSSAIs of the Serving PLMN values to the corresponding S-NSSAI values of the HPLMN for each S-NSSAI in the Requested NSSAI for which a mapping is available These values are found in the mapping previously received from the Serving PLMN of the S-NSSAIs of the Configured NSSAI for the Serving PLMN or of the S-NSSAIs of the Allowed NSSAI for the Serving PLMN and Access Type to the corresponding S-NSSAIs values used in the HPLMN If the AMF provides Partially Allowed NSSAI to the UE in roaming case the AMF may provide the mapping information of each S-NSSAI of the Partially Allowed NSSAI to the corresponding HPLMN S-NSSAI as described in clause 51517 51542 Update of UE Network Slice configuration At any time the AMF may provide the UE with a new Configured NSSAI for the Serving PLMN associated with mapping of the Configured NSSAI to HPLMN S-NSSAIs as specified in clause 51541",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_709",
    "document_id": "23501-i80",
    "chunk_id": 709,
    "text": "The Configured NSSAI for the Serving PLMN and the mapping information is either determined in the AMF if based on configuration the AMF is allowed to determine the Network Slice configuration for the whole PLMN or by the NSSF The AMF provides an updated Configured NSSAI as specified in clause 424 of TS 23502 3 UE Configuration Update procedure If an S-NSSAI is to be stopped to be used eg due to the network slice is to be deleted as described in TS 28541 149 the AMFs may reject UE requests for the S-NSSAI based on the OAM state before the network slice becomes unavailable The AMF may based on operator policies eg when there is no timing information related to the termination or the AMF or UE does not support the timing information as described in in clause 51516 release PDU Sessions associated with the S-NSSAI and remove the S-NSSAI from eg the Allowed NSSAI and the Configured NSSAI before the Network Slice becomes unavailable The AMF may use the timing information as described in clause 51516 if it supports this feature and set validity time of the S-NSSAI accordingly The AMF shall provide the UE with NSSRG information alongside the Configured NSSAI if NSSRG information is included in the subscription information received from the UDM and if the UE has indicated support for the feature as part of the registration request see clause 51512 The AMF may provide the UE with the mapping of old S-NSSAI to the Alternative S-NSSAI if the UE has indicated support for the feature as part of the registration request see clause 51519 If the HPLMN performs the configuration update of a UE registered in the HPLMN eg due to a change in the Subscribed S-NSSAIs or due to a change of NSSRG information this results in updates to the Configured NSSAI for the HPLMN and if applicable NSSRG information for each S-NSSAI of the Configured NSSAI Updates to the Allowed NSSAI andor if present to the associated mapping of the Allowed NSSAI to HPLMN S-NSSAIs are also possible if the configuration update affects S-NSSAIs in the current Allowed NSSAI If the VPLMN performs the configuration update of a UE registered in the VPLMN eg due to a change in the Subscribed S-NSSAIs the associated mapping is updated or due to a change of NSSRG information this results in updates to the Configured NSSAI for the Serving PLMN andor to the associated mapping of the Configured NSSAI for the Serving PLMN to HPLMN S-NSSAIs and if applicable NSSRG information for each S-NSSAI of the Configured NSSAI Updates to the Allowed NSSAI andor to the associated mapping of the Allowed NSSAI to HPLMN S-NSSAIs are also possible if the configuration update affects S-NSSAIs in the current Allowed NSSAI A UE for which the Configured NSSAI for the Serving PLMN has been updated as described in clause 51541 and has been requested to perform a Registration procedure shall initiate a Registration procedure to receive a new valid Allowed NSSAI see clause 515522 When the subscribed S-NSSAIs change a UDR flag is set in the HPLMN to make sure the current PLMN or if the UE was not reachable the next serving PLMN is informed by the UDM that the subscription data for network slicing has changed The AMF when it receives the indication from the UDM subscription has changed indicates the UE that subscription has changed and uses any updated subscription information from the UDM to update the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_710",
    "document_id": "23501-i80",
    "chunk_id": 710,
    "text": "Once the AMF updates the UE and obtains an acknowledgment from the UE the AMF informs the UDM that the configuration update was successful and the UDM clears the flag in the UDR If the UE is in a CM-IDLE state the AMF may trigger Network Triggered Service Request or wait until the UE is in a CM-CONNECTED state as described in clause 4242 TS 23502 3 If the UE receives indication from the AMF that Network Slicing subscription has changed the UE locally deletes the network slicing information it has for all PLMNs except the Default Configured NSSAI if present It also updates the current PLMN network slicing configuration information with any received values from the AMF The update of URSP rules which include the NSSP if necessary at any time is described in TS 23503 45 5155 Detailed Operation Overview 51551 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_711",
    "document_id": "23501-i80",
    "chunk_id": 711,
    "text": "The establishment of User Plane connectivity to a Data Network via a Network Slice instances comprises two steps - performing a RM procedure to select an AMF that supports the required Network Slices - establishing one or more PDU Session to the required Data network via the Network Slice instances 51552 Selection of a Serving AMF supporting the Network Slices 515521 Registration to a set of Network Slices When a UE registers over an Access Type with a PLMN if the UE has either or both of - a Configured NSSAI for this PLMN - an Allowed NSSAI for this PLMN and Access Type the UE shall provide to the network in AS layer under the conditions described in clause 5159 and in NAS layer a Requested NSSAI containing the S-NSSAIs corresponding to the Network Slices to which the UE wishes to register unless they are stored in the UE in the Pending NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_712",
    "document_id": "23501-i80",
    "chunk_id": 712,
    "text": "The Requested NSSAI shall be one of - the Default Configured NSSAI ie if the UE has no Configured NSSAI nor an Allowed NSSAI for the serving PLMN - the Configured-NSSAI or a subset thereof as described below eg if the UE has no Allowed NSSAI for the Access Type for the serving PLMN - the Allowed-NSSAI for the Access Type over which the Requested NSSAI is sent or a subset thereof or - the Allowed-NSSAI for the Access Type over which the Requested NSSAI is sent or a subset thereof plus one or more S-NSSAIs from the Configured-NSSAI not yet in the Allowed NSSAI for the Access Type as described below NOTE 1 If the UE wishes to register only a subset of the S-NSSAIs from the Configured NSSAI or the Allowed NSSAI to be able to register with some Network Slices eg to establish PDU Sessions for some applications and the UE uses the URSP rules which includes the NSSP or the UE Local Configuration as defined in clause 61221 of TS 23503 45 then the UE uses applicable the URSP rules or the UE Local Configuration to ensure that the S-NSSAIs included in the Requested NSSAI are not in conflict with the URSP rules or with the UE Local Configuration The subset of S-NSSAIs in the Configured-NSSAI provided in the Requested NSSAI consists of one or more S-NSSAIs in the Configured NSSAI applicable to this PLMN if one is present and for which no corresponding S-NSSAI is already present in the Allowed NSSAI for the access type for this PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_713",
    "document_id": "23501-i80",
    "chunk_id": 713,
    "text": "The UE shall not include in the Requested NSSAI any S-NSSAI that is currently rejected by the network ie rejected in the current registration area or rejected in the PLMN For the registration to a PLMN for which neither a Configured NSSAI applicable to this PLMN or an Allowed NSSAI are present the S-NSSAIs provided in the Requested NSSAI correspond to the S-NSSAIs in the Default Configured NSSAI unless the UE has HPLMN S-NSSAI for established PDU Sessions in which case the HPLMN S-NSSAIs shall be provided in the mapping of Requested NSSAI in the NAS Registration Request message with no corresponding VPLMN S-NSSAI in the Requested NSSAI If the UE has been provided with NSSRG information together with the Configured NSSAI the UE only includes in the Requested NSSAI S-NSSAIs that share a common NSSRG see clause 515122 If the UE has stored Pending NSSAI and the UE is still interested in the Pending NSSAI then all the S-NSSAIs in the Requested NSSAI and the Pending S-NSSAI shall share a common NSSRG When a UE registers over an Access Type with a PLMN the UE shall also indicate in the Registration Request message when the Requested NSSAI is based on the Default Configured NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_714",
    "document_id": "23501-i80",
    "chunk_id": 714,
    "text": "The UE shall include the Requested NSSAI in the RRC Connection Establishment and in the establishment of the connection to the N3IWFTNGF as applicable and in the NAS Registration procedure messages subject to conditions set out in clause 5159 However the UE shall not indicate any NSSAI in RRC Connection Establishment or Initial NAS message unless it has either a Configured NSSAI for the corresponding PLMN an Allowed NSSAI for the corresponding PLMN and Access Type or the Default Configured NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_715",
    "document_id": "23501-i80",
    "chunk_id": 715,
    "text": "If the UE has HPLMN S-NSSAIs for established PDU Sessions the HPLMN S-NSSAIs shall be provided in the mapping of Requested NSSAI in the NAS Registration Request message independent of whether the UE has the corresponding VPLMN S-NSSAI The RAN shall route the NAS signalling between this UE and an AMF selected using the Requested NSSAI obtained during RRC Connection Establishment or connection to N3IWFTNGF respectively If the RAN is unable to select an AMF based on the Requested NSSAI it routes the NAS signalling to an AMF from a set of default AMFs In the NAS signalling if the UE is roaming the UE provides the mapping of each S-NSSAI of the Requested NSSAI to a corresponding HPLMN S-NSSAI When a UE registers with a PLMN if for this PLMN the UE has not included a Requested NSSAI nor a GUAMI while establishing the connection to the RAN the RAN shall route all NAS signalling fromto this UE tofrom a default AMF When receiving from the UE a Requested NSSAI and a 5G-S-TMSI or a GUAMI in RRC Connection Establishment or in the establishment of connection to N3IWFTNGF if the 5G-AN can reach an AMF corresponding to the 5G-S-TMSI or GUAMI then 5G-AN forwards the request to this AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_716",
    "document_id": "23501-i80",
    "chunk_id": 716,
    "text": "Otherwise the 5G-AN selects a suitable AMF based on the Requested NSSAI provided by the UE and forwards the request to the selected AMF If the 5G-AN is not able to select an AMF based on the Requested NSSAI then the request is sent to a default AMF When the AMF selected by the AN during Registration Procedure receives the UE Registration request or after an AMF selection by MME ie during EPS to 5GS handover the AMF receives S-NSSAIs from SMFPGW-C in 5GC -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_717",
    "document_id": "23501-i80",
    "chunk_id": 717,
    "text": "As part of the Registration procedure described in clause 42222 of TS 23502 3 or as part of the EPS to 5GS handover using N26 interface procedure described in clause 411122 of TS 23502 3 the AMF may query the UDM to retrieve UE subscription information including the Subscribed S-NSSAIs - The AMF verifies whether the S-NSSAIs in the Requested NSSAI or the S-NSSAIs received from SMFPGW-C are permitted based on the Subscribed S-NSSAIs to identify the Subscribed S-NSSAIs the AMF may use the mapping to HPLMN S-NSSAIs provided by the UE in the NAS message for each S-NSSAI of the Requested NSSAI - When the UE context in the AMF does not yet include an Allowed NSSAI for the corresponding Access Type the AMF queries the NSSF see B below for subsequent handling except in the case when based on configuration in this AMF the AMF is allowed to determine whether it can serve the UE see A below for subsequent handling The IP address or FQDN of the NSSF is locally configured in the AMF NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_718",
    "document_id": "23501-i80",
    "chunk_id": 718,
    "text": "The configuration in the AMF depends on operators policy - When the UE context in the AMF already includes an Allowed NSSAI for the corresponding Access Type based on the configuration for this AMF the AMF may be allowed to determine whether it can serve the UE see A below for subsequent handling - AMF or NSSF may have previously subscribed to slice load level andor Observed Service Experience andor Dispersion Analytics related network data analytics for a Network Slice from NWDAF optionally for an Area of Interest composed of one or several TAIs If AMF subscribes to analytics AMF may determine that it cannot serve the UE based on received analytics see A below If AMF subscribes to notifications on changes on the Network Slice or Network Slice instance availability information from NSSF optionally indicating a list of supported TAIs it may determine that it cannot serve the UE after the restriction notification is received see A below If AMF does not subscribe to notifications on changes on the availability information from NSSF NSSF may take the analytics information into account when AMF queries NSSF see B below NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_719",
    "document_id": "23501-i80",
    "chunk_id": 719,
    "text": "The configuration in the AMF depends on the operators policy A Depending on fulfilling the configuration as described above the AMF may be allowed to determine whether it can serve the UE and the following is performed - For the mobility from EPS to 5GS the AMF first derives the serving PLMN values of S-NSSAIs based on the HPLMN S-NSSAIs in the mapping of Requested NSSAI in CM-IDLE state or the HPLMN S-NSSAIs received from SMFPGW-C in CM-CONNECTED state After that the AMF regards the derived values as the Requested NSSAI - For the inter PLMN within 5GC mobility the new AMF derives the serving PLMN values of S-NSSAIs based on the HPLMN S-NSSAIs in the mapping of Requested NSSAI After that the AMF regards the derived values as the Requested NSSAI - AMF checks whether it can serve all the S-NSSAIs from the Requested NSSAI present in the Subscribed S-NSSAIs potentially using configuration for mapping S-NSSAI values between HPLMN and Serving PLMN or all the S-NSSAIs marked as default in the Subscribed S-NSSAIs in the case that no Requested NSSAI was provided or none of the S-NSSAIs in the Requested NSSAI are permitted ie do not match any of the Subscribed S-NSSAIs see clause 5153 or not available at the current UEs Tracking Area see clause 5158 If the AMF is configured with a local policy to include in the Allowed NSSAI subscribed S-NSSAIs that are not in the Requested NSSAI and some of the Subscribed S-NSSAIs are not supported by the AMF the AMF queries the NSSF see B below - If AMF has subscribed to slice load level andor Observed Service Experience andor Dispersion Analytics related network data analytics for a Network Slice from NWDAF or if AMF had received a Network Slice restriction from NSSF that applies to the list of TAIs supported by the AMF it may use that information to determine whether the AMF can serve the UE on the S-NSSAIs in the Requested NSSAI - If the AMF can serve the S-NSSAIs in the Requested NSSAI and any additional S-NSSAI added due to local policy as described below the AMF remains the serving AMF for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_720",
    "document_id": "23501-i80",
    "chunk_id": 720,
    "text": "The Allowed NSSAI is then determined by taking into account the list of S-NSSAIs in the Requested NSSAI permitted based on the Subscribed S-NSSAIs andor the list of S-NSSAIs for the Serving PLMN which are mapped to the HPLMN S-NSSAIs provided in the mapping of Requested NSSAI permitted based on the Subscribed S-NSSAIs or if neither Requested NSSAI nor the mapping of Requested NSSAI was provided or none of the S-NSSAIs in the Requested NSSAI are permitted all the S-NSSAIs marked as default in the Subscribed S-NSSAIs and taking also into account the availability of the Network Slice instances as described in clause 5158 that are able to serve the S-NSSAIs in the Allowed NSSAI in the current UEs Tracking Areas in addition to any Network Slice instance restriction for the S-NSSAIs in the Allowed NSSAI provided by the NSSF The AMF based on local policy may determine to include in the Allowed NSSAI additional Subscribed S-NSSAIs eg Subscribed S-NSSAIs not marked as default andor Subscribed S-NSSAIs that were not provided in the Requested NSSAI See NOTE 4 If the AMF has received NSSRG Information for the Subscribed S-NSSAIs as part of the UE subscription information it shall only include in the Allowed NSSAI S-NSSAIs that all share a common NSSRG see clause 51512 If at least one S-NSSAI in the Requested NSSAI is not available in the current UEs Tracking Area then either the AMF may determine a Target NSSAI or step B is executed The AMF also determines the mapping if the S-NSSAIs included in the Allowed NSSAI needs to be mapped to Subscribed S-NSSAIs values If no Requested NSSAI is provided or the mapping of the S-NSSAIs in Requested NSSAI to HPLMN S-NSSAIs is incorrect or the Requested NSSAI includes an S-NSSAI that is not valid in the Serving PLMN or the UE indicated that the Requested NSSAI is based on the Default Configured NSSAI the AMF based on the Subscribed S-NSSAIs and operators configuration may also determine the Configured NSSAI for the Serving PLMN and if applicable the associated mapping of the Configured NSSAI to HPLMN S-NSSAIs so these can be configured in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_721",
    "document_id": "23501-i80",
    "chunk_id": 721,
    "text": "Then Step C is executed NOTE 4 The ability for the AMF to construct the Allowed NSSAI with values not contained in Requested NSSAI but permitted by subscribed NSSAI can be used to allow the UE to use newly-added S-NSSAIs in the case of Network Slicing Subscription Change see clause 42222 of TS 23502 3 - Else the AMF queries the NSSF see B below B When required as described above the AMF needs to query the NSSF and the following is performed - The AMF queries the NSSF with Requested NSSAI Default Configured NSSAI Indication mapping of Requested NSSAI to HPLMN S-NSSAIs the Subscribed S-NSSAIs with an indication if marked as default S-NSSAI NSSRG Information if provided by the UDM see clause 51512 any Allowed NSSAI it might have for the other Access Type including its mapping to HPLMN S-NSSAIs PLMN ID of the SUPI and UEs current Tracking Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_722",
    "document_id": "23501-i80",
    "chunk_id": 722,
    "text": "If the AMF has pending NSSAI for the UE then the AMF includes pending NSSAI in the Requested NSSAI NOTE 5 The Default Configured NSSAI Indication is provided when received from the UE or when the AMF indicates to the NSSF to return Configured NSSAI in case of the Network Slicing Subscription Change Indication is received from UDM - Based on this information local configuration and other locally available information including RAN capabilities in the current Tracking Area for the UE or load level information for a Network Slice instance provided by the NWDAF the NSSF does the following - It verifies which S-NSSAIs in the Requested NSSAI are permitted based on comparing the Subscribed S-NSSAIs with the S-NSSAIs in the mapping of Requested NSSAI to HPLMN S-NSSAIs It considers the S-NSSAIs marked as default in the Subscribed S-NSSAIs in the case that no Requested NSSAI was provided or no S-NSSAI from the Requested NSSAI are permitted ie are not present in the Subscribed S-NSSAIs or not available eg at the current UEs Tracking Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_723",
    "document_id": "23501-i80",
    "chunk_id": 723,
    "text": "If NSSRG information is provided the NSSF only selects S-NSSAIs that share a common NSSRG see clause 51512 - If AMF has not subscribed to notifications on changes on the Network Slice or Network Slice instance availability information from NSSF and NSSF has subscribed to slice load level andor Observed Service Experience andor Dispersion Analytics related network data analytics for a Network Slice from NWDAF NSSF may use the analytics information for the determination of the Network Slice instances and the list of S-NSSAIs in the Allowed NSSAIs to serve the UE - It selects the Network Slice instances to serve the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_724",
    "document_id": "23501-i80",
    "chunk_id": 724,
    "text": "When multiple Network Slice instances in the UEs Tracking Area are able to serve a given S-NSSAI based on operators configuration the NSSF may select one of them to serve the UE or the NSSF may defer the selection of the Network Slice instance until a NFservice within the Network Slice instance needs to be selected - It determines the target AMF Set to be used to serve the UE or based on configuration the list of candidate AMFs possibly after querying the NRF NOTE 6 If the target AMFs returned from the NSSF is the list of candidate AMFs the Registration Request message can only be redirected via the direct signalling between the initial AMF and the selected target AMF as described in clause 515523 The NSSF does not provide the target AMFs when it provides a Target NSSAI in order to redirect or handover the UE to a cell of another TA as described in clause 53433 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_725",
    "document_id": "23501-i80",
    "chunk_id": 725,
    "text": "It determines the Allowed NSSAIs for the applicable Access Type by taking into account the list of S-NSSAIs in the Requested NSSAI permitted based on the Subscribed S-NSSAIs andor the list of S-NSSAIs for the Serving PLMN which are mapped to the HPLMN S-NSSAIs provided in the mapping of Requested NSSAI permitted based on the Subscribed S-NSSAIs or if neither Requested NSSAI nor the mapping of Requested NSSAI was provided or none of the S-NSSAIs in the Requested NSSAI are permitted all the S-NSSAIs marked as default in the Subscribed S-NSSAIs and taking also into account the availability of the Network Slice instances as described in clause 5158 that are able to serve the S-NSSAIs in the Allowed NSSAI in the current UEs Tracking Areas and taking also into account local policy in the NSSF that may determine to include in the Allowed NSSAI additional Subscribed S-NSSAIs eg Subscribed S-NSSAIs not marked as default andor Subscribed S-NSSAIs that were not provided in the Requested NSSAI see NOTE 7 If NSSRG information applies the NSSF only selects S-NSSAIs that share a common NSSRG see clause 51512 NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_726",
    "document_id": "23501-i80",
    "chunk_id": 726,
    "text": "The ability for the NSSF to construct the Allowed NSSAI with values not contained in Requested NSSAI but permitted by Subscribed NSSAIs can be used to allow the UE to use newly-added S-NSSAIs in the case of Network Slicing Subscription Change see clause 42222 of TS 23502 3 - It also determines the mapping of each S-NSSAI of the Allowed NSSAIs to the Subscribed S-NSSAIs if necessary - Based on operator configuration the NSSF may determine the NRFs to be used to select NFsservices within the selected Network Slice instances - Additional processing to determine the Allowed NSSAIs in roaming scenarios and the mapping to the Subscribed S-NSSAIs as described in clause 5156 - If no Requested NSSAI is provided or the Requested NSSAI includes an S-NSSAI that is not valid in the Serving PLMN or the mapping of the S-NSSAIs in Requested NSSAI to HPLMN S-NSSAIs is incorrect the NSSF based on the Subscribed S-NSSAIs and operator configuration may also determine the Configured NSSAI for the Serving PLMN and if applicable the associated mapping of the Configured NSSAI to HPLMN S-NSSAIs so these can be configured in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_727",
    "document_id": "23501-i80",
    "chunk_id": 727,
    "text": "The NSSF shall return a Configured NSSAI when receiving Default Configured NSSAI Indication from the AMF - If at least one S-NSSAI in the Requested NSSAI is not available in the current UEs Tracking Area the NSSF may provide a Target NSSAI for the purpose of allowing the NG-RAN to redirect the UE to a cell of a TA in another frequency band supporting network slices not available in the current TA as described in clause 53433 - The NSSF returns to the current AMF the Allowed NSSAI for the applicable Access Type the mapping of each S-NSSAI of the Allowed NSSAI to the Subscribed S-NSSAIs if determined and the target AMF Set or based on configuration the list of candidate AMFs The NSSF may return the NRFs to be used to select NFsservices within the selected Network Slice instances and the NRF to be used to determine the list of candidate AMFs from the AMF Set",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_728",
    "document_id": "23501-i80",
    "chunk_id": 728,
    "text": "The NSSF may return NSI IDs to be associated to the Network Slice instances corresponding to certain S-NSSAIs NSSF may return the rejected S-NSSAIs as described in clause 51541 The NSSF may return the Configured NSSAI for the Serving PLMN and the associated mapping of the Configured NSSAI to HPLMN S-NSSAIs The NSSF may return Target NSSAI as described in clause 53433 - Depending on the available information and based on configuration the AMF may query the appropriate NRF eg locally pre-configured or provided by the NSSF with the target AMF Set The NRF returns a list of candidate AMFs - If AMF Re-allocation is necessary the current AMF reroutes the Registration Request or forwards the UE context to a target serving AMF as described in clause 515523 - Step C is executed C",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_729",
    "document_id": "23501-i80",
    "chunk_id": 729,
    "text": "The serving AMF shall determine a Registration Area such that all S-NSSAIs of the Allowed NSSAI for this Registration Area are available in all Tracking Areas of the Registration Area and also considering other aspects as described in clause 5323 and clause 53433 and then return to the UE this Allowed NSSAI and the mapping of the Allowed NSSAI to the Subscribed S-NSSAIs if provided The AMF may return the rejected S-NSSAIs as described in clause 51541 NOTE 8 The S-NSSAIs in the Allowed NSSAI for Non-3GPP access are available homogeneously in the PLMN for the N3IWF case since a N3IWF providing access to a 5GC can be reached from any IP location For other types of Non-3GPP access the S-NSSAIs in the Allowed NSSAI for Non-3GPP access can be not available homogeneously for example different W-AGFsTNGFs can be deployed in different locations and support different TAIs that support different network slices When either no Requested NSSAI was included or the mapping of the S-NSSAIs in Requested NSSAI to HPLMN S-NSSAIs is incorrect or a Requested NSSAI is not considered valid in the PLMN and as such at least one S-NSSAI in the Requested NSSAI was rejected as not usable by the UE in the PLMN or the UE indicated that the Requested NSSAI is based on the Default Configured NSSAI the AMF may update the UE slice configuration information for the PLMN as described in clause 51542 If the Requested NSSAI does not include S-NSSAIs which map to S-NSSAIs of the HPLMN subject to Network Slice-Specific Authentication and Authorization and the AMF determines that no S-NSSAI can be provided in the Allowed NSSAI for the UE in the current UEs Tracking Area and if no default S-NSSAIs could be added as described in step A the AMF shall reject the UE Registration and shall include in the rejection message the list of Rejected S-NSSAIs each of them with the appropriate rejection cause value If the Requested NSSAI includes S-NSSAIs which map to S-NSSAIs of the HPLMN subject to Network Slice-Specific Authentication and Authorization the AMF shall include in the Registration Accept message an Allowed NSSAI containing only those S-NSSAIs that are not to be subject to Network Slice-Specific Authentication and Authorization and based on the UE Context in AMF those S-NSSAIs for which Network Slice-Specific Authentication and Authorization for at least one of the corresponding HPLMN S-NSSAIs succeeded previously regardless the Access Type if any The AMF shall also provide the list of Rejected S-NSSAIs each of them with the appropriate rejection cause value If the AMF determined the Target NSSAI or received a Target NSSAI from the NSSF the AMF should provide the Target NSSAI to the PCF for retrieving a corresponding RFSP as described in clause 53431 or if the PCF is not deployed the AMF should determine a corresponding RFSP based on local configuration Then the AMF provides the Target NSSAI and the corresponding RFSP to the NG-RAN as described in clause 53433",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_730",
    "document_id": "23501-i80",
    "chunk_id": 730,
    "text": "The S-NSSAIs which map to S-NSSAIs of the HPLMN subject to an ongoing Network Slice-Specific Authentication and Authorization shall be included in the Pending NSSAI and removed from Allowed NSSAI The Pending NSSAI may contain a mapping of the S-NSSAIs for the Serving PLMN to the HPLMN S-NSSAIs if applicable The UE shall not include in the Requested NSSAI any of the S-NSSAIs from the Pending NSSAI the UE stores regardless of the Access Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_731",
    "document_id": "23501-i80",
    "chunk_id": 731,
    "text": "If - all the S-NSSAIs in the Requested NSSAI are still to be subject to Network Slice-Specific Authentication and Authorization or - no Requested NSSAI was provided or none of the S-NSSAIs in the Requested NSSAI matches any of the Subscribed S-NSSAIs and all the S-NSSAIs marked as default in the Subscribed S-NSSAIs are to be subject to Network Slice-Specific Authentication and Authorization the AMF shall provide a NSSAA to be performed indicator and no Allowed NSSAI to the UE in the Registration Accept message Upon receiving the Registration Accept message the UE is registered in the PLMN but shall wait for the completion of the Network Slice-Specific Authentication and Authorization without attempting to use any service provided by the PLMN on any access except eg emergency services see TS 24501 47 until the UE receives an allowed NSSAI Then the AMF shall initiate the Network Slice-Specific Authentication and Authorization procedure as described in clause 51510 for each S-NSSAI that requires it except based on Network policies for those S-NSSAIs for which Network Slice-Specific Authentication and Authorization have been already initiated on another Access Type for the same S-NSSAIs At the end of the Network Slice-Specific Authentication and Authorization steps the AMF by means of the UE Configuration Update procedure shall provide a new Allowed NSSAI to the UE which also contains the S-NSSAIs subject to Network Slice-Specific Authentication and Authorization for which the authentication and authorization is successful The AMF may perform AMF selection when NSSAA completes for the S-NSSAIs subject to NSSAA If an AMF change is required this shall be triggered by the AMF using the UE Configuration Update procedure indicating a UE re-registration is required The S-NSSAIs which were not successfully authenticated and authorized are not included in the Allowed NSSAI and are included in the list of Rejected S-NSSAIs with a rejection cause value indicating Network Slice-Specific Authentication and Authorization failure Once completed the Network Slice-Specific re-Authentication and re-Authorization procedure if the AMF determines that no S-NSSAI can be provided in the Allowed NSSAI for the UE which is already authenticated and authorized successfully by a PLMN and if no default S-NSSAIs could be added as described in step A the AMF shall execute the Network-initiated Deregistration procedure described in clause 42233 of TS 23502 3 and shall include in the explicit De-Registration Request message the list of Rejected S-NSSAIs each of them with the appropriate rejection cause value If an S-NSSAI is rejected with a rejection cause value indicating Network Slice-Specific Authentication and Authorization failure or revocation the UE can re-attempt to request the S-NSSAI based on policy local in the UE 515522 Modification of the Set of Network Slices for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_732",
    "document_id": "23501-i80",
    "chunk_id": 732,
    "text": "The set of Network Slices for a UE can be changed at any time while the UE is registered with a network and may be initiated by the network or by the UE under certain conditions as described below The network based on local policies subscription changes andor UE mobility andor UE Dispersion data classification operational reasons eg a Network Slice instance is no longer available or load level information or service experience for a Network Slice or network slice instance provided by the NWDAF may change the set of Network Slices to which the UE is registered and provide the UE with a new Registration Area andor Allowed NSSAI and the mapping of this Allowed NSSAI to HPLMN S-NSSAIs for each Access Type over which the UE is registered In addition the network may provide the Configured NSSAI for the Serving PLMN the associated mapping information and the rejected S-NSSAIs The network may perform such a change over each Access Type during a Registration procedure or trigger a notification towards the UE of the change of the Network Slices using a UE Configuration Update procedure as specified in clause 424 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_733",
    "document_id": "23501-i80",
    "chunk_id": 733,
    "text": "The new Allowed NSSAIs and the mapping to HPLMN S-NSSAIs are determined as described in clause 515521 an AMF Re-allocation may be needed The AMF provides the UE with - an indication that the acknowledgement from UE is required - Configured NSSAI for the Serving PLMN if required rejected S-NSSAIs if required and TAI list and - the new Allowed NSSAI with the associated mapping of Allowed NSSAI for each Access Type as applicable unless the AMF cannot determine the new Allowed NSSAI eg all S-NSSAIs in the old Allowed NSSAI have been removed from the Subscribed S-NSSAIs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_734",
    "document_id": "23501-i80",
    "chunk_id": 734,
    "text": "Furthermore - If the changes to the Allowed NSSAI require the UE to perform immediately a Registration procedure because they affect the existing connectivity to AMF eg the new S-NSSAIs require a separate AMF that cannot be determined by the current serving AMF or the AMF cannot determine the Allowed NSSAI or due to AMF local policies also when the changes does not affect the existing connectivity to AMF - The serving AMF indicates to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_735",
    "document_id": "23501-i80",
    "chunk_id": 735,
    "text": "the need for the UE to perform a Registration procedure without including the GUAMI or 5G-S-TMSI in the access stratum signalling after entering CM-IDLE state The AMF shall release the NAS signalling connection to the UE to allow to enter CM-IDLE after receiving the acknowledgement from UE - When the UE receives indications to perform a Registration procedure without including the GUAMI or 5G-S-TMSI in the access stratum signalling after entering CM-IDLE state then - The UE deletes any stored old Allowed NSSAI and associated mapping as well as any old rejected S-NSSAI - The UE shall initiate a Registration procedure with the registration type Mobility Registration Update after the UE enters CM-IDLE state as specified in as described in step 4 of clause 4242 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_736",
    "document_id": "23501-i80",
    "chunk_id": 736,
    "text": "The UE shall include a Requested NSSAI as described in clause 515521 with the associated mapping of Requested NSSAI in the Registration Request message Also the UE shall include subject to the conditions set out in clause 5159 a Requested NSSAI in access stratum signalling but no GUAMI - If the AMF determines that the S-NSSAI in the Allowed NSSAI is replaced with Alternative S-NSSAI over an Access Type the AMF provides the mapping of old S-NSSAI to the Alternative S-NSSAI to the UE over the same Access Type as described in clause 51519 If there is an established PDU Session associated with emergency services then the serving AMF indicates to the UE the need for the UE to perform a Registration procedure but does not release the NAS signalling connection to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_737",
    "document_id": "23501-i80",
    "chunk_id": 737,
    "text": "The UE performs the Registration procedure only after the release of the PDU Session used for the emergency services In addition to sending the new Allowed NSSAI to the UE when a Network Slice used for a one or multiple PDU Sessions is no longer available for a UE the following applies - If the Network Slice becomes no longer available under the same AMF and the Network Slice Replacement is not used eg due to UE subscription change the AMF indicates to the SMFs which PDU Session IDs corresponding to the relevant S-NSSAI shall be released SMF releases the PDU Session according to clause 4342 of TS 23502 3 If the Network Slice Replacement is used the AMF performs Network Slice Replacement as described in clause 51519 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_738",
    "document_id": "23501-i80",
    "chunk_id": 738,
    "text": "If the Network Slice becomes no longer available upon a change of AMF eg due to Registration Area change the new AMF indicates to the old AMF that the PDU Sessions corresponding to the relevant S-NSSAI shall be released The old AMF informs the corresponding SMFs to release the indicated PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_739",
    "document_id": "23501-i80",
    "chunk_id": 739,
    "text": "The SMFs release the PDU Sessions as described in clause 434 of TS 23502 3 Then the new AMF modifies the PDU Session Status correspondingly The PDU Sessions context is locally released in the UE after receiving the PDU Session Status in the Registration Accept message The UE uses either the URSP rules which includes the NSSP or the UE Local Configuration as defined in clause 61221 of TS 23503 45 to determine whether ongoing traffic can be routed over existing PDU Sessions belonging to other Network Slices or establish new PDU Sessions associated with sameother Network Slice In order to change the set of S-NSSAIs the UE is registered to over an Access Type the UE shall initiate a Registration procedure over this Access Type as specified in clause 515521",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_740",
    "document_id": "23501-i80",
    "chunk_id": 740,
    "text": "If for an established PDU Session - none of the values of the S-NSSAIs of the HPLMN in the mapping of the Requested NSSAI to S-NSSAIs of the HPLMN included in the Registration Request matches the S-NSSAI of the HPLMN associated with the PDU Session or - none of the values of the S-NSSAIs in the Requested NSSAI matches the value of the S-NSSAI of HPLMN associated with the PDU Session and the mapping of the Requested NSSAI to S-NSSAIs of the HPLMN is not included in the Registration Request the network shall release this PDU Session as follows - the AMF informs the corresponding SMFs to release the indicated PDU Sessions The SMFs release the PDU Sessions as described in clause 434 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_741",
    "document_id": "23501-i80",
    "chunk_id": 741,
    "text": "Then the AMF modifies the PDU Session Status correspondingly The PDU Sessions context is locally released in the UE after receiving the PDU Session Status from the AMF A change of the set of S-NSSAIs whether UE or Network initiated to which the UE is registered may subject to operator policy lead to AMF change as described in clause 515521 If the AMF supports the Network Slice Replacement feature and is configured to use the NSSF to trigger the Network Slice Replacement the AMF subscribes with the NSSF for notifications when any of the S-NSSAIs served by the AMF eg the S-NSSAI in the Serving PLMN and the HPLMN S-NSSAI in roaming case has to be replaced as described in clause 51519 If the AMF supports the Network Slice Instance Replacement and configured to use Network Slice Instance Replacement the AMF subscribes with the NSSF for notifications when a Network Slice instances served by the AMF is congested or no longer available as described in clause 51520",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_742",
    "document_id": "23501-i80",
    "chunk_id": 742,
    "text": "The AMF may perform Network Slice Replacement for the PDU Session as described in clause 51519 515523 AMF Re-allocation due to Network Slices Support During a Registration procedure in a PLMN if the network decides that the UE should be served by a different AMF based on Network Slices aspects then the AMF that first received the Registration Request shall redirect the Registration request to target AMF via the 5G-AN or via direct signalling between the initial AMF and the target AMF If the target AMFs are returned from the NSSF and identified by a list of candidate AMFs the redirection message shall only be sent via the direct signalling between the initial AMF and the target AMF If the redirection message is sent by the AMF via the 5G-AN the message shall include information for selection of a new AMF to serve the UE When during a Registration procedure the UE requests a new S-NSSAI which is not supported in the UEs current Tracking Area the serving AMF itself or by interacting with the NSSF as described in clause 515521 may determine a Target NSSAI The AMF provides the Target NSSAI to the NG-RAN and the NG-RAN may apply redirection or handover of the UE to a cell in another TA supporting the Target NSSAI as described in clause 53433 During a EPS to 5GS handover using N26 interface procedure if the network decides that the UE should be served by a different AMF based on Network Slices aspects then the AMF which received the Forward Relocation Request from MME shall forward the UE context to target AMF via direct signalling between the initial AMF and the target AMF as described in clause 411122 of TS 23502 3 For a UE that is already registered the system shall support a redirection initiated by the network of a UE from its serving AMF to a target AMF due to Network Slices considerations eg the operator has changed the mapping between the Network Slice instances and their respective serving AMFs Operator policy determines whether redirection between AMFs is allowed 51553 Establishing a PDU Session in a Network Slice The PDU Session Establishment in a Network Slice instance to a DN allows data transmission in a Network Slice instance A PDU Session is associated to an S-NSSAI and a DNN A UE that is registered in a PLMN over an Access Type and has obtained a corresponding Allowed NSSAI shall indicate in the PDU Session Establishment procedure the S-NSSAI according to the NSSP in the URSP rules or according to the UE Local Configuration as defined in clause 61221 of TS 23503 45 and if available the DNN the PDU Session is related to The UE includes the appropriate S-NSSAI from this Allowed NSSAI and if mapping of the Allowed NSSAI to HPLMN S-NSSAIs was provided an S-NSSAI with the corresponding value from this mapping If the UE cannot determine any S-NSSAI after performing the association of the application to a PDU Session according to clause 61221 of TS 23503 45 the UE shall not indicate any S-NSSAI in the PDU Session Establishment procedure The network HPLMN may provision the UE with Network Slice selection policy NSSP as part of the URSP rules see clause 662 of TS 23503 45 When the Subscription Information contains more than one S-NSSAI and the network wants to controlmodify the UE usage of those S-NSSAIs then the network provisionsupdates the UE with NSSP as part of the URSP rules When the Subscription Information contains only one S-NSSAI the network needs not provision the UE with NSSP as part of the URSP rules The NSSP rules associate an application with one or more HPLMN S-NSSAIs A default rule which matches all applications to a HPLMN S-NSSAI may also be included The UE shall store and use the URSP rules including the NSSP as described in TS 23503 45 When a UE application associated with a specific S-NSSAI requests data transmission - if the UE has one or more PDU Sessions established corresponding to the specific S-NSSAI the UE routes the user data of this application in one of these PDU Sessions unless other conditions in the UE prohibit the use of these PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_743",
    "document_id": "23501-i80",
    "chunk_id": 743,
    "text": "If the application provides a DNN then the UE considers also this DNN to determine which PDU Session to use This is further described in clause 662 of TS 23503 45 - If the UE does not have a PDU Session established with this specific S-NSSAI the UE requests a new PDU Session corresponding to this S-NSSAI and with the DNN that may be provided by the application In order for the RAN to select a proper resource for supporting network slicing in the RAN RAN needs to be aware of the Network Slices used by the UE This is further described in clause 662 of TS 23503 45 If the AMF is not able to determine the appropriate NRF to query for the S-NSSAI provided by the UE the AMF may query the NSSF with this specific S-NSSAI location information PLMN ID of the SUPI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_744",
    "document_id": "23501-i80",
    "chunk_id": 744,
    "text": "The NSSF determines and returns the appropriate NRF to be used to select NFsservices within the selected Network Slice instance The NSSF may also return an NSI ID to be used to select NFs within the selected Network Slice instance to use for this S-NSSAI The AMF or NSSF may select an S-NSSAI if the UE does not provide an S-NSSAI for the PDU session establishment and a Network Slice instance based on load level andor Observe Service Experience andor Dispersion analytics from NWDAF as described in TS 23288 86 The IP address or FQDN of the NSSF is locally configured in the AMF SMF discovery and selection within the selected Network Slice instance is initiated by the AMF when a SM message to establish a PDU Session is received from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_745",
    "document_id": "23501-i80",
    "chunk_id": 745,
    "text": "The appropriate NRF is used to assist the discovery and selection tasks of the required network functions for the selected Network Slice instance The AMF queries the appropriate NRF to select an SMF in a Network Slice instance based on S-NSSAI DNN NSI-ID if available and other information eg UE subscription and local operator policies when the UE triggers PDU Session Establishment",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_746",
    "document_id": "23501-i80",
    "chunk_id": 746,
    "text": "The AMF may select the SMF among the set of the SMF instances returned by the NRF or locally configured in the AMF based on network data analytics NF load etc from the NWDAF as described in TS 23288 86 The selected SMF establishes a PDU Session based on S-NSSAI and DNN When the AMF belongs to multiple Network Slice instances based on configuration the AMF may use an NRF at the appropriate level for the SMF selection For further details on the SMF selection refer to clause 43223 of TS 23502 3 When a PDU Session for a given S-NSSAI is established using a specific Network Slice instance the CN provides to the RAN the S-NSSAI corresponding to this Network Slice instance to enable the RAN to perform access specific functions The UE shall not perform PDU Session handover from one Access Type to another if the S-NSSAI of the PDU Session is not included in the Allowed NSSAI of the target Access Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_747",
    "document_id": "23501-i80",
    "chunk_id": 747,
    "text": "In non-roaming case if the Serving PLMN ID is not the same as the PLMN ID of the SUPI and a mapped S-NSSAI value of the HPLMN is present in the Allowed NSSAI the procedures as defined in clause 4235 of TS 23502 3 is used for PDU Session Management with the following differences -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_748",
    "document_id": "23501-i80",
    "chunk_id": 748,
    "text": "In PDU Session Establishment procedure the AMF selects the SMF according to the S-NSSAI of the mapped S-NSSAI value of the HPLMN and selects I-SMF according to the S-NSSAI of the S-NSSAI value of the Serving PLMN and provides the S-NSSAI of the Serving PLMN and the mapped S-NSSAI of the HPLMN as received from the UE to the selected I-SMF 5156 Network Slicing Support for Roaming For roaming scenarios - If the UE only uses standard S-NSSAI values then the same S-NSSAI values can be used in VPLMN as in the HPLMN - If the VPLMN and HPLMN have an SLA to support non-standard S-NSSAI values in the VPLMN the NSSF of the VPLMN maps the Subscribed S-NSSAIs values to the respective S-NSSAI values to be used in the VPLMN The S-NSSAI values to be used in the VPLMN are determined by the NSSF of the VPLMN based on the SLA The NSSF of the VPLMN need not inform the HPLMN of which values are used in the VPLMN Depending on operators policy and the configuration in the AMF the AMF may decide the S-NSSAI values to be used in the VPLMN and the mapping to the Subscribed S-NSSAIs For the home routed case the AMF or NSSF may select an S-NSSAI if the UE does not provide an S-NSSAI for the PDU session establishment and a Network Slice instance based on load level andor Observe Service Experience andor Dispersion analytics of the VPLMN andor that of the HPLMN from NWDAF as described in TS 23288 86 - The UE constructs Requested NSSAI and provides the mapping of S-NSSAIs of the Requested NSSAI to HPLMN S-NSSAIs if the mapping is stored in the UE as described in clause 515521 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_749",
    "document_id": "23501-i80",
    "chunk_id": 749,
    "text": "The NSSF in the VPLMN determines the Allowed NSSAI without interacting with the HPLMN - the HPLMN may provide NSSRG Information as part of the Subscription information as described in clause 51512 - The Allowed NSSAI in the Registration Accept includes S-NSSAI values used in the VPLMN The mapping information described above is also provided to the UE with the Allowed NSSAI as described in clause 5154 - If the S-NSSAI values are subject to NSAC depending on operators policy a roaming agreement or an SLA between VPLMN and HPLMN the AMF or SMF in VPLMN triggers a request for NSAC for these S-NSSAI values as described in clause 515113 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_750",
    "document_id": "23501-i80",
    "chunk_id": 750,
    "text": "In PDU Session Establishment procedure the UE includes both a the S-NSSAI that matches the application that is triggering the PDU Session Request within the NSSP in the URSP rules or within the UE Local Configuration as defined in clause 61221 of TS 23503 45 the value of this S NSSAI is used in the HPLMN and b an S-NSSAI belonging to the Allowed NSSAI that maps to a using the mapping of the Allowed NSSAI to HPLMN S-NSSAIs the value of this S-NSSAI is used in the VPLMN For the home routed case the AMF may select the V-SMF and the H-SMF based on network data analytics NF load etc of the VPLMN and that of the HPLMN from the NWDAF as described in TS 23288 86",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_751",
    "document_id": "23501-i80",
    "chunk_id": 751,
    "text": "The V-SMF sends the PDU Session Establishment Request message to the H-SMF along with the S-NSSAI with the value used in the HPLMN a If the S-NSSAI values are subject to NSAC the V-SMF or H-SMF triggers a request for NSAC for these S-NSSAI values as described in clause 515113 - When a PDU Session is established the CN provides to the AN the S-NSSAI with the value from the VPLMN corresponding to this PDU Session as described in clause 51553 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_752",
    "document_id": "23501-i80",
    "chunk_id": 752,
    "text": "The Network Slice instance specific network functions in the VPLMN are selected by the VPLMN by using the S-NSSAI with the value used in the VPLMN and querying an NRF that has either been pre-configured or provided by the NSSF in the VPLMN The Network Slice specific functions of the HPLMN if applicable are selected by the VPLMN by using the related S-NSSAI with the value used in the HPLMN via the support from an appropriate NRF in the HPLMN identified as specified in clause 4175 of TS 23502 3 and for SMF in clause 432233 of TS 23502 3 - If the serving AMF supports the Network Slice Replacement feature and is configured to use the NSSF for Network Slice Replacement triggering the AMF subscribes with the NSSF of the VPLMN for notifications when an HPLMN S-NSSAI needs to be replaced with an Alternative S-NSSAI in addition to notifications for the Serving PLMN S-NSSAIs The NSSF of the VPLMN shall subscribe with the NSSF of the HPLMN for notifications when an HPLMN S-NSSAI needs to be replaced with an Alternative S-NSSAI -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_753",
    "document_id": "23501-i80",
    "chunk_id": 753,
    "text": "If the serving AMF support the Network Slice Instance Replacement and configured to use Network Slice Instance Replacement the AMF subscribes with the NSSF of the VPLMN for notifications when a Network Slice instance is congested or no longer available as described in clause 51520 The NSSF of the VPLMN shall subscribe with the NSSF of the HPLMN for notifications when the Network Slice instance is congested or no longer available 5157 Network slicing and Interworking with EPS 51571 General A 5GS supports Network Slicing and might need to interwork with the EPS in its PLMN or in other PLMNs as specified in clause 5172 The EPC may support the Dedicated Core Networks DCN In some deployments the MME selection may be assisted by a DCN-ID provided by the UE to the RAN see TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_754",
    "document_id": "23501-i80",
    "chunk_id": 754,
    "text": "Mobility between 5GC to EPC does not guarantee all active PDU Sessions can be transferred to the EPC During PDN connection establishment in the EPC the UE allocates the PDU Session ID and sends it to the SMFPGW-C via PCO As described in clause 4110a5 of TS 23502 3 an S-NSSAI associated with the PDN connection is determined based on the S-NSSAIs supported by the SMFPGW-C the Subscribed S-NSSAI from UDM whether interworking with EPS is supported for the DNN and S-NSSAI in the Session Management Subscription data and the operator policy by the SMFPGW-C eg based on a combination of SMFPGW-C address and APN and is sent to the UE in PCO together with a PLMN ID that the S-NSSAI relates to In Home Routed roaming case the UE receives a HPLMN S-NSSAI value from the SMFPGW-C If the SMFPGW-C supports more than one S-NSSAI and the APN is valid for more than one S-NSSAI the SMFPGW-C should only select an S-NSSAI that is mapped to the subscribed S-NSSAI of the UE and this subscribed S-NSSAI is not subject to Network Slice-Specific Authentication and Authorization The UE stores this S-NSSAI and the PLMN ID associated with the PDN connection The UE derives Requested NSSAI by taking into account of the received PLMN ID The Requested NSSAI is included in the NAS Registration Request message and subject to the conditions in clause 5159 the RRC message carrying this Registration Request when the UE registers in 5GC if the UE is non-roaming or the UE has Configured NSSAI for the VPLMN in roaming case If the UE has no Configured NSSAI of the VPLMN the UE includes the HPLMN S-NSSAIs in the NAS Registration Request message as described in clause 515521 When UE moves from EPS to 5GS AMF reallocation may happen as described in clause 51572 and clause 51573 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_755",
    "document_id": "23501-i80",
    "chunk_id": 755,
    "text": "It is assumed that if a MME is configured with a N26 interface towards an AMF the MME has N26 interfaces with all AMFs serving the same area than the initial AMF and that can serve UE subject to EPS to 5GS mobility 51572 Idle mode aspects In addition to the interworking principles documented in clause 5172 the following applies for interworking with N26 - When UE moves from 5GS to EPS the UE context information sent by AMF to MME includes the UE Usage type which is retrieved from UDM by AMF as part of subscription data - When UE moves from EPS to 5GS then the UE includes the S-NSSAIs with values for the Serving PLMN of the target 5GS if available associated with the established PDN connections in the Requested NSSAI in RRC Connection Establishment subject to the conditions set out in clause 5159 and NAS The UE also provides to the AMF in the Registration Request message the mapping information as described in clause 5156",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_756",
    "document_id": "23501-i80",
    "chunk_id": 756,
    "text": "The UE derives the S-NSSAIs values for the Serving PLMN by using the latest available information from EPS if received in PCO and from 5GS eg based on URSP Configured NSSAI Allowed NSSAI In the home-routed roaming case the AMF selects default V-SMFs The SMFPGW-C sends PDU Session IDs and related S-NSSAIs to AMF The AMF derives S-NSSAI values for the Serving PLMN as described in clause 515521 and determines whether the AMF is the appropriate AMF to serve the UE If not the AMF reallocation may need be triggered For each PDU Session the AMF determines whether the V-SMF need be reselected based on the associated S-NSSAI value for the Serving PLMN If the V-SMF need be reallocated ie change from the default V-SMF to another V-SMF the AMF trigger the V-SMF reallocation as described in clause 4233 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_757",
    "document_id": "23501-i80",
    "chunk_id": 757,
    "text": "In addition to the interworking principles documented in clause 5172 the following applies for interworking without N26 - When the UE initiates the Registration procedure and subject to the conditions set out in clause 5159 the UE includes the S-NSSAI with values for the Serving PLMN of the target 5GS associated with the established PDN connections in the Requested NSSAI in the RRC Connection Establishment -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_758",
    "document_id": "23501-i80",
    "chunk_id": 758,
    "text": "The UE includes the S-NSSAIs with values for the Serving PLMN of the target 5GS if available and the HPLMN S-NSSAI received in the PCO for the PDN connections as mapping information when moving PDN connections to 5GC using PDU Session Establishment Request message The UE derives the S-NSSAIs values for the Serving PLMN by using the latest available information from EPS if received in PCO and from 5GS eg based on URSP Configured NSSAI Allowed NSSAI 51573 Connected mode aspects In addition to the interworking principles documented in clause 5172 the following applies for interworking with N26 - When a UE is CM-CONNECTED in 5GC and a handover to EPS occur the AMF selects the target MME based on the source AMF Region ID AMF Set ID and target location information The AMF forwards the UE context to the selected MME over the N26 Interface",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_759",
    "document_id": "23501-i80",
    "chunk_id": 759,
    "text": "In the UE context the AMF also includes the UE Usage type if it is received as part of subscription data The Handover procedure is executed as documented in TS 23502 3 When the Handover procedure completes successfully the UE performs a Tracking Area Update This completes the UE registration in the target EPS As part of this the UE obtains a DCN-ID if the target EPS uses it - When a UE is ECM-CONNECTED in EPC and performs a handover to 5GS the MME selects the target AMF based on target location information eg TAI and any other available local information including the UE Usage Type if one is available for the UE in the subscription data and forwards the UE context to the selected AMF over the N26 interface In the home-routed roaming case the AMF selects default V-SMFs The Handover procedure is executed as documented in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_760",
    "document_id": "23501-i80",
    "chunk_id": 760,
    "text": "The SMFPGW-C sends PDU Session IDs and related S-NSSAIs to AMF Based on the received S-NSSAIs values the target AMF derives the S-NSSAI values for the Serving PLMN the target AMF reselects a final target AMF if necessary as described in clause 515521 the AMF reallocation procedure is triggered For each PDU Session based on the associated derived S-NSSAI values if the V-SMF need be reallocated the final target AMF triggers the V-SMF reallocation as described in clause 4232 of TS 23502 3 When the Handover procedure completes successfully the UE performs a Registration procedure This completes the UE registration in the target 5GS and as part of this the UE obtains an Allowed NSSAI 51574 Support of Network Slice usage control and Interworking with EPC As described in clause 51515 if Network Slice usage control is required for a PDN Connection the SMFPGW-C configures PDU Session inactivity timer to the UPFPGW-U When the SMFPGW-C receives inactivity report of the PDN Connection from the UPFPGW-U the SMFPGW-C releases the PDN Connection 5158 Configuration of Network Slice support and availability in a PLMN A Network Slice may be supported in the whole PLMN or in one or more Tracking Areas of the PLMN A Network Slice is supported within a TA if the 5G-AN has been configured to support the S-NSSAI in the TA Network Slices are defined to be available within an NS-AoS when the Network Slice is supported in the set of TAs which the NS-AoS comprises and more than zero resources are allocated to the Network Slice in the NG-RAN cells of the NS-AoS An NS-AoS can be defined on a per cell level granularity when the NS-AoS is not matching deployed Tracking Areas as defined in clause 51518",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_761",
    "document_id": "23501-i80",
    "chunk_id": 761,
    "text": "The availability of a Network Slice S-NSSAI in an NS-AoS requires the support of the S-NSSAI in the involved NFs and in the NG-RAN in the TAs which the NS-AoS comprises Hence the cells of a TA need to be configured to support a S-NSSAI if the S-NSSAI needs to be available in at least a cell of the TA A Network Slice is considered available in a TA if the Network Slice is supported within the TA and available in all cells of the TA In addition policies in the NSSF may further restrict from using certain Network Slices in a particular TA eg depending on the HPLMN of the UE The UE can receive for a Network Slice where the NS-AoS does not match the whole set of cells in one or more TAs S-NSSAI location availability information as described in clause 51518",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_762",
    "document_id": "23501-i80",
    "chunk_id": 762,
    "text": "The support of a Network Slice in a TA is established end-to-end using a combination of OAM and signalling among network functions It is derived by using the S-NSSAIs supported per TA in 5G-AN the S-NSSAIs supported in the AMF and operator policies per TA in the NSSF The AMF learns the S-NSSAIs supported per TA by the 5G-AN when the 5G-AN nodes establish or update the N2 connection with the AMF see TS 38413 34 and TS 38300 27 One or all AMF per AMF Set provides and updates the NSSF with the S-NSSAIs support per TA The 5G-AN learns the S-NSSAIs per PLMN ID the AMFs it connects to support when the 5G-AN nodes establishes the N2 connection with the AMF or when the AMF updates the N2 connection with the 5G-AN see TS 38413 34 and TS 38300 27 The NSSF may be configured with operator policies specifying under what conditions the S-NSSAIs can be restricted per TA and per HPLMN of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_763",
    "document_id": "23501-i80",
    "chunk_id": 763,
    "text": "The per TA restricted S-NSSAIs may be provided to the AMFs of the AMF Sets at setup of the network and whenever changed The AMF may be configured for the S-NSSAIs it supports with operator policies specifying any restriction per TA and per HPLMN of the UE 5159 Operator-controlled inclusion of NSSAI in Access Stratum Connection Establishment The Serving PLMN can control per Access Type which if any NSSAI the UE includes in the Access Stratum when establishing a connection caused by Service Request Periodic Registration Update or Registration procedure used to update the UE capabilities In addition the Home and Visited PLMNs can also instruct the UE to never include NSSAI in the Access Stratum regardless of the procedure that causes a RRC Connection to be established ie to always enable privacy for the NSSAI During the Registration procedure the AMF may provide to the UE in the Registration Accept message an Access Stratum Connection Establishment NSSAI Inclusion Mode parameter indicating whether and when the UE shall include NSSAI information in the Access Stratum Connection Establishment eg an RRC connection Establishment defined in TS 38331 28 according to one of these modes a The UE shall include an NSSAI set to the Allowed NSSAI if available in the Access Stratum Connection Establishment caused by a Service Request Periodic Registration Update or Registration procedure used to update the UE capabilities b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_764",
    "document_id": "23501-i80",
    "chunk_id": 764,
    "text": "The UE shall include a NSSAI with the following content - for the case of Access Stratum Connection Establishment caused by a Service Request an NSSAI including the S-NSSAIs of the Network Slices that trigger the Access Stratum Connection Establishment ie all the S-NSSAIs of the PDU sessions that have the User Plane reactivated by the Service Request or the S-NSSAIs of the Network Slices a Control Plane interaction triggering the Service Request is related to eg for SM it would be the S-NSSAI of the PDU Session the SM message is about - for the case of Access Stratum Connection Establishment caused by a Periodic Registration Update or Registration procedure used to update the UE capabilities an NSSAI set to the Allowed NSSAI c The UE shall not include any NSSAI in the Access Stratum Connection Establishment caused by Service Request Periodic Registration Update or Registration procedure used to update the UE capabilities or d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_765",
    "document_id": "23501-i80",
    "chunk_id": 765,
    "text": "The UE shall not provide NSSAI in the Access stratum For the case of Access Stratum Connection Establishment caused by Mobility Registration Update or Initial Registration in modes a b or c the UE shall include the Requested NSSAI provided by the NAS layer and defined in clause 515521 For all UEs that are allowed to use modes a b or c the Access Stratum Connection Establishment NSSAI Inclusion Mode should be the same over the same Registration AreasThe UE shall store and comply to the required behaviour for a PLMN per Access Type as part of the network slicing configuration The Serving PLMN AMF shall not instruct the UE to operate in any other mode than mode d in 3GPP Access Type unless the HPLMN provides an indication that it is allowed to do so ie if a PLMN allows behaviours abc then its UDM sends to the serving AMF an explicit indication that the NSSAI can be included in RRC as part of the subscription data The UE default mode of operation is the following - For 3GPP access the UE shall by default operate in mode d unless it has been provided with an indication to operate in mode a b or c - For untrusted non-3GPP access the UE shall operate by default in mode b unless it has been provided with an indication to operate in mode a c or d -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_766",
    "document_id": "23501-i80",
    "chunk_id": 766,
    "text": "For trusted non-3GPP access the UE shall operate by default in mode d unless it has been provided with an indication to operate in mode a b or c - For W-5GAN access the 5G-RG shall operate by default in mode b unless it has been provided with an indication to operate in mode a c or d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_767",
    "document_id": "23501-i80",
    "chunk_id": 767,
    "text": "An operator may pre-configure the UE to operate by default according to mode c in the HPLMN ie the UE by default includes NSSAI in the access stratum when it performs an Initial Registration and Mobility Registration Update with the HPLMN until the HPLMN changes the mode as described above 51510 Network Slice-Specific Authentication and Authorization A serving PLMN or SNPN shall perform Network Slice-Specific Authentication and Authorization for the S-NSSAIs of the HPLMN or SNPN which are subject to it based on subscription information The UE shall indicate in the Registration Request message in the UE 5GMM Core Network Capability whether it supports NSSAA feature If the UE does not support NSSAA feature and if the UE requests any of these S-NSSAIs that are subject to Network Slice-Specific Authentication and Authorization the AMF shall not trigger this procedure for the UE and they are rejected for the PLMN or SNPN If the UE supports NSSAA feature and if the UE requests any of these S-NSSAIs that are subject to Network Slice-Specific Authentication and Authorization they are included in the list of Pending NSSAI for the PLMN or SNPN as described in clause 515521 If a UE is configured with S-NSSAIs which are subject to Network Slice-Specific Authentication and Authorization the UE stores an association between the S-NSSAI and corresponding credentials for the Network Slice-Specific Authentication and Authorization NOTE 1 How the UE is aware that an S-NSSAI is subject to Network Slice-Specific Authentication and Authorization eg based on local configuration is out of scope of this specification The UE may support remote provisioning of credentials for NSSAA specified in clause 539 A UE that supports to be provisioned with the credentials used for NSSAA over UP remote provisioning shall use connectivity over an S-NSSAIDNN which can access the provisioning server to establish a PDU session for remote provisioning as defined in clause 539 NOTE 2 The credentials for Network Slice-Specific Authentication and Authorization are not specified To perform the Network Slice-Specific Authentication and Authorization for an S-NSSAI the AMF invokes an EAP- based Network Slice-Specific authorization procedure documented in clause 429 of TS 23502 3 see also TS 33501 29 for the S-NSSAI When an NSSAA procedure is started and is ongoing for an S-NSSAI the AMF stores the NSSAA status of the S-NSSAI as pending and when the NSSAA is completed the S-NSSAI becomes either part of the Allowed NSSAI or a Rejected S-NSSAI The NSSAA status of each S-NSSAI if any is stored is transferred when the AMF changes This procedure can be invoked for a supporting UE by an AMF at any time eg when a The UE registers with the AMF and one of the S-NSSAIs of the HPLMN or SNPN which maps to an S-NSSAI in the Requested NSSAI is requiring Network Slice-Specific Authentication and Authorization see clause 515521 for details and the S-NSSAI in the Requested NSSAI can be added to the Allowed NSSAI by the AMF once the Network Slice-Specific Authentication and Authorization for the HPLMN or SNPN S-NSSAI succeeds or b The Network Slice-Specific AAA Server triggers a UE re-authentication and re-authorization for an S-NSSAI or c The AMF based on operator policy or a subscription change decides to initiate the Network Slice-Specific Authentication and Authorization procedure for a certain S-NSSAI which was previously authorized In the case of re-authentication and re-authorization b and c above the following applies - If S-NSSAIs that are requiring Network Slice-Specific Authentication and Authorization map to S-NSSAIs that are included in the Allowed NSSAI for each Access Type AMF selects an Access Type to be used to perform the Network Slice Specific Authentication and Authorization procedure based on network policies - If the Network Slice-Specific Authentication and Authorization for some S-NSSAIs mapped to some S-NSSAIs in the Allowed NSSAI is unsuccessful the AMF shall update the Allowed NSSAI for each Access Type to the UE via UE Configuration Update procedure - If the Network Slice-Specific Authentication and Authorization fails for all S-NSSAIs mapped to all S-NSSAIs in the Allowed NSSAI the AMF determines a new Allowed NSSAI including default S-NSSAIs If no default S-NSSAIs could be added the AMF shall execute the Network-initiated Deregistration procedure described in clause 42233 of TS 23502 3 and shall include in the explicit De-Registration Request message the list of Rejected S-NSSAIs each of them with the appropriate rejection cause value After a successful or unsuccessful UE Network Slice-Specific Authentication and Authorization the UE context in the AMF shall retain the authentication and authorization status for the UE for the related specific S-NSSAI of the HPLMN or SNPN while the UE remains RM-REGISTERED in the PLMN or SNPN so that the AMF is not required to execute a Network Slice-Specific Authentication and Authorization for a UE at every Periodic Registration Update or Mobility Registration procedure with the PLMN or SNPN A Network Slice-Specific AAA server may revoke the authorization or challenge the authentication and authorization of a UE at any time When authorization is revoked for an S-NSSAI that maps to an S-NSSAI in the current Allowed NSSAI for an Access Type the AMF shall provide a new Allowed NSSAI to the UE and trigger the release of all PDU sessions associated with the S-NSSAI for this Access Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_768",
    "document_id": "23501-i80",
    "chunk_id": 768,
    "text": "The AMF provides the GPSI of the UE related to the S-NSSAI to the AAA Server to allow the AAA server to initiate the Network Slice-Specific Authentication and Authorization or the Authorization revocation procedure where the current AMF serving the UE needs to be identified by the system so the UE authorization status can be challenged or revoked The Network Slice-Specific Authentication and Authorization requires that the UE Primary Authentication and Authorization of the SUPI has successfully completed If the SUPI authorization is revoked then also the Network Slice-Specific authorization is revoked 51511 Network Slice Admission Control 515110 General The Network Slice Admission Control Function NSACF monitors and controls the number of registered UEs per network slice andor the number of PDU Sessions per network slice for the network slices that are subject to Network Slice Admission Control NSAC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_769",
    "document_id": "23501-i80",
    "chunk_id": 769,
    "text": "The NSACF is configured with the maximum number of UEs andor the maximum number of PDU Sessions allowed to be served per S-NSSAI subject to NSAC The NSACF is also configured with information indicating applicable access types for the S-NSSAI ie 3GPP Access Type Non-3GPP Access Type or both The NSACF also provides event-based Network Slice status notifications and reports to the consumer NFs eg AF A NSACF can be configured with the NSAC Service Areas it serves The NSAC Service Area Identifier is a unique identifier in a PLMN or SNPN The consumer NFs which use the NSAC services are configured with a single and network slice independent value of the NSAC Service Area Identifier so they can discover the correct NSACF see clause 6322 The NSACF may be responsible for one or more S-NSSAIs For one S-NSSAI there may be one or multiple NSACFs deployed in a network a PLMN or a SNPN as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_770",
    "document_id": "23501-i80",
    "chunk_id": 770,
    "text": "If a PLMN or SNPN is configured with a single NSAC service area there is a single NSACF configured with the maximum number of UEs per network slice andor the maximum number of PDU Sessions per network slice which are valid in the network In this case there is no need to provision any NSAC Service Area Identifier value in the PLMN or SNPN - If a PLMN or SNPN is configured with multiple NSAC service areas an NSACF may be deployed on a NSAC service area basis which can be one NSACF instance or one NSACF Set There are three NSAC architecture options - Option 1 non-Hierarchical NSAC architecture In this architecture independent NSACFs are deployed in every NSAC service area There is no interaction between the NSACFs deployed in different NSAC service areas Each NSACF is configured with the maximum number of UEs per network slice andor the maximum number of PDU Sessions which are valid in the NSAC service area see clauses 5151111 and 5151121 for more details - Option 2 Centralized NSAC architecture In this architecture a single centralized NSACF is deployed in the network to handle admissions in all NSAC service areas The centralized NSACF is configured with the total number of UEs per network slice and the maximum number of PDU Sessions for the entire PLMN NSAC Requests from AMF or SMF to the single centralized NSCAF in this case includes the NSAC service area of the NF consumer if multiple NSAC service areas are deployed in PLMN NOTE 1 It is possible to configure in the centralized architecture the maximum number of registered UEs andor the maximum number of PDU sessions per NSAC service area if required by the operator In this case NSAC can be performed on a per NSAC service area - Option 3 Hierarchical NSAC architecture is deployed in the network There are two roles of NSACF and interaction between them may be required see clauses 5151112 and 5151122 for more details - Primary NSACF controls and distributes of the maximum number of UEs andor the maximum number of PDU Sessions for other NSACFs deployed in different NSAC service Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_771",
    "document_id": "23501-i80",
    "chunk_id": 771,
    "text": "The Primary NSACF handles overall NSAC for an S-NSSAI at the global level ie it is ultimately responsible for the NSAC for an S-NSSAI NSACF is responsible for one or multiple NSAC service Area And one NSAC service area is only associated with one NSACF instance or one NSACF Set NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_772",
    "document_id": "23501-i80",
    "chunk_id": 772,
    "text": "When multiple NSACFs are deployed how the maximum number of UEs per network slice and the maximum number of PDU Sessions per network slice is distributed by OAM for Option 1 and by the primary NSACF for Option 3 among multiple NSACFs ie the algorithm of the maximum number distribution is implementation specific NOTE 3 When multiple NSACFs are deployed based on option 1 the UE moves to new NSAC service area with a different NSACF and if the number of UE or PDU Sessions in the target NSACF has reached the maximum number whether the session continuity can be guaranteed is left to implementation NOTE 4 When multiple NSACFs are deployed based on Hierarchical NSAC architecture it is possible that the role of Primary NSACF and the role of NSACF are co-located at the same NSACF instance Subject to operator policy and nationalregional regulations the AMF may exempt UEs and the SMF may exempt PDU sessions from NSAC when the UE andor PDU Session is used for Emergency service or for Critical and Priority services eg MCX MPS When the AMF receives a Registration Request for an Emergency Registration or with a Registration Request with an Establishment Cause indicating a priority service eg MCX MPS or when the AMF determines that there is a priority subscription eg MPS MCX in the UDM the AMF may accept the registration request without applying NSAC ie the AMF triggers the NSAC procedure but the response from the NSACF is ignored at the AMF When the SMF receives a PDU Session Establishment Request for an emergency PDU Session or a PDU Session Establishment Request with a priority header the SMF may accept the PDU Session Establishment Request without applying NSAC ie the SMF triggers the NSAC procedure but the response from the NSACF is ignored at the SMF Alternatively when NSAC is exempted for the UE andor PDU Session the AMF and the SMF skip the corresponding NSAC procedure ie this UE respectively PDU Session is not counted towards the maximum number of UEs respectively PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_773",
    "document_id": "23501-i80",
    "chunk_id": 773,
    "text": "The support of NSAC for the S-NSSAI used for onboarding as described in clause 530210 is optional and subject to Onboarding Network operator policies However NSAC for S-NSSAI used for onboarding is not applicable to UEs that registered in ON-SNPN with Registration Type SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_774",
    "document_id": "23501-i80",
    "chunk_id": 774,
    "text": "Onboarding In the case of NSAC for maximum number of PDU Sessions when the NSACF rejects the request from the SMF to increase the number of PDU Sessions the SMF may provide to the UE a back-off timer associated with reject cause set to Maximum number of PDU Sessions per S-NSSAI reached for an Access Type as described in clause 42114 of TS 23502 3 If the UE receives from the SMF a back-off timer associated with the reject cause set to Maximum number of PDU Sessions per S-NSSAI reached for an Access Type the UE shall not request the establishment of a PDU Session for this S-NSSAI on the indicated Access Type until the back-off timer expires 515111 Network Slice Admission Control for maximum number of UEs 5151111 Non-Hierarchical NSAC architecture",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_775",
    "document_id": "23501-i80",
    "chunk_id": 775,
    "text": "The NSACF keeps track of the current number of UEs registered for a network slice so that it can ensure it does not exceed the maximum number of UEs allowed to register with the network slice The NSACF also maintains a list of UE IDs registered with a network slice that is subject to NSAC When an event related to a UE causes the current number of UEs registered with a network slice to increase the NSACF first checks whether the UE Identity is already in the list of UEs registered with that network slice If not the NSACF checks whether the maximum number of UEs per network slice for that network slice has already been reached and if it has the NSACF applies admission control policies The AMF triggers a request to NSACF for NSAC for maximum number of UEs when the UEs registration status for a network slice subject to NSAC is changing ie during the UE Registration procedure in clause 42222 of TS 23502 3 UE Deregistration procedure in clause 4223 of TS 23502 3 Network Slice-Specific Authentication and Authorisation procedure in clause 4292 of TS 23502 3 AAA Server triggered Network Slice-Specific Re-authentication and Re-authorization procedure in clause 4293 of TS 23502 3 AAA Server triggered Slice-Specific Authorization Revocation in clause 4294 of TS 23502 3 and UE Configuration Update procedure in clause 4242 of TS 23502 3 NOTE 1 Early Admission Control EAC mode is applicable for Number of UEs per network slice admission control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_776",
    "document_id": "23501-i80",
    "chunk_id": 776,
    "text": "The use of EAC in relation to the number of registered UEs is described in clauses 42112 and 42113 of TS 23502 3 Since the UE may register or deregister for an S-NSSAI via 3GPP access andor non-3GPP access as described in clause 515521 The Allowed NSSAI for the access type may change while the UE is registering to a network The AMF provides the Access Type to the NSACF when triggering a request to increase or decrease the current number of UEs registered with a S-NSSAI The NSACF may take the Access Type into account for increasing and decreasing the number of UEs per network slice by storing the UE ID with the associated one or more Access Types ie the NSACF is able to add or remove a registration for the UE ID for each Access Type and trigger the increase or decrease of the current number of UEs registered with a S-NSSAI based on a policy that takes the access type into account If the Access Type provided by the AMF is not configured for NSAC in the NSACF the NSACF always accepts the request from the AMF without increasing or decreasing the number of UEs If the Access Type provided by the AMF is configured for NSAC in the NSACF and the maximum number is reached the NSACF sends a reject response to the AMF including the access type NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_777",
    "document_id": "23501-i80",
    "chunk_id": 777,
    "text": "For example if the NSACF is configured to apply NSAC for 3GPP Access Type only the NSACF counts registration via 3GPP access type only If the NSACF is configured to apply NSAC for both Access Types and the UE newly registers via 3GPP access while the UE is already registered via non-3GPP access or vice versa the NSACF updates the UE ID entry with both 3GPP Access Type and non-3GPP Access Type and the NSACF may count the UE once or twice based on its policy 5151112 Hierarchical NSAC architecture In the Hierarchical NSAC architecture the NSACFs deployed in the NSAC service areas interacts with the Primary NSACF when needed and as explained below The main differences between the non-Hierarchical architecture and the Hierarchical architecture is that the AMFs and the NSACFs deployed in the Hierarchical architecture support the following - When the AMF triggers an NSAC request to the NSACF the AMF includes the UE already Registered indication if the AMF can determine that the UE has been registered with the S-NSSAI in one NSAC service area before If the AMF does not include the UE already Registered indication the registration request to the indicated S-NSSAI is determined as initial registration ie the UE has not been registered in any service area before The AMF determines the UE already Registered indication based on the received Allowed NSSAI information from the source AMF in case of inter AMF handover or from SMFPGW-C in case of mobility from EPS to 5GS - There are two types of UE admission control quota-based control or threshold-based control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_778",
    "document_id": "23501-i80",
    "chunk_id": 778,
    "text": "A PLMN is configured to deploy only one type of UE admission control Based on the type of UE admission control configured for the PLMN the NSACF handles the NSAC request as described below - For NSACFs supporting quota-based control if the NSACF receives a request to increase the number of UEs and the number of UEs registered for a network slice has reached the local maximum number of UEs provisioned in the NSACF or upon receiving a request to decrease the number of UEs and no UE entry is present in the NSACF the NSACF interacts with the Primary NSACF for the handling of the NSAC request for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_779",
    "document_id": "23501-i80",
    "chunk_id": 779,
    "text": "The Primary NSACF may return in the response an updated local maximum number of registered UEs value to the NSACF based on the status of registered UEs for the Network Slice and which enables the NSACF to handle locally the request Alternatively and if the request to increase the number of UEs includes the UE already Registered indication the Primary NSACF may admit the UE request and store the UE entry which allows for service continuity The Primary NSACF may also reject the request If the NSACF receives a request to increase the number of UEs and the local maximum number of UEs is not reached the NSACF handles the request locally and sends a response to the AMF without interaction with the Primary NSACF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_780",
    "document_id": "23501-i80",
    "chunk_id": 780,
    "text": "For NSACF supporting threshold-based control the NSACF is initially configured with a UE admission threshold and a local maximum number of Registered UEs to be admitted Threshold-based control refers to an admission threshold defined in percentage against provisioned local maximum number in NSACF eg an admission threshold of 80 refers to the case when 80 of the provisioned local maximum number should be used If upon a receiving a request to increase the number of UEs without a UE already Registered indication and if UE admission threshold is at or above the threshold level configured at the NSACF the NSACF immediately rejects the NSAC request If the received request includes the UE already Registered indication and if UE admission is at or above the threshold level configured at the NSACF the NSACF accepts the request to enable UE admission and allow for service continuity as long as the local maximum number of Registered UEs have not been reached If the local maximum number of registered UEs value have been reached the NSACF interacts with the Primary NSACF for the handling of the NSAC request for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_781",
    "document_id": "23501-i80",
    "chunk_id": 781,
    "text": "The NSACF does not include the UE already Registered indication in this case The Primary NSACF may return an updated UE admission threshold value to the NSACF in the response which enables the NSACF to handle the request locally Alternatively the Primary NSACF may handle and store the UE entry The Primary NSACF may also reject the request - For both options the Primary NSACF supports the following capabilities depending on the NSACF configuration - Returning a new updated local maximum number of Registered UEs for the NSACF to admit if the NSACF is configured to support the quota-based UE admission control or - Returning a new updated UE admission threshold for the NSACF to apply if the NSACF is configured to support the threshold-based UE admission control -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_782",
    "document_id": "23501-i80",
    "chunk_id": 782,
    "text": "The Primary NSACF handles stores entries only related to UEs which the NSAC request includes the UE already Registered indication that are already admitted in an existing NSAC service area but cannot be admitted in the new NSAC service area due to no remaining local maximum number of registered UEs as long as the overall PLMN number of registered UEs at the Primary NSACF is not exhausted The Primary NSACF informs the NSACF in its response - Based on the response from the Primary NSACF the NSACF determines whether to accept or reject the NSAC request for UE registration In addition the NSACF may also update the local maximum number of Registered UEs or admission threshold respectively if the related updated value is received - At any time the Primary NSACF can update the NSACFs local maximum number of Registered UEs or admission threshold through the Nnsacf_NSAC_LocalNumberUpdate operation as described in clause 42116 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_783",
    "document_id": "23501-i80",
    "chunk_id": 783,
    "text": "The updated values provided from the Primary NSACF to the NSACFs may directly apply to current NSAC pending request in NSACF and are used for all future requests - The Primary NSACF subscribes with all NSACFs to obtain the number of currently registered UEs at all NSACFs Based on the obtained information the Primary NSACF can update the NSACF with local maximum number of registered UEs 5151113 Centralized NSAC architecture The main differences between the NSACFs deployed in a non-Hierarchical architecture and NSACFs deployed in a Centralized NSAC architecture is as follows - If multiple NSAC service areas are deployed in PLMN the AMF provides the NSAC Service Area Identifier information to the centralized NSACF The centralized NSACF also stores the NSAC Service Area Identifier of the AMF the UE is registered with 515112 Network Slice Admission Control for maximum number of PDU sessions 5151121 Non-",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_784",
    "document_id": "23501-i80",
    "chunk_id": 784,
    "text": "Hierarchical NSAC architecture The NSACF keeps track of the current number of PDU Sessions per network slice so that it can ensure it does not exceed the maximum number of PDU session allowed to be served by the network slice When an event related to a UE causes the current number of PDU sessions established within the network slice is to increase the NSACF checks whether the maximum number of PDU sessions per network slice for that network slice has already been reached and if it has the NSACF applies admission control policies The anchor SMF triggers a request to NSACF for maximum number of PDU sessions per network slice control during PDU session establishmentrelease procedures in clauses 432 and 434 of TS 23502 3 The SMF provides the Access Type to the NSACF when triggering a request to increase or decrease the number of PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_785",
    "document_id": "23501-i80",
    "chunk_id": 785,
    "text": "The NSACF takes Access Type into account for increasing and decreasing the current number of PDU Sessions depending on the applicability of the Access Type for the NSAC for maximum number of PDU Sessions for the S-NSSAI NOTE 1 For MA PDU Session the SMF provides the Access Type to NSACF when the user plane connection is about to be established or released in the corresponding access network With this the SMF provides one or two Access Types for the MA PDU Session in the same request message to the NSACF The NSACF can reject a single or both Access Types depending on the applicability of the Access Type for the NSAC NOTE 2 I-SMF does not interact with NSCAF 5151122 Hierarchical NSAC architecture The main differences between the NSACFs deployed in a non-Hierarchical architecture and NSACFs deployed in a Hierarchical architecture is as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_786",
    "document_id": "23501-i80",
    "chunk_id": 786,
    "text": "The NSCAF is enhanced to support PDU session admission quota-based control - When the local maximum number of PDU sessions is reached the NSACF interacts with the Primary NSACF to handle the request The Primary NSACF either return an increased local maximum number to the NSACF or reject the local maximum number value update request if all the global maximum number are consumed based on the status of established PDU sessions to the network slice NOTE For Hierarchical NSAC architecture global maximum number used within this specification is synonymous with the maximum number of allowed registered UEs or established PDU Sessions for an S-NSSAI subject to Network Slice Admission Control NSAC for the entire PLMN and outbound roamers - Based on the response from Primary NSACF the NSACF updates the local maximum number if updated value is received from the Primary NSACF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_787",
    "document_id": "23501-i80",
    "chunk_id": 787,
    "text": "The NSACF updates local maximum number value if received and determines whether to accept or reject the NSAC request for PDU session establishment based on the local maximum number value - The update of local maximum number value by the Primary NSACF can also happen at any time through the Nnsacf_NSAC_LocalNumberUpdate service operation as described in clause 42116 TS 23502 3 The updated values provided from the Primary NSACF to NSACFs may directly apply to current NSAC pending request in NSACF and are used for all future requests - The Primary NSACF subscribes with all NSACFs to obtain the number of currently established PDU sessions at all NSACFs Based on the obtained information the Primary NSACF can update the NSACF with local maximum number of established PDU sessions 5151123 Centralized NSAC architecture The main differences between the NSACFs deployed in a non-Hierarchical NSAC architecture and NSACFs deployed in a Centralized NSAC architecture is as follows - If multiple NSAC service areas are deployed in a PLMN the SMF provides the NSAC Service Area Identifier to the centralized NSACF The centralized NSACF also stores the NSAC Service Area Identifier of the SMF the PDU session is established on 515113 Network Slice Admission Control for Roaming 5151130 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_788",
    "document_id": "23501-i80",
    "chunk_id": 788,
    "text": "In the case of roaming depending on operators policy a roaming agreement or an SLA between the VPLMN and the HPLMN NSAC of roaming UEs is performed by one of the following modes of NSAC admission - VPLMN NSAC Admission or - VPLMN with HPLMN assistance NSAC Admission or - HPLMN NSAC Admission",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_789",
    "document_id": "23501-i80",
    "chunk_id": 789,
    "text": "The VPLMN AMF and SMF identifies the mode to apply from the AMF subscription data at UE registration and from the SMF subscription data at PDU session establishment For all the above modes for NSAC of roaming UEs for maximum number of UEs per network slice andor maximum number of PDU Sessions per network slice managed by the VPLMN each S-NSSAI of the HPLMN that is subject to NSAC is mapped to a corresponding S-NSSAI of the VPLMN subject to NSAC For both VPLMN NSAC Admission and VPLMN with HPLMN assistance NSAC Admission modes each configured S-NSSAI that is subject to NSAC and that is mapped from the HPLMN S-NSSAI the SMF performs NSAC for home routed PDU sessions according to the principles described in clause 515112 5151131 VPLMN NSAC Admission Mode For NSAC of roaming UEs for maximum number of UEs per network slice andor maximum number of PDU Sessions per network slice managed by the VPLMN the following principles shall be used - For NSAC for the maximum number of UEs for S-NSSAI of the HPLMN a NSACF in the VPLMN can be configured with the maximum number of allowed roaming UEs per mapped S-NSSAI of the HPLMN for a S-NSSAI of the HPLMN that is subject to NSAC In such a case the AMFs trigger a request to a NSACF of the VPLMN - For NSAC for the maximum number of PDU Sessions for S-NSSAI of the HPLMN a NSACF in the VPLMN can be configured with the maximum number of allowed PDU Sessions in LBO mode per mapped S-NSSAI of the HPLMN for a S-NSSAI of the HPLMN that is subject to NSAC In such a case the anchor SMF in the VPLMN triggers a request to a NSACF of the VPLMN - For NSAC for the maximum number of UEs for S-NSSAI of the VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_790",
    "document_id": "23501-i80",
    "chunk_id": 790,
    "text": "AMFs trigger a request to a NSACF of the VPLMN to perform NSAC based on the S-NSSAI of the VPLMN subject to NSAC The NSACF of the HPLMN is not involved - For NSAC for the maximum number of PDU Sessions for S-NSSAI of the VPLMN in the LBO roaming case the SMF triggers a request to a NSACF of the VPLMN to perform NSAC based on the S-NSSAI of the VPLMN subject to NSAC The NSACF of the HPLMN is not involved The AMF or SMF in LBO roaming case in the VPLMN provides both the S-NSSAI in the VPLMN and the corresponding mapped S-NSSAI in the HPLMN to the NSACF in the VPLMN The NSACF in the VPLMN performs NSAC for both S-NSSAI of the VPLMN and the corresponding mapped S-NSSAI of the HPLMN based on the SLA between the VPLMN and the HPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_791",
    "document_id": "23501-i80",
    "chunk_id": 791,
    "text": "In addition to configuring the VPLMN NFs with the maximum number of allowed roaming UEs per mapped S-NSSAI of the HPLMN subject to NSAC and the maximum number of allowed PDU Sessions in LBO mode per mapped S-NSSAI of the HPLMN subject to NSAC the VPLMN can optionally fetch this information from the HPLMN primary NSACF in a hierarchal architecture or centralized NSACF in a centralized architecture If the NSACF in VPLMN does not have quota configured but can receive quota from the HPLMN the NSACF in VPLMN may interact with the HPLMN for retrieving the quota before processing any incoming request The VPLMN is either configured or discovers the NSACF in the HPLMN for quota retrieval However in this case the VPLMN rejects any additional requests exceeding the received information 5151132 VPLMN with HPLMN assistance NSAC Admission",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_792",
    "document_id": "23501-i80",
    "chunk_id": 792,
    "text": "In this admission mode HPLMN delegates NSAC for S-NSSAIs subject to NSAC to the VPLMN both for number of registered UEs and the number of LBO PDU sessions Every NSACF performing admission in the VPLMN for each S-NSSAI of the HPLMN that is subject to NSAC and mapped to a corresponding S-NSSAI of the VPLMN fetches from the VPLMN primary NSACF in a hierarchal architecture the maximum number of registered UEs to be admitted andor the maximum number of LBO PDU sessions to be allowed The VPLMN primary or central NSACF in turn acquires the information from the HPLMN central or primary NSACF depending on the deployed architecture The VPLMN is either configured or discovers the NSACF in the HPLMN for quota retrieval If re-distribution of quota is required in the VPLMN in a hierarchal architecture amongst multiple NSACFs than this is handled by the primary NSACF in VPLMN with no involvement from the HPLMN The VPLMN NSACF discovers the HPLMN primary or central NSACF or be configured with the needed information For any requests received in any NSACF in the VPLMN exceeding the received maximum number information the NSACF interacts with the VPLMN primary NSACF which in turn interacts with HPLMN primary or central NSACF to receive an updated roaming quota for the corresponding mapped S-NSSAI which is used to determine whether admission request is accepted or rejected unless forbidden by the SLA If an admission request is accepted the UE entry is stored in the NSACF performing admission in the VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_793",
    "document_id": "23501-i80",
    "chunk_id": 793,
    "text": "This applies to the number of registered UEs as well as the number of LBO PDU sessions The primary NSACF in VPLMN may re-distribute the received updated roaming quota to the NSACFs in VPLMN to perform NSAC for Roaming UEs according to the principles described in clauses 515111 and 515112 5151133 HPLMN NSAC Admission Mode In this admission mode the AMF or SMF in VPLMN interacts with HPLMN for admission both for number of registered UEs or the number of LBO PDU sessions respectively For each S-NSSAI of the HPLMN that is subject to NSAC and mapped to a corresponding S-NSSAI of the VPLMN AMF performs NSAC admission for the number of registered UEs with the HPLMN central or primary NSACF for all inbound roamers from that HPLMN when they register in this VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_794",
    "document_id": "23501-i80",
    "chunk_id": 794,
    "text": "The AMF discovers the HPLMN primary or central NSACF or be configured with the needed information For each S-NSSAI of the HPLMN that is subject to NSAC and mapped to a corresponding S-NSSAI of the VPLMN every SMF in this VPLMN performs NSAC admission for the number of LBO PDU sessions with the HPLMN central or primary NSACF for all inbound roamers from that HPLMN when they initiate an LBO PDU session The SMFs discover the HPLMN primary or central NSACF or be configured with the needed information For each S-NSSAI of the HPLMN that is subject to NSAC the SMF performs NSAC according to the principles described in clause 515112 for home routed PDU sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_795",
    "document_id": "23501-i80",
    "chunk_id": 795,
    "text": "In the HPLMN NSAC admission mode the primary NSACF or central NSACF in HPLMN determines whether the NSAC admission request for a roaming UE is accepted or rejected 515114 Network Slice status notifications and reports to a consumer NF A consumer NF eg AF Primary NSACF can subscribe with the NSACF for Network Slice status notifications and reports Upon such subscription the corresponding NSACF in different NSAC architecture as defined in clause 515110 can provide event based notifications and reports to the consumer NF eg to AF via NEF related to the current number of UEs registered for a network slice or the current number of UEs with at least one PDU SessionPDN Connection in the case of EPC interworking or the current number of PDU Sessions established on a network slice NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_796",
    "document_id": "23501-i80",
    "chunk_id": 796,
    "text": "The Primary NSACF subscribes Network Slice status from all the NSACFs it contacts with for the update of the maximum number of UE or PDU session configured at the NSACF 515115 Support of Network Slice Admission Control and Interworking with EPC This clause describes the NSAC for maximum number of registered UEs and for maximum number of PDU Sessions for network slice subjected to EPS interworking The NSAC for maximum number of UE with at least one PDU SessionPDN Connection is described in clause 515115a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_797",
    "document_id": "23501-i80",
    "chunk_id": 797,
    "text": "A network slice subject to both NSAC and EPS counting shall be configured with only one of the options - Maximum number of registered UEs andor maximum number of PDU Session or - Maximum number of UEs with at least one PDU SessionPDN Connection andor maximum number of PDU Session If EPS counting is required for a network slice the NSAC for maximum number of UEs andor for maximum number of PDU Sessions per network slice is performed at the time of PDN connection establishment in case of EPC interworking To support the NSAC for maximum number of UEs andor for maximum number of PDU Sessions per network slice in EPC the SMFPGW-C is configured with the information indicating which network slice is subject to NSAC During PDN connection establishment in EPC the SMFPGW-C selects an S-NSSAI associated with the PDN connection as described in clause 51571 If the selected S-NSSAI by the SMFPGW-C is subject to the NSAC the SMFPGW-C triggers interaction with NSACF to check the availability of the network slice by invoking separate NSAC procedures for number of UE and number of PDU Session as described in clause 41159 of TS 23502 3 before the SMFPGW-C provides the selected S-NSSAI to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_798",
    "document_id": "23501-i80",
    "chunk_id": 798,
    "text": "If the network slice is available the SMFPGW-C continues to proceed with the PDN connection establishment procedure The NSACF performs the following for checking network slice availability prior to returning a response to the SMFPGW-C - For NSAC for number of UEs if the UE identity is already included in the list of UE IDs registered with a network slice or the UE identity is not included in the list of UE IDs registered with a network slice and the current number of UE registration did not reach the maximum number the NSACF responds to the SMFPGW-C with the information that the network slice is available The NSACF includes the UE identity in the list of UE IDs if not already on the list and increases the current number of UE registration",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_799",
    "document_id": "23501-i80",
    "chunk_id": 799,
    "text": "Otherwise the NSACF returns a response indicating that the maximum number with the network slice has been reached If hierarchical NSAC architecture is deployed when the local maximum number or local threshold is reached the NSACF may interact with the Primary NSACF before it returns the response back to the SMFPGW-C For more details on handling at the NSACF and Primary NSACF see clause 5151112 - For NSAC for number of PDU Sessions if the current number of PDU sessions is below the maximum number the NSACF responds to the SMFPGW-C with the information that the network slice is available The NSACF increases the current number of PDU sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_800",
    "document_id": "23501-i80",
    "chunk_id": 800,
    "text": "Otherwise the NSACF returns the response indicating that the maximum number with the network slice has been reached If hierarchical NSAC architecture is deployed when the local maximum number is reached the NSACF may interact with the Primary NSACF before it returns the response back to the SMFPGW-C For more details on handling at the NSACF and Primary NSACF see clause 5151122 If the maximum number of UEs andor the maximum number of PDU sessions has already been reached unless operator policy implements a different action the SMFPGW-C rejects the PDN connection NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_801",
    "document_id": "23501-i80",
    "chunk_id": 801,
    "text": "As an implementation option if the APN is mapped to more than one S-NSSAI and the first selected S-NSSAI is not available eg either current number of UE registration reached maximum or current number of PDU sessions reached maximum then based on the operator policy the PGW-CSMF can try another mapped S-NSSAI for the PDN connection establishment procedure If the establishment of a new PDN Connections is with a different SMFPGW-C from the SMFPGW-C used for already existing PDN connection associated with the same S-NSSAI each SMFPGW-C will send a request for update eg increase or decrease to the NSACF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_802",
    "document_id": "23501-i80",
    "chunk_id": 802,
    "text": "The NSACF may maintain a registration entry per SMFPGW-C for the same UE ID The SMFPGW-C provides the Access Type to the NSACF when triggering a request to increase or decrease the number of UEs andor the number of PDU Sessions for an S-NSSAI NOTE 2 The SMFPGW-C determines the Access Type based on the RAT type parameter in the PMIP or GTP message received from the ePDG or alternatively it can internally determine the Access Type based on the source node eg SGW sending the request for the PDN Connection establishment When the UE with ongoing PDN connections moves from EPC to 5GC the SMFPGW-C triggers a request to decrease the number of the UE registration in NSACF and the AMF triggers a request to increase the number of the UE registration in NSACF when the UE is registered in the new AMF If there are more than one PDN connections associated with the S-NSSAI the NSACF may receive multiple requests for the same S-NSSAI from different SMFPGW-Cs When the UE with ongoing PDU sessions moves from 5GC to EPC the SMFPGW-C triggers a request to increase the number of the UE registration in NSACF and the old AMF triggers a request to decrease the number of the UE registration in NSACF when the UE is deregistered in old AMF If there are more than one PDU sessions associated with the S-NSSAI the NSACF may receive multiple requests for the same S-NSSAI from different SMFPGW-Cs The NSACF maintains a list of UE IDs based on the requests from SMFPGW-Cs and AMF and adjusts the current number of registrations accordingly When EPS counting is performed for a network slice and the UE with ongoing PDN connections moves from EPC to 5GC session continuity is guaranteed from NSAC standpoint as the admission was granted at the time of PDN connection establishment ie the number of PDU session is not counted again in 5GC Similarly when the UE with ongoing PDU sessions moves from 5GC to EPC session continuity is guaranteed from NSAC standpoint as the admission of the PDN Connections to the network slice was already granted at the time of PDU Session establishment in 5GC If the PDN connection associated with S-NSSAI is released in EPC the SMFPGW-C triggers a request ie decrease to NSACF for maximum number of UEs andor maximum number of PDU sessions per network slice control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_803",
    "document_id": "23501-i80",
    "chunk_id": 803,
    "text": "The NSACF decreases the current number of registrations and removes the UE identity from the list of UE IDs if the PDN connections associated with the S-NSSAI are all released in EPC NOTE 3 NSAC in EPC is not performed for the attachment without PDN connectivity If EPS counting is not required for a network slice the NSAC for maximum number of UEs andor for maximum number of PDU Sessions per network slice is performed when the UE moves from EPC to 5GC ie when the UE performs mobility Registration procedure from EPC to 5GC NSAC for maximum number of UEs per network slice andor when the PDN connections are handed over from EPC to 5GC NSAC for maximum number of PDU Sessions per network slice The SMFPGW-C is configured with the information indicating the network slice is subject to NSAC only in 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_804",
    "document_id": "23501-i80",
    "chunk_id": 804,
    "text": "The PDN connection interworking procedure is performed as described in clause 51571 Mobility from EPC to 5GC does not guarantee all active PDU Sessions can be transferred to the 5GC in certain circumstances when either the current number of UE registration or the current number of PDU sessions would exceed the maximum number when the UE moves from EPC to 5GC When the UE with ongoing PDU sessions moves from 5GC to EPC the SMFPGW-C triggers a request to decrease the number of PDU Session to NSACF If there are more than one PDU sessions associated with the S-NSSAI the NSACF may receive multiple requests for the same S-NSSAI from different SMFPGW-Cs and NSACF removes the PDU Session IDs while decreasing the number of PDU Sessions NOTE 4 Given that session continuity is not guaranteed when EPS counting is not required it is recommended for services which require the session continuity to support EPS counting NOTE 5 When multiple NSACFs are deployed and if the number of UE in target NSACF has reached the maximum number whether session continuity can be guaranteed is left to implementation NOTE 6 When a centralized architecture is deployed UE admission is guaranteed at inter-system and inter-AMF mobility if the same NSACF is selected This is the case for non-roaming scenarios and for roaming scenarios with HPLMN NSAC Admission Mode described in clause 515113 515115a Support of Network Slice Admission Control in 5GS for maximum number of UEs with at least one PDU SessionPDN Connection When EPS counting is required for a network slice and NSACF is configured with maximum number of UEs with at least one PDU SessionPDN Connection the NSACF keeps track of the current number of UEs with at least one PDU sessionPDN connection established on a network slice to ensure it does not exceed the maximum configured number To support the NSAC for maximum number of UEs with at least one PDU SessionPDN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_805",
    "document_id": "23501-i80",
    "chunk_id": 805,
    "text": "Connection the SMFPGW-C may be configured with one of the following options - Option 1 Triggering an Nnsacf_NSAC_NumOfUEsUpdate_Request to NSACF for NSAC for maximum number of UEs when the UE establishes first PDU SessionPDN connection associated with the network slice in the SMFPGW-C or when the last PDU SessionPDN connection associated with the network slice is released The NSACF performs admission control as described in clause 515115 and the number of registered UE is replaced with number of UE with at least one PDU sessionPDN connection Also if the maximum number of UEs with at least one PDU SessionPDN connection has already been reached and SMFPGW-C receives the rejection from NSACF unless operator policy implements a different action the SMFPGW-C rejects the PDU SessionPDN connection indicating the cause being the number of UEs in the network slice has been exceeded The AMF is not configured for this S-NSSAI to be subject to NSAC or - Option 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_806",
    "document_id": "23501-i80",
    "chunk_id": 806,
    "text": "Triggering an Nnsacf_NSAC_NumOfPDUsUpdate_Request as described in clause 515115 to NSACF and the NSACF performs admission control for the number of UEs with at least one PDU SessionPDN connection as follows - The NSACF supports handling both for the number of UEs with at least one PDU SessionPDN Connection and number of PDU session for the S-NSSAI that is subject to EPC interworking and NSAC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_807",
    "document_id": "23501-i80",
    "chunk_id": 807,
    "text": "In this case the AMF is not configured for this S-NSSAI to be subject to NSAC As an optimization option the SMFPGW-C can be configured not to trigger the Nnsacf_NSAC_NumOfUEsUpdate_Request to NSACF - When the NSACF receives request to increase the current number of PDU SessionPDN Connection established for the network slice the NSACF checks whether this is the first PDU SessionPDN Connection associated with the network slice If this is the first PDU SessionPDN Connection associated with the network slice the NSACF checks whether the maximum number of UEs with at least one PDU SessionPDN Connection has been reached If the maximum number has not been reached then the NSACF increases the number of UE with at least one PDU sessionPDN connection and add an entry for UE ID If the maximum number of UEs has already been reached unless operator policy implements a different action the SMFPGW-C rejects the PDU SessionPDN connection indicating the cause being the number of UEs in the network slice has been exceeded - When the NSACF receives request to decrease the current number of PDU SessionPDN Connection established for the network slice the NSACF locates the UE entry checks whether this is the last PDU SessionPDN Connection associated with the network slice for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_808",
    "document_id": "23501-i80",
    "chunk_id": 808,
    "text": "If it is the last PDU SessionPDN Connection the NSACF decreases the number of UE with at least one PDU sessionPDN connection and remove the associated UE entry NOTE 1 A PLMN can deploy one of the above two options for a slice when EPS counting is required for a network slice and NSACF is configured with maximum number of UEs with at least one PDU SessionPDN Connection NSACF is configured with the information of whether the NSAC for number of UEs with at least one PDU sessionPDN connection is based on Option1 or Option 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_809",
    "document_id": "23501-i80",
    "chunk_id": 809,
    "text": "In both options the SMFPGW-C provides the Access Type to the NSACF when triggering a request to increase or decrease or update the number of UEs with at least one PDU SessionPDN Connection andor the number of PDU Sessions for an S-NSSAI In the case of roaming same mechanisms in clause 515113 are used and number of registered UE is replaced with number of UE with at least one PDU SessionPDN Connection For home routed PDU SessionPDN Connection only HPLMN admission mode can be used in this case If hierarchical NSAC architecture is deployed when the local maximum number or local threshold is reached the NSAC may interact with the Primary NSACF before it returns the response back to the SMFPGW-C For more details on handling at the NSACF and Primary NSACF see clause 5151112",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_810",
    "document_id": "23501-i80",
    "chunk_id": 810,
    "text": "NOTE 2 When NSAC for number of UEs with at least one PDU session or one PDN connection is used the session continuity is guaranteed at inter-system mobility as the admission is granted during the establishment of the PDU SessionPDN Connection 51512 Support of subscription-based restrictions to simultaneous registration of network slices 515121 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_811",
    "document_id": "23501-i80",
    "chunk_id": 811,
    "text": "The subscription information for a UE may include for each S-NSSAI Network Slice Simultaneous Registration Group NSSRG information constraining which S-NSSAIs can be simultaneously provided to the UE in the Allowed NSSAI When S-NSSAIs have associated NSSRG information then the S-NSSAIs in the Allowed NSSAI shall share at least one NSSRG The NSSRG information defining the association of S-NSSAIs to NSSRG is provided as an additional and separate information If the optional NSSRG information is not present for the S-NSSAIs of a subscription and other restrictions do not apply eg availability at a specific location then it is assumed that all the S-NSSAIs in the subscription information can be simultaneously provided to the UE in the Allowed NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_812",
    "document_id": "23501-i80",
    "chunk_id": 812,
    "text": "However if NSSRG information is present in the subscription information at least one NSSRG shall be associated with each of the S-NSSAIs in the subscription information At any time if the AMF has received subscription information for a UE that includes NSSRG information the Allowed NSSAI for the UE can only include S-NSSAIs which share a common NSSRG NOTE 1 The AMF enforces NSSRG only for the accesses the UE registered to the AMF When the UE is registered to different PLMNs over 3GPP access and non-3GPP access the AMF in one access cannot enforce a common NSSRG over both accesses The default S-NSSAIs if more than one is present are associated with the same NSSRGs ie the UE is always allowed to be registered with all the default S-NSSAIs simultaneously The HPLMN only sends S-NSSAIs sharing all the NSSRGs of the Default S-NSSAIs to a non-supporting VPLMN as part of the subscription information ie in addition to the default S-NSSAIs the HPLMN may send any other subscribed S-NSSAI which shares at least all the NSSRG defined for the default S-NSSAIs and the HPLMN sends no NSSRG information to the VPLMN A subscription information that includes NSSRG information shall include at least one default S-NSSAI A supporting AMFNSSF when it receives a Requested NSSAI evaluates the S-NSSAIs of the HPLMN in the mapping information of the Requested NSSAI when a mapping information is applicable based on any received NSSRG information for these S-NSSAIs to determines whether they can be provided together in the Allowed NSSAI NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_813",
    "document_id": "23501-i80",
    "chunk_id": 813,
    "text": "An HPLMN enabling support of subscription-based restrictions to simultaneous registration of network slices for a Subscriber can set the subscribed S-NSSAIs already in the subscription information before the NSSRG information was added to the subscription information to have the same NSSRGs defined for the default S-NSSAIs if it has to continue to support the same service behaviour for these S-NSSAIs 515122 UE and UE configuration aspects A UE may support the subscription-based restrictions to simultaneous registration of network slices feature In this case the UE indicates its support in the Registration Request message in the Initial Registration and the Mobility Registration Update as part of the UE 5GMM Core Network Capability When the serving AMF provides the Configured NSSAI to the UE and the UE has indicated it supports the subscription-based restrictions to simultaneous registration of network slices feature the AMF also provides the UE with the NSSRG information related to the S-NSSAIs of the HPLMN which are in the mapping information of the Configured NSSAI A UE which receives the NSSRG values in the network slicing configuration information shall only include in the Requested NSSAI S-NSSAIs that share a common NSSRG as per the received information If the UE has stored Pending NSSAI and the UE is still interested in the Pending NSSAI then all the S-NSSAIs in the Requested NSSAI and the Pending S-NSSAI shall share a common NSSRG If the HPLMN changes NSSRG information in the subscription information for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_814",
    "document_id": "23501-i80",
    "chunk_id": 814,
    "text": "the UDM updates the supporting AMF serving the UE with the new NSSRG information and the AMF possibly after interaction with the NSSF see clause 521621 of TS 23502 3 updates the UE as necessary with network slicing configuration by means of the UE Configuration Update procedure this may include changes in the Configured NSSAI and related mapping information and changes in the Allowed NSSAI as applicable The UE acknowledges this UE Configuration Update according to clause 4242 of TS 23502 3 At any time a UE supporting subscription-based restrictions to simultaneous registration of network slices feature and that has received NSSRG information together with the Configured NSSAI shall only request S-NSSAIs across all Access Types regardless of whether the same PLMN or different PLMNs are used that share one or more common NSSRG NOTE In Requested NSSAI across all Access Types the UE needs to include S-NSSAIs that share at least one common NSSRG An AMF which supports the subscription-based restrictions to simultaneous registration of network slice feature configures a non-supporting UE with a Configured NSSAI including only the S-NSSAIs sharing all the NSSRG values of the default S-NSSAIs except if it has been instructed otherwise by the UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_815",
    "document_id": "23501-i80",
    "chunk_id": 815,
    "text": "In addition to the default S-NSSAIs the AMF sends to the UE in the Configured NSSAI any other subscribed S-NSSAI whose NSSRG match at least those defined for the default S-NSSAIs The UDM in a supporting HPLMN may optionally keep a record of the PEIs or Type Allocation Codes values regarding UE ability to handle network slices that cannot be provided simultaneously in Allowed NSSAI The UDM may based on configuration or the optional PEI records indicate the AMF to provide the non-supporting UEs with the full set of subscribed S-NSSAIs even if they do not share a common NSSRG",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_816",
    "document_id": "23501-i80",
    "chunk_id": 816,
    "text": "The UDM instructs the supporting AMFs of a PLMN to do so by indicating that the UE can be given a Configured NSSAI with all the S-NSSAIs in the subscription information If this indication is received from the UDM by the AMF this is included in the UE context Based on its policy including configuration or optionally checking the specific PEI or Type Allocation Code used by the UE and subject to roaming agreement the UDM may also provide the serving AMF in a non-supporting VPLMN with all the S-NSSAI in the subscription information In this case the AMF provides the UE with a Configured NSSAI including all the S-NSSAIs in the subscription information the AMF receives The AMF provides no NSSRG information to a non-supporting UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_817",
    "document_id": "23501-i80",
    "chunk_id": 817,
    "text": "When an AMF which supports the subscription-based restrictions to simultaneous registration of network slice feature receives from a UE a Requested NSSAI including S-NSSAIs that are supported in the Tracking Area but do not share a common NSSRG or the AMF has pending NSSAI stored for the UE and the S-NSSAIs of the requested NSSAI and the pending NSSAI do not share a common NSSRG the AMF assumes the UE configuration is not up-to-date and provides the following - a supporting UE with an updated configuration including the up-to-date NSSRG information for the S-NSSAIs in the Configured NSSAI as described above - a non-supporting UE with an updated Configured NSSAI including only the S-NSSAIs sharing all the NSSRG values of the default S-NSSAIs only for the case where the UE context does not include an indication to provide all the subscribed S-NSSAIs in the subscription information in the Configured NSSAI for the UE 51513 Support of data rate limitation per Network Slice for a UE A UE subscription information may include an optional Slice Maximum Bit Rate for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_818",
    "document_id": "23501-i80",
    "chunk_id": 818,
    "text": "Subscribed UE-Slice-MBR for an S-NSSAI which applies for 3GPP access type only The Subscribed UE-Slice-MBR includes a UL and a DL value If a Subscribed UE-Slice-MBR is associated to an S-NSSAI in the subscription information it is provided by the AMF to the NG-RAN when the AMF provides the Allowed NSSAI for the UE to the NG-RAN as UE-Slice-MBR QoS parameter The UE-Slice-MBR QoS parameter is defined in clause 5726 If the Subscribed UE-Slice-MBR for a UE changes the AMF updates UE-Slice-MBR in the NG-RAN accordingly In roaming case the UE-Slice-MBR is provided for the S-NSSAI of the VPLMN which maps to the S-NSSAI of the HPLMN and the AMF may first interact with the PCF for authorization of the Subscribed UE-Slice-MBR If the AMF interacts with the PCF the PCF may provide the Authorized UE-Slice-MBR that is used as UE-Slice-MBR by the AMF as described in clause 6121 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_819",
    "document_id": "23501-i80",
    "chunk_id": 819,
    "text": "For a roaming UE the S-NSSAI of the VPLMN maps to only one S-NSSAI of the HPLMN for which an UE-Slice-MBR is applied The enforcement of the UE-Slice-MBR value if present in the UE context in the NG-RAN for an S-NSSAI is described in clause 57110 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_820",
    "document_id": "23501-i80",
    "chunk_id": 820,
    "text": "The PCF for the PDU Session may in addition be configured to monitor the data rate per Network Slice for a UE and to strengthen or relax the traffic restrictions for individual PDU Sessions or PCC rules accordingly as described in TS 23503 45 clause 6219 51514 Network Slice AS Groups support The NG-RAN may support Network Slice AS Groups NSAGs which are used as specified in TS 38300 27 TS 38331 28 TS 38321 143 and TS 38304 50 A Network Slice AS Group is an identifier of a group of network slices which are associated with it A Network Slice AS Group association with a group of network slices may be valid in one or more Tracking Areas An S-NSSAI can be associated with at most one NSAG values for Random Access and at most one NSAG value for Cell Reselection within a Tracking Area An S-NSSAI can be associated with different NSAG values in different Tracking Areas",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_821",
    "document_id": "23501-i80",
    "chunk_id": 821,
    "text": "The NG-RAN provides and updates the AMF with the values of the NSAGs an S-NSSAI is associated with in a TA using the NG Set Up and RAN Configuration Update procedures see TS 38413 34 The AMF in turn provides this information to the NSSF In deployments where the total number of groups does not exceed the number of groups associated with the NSAG size limit defined in TS 38331 28 all the NSAGs configured in the NG-RAN may be unique per PLMN or SNPN If the UE has indicated that the UE supports NSAG in the 5GMM Core Network Capability see clause 544a the AMF may with or without NSSF assistance configure the UE with NSAG Information for one or more S-NSSAIs in the Configured NSSAI by including this NSAG Information in the Registration Accept message or the UE Configuration Command message The UE uses the NSAG Information as defined in clause 53431",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_822",
    "document_id": "23501-i80",
    "chunk_id": 822,
    "text": "The AMF shall indicate in the NSAG Information in which TA a specific NSAG association to S-NSSAIs is valid if the AMF provides in the UE configuration a NSAG value which is used in different TAs with a different association with NSSAIs The configuration the AMF provides includes at least the NSAGs for the UE for the TAs of the Registration Area If the AMF does not include the list of TAIs in association with an NSAG in the NSAG Information the NSAG is valid in the Registered PLMN and equivalent PLMNs or SNPN NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_823",
    "document_id": "23501-i80",
    "chunk_id": 823,
    "text": "If the NSAGs for the PLMN and equivalent PLMNs have different associations to S-NSSAIs then the AMF includes the list of TAIs in the NSAG information The UE shall store and consider the received NSAG Information valid for the Registered PLMN and equivalent PLMNs or SNPN until - the UE receives new NSAG information in a Registration Accept message or UE Configuration Command message in this PLMN or SNPN or - the UE receives a Configured NSSAI without any NSAG information in this PLMN or SNPN The UE shall store the currently valid NSAG information received in the Registered PLMN or SNPN when registered in this PLMN or SNPN and - The UE should be able to store the NSAG information for at least the Registered-PLMN and equivalent PLMNs or the Registered-SNPN and equivalent SNPNs -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_824",
    "document_id": "23501-i80",
    "chunk_id": 824,
    "text": "The Registered-PLMN can provide NSAG information to the UE for the PLMN and the equivalent PLMNs and the Registered-SNPN can provide NSAG information to the UE for the SNPN - There can be at most 32 NSAGs configured in the UE at a time for a PLMN or SNPN - At most 4 NSAGs can have an optional TAI associated with it The NSAG information is not required to be stored after power off or after the UE becomes Deregistered as it is not used for cell selection 51515 Support of Network Slice usage control 515151 General Network Slice usage control is achieved as follows 1 Configuring network-controlled Slice Usage Policy to supporting UEs see clause 515152 2 Configuring PDU Sessions inactivity timers and Network Slice deregistration inactivity timers see clause 515153 NOTE The use of Network Slice Usage Control while roaming is not supported in UE and VPLMN ie no timers are configured in the UE and VPLMN in this Release of the specification",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_825",
    "document_id": "23501-i80",
    "chunk_id": 825,
    "text": "However for Home Routed PDU sessions PDU Session inactivity timer can be configured in the H-UPF based on operator policy Subject to operator policy and nationalregional regulations the AMF ensures that Network Slice usage control does not apply to a Network Slice used for Emergency services 515152 UE Configuration of network-controlled Slice Usage Policy The UE during the Registration procedure may indicate in UE MM Core Network Capability that it supports UE configuration of network-controlled Slice Usage Policy If so the AMF determines Slice Usage Policy for one or more Network Slices for the UE and configures the UE with this information together with Configured NSSAI to control the usage of this or these Network Slices The AMF may be locally configured with network Slice Usage Policy or receive the policy from the AM-PCF or per the information received from UDM for AF managed timer values see clause 515153 for more details The network-controlled Slice Usage Policy is provided to the UE in the Registration Accept or the UE Configuration Update Command and may include - An indication for one or more of S-NSSAIs of the HPLMN in the Configured NSSAI whether the UE only registers with the Network Slice with the network when applications in the UE require data transmission in the Network Slice ie the UE can only register the Network Slice only on demand and consider the Network Slice as on demand S-NSSAI NOTE All Other Network Slices in the Configured NSSAI are handled by the UE using UE specific policies",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_826",
    "document_id": "23501-i80",
    "chunk_id": 826,
    "text": "eg they may be registered irrespective of applications need - Optionally for on demand S-NSSAIs of the HPLMN in the Configured NSSAI a slice deregistration inactivity timer per access type that causes the UE to deregister the Network Slice Regarding the slice deregistration inactivity timer following applies a The UE and AMF start the timer when one of the following conditions occur 1 the Network Slice is added to the Allowed NSSAI and there are no PDU Sessions associated with the Network Slice over the corresponding access type and 2 the last PDU Session associated with the Network Slice over the same access type is released b The UE and AMF stop the timer and reset when at least one PDU Session associated with the Network Slice is successfully established or the Network Slice is removed from the Allowed NSSAI c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_827",
    "document_id": "23501-i80",
    "chunk_id": 827,
    "text": "When the slice deregistration inactivity timer for a Network Slice over an access type expires the UE and AMF locally remove the S-NSSAI from the Allowed NSSAI If the UE and network state became misaligned the UE may for example request connectivity in a Network Slice which is no longer allowed In this case the AMF shall provide the updated Allowed NSSAI in a UE Configuration Update Command after rejecting the PDU Session establishment The UE may then re-register with the Network Slice if needed The UE stores the received Slice Usage Policy with the Configured NSSAI for the serving PLMN and this is kept stored for as long as a Configured NSSAI remains stored for the PLMN When the Configured NSSAI is updated the AMF may also provide a new Slice Usage Policy to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_828",
    "document_id": "23501-i80",
    "chunk_id": 828,
    "text": "The AMF receives slice deregistration inactivity timer values ie the configured slice deregistration inactivity timer as described in clause 515153 At mobility between AMFs the old AMF provides both the ongoing slice deregistration inactivity timer information if it is started to enable the new AMF know when the timer expires and the configured slice deregistration inactivity timer values in the UE context to the new AMF if the slice deregistration inactivity timer is received from the AM-PCF If the configured slice deregistration inactivity timer values have been updated at the old AMF but not notified to the UE the old AMF provides the new configured slice deregistration inactivity timer values as the configured slice deregistration inactivity timer values to the new AMF The new AMF includes the slice deregistration inactivity timer in Registration Accept Message sent to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_829",
    "document_id": "23501-i80",
    "chunk_id": 829,
    "text": "If the slice deregistration inactivity timer value is updated and the AMF determines to provide the timer to the UE the AMF provides the updated value to the UE if the UE supports UE configuration of network-controlled Slice Usage Policy during the registration procedure or any subsequent registration if there is no ongoing registration procedure The AMF and the UE if the update been provided to the UE successfully use the updated slice deregistration inactivity timer value next time the slice deregistration inactivity timer starts 515153 Network-based per UE Network Slice usage behaviour control The 5GC performs Network Slice usage monitoring to be able to enforce the release of inactive PDU Sessions and deregistering of UEs from Network Slices with no PDU Sessions on them according to its own policies In order to support usage monitoring for a Network Slice - The AMF runs a slice deregistration inactivity timer per S-NSSAI and access type to deregister the Network Slice",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_830",
    "document_id": "23501-i80",
    "chunk_id": 830,
    "text": "Regarding the slice deregistration inactivity timer following applies a The AMF starts the timer when one of the following conditions occur 1 the Network Slice is added to the Allowed NSSAI and there are no PDU Sessions associated with the Network Slice over the corresponding access type and 2 the last PDU Session associated with the Network Slice over the same access type is released b The AMF stops the timer and reset when at least one PDU Session associated with the Network Slice is successfully established or the Network Slice is removed from the Allowed NSSAI c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_831",
    "document_id": "23501-i80",
    "chunk_id": 831,
    "text": "When the slice deregistration inactivity timer for a Network Slice over an access type expires the AMF removes the Network Slice from the Allowed NSSAI over the access type by sending the UE Configuration Update Command to impacted UEs - The SMFs provide to UPFs that handle the PDU sessions in the Network Slice a PDU Session inactivity timer The PDU Session inactivity timer is started after no data packet is transmitted or received and runs until the next data packet is transmitted or received which restarts the timer again If the PDU Session inactivity timer expires before any packet is received or transmitted the UPF reports this PDU Session inactivity event to the SMF to cause the SMF to release the PDU Session While releasing the PDU session the SMF may indicate the release cause because of slice inactivity When the AMF receives the notification of PDU Session release and it includes the release cause of slice inactivity and if the Network Slice of the released PDU Session is not used by other PDU Sessions ie the last PDU Session using the Network Slice is released over the corresponding access type the AMF may trigger the UE Configuration Update procedure to remove the Network Slice from the Allowed NSSAI over that corresponding access type or start slice deregistration inactivity timer for the Network Slice If the PDU Session inactivity timer value is updated the SMF provides the updated PDU Session inactivity timer value to the UPF The UPF uses the updated PDU Session inactivity timer value immediately or next time the PDU Session inactivity timer starts NOTE For MA PDU Session the PDU Session inactivity timer is independent of Access Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_832",
    "document_id": "23501-i80",
    "chunk_id": 832,
    "text": "If an S-NSSAI is dedicated for a single AF and if authorized by operator policy to provide deregistration inactivityPDU Session inactivity timer values for the S-NSSAI the AF uses external parameter provisioning procedure to provide deregistration inactivity and PDU session inactivity timer values as described in clause 41563g of TS 23502 3 In this case the AF provided timer values are stored in the UDM and provided to the AMFSMF as part of subscription data for the corresponding S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_833",
    "document_id": "23501-i80",
    "chunk_id": 833,
    "text": "If no AF is authorized to provide deregistration inactivityPDU Session inactivity timer values for the S-NSSAI ie no timer value received from UDM the slice deregistration inactivity timer value and PDU Session inactivity timer value are either pre-configured in the AMFSMF or received by the AMFSMF during the AM Policy Association SM Policy Association procedure respectively To enable a serving network to direct UEs to a preferred Network Slice the AMF may request the UE to transfer a PDU Session from one S-NSSAI to another S-NSSAI as described in clause 51519 51516 Optimized handling of temporarily available network slices A network slice may be available for all UEs or a limited number of UEs only for a limited time that is known at the network in advance eg by OAM or subscription",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_834",
    "document_id": "23501-i80",
    "chunk_id": 834,
    "text": "The limited time duration may be due to for example the fact that network slice is only temporarily or periodically active in the deployment eg for a limited time to serve an event or a UE may be only authorized to access the network slice for a limited time known in advance or the network slice is being decommissioned at a known future time This feature is enabled by S-NSSAI validity time that the network and the UE can handle to reduce the signalling load associated to the transitions in RM and SM states for the network slice",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_835",
    "document_id": "23501-i80",
    "chunk_id": 835,
    "text": "The UE may indicate its support for temporarily available network slices in the UE MM Core Network Capability see clause 544a in the Registration Request The AMF based on OAM configuration or information received from the UDM or NSSF may indicate to a supporting UE the validity time for one or more S-NSSAIs in the Configured NSSAI in the Registration Accept message or via the UE Configuration Update procedure In roaming case the AMF my include the validity time for an S-NSSAI in the Configured NSSAI either because of limited availability of the VPLMN S-NSSAI or the mapped S-NSSAI of the HPLMN NOTE 1 When the validity time changes or a validity time is determined for a S-NSSAI in the configured NSSAI the PLMN provides the new validity time for the S-NSSAIs in the Configured NSSAI to a supporting UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_836",
    "document_id": "23501-i80",
    "chunk_id": 836,
    "text": "If a supporting UE is configured with validity time for an S-NSSAI a If the validity time indicates the S-NSSAI is available the UE may request the S-NSSAI in a Requested NSSAI in a Registration request and if the S-NSSAI is included in the Allowed NSSAI or in the Partially Allowed NSSAI the UE may establish PDU sessions associated with the S-NSSAI b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_837",
    "document_id": "23501-i80",
    "chunk_id": 837,
    "text": "If the validity time indicates the S-NSSAI is not available - The UE shall not include the S-NSSAI in the Requested NSSAI for any Access Types regardless of the validity time information was received - If the S-NSSAI is already part of the Allowed NSSAI or Partially Allowed NSSAI the UE shall remove the S-NSSAI from the locally stored Allowed NSSAI or Partially Allowed NSSAI and the UE shall also locally release any PDU sessions associated with the S-NSSAI - If the validity time indicates the S-NSSAI will not be available again the UE shall remove the S-NSSAI from the locally stored Configured NSSAI NOTE 2 Subject to implementation decisions outside 3GPP scope the UE may also use the validity time information to eg attempt to use another PDU sessions to continue supporting the connectivity with another connectivity option if possible according to the URSP rules or if not possible eg provide implementation-dependent information on the availability of connectivity for specific applications affected by an impending connectivity loss so the UE can let the end user prepare for the loss of connectivity NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_838",
    "document_id": "23501-i80",
    "chunk_id": 838,
    "text": "The AMF will add an S-NSSAI to the Allowed NSSAI before an S-NSSAI validity time of a single S-NSSAI in the Allowed NSSAI expires - If a UE supporting temporary available network slices only got one S-NSSAI in the Allowed NSSAI with a validity time that is about to expire and does not have any Pending NSSAI then the UE may trigger a Mobility Registration Update to register with any other S-NSSAI in the Configured NSSAI which is still available if any and if UE does not trigger Mobility Registration Update and Allowed NSSAI becomes empty after expiry of validity time then the UE shall enter RM-DEREGISTERED state implicitly For a supporting UE if validity time applies to an S-NSSAI an AMF supporting temporarily available network slices shall - If the S-NSSAI is provided in a Requested NSSAI in a Registration Request by the UE and the validity time indicates the S-NSSAI is not available but it is going to become available again ie the UE is detected as not having up to date validity time then the AMF sends the Configured NSSAI to the UE including the validity time for the S-NSSAI in the Registration Accept message If the validity time indicates the S-NSSAI is not available and will not become available again then the AMF sends the Configured NSSAI to the UE excluding the S-NSSAI from the Configured NSSAI - If the S-NSSAI is in the Allowed NSSAI or the Partially Allowed NSSAI for the UE and the validity time indicates that the S-NSSAI is not available then locally remove ie without sending any signalling to the UE the S-NSSAI from the Allowed NSSAI or Partially Allowed NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_839",
    "document_id": "23501-i80",
    "chunk_id": 839,
    "text": "If there is any PDU session established for the S-NSSAI the AMF requests the SMF to release the PDU session - If the UE is in CM-CONNECTED state the AMF releases the PDU session for the S-NSSAI by sending to the SMF as per step 1f in clause 4342 of TS 23502 3 a Nsmf_PDUSession_UpdateSMContext Request with a release indication to request the release of the PDU Session and then the AMF forwards the N2 SM request to release the AN resources associated with the PDU session - If the UE is in CM-IDLE state the AMF locally releases the PDU session without paging the UE and causes the SMF to locally release the SM context for the UE by a Nsmf_PDUSession_ReleaseSMContext as in step 1c in clause 4342 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_840",
    "document_id": "23501-i80",
    "chunk_id": 840,
    "text": "The PDU Session status is synchronized at next time when the UE connects to the network - If there is no S-NSSAI present in the Allowed NSSAI or Partially Allowed NSSAI after AMF removes the S-NSSAI locally after expiry of validity time the AMF shall enter RM-DEREGISTERED state for the UE implicitly For a non-supporting UE if validity time applies to an S-NSSAI an AMF supporting temporarily available network slices shall - If the validity time indicates the S-NSSAI is available allow or partially allow the network slice when requested establish PDU sessions when requested - If the S-NSSAI is provided in a Requested NSSAI in a Registration Request by the UE and the validity time indicates the S-NSSAI is not available reject the S-NSSAI and remove the S-NSSAI from the Configured NSSAI by providing an updated Configured NSSAI in the Registration Accept message - If the S-NSSAI is in the UE in the Allowed NSSAI or Partially Allowed NSSAI and the validity time indicates the S-NSSAI is not available remove the S-NSSAI from the Configured NSSAI and the Allowed NSSAI or Partially Allowed NSSAI by a UE Configuration Update procedure If there is any PDU session established for the S-NSSAI the AMF requests the SMF to release the PDU session in the network - If the UE is in CM-CONNECTED state the AMF releases the PDU session for the S-NSSAI by sending to the SMF as in step 1f in clause 4342 of TS 23502 3 a Nsmf_PDUSession_UpdateSMContext Request with a release indication to request the release of the PDU Session and then the AMF forwards the N2 SM request to release the AN resources associated with the PDU session - If the UE is in CM-IDLE the AMF locally releases the PDU session without paging the UE and causes the SMF to locally release the SM context for the UE by a Nsmf_PDUSession_ReleaseSMContext as in step 1c in clause 4342 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_841",
    "document_id": "23501-i80",
    "chunk_id": 841,
    "text": "The PDU Session status is synchronized at next time when the UE connects to the network NOTE 4 If the network slice becomes unavailable and a large number of UEs are impacted the AMF can send the updates to the non-supporting UEs in a manner that avoids surge in signalling eg next time the UE becomes connected - If the AMF detects from the validity time of a S-NSSAI that it is available again then update the Configured NSSAI to include the S-NSSAI via a UE Configuration Update procedure NOTE 5 The AMF for the case of UE not performing any actions despite the validity timing information provided by the network can terminate PDU Sessions associated with S-NSSAI subject to be terminated according to the validity time by explicitly releasing the PDU Sessions associated with the S-NSSAI 51517 Partial Network Slice support in a Registration Area A Network Slice may be supported in one or more TAs in a PLMNSNPN The Partial Network Slice support in a Registration Area for a UE includes configuring the UE with a Partially Allowed NSSAI andor S-NSSAIs rejected partially in the RA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_842",
    "document_id": "23501-i80",
    "chunk_id": 842,
    "text": "When creating a Registration Area for UEs registering over the 3GPP access and supporting the Partial Network Slice support in a Registration Area the AMF may consider the trade-off between signalling for paging in TAs where the S-NSSAI is not supported versus the signalling for Mobility Registration Updates to register with the S-NSSAI in the TAs where the S-NSSAI is supported so that the AMF may create a Registration Area including the TAs where a requested S-NSSAI is not supported For supporting UEs whether the AMF uses the Partially Allowed NSSAI or rejects the S-NSSAIs partially in the RA or whether the AMF rejects the S-NSSAI for the current RA is a per S-NSSAI decision which is based on AMF local policy If supported and allowed by local policy the Partially Allowed NSSAI and S-NSSAIs rejected partially in the RA may be applied simultaneously for one UE for different S-NSSAIs For such S-NSSAI - If requested by the UE from a TA where the S-NSSAI is not supported including the case when the S-NSSAI is provided as a rejected S-NSSAI for the TA from the NSSF - the S-NSSAI is included either in the Partially Allowed NSSAI or the AMF rejects the S-NSSAI partially in the RA or - if the S-NSSAI is subject to NSAC for maximum number of UEs then the AMF should send this S-NSSAI as rejected partially in the RA in the Registration Accept message - If the S-NSSAI is subject to NSSAA and successful NSSAA status for the S-NSSAI is not present in the AMF then the AMF either sends this S-NSSAI as rejected partially in the RA in the Registration Accept message or the AMF starts executing NSSAA and includes the S-NSSAI in the Pending NSSAI in the Registration Accept message If the S-NSSAI is subject to NSSAA and successful NSSAA status for the S-NSSAI is present then the AMF may include the S-NSSAI either in the Partially Allowed NSSAI or the AMF rejects the S-NSSAI partially in the RA NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_843",
    "document_id": "23501-i80",
    "chunk_id": 843,
    "text": "In roaming case the NSSAA requirement is based on the mapped S-NSSAI of the HPLMN - if the slice deregistration inactivity timer is configured for the S-NSSAI see clause 515153 then AMF should send this S-NSSAI as rejected partially in the RA - If requested by the UE from a TA where the S-NSSAI is supported including the case when the S-NSSAI is provided in the Allowed NSSAI from the NSSF - the S-NSSAI is included in the Partially Allowed NSSAI or - if the S-NSSAI is subjected to NSAC for maximum number of UEs then the AMF should restrict the RA so that the S-NSSAI is supported in all the TAs of the RA and includes the S-NSSAI in the Allowed NSSAI - If the S-NSSAI is subject to NSSAA then the AMF starts executing NSSAA and sends this S-NSSAI in the Pending NSSAI in the Registration Accept message unless successful NSSAA status is present in the AMF for this S-NSSAI in which case it can be sent in the Partially Allowed NSSAI NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_844",
    "document_id": "23501-i80",
    "chunk_id": 844,
    "text": "In roaming case the NSSAA requirement is based on the mapped S-NSSAI of the HPLMN - if the S-NSSAI is included in neither the Partially Allowed NSSAI nor the Allowed NSSAI the AMF may reject the S-NSSAI as described in clause 515411 While the S-NSSAIs of the Allowed NSSAI are supported in all the TAs of the Registration Area the S-NSSAIs of the Partially Allowed NSSAI are supported only in the TAs corresponding to the list of TAs which are subset of the list of TAIs forming the Registration Area associated with the S-NSSAI If the UE supports Partial Network Slice support in a Registration Area the AMF may create a Registration Area for the UE considering the support of the S-NSSAIs of the Requested NSSAI in the current TA and in the neighbouring TAs and provides to the UE in the Registration Accept message or in the UE Configuration Update Command message the Partially Allowed NSSAI or the S-NSSAIs rejected partially in the RA as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_845",
    "document_id": "23501-i80",
    "chunk_id": 845,
    "text": "If one or more of the requested S-NSSAIs are supported in a subset of the TAs of the potential Registration Area the AMF may include such S-NSSAIs in the Partially Allowed NSSAI and corresponding mapping information of the S-NSSAIs of the Partially Allowed NSSAI to the HPLMN S-NSSAIs For each S-NSSAI of the Partially Allowed NSSAI the AMF provides a list of TAs where the S-NSSAI is supported The UE is considered registered with the S-NSSAI in the whole Registration Area The AMF also provides the Partially Allowed NSSAI without indication of the TA list where the partially allowed S-NSSAIs are supported to the NG-RAN together with the UEs context - Alternatively the AMF may reject the S-NSSAIs with reject cause indicating partially in the RA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_846",
    "document_id": "23501-i80",
    "chunk_id": 846,
    "text": "For each S-NSSAI of the S-NSSAIs rejected partially in the RA the AMF provides a list of TAs where the S-NSSAI is not supported NOTE 3 If the UE requests an S-NSSAI in a cell of a TA where the NS-AoS of the S-NSSAI does not match deployed Tracking Areas see clause 51518 the AMF includes the S-NSSAI in the Allowed NSSAI or Partially Allowed NSSAI For Partially Allowed NSSAI the following applies - The UE is considered registered with an S-NSSAI of the Partially Allowed NSSAI in the whole Registration Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_847",
    "document_id": "23501-i80",
    "chunk_id": 847,
    "text": "The UE does not trigger registration when moving between the TAs of support and non-support for the S-NSSAI within the RA - The UE is allowed to initiate PDU Session establishment for the S-NSSAI only when the UE is in a TA where the S-NSSAI is supported If the UE has overlapping areas between non-allowed area area where the S-NSSAI is supported then the non-allowed area restriction applies - If the AMF determines a PDU Session is associated with S-NSSAI present in the Partially Allowed NSSAI the AMF indicates to the SMF that the PDU Session is subject to area restrictions for the S-NSSAI As a result the SMF subscribes to UE mobility event notification event for reporting UE presence in Area of Interest by providing S-NSSAI to the AMF as described in clauses 5611 and 5344 if this event has not been subscribed before The supporting AMF shall provide this indication in all the subsequent PDU Session update message to the SMF as long as the S-NSSAI of the PDU Session is subject to area restriction When the AMF does not indicate to the SMF that the PDU Session is subject to area restriction for the S-NSSAI the SMF may unsubscribe UE mobility event notification event in the AMF if this event has been subscribed before - When the UE has already established a PDU Session with an S-NSSAI part of the Partially Allowed NSSAI the UE is allowed to activate the User Plane resources of the PDU Session only when the UE is in a TA part of the list of TAs associated with the S-NSSAI The UE shall not request User Plane resources when the UE is in a TAI where the S-NSSAI of the PDU Session is not supported based on the Partially Allowed NSSAI as a result the always-on PDU Session is also not re-activated during the Service Request or registration procedure - When the User Plane resources are activated for a PDU Session of an S-NSSAI part of the Partially Allowed NSSAI and the UE moves to a TA which is not part of the list of TAs associated with the S-NSSAI the NG-RAN releases the User Plane resources for the PDU Session as described in step 1d in clause 4342 of TS 23502 3 and the SMF deactivates the PDU Session as described in step 3a in clause 4342 of TS 23502 3 but the PDU Session context in UE and SMF is not released The User Plane resources for the PDU Session shall not be activated as long as the UE is located in a TA which is not part of the list of TAs associated with the S-NSSAI of the Partially Allowed NSSAI The UE shall not send user data as payload of a NAS message see clause 53141 in uplink directions The AMF determines the UE presence in Area of Interest as described in Annex D clauses D1 and D2 of TS 23502 3 and notifies the result to the SMF When the SMF is notified by the AMF that the UE location is outside of the Area of Interest the SMF shall not send user data as payload of NAS message see clause 53141 in downlink directions and disable data notification When the SMF is notified by the AMF that the UE location is UNKNOWN as defined in Annex D clauses D1 and D2 of TS 23502 3 then based on operator policy SMF may enable downlink data notification and trigger the Network triggered Service Request procedure to active the UP connection or send user data as payload of a NAS message see clause 53141 when the SMF receives downlink data or Data Notification from UPF NOTE 4 When I-SMFV-SMF is inserted for the PDU session it is the I-SMFV-SMF to handle the area restrictions for the S-NSSAI The SMFH-SMF is not involved in this procedure For an already established PDU Session associated with an S-NSSAI included in the Partially Allowed NSSAI even when the supporting UE is in a TA where the S-NSSAI is not supported the supporting UE may initiate a PDU Session release procedure or PDU Session modification procedure ie for PS data off status change reporting When the UE stores a S-NSSAI rejected partially in the RA with the associated list of TAs the UE is allowed to initiate a Mobility Registration Update procedure to request registration with the S-NSSAI only when the UE is in a TA which is not part of the list of TAs associated with this S-NSSAI For a UE in CM-CONNECTED state when a PDU Session is established on an S-NSSAI included in the Partially Allowed NSSAI the User Plane resources are activated and the UE moves to a TA where the S-NSSAI is not supported the NG-RAN releases the User Plane resources of the PDU sessions associated with the S-NSSAIs as described in step 1d of clause 4342 of TS 23502 3 and the SMF deactivates the PDU session as described in step 3a of clause 4342 of TS 23502 3 51518 Support for Network Slices with Network Slice Area of Service not matching deployed Tracking Areas 515181",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_848",
    "document_id": "23501-i80",
    "chunk_id": 848,
    "text": "General The network support for a Network Slice is defined on a per Tracking Area granularity It may be beneficial to deploy some Network Slices such that the Network Slice have a limited geographical availability that is not matching existing Tracking Area boundaries The operator can in this case decide to change the topology of the Tracking Areas so they match the boundaries of the Network Slice or the operator may configure resources for the Network Slices in the cells of TAs where the Network Slices are to be available and in cells of the TAs where the network slice is defined to be not available the cells are configured with zero resources If a Network Slice is considered available in a cell the Network Slice is also supported by the TA comprising the cell The AMF receives from the OAM the information on availability of a network slice when the granularity is smaller than TA ie if the NS-AoS includes TAs where the network slice is not available in some cells of the TA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_849",
    "document_id": "23501-i80",
    "chunk_id": 849,
    "text": "In order to optimize the end-to-end behaviour the AMF can based on NS-AoS information received from OAM configure supporting UEs with S-NSSAI location availability information and the network may need to monitor the S-NSSAI usage and enforce the NS-AoS eg if the UE does not support the S-NSSAI location availability information 515182 S-NSSAI location availability information S-NSSAI location availability information defines additional restrictions to the usage of an S-NSSAI in TAs where the Network Slice availability does not match the TA boundaries The AMF is configured per S-NSSAI whether to send the S-NSSAI location availability information to supporting UEs The S-NSSAI location availability information sent to the UE includes for each applicable S-NSSAI of the Configured NSSAI Location information indicating the cells of TAs in the RA where the related S-NSSAI is available if the S-NSSAI is not available in all the cells of the TA If the UE has indicated that the UE supports S-NSSAI location availability information in the 5GMM Core Network Capability see clause 544a the AMF may based on OAM configuration configure the UE with S-NSSAI location availability information for one or more S-NSSAIs when the AMF allocates an RA where the Network Slice availability does not match whole TAs by including the S-NSSAI location availability information in the Registration Accept message or the UE Configuration Command message A UE that receives S-NSSAI location availability information applies the information as follows 1 If the S-NSSAI is rejected in the RA or rejected partially in the RA or rejected with a cause code that allows attempting to register the S-NSSAI again the UE can request the S-NSSAI only if the S-NSSAI location availability information indicates that the S-NSSAI is available at the cell where the UE is camping 2 If the S-NSSAI is in the Partially Allowed NSSAI or in the Allowed NSSAI and the UE is in a cell within the RA but outside the NS-AoS of the S-NSSAI the following applies a The UE shall not activate User Plane resources for any already established PDU Session with that S-NSSAI including the case of always-on",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_850",
    "document_id": "23501-i80",
    "chunk_id": 850,
    "text": "PDU Session b The UE shall not send user data as payload of a NAS message see clause 53141 in uplink direction c For an already established PDU Session the supporting UE may initiate signalling for PDU Session release procedure or PDU Session modification procedure ie for PS data off status change reporting 3 If the UE has overlapping areas between non-allowed area a cell inside the NS-AoS then the non-allowed area restriction applies 4 If the S-NSSAI is in the Partially Allowed NSSAI or in the Allowed NSSAI and the UE in CM-CONNECTED state moves from a cell inside the NS-AoS to a cell outside the NS-AoS and the User Plane resources are active for a PDU Session on that S-NSSAI the NG-RAN releases the User Plane resources as described in step 1d of the AN initiated Release of a PDU Session in clause 4342 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_851",
    "document_id": "23501-i80",
    "chunk_id": 851,
    "text": "The SMF also deactivates the PDU Session as described in step 3a in clause 4342 of TS 23502 3 NOTE 1 By Radio Resource Management and existing mechanisms in NG-RAN handover can be used to keep the UE in the NS-AoS or steer the UE to enter the NS-AoS as long as radio conditions allow it NOTE 2 Since the S-NSSAI location availability information is not a used as a trigger for the UE to perform MRU due to mobility ie the UE performs MRU due to mobility upon changing to a new TA outside the UEs Registration Area the S-NSSAI remains registered and is included in the Allowed NSSAI when the UE exits the NS-AoS If the S-NSSAI is subject for NSAC the S-NSSAI is counted towards NSAC as described in clause 51511 also when the UE is outside the NS-AoS 515183 Network based monitoring and enforcement of Network Slice Area of Service not matching deployed Tracking Areas OAM may configure RRM policies for S-NSSAIs on a per cell basis as defined in TS 28541 149 ie cells outside the Network Slice Area of Service while in a TA supporting the S-NSSAI are allocated with no RRM resources for the S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_852",
    "document_id": "23501-i80",
    "chunk_id": 852,
    "text": "The network may enforce the NS-AoS for an S-NSSAI as follows 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_853",
    "document_id": "23501-i80",
    "chunk_id": 853,
    "text": "The network may monitor the validity of the S-NSSAI for UE in CM-CONNECTED state ie the AMF subscribes to the AoI using the Location information of the S-NSSAI location availability information as described in TS 38413 34 2 If the non-supporting UE makes a PDU Session establishment request with an S-NSSAI that is not valid as per the S-NSSAI location availability information the AMF may reject the NAS Transport message with a back-off timer using S-NSSAI based congestion control as described in clause 51974 3 If the AMF determines that the UE in CM-CONNECTED has moved outside the NS-AoS the AMF performs the following logic a If the non-supporting UE has other S-NSSAIs in the Allowed NSSAI then the AMF may update the UE with a UE Configuration Update by removing the S-NSSAI from the Allowed NSSAI and optionally removing the S-NSSAI from the Configured NSSAI and then the AMF requests the SMF to release any PDU Sessions with that S-NSSAI as per step 1f in clause 4234 in TS 23502 3 b If the non-supporting UE does not have any other S-NSSAI in the Allowed NSSAI then the AMF may update the UE with a UE Configuration Update by removing the S-NSSAI from the Allowed NSSAI and optionally removing the S-NSSAI from the Configured NSSAI and adding a default S-NSSAI to the Allowed NSSAI and then the AMF requests the SMF to release any PDU Sessions with the removed S-NSSAI as per step 1f in clause 4342 in TS 23502 3 NOTE 1 Whether the AMF removes the S-NSSAI only from Allowed NSSAI or from both Allowed NSSAI and Configured NSSAI or only releases the associated PDU Sessions when the AMF enforces the NS-AoS is up to AMF configuration c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_854",
    "document_id": "23501-i80",
    "chunk_id": 854,
    "text": "For a non-supporting UE that does not have any other S-NSSAI in the Allowed NSSAI nor in the Configured NSSAI then the AMF indicates to the SMF to release the PDU Session 4 If the AMF determines that the S-NSSAI becomes valid eg the UE has moved into the NS-AoS the AMF may update the UE with a UCU eg including the S-NSSAI in the Configured NSSAI 5 When the AMF determines that the S-NSSAI of a PDU Session is restricted to an NS-AoS in the PDU session the AMF indicates to the SMF that the PDU Session is subject to area restriction for the S-NSSAI As a result the SMF subscribes to UE mobility event notification event for reporting UE presence in Area of Interest by providing S-NSSAI to the AMF as described in clauses 5611 and 5344 if this event has not been subscribed before The supporting AMF shall provide this indication in all the subsequent PDU Session update message to the SMF as long as the S-NSSAI of the PDU Session is subject to area restriction The AMF determines the UE presence in Area of Interest as described in Annex D clauses D1 and D2 of TS 23502 3 and notifies the result to the SMF When SMF is notified that the UE location is outside of Area of Interest SMF shall not send user data as payload of NAS message see clause 53141 in downlink directions and disable data notification When the AMF does not indicate to the SMF that the PDU Session is subject to area restriction for the S-NSSAI based on local configuration the SMF may unsubscribe the UE mobility event notification event in AMF if this event has been subscribed before 6 When the SMF is notified by the AMF that the UE location is UNKNOWN as defined in Annex D clauses D1 and D2 of TS 23502 3 then based on operator policy SMF may enable downlink data notification and trigger the Network triggered Service Request procedure to active the UP connection or send user data as payload of a NAS message see clause 53141 when the SMF receives downlink data or Data Notification from UPF NOTE 2 When I-SMFV-SMF is inserted for the PDU session it is the I-SMFV-SMF to handle the area restrictions for the S-NSSAI The SMFH-SMF is not involved in this procedure 51519 Support of Network Slice Replacement The Network Slice Replacement feature is used to temporarily replace an S-NSSAI with an Alternative S-NSSAI when an S-NSSAI becomes unavailable or congested in the 5GC The Network Slice Replacement may be triggered in the following cases - If the NSSF detects that an S-NSSAI becomes unavailable or congested eg based on OAM or NWDAF analytics output the NSSF sends network slice availability notification for the S-NSSAI to the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_855",
    "document_id": "23501-i80",
    "chunk_id": 855,
    "text": "The notification may include an Alternative S-NSSAI which can be used by the AMF to replace the S-NSSAI and congestion mitigation information if the S-NSSAI is congested The NSSF notifies the AMF when the S-NSSAI is available again - If the PCF detects that an S-NSSAI becomes unavailable or congested for a UE eg based on OAM or NWDAF analytics output the PCF sends access and mobility related policy notification to the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_856",
    "document_id": "23501-i80",
    "chunk_id": 856,
    "text": "The notification may include an Alternative S-NSSAI which can be used by the AMF to replace the S-NSSAI The PCF notifies the AMF when the S-NSSAI is available again for the UE - The OAM sends notification to AMF when an S-NSSAI becomes unavailable or congested and also when this S-NSSAI becomes available again and provides the Alternative S-NSSAI to AMF and the OAM may provide congestion mitigation information if the S-NSSAI is congested The network slice associated with the Alternative S-NSSAI is assumed in this specification to have NS-AoS to be covering at least the NS-AoS of the replaced network slice If the UE moves to a cell where the replaced S-NSSAI is not supported but still within the NS-AoS of the Alternative S-NSSAI the AMF removes the replaced S-NSSAI from the Allowed NSSAI if the S-NSSAI was in the Allowed NSSAI and from the Partially Allowed NSSAI if the UE moves out of the RA also If the replaced S-NSSAI is subject to area restrictions the AMF indicates to the SMF that the PDU Session is subject to area restrictions for the replaced S-NSSAI and the AMF and the SMF then apply the area restriction for the replaced S-NSSAI as described in clause 51517 or clause 51518 and the SMF additionally deactivates the PDU Session when the UE is OUT of AoI NOTE 1 It is recommended to use a network slice associated with the Alternative S-NSSAI that is able to support requirements for the services that the replaced network slice supports It is further recommended in particular that the Alternative S-NSSAI supports at least the DNNs supported in the replaced S-NSSAI NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_857",
    "document_id": "23501-i80",
    "chunk_id": 857,
    "text": "The AMF can by using the UEs presence in the AoI for the replaced S-NSSAI prevent the UE from obtaining service in the Alternative network slice in cells outside the NS-AoS of the replaced network slice but within the NS-AoS of the Alternative network slice if the Alternative network slice NS-AoS exceeds the NS-AoS of the replaced network slice Based on the notification above from NSSF or PCF or OAM the AMF may determine that an S-NSSAI is to be replaced with Alternative S-NSSAI For roaming case the AMF subscribes the network slice availability notification of the HPLMN S-NSSAI from the NSSF in VPLMN and the NSSF in VPLMN subscribes the notification from NSSF in the HPLMN as described in clause 5156",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_858",
    "document_id": "23501-i80",
    "chunk_id": 858,
    "text": "If the notification is from NSSF or OAM and reason for the replacement is due to congestion the notification includes additional congestion mitigation information The details of the congestion mitigation information from NSSF and how the congestion mitigation information is used by the AMF is described in clause 521633 of TS 23502 3 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_859",
    "document_id": "23501-i80",
    "chunk_id": 859,
    "text": "It is recommended that the operator configures to use only one option ie OAM PCF or NSSF for determining an Alternative S-NSSAI and triggering the Network Slice Replacement for S-NSSAI The AMF uses the Alternative S-NSSAI received in the notification from the NSSF or from OAM or from the PCF If the NSSF or PCF or OAM do not provide an Alternative S-NSSAI in the notification the AMF uses an Alternative S-NSSAI based on local configuration The Alternative S-NSSAI shall be supported in the UE Registration Area If AMF cannot determine the Alternative S-NSSAI for the S-NSSAI eg OAM or NSSF doesnt provide Alternative S-NSSAI and there is no Alternative S-NSSAI in the AMF local configuration the AMF may further interact with the PCF to determine the Alternative S-NSSAI The event trigger in AMF for interacting with PCF is described in clause 6125 of TS 23503 45 If the Alternative S-NSSAI is subject to NSSAA the Alternative S-NSSAI shall only be used for UEs for which the Alternative S-NSSAI is included in the Subscribed S-NSSAIs In this case the AMF performs the NSSAA procedure for the Alternative S-NSSAI as described in clause 51510 before the AMF triggers Network Slice Replacement as specified below The UE indicates the support of Network Slice Replacement feature during the UE Registration procedure For supporting UE in CM-CONNECTED state and if there is a PDU Sessions in the UE context associated with the S-NSSAI that needs to be replaced over an Access Type the AMF additionally provides the Alternative S-NSSAI for this S-NSSAI in the Allowed NSSAI over the same Access Type and in the Configured NSSAI if not included yet and the mapping between S-NSSAIs to Alternative S-NSSAIs to the UE in UE Configuration Update message as follows - for non-roaming UEs the AMF provides the mapping of the S-NSSAI to the Alternative S-NSSAI to the UE NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_860",
    "document_id": "23501-i80",
    "chunk_id": 860,
    "text": "In the non-roaming case the Alternative S-NSSAI does not have to be a Subscribed S-NSSAIs as the replaced S-NSSAI is always a subscribed S-NSSAI - for roaming UEs when the VPLMN S-NSSAI has to be replaced by a VPLMN Alternative S-NSSAI the AMF provides the mapping of the VPLMN S-NSSAI to the Alternative VPLMN S-NSSAI to the UE - for roaming UEs when the HPLMN S-NSSAI has to be replaced by an Alternative HPLMN S-NSSAI the AMF provides the mapping of the HPLMN S-NSSAI to the Alternative HPLMN S-NSSAI to the UE NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_861",
    "document_id": "23501-i80",
    "chunk_id": 861,
    "text": "In the roaming cases the Alternative HPLMN S-NSSAI does not have to be one of the Subscribed S-NSSAIs as the replaced HPLMN S-NSSAI is always part of the Subscribed S-NSSAIs The AMF provides the mapping of the S-NSSAI to the Alternative S-NSSAI over the access the AMF wants to trigger Network Slice Replacement The UE stores the received mapping information together with the received Access Type and only uses it over that access Since Network Slice Replacement applies independent of Access Type when the replacement occurs the same Alternative S-NSSAI mapping to the replaced S-NSSAI is provided over the Access Types where the replaced S-NSSAI is in the Allowed NSSAI If the replaced S-NSSAI cannot be kept in the Allowed NSSAI or Partially Allowed NSSAI the AMF additionally removes the Alternative S-NSSAI from the Allowed NSSAI or Partially Allowed NSSAI if the Alternative S-NSSAI is only used for Network Slice Replacement",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_862",
    "document_id": "23501-i80",
    "chunk_id": 862,
    "text": "At mobility between AMFs the source AMF provides to the new AMF the Alternative S-NSSAI and the mapping of the replaced S-NSSAI to the Alternative S-NSSAI in the UE context When an S-NSSAI is subject to Network Slice Replacement the new AMF compares the Requested NSSAI with the received UE context and updates the UE which misses the mapping of the replaced S-NSSAI to the Alternative S-NSSAI For the supporting UE when the UE has a NAS signalling connection ie it is CM-CONNECTED or it has become CM-CONNECTED eg through a Service Request procedure or through a UE registration procedure if the AMF determines that the S-NSSAI is to be replaced and there is a PDU Session associated with the S-NSSAI in the UE context see also NOTE 3 the AMF sends the mapping of the S-NSSAI to the Alternative S-NSSAI to the UE in the UE Configuration Update message or in the Registration Accept message NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_863",
    "document_id": "23501-i80",
    "chunk_id": 863,
    "text": "It is left to AMF local policy whether to send the mapping of the S-NSSAI to the Alternative S-NSSAI to the UE when there is no PDU session associated with the S-NSSAI or wait and send the mapping of the S-NSSAI to the Alternative S-NSSAI to the UE when the UE establishes a PDU Session associated with the S-NSSAI When the S-NSSAI is replaced by the Alternative S-NSSAI the UE associates both of the replaced S-NSSAI and the Alternative S-NSSAI with the PDU session The UE procedure for associating applications to PDU session based on URSP described in clause 6623 of TS 23503 45 and establishing a PDU session described in clause 51553 is based on the replaced S-NSSAI not based on Alternative S-NSSAI During a new PDU Session establishment procedure for a S-NSSAI - if the UE has received together with the Allowed NSSAI a mapping of the S-NSSAI to an Alternative S-NSSAI the UE shall provide both the Alternative S-NSSAI and the S-NSSAI in the PDU Session Establishment message When the AMF receives the Alternative S-NSSAI and the S-NSSAI in the PDU Session Establishment message the AMF uses SMF Selection Subscription data of the replaced S-NSSAI and selects a suitable SMF supporting Network Slice Replacement and the Alternative S-NSSAI and verifies the Alternative S-NSSAI and the S-NSSAI based on the UE context and includes both the Alternative S-NSSAI and the S-NSSAI to the SMF in Nsmf_PDUSession_CreateSMContext service operation - if the UE has not yet received with the Allowed NSSAI a mapping of the S-NSSAI to the Alternative S-NSSAI the UE provides only the S-NSSAI in the PDU Session Establishment message If the AMF determines that the requested S-NSSAI is to be replaced with the Alternative S-NSSAI and if the UE supports Network Slice Replacement the AMF performs UE Configuration Update procedure to reconfigure the UE with the Alternative S-NSSAI The AMF continues the PDU Session establishment procedure with the Alternative S-NSSAI and uses SMF Selection Subscription data of the replaced S-NSSAI and selects a suitable SMF supporting Network Slice Replacement and the Alternative S-NSSAI The AMF provides both the Alternative S-NSSAI and the S-NSSAI to the SMF in Nsmf_PDUSession_CreateSMContext service operation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_864",
    "document_id": "23501-i80",
    "chunk_id": 864,
    "text": "The SMF proceeds with the PDU Session establishment using the Alternative S-NSSAI and the received DNN The SMF retrieves subscription data by using the replaced S-NSSAI and the DNN The SMF uses replaced S-NSSAI value when the SMF registers the PDU Session to the UDM The SMF sends the Alternative S-NSSAI to NG-RAN in N2 SM information and to UE in PDU Session Establishment Accept message NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_865",
    "document_id": "23501-i80",
    "chunk_id": 865,
    "text": "It is assumed that the operator configures their network so that the Alternative S-NSSAI is selected to ensure that the selected SMF by using the Alternative S-NSSAI supports necessary capabilities according to the replaced S-NSSAI subscription data For existing PDU Session associated with an S-NSSAI that is replaced with the Alternative S-NSSAI after the AMF sends mapping of the S-NSSAI to the Alternative S-NSSAI to the supporting UE in UE Configuration Update message the AMF sends updates to the SMF of the PDU Session eg triggering Nsmf_PDUSession_UpdateSMContext service operation that the PDU Session is to be transferred to Alternative S-NSSAI and includes the Alternative S-NSSAI as follows see details in clause 433 of TS 23502 3 - If the SMF determines that the PDU Session is to be retained eg if the anchor UPF can be reused with the alternative S-NSSAI and SSC mode 1 the SMF sends the Alternative S-NSSAI to the UPF in the N4 message to the NG-RAN in N2 message and to the supporting UE in PDU Session Modification Command message The S-NSSAI provided to the RAN and to the UPF is the Alternative S-NSSAI - If the SMF determines that the PDU Session is to be re-established the SMF sends the Alternative S-NSSAI to the supporting UE either in PDU Session Modification Command if the PDU Session is of SSC mode 3 or in PDU Session Release if the PDU Session is of SSC mode 2 or SSC mode 1 to trigger the re-establishment of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_866",
    "document_id": "23501-i80",
    "chunk_id": 866,
    "text": "The UE includes both the S-NSSAI and the Alternative S-NSSAI in the PDU Session Establishment message During registration procedure the Requested NSSAI may include Alternative S-NSSAIs that are not subscribed S-NSSAIs In addition to the behaviour described in clause 515521 the AMF verifies if S-NSSAIs in the Requested NSSAI are either subscribed S-NSSAIs or Alternative S-NSSAIs in UE context and based on the verification the AMF determines whether to update the UE configuration When the AMF is notified that the S-NSSAI is available again eg the congestion of the S-NSSAI has been mitigated if the AMF has configured the supporting UE with the Alternative S-NSSAI and the AMF determines for the UE in CM-CONNECTED state to use the replaced S-NSSAI again the AMF reconfigures the supporting UE eg by using UE Configuration Update procedure or in the next registration procedure to use the replaced S-NSSAI again by removing the mapping of the replaced S-NSSAI to Alternative S-NSSAI and removing the Alternative S-NSSAI from the Allowed NSSAI if the Alternative S-NSSAI is only used for the Network Slice Replacement The AMF also removes the Alternative S-NSSAI from the Configured NSSAI if the Alternative S-NSSAI is not one of the Subscribed S-NSSAIs and the Alternative S-NSSAI is not used in any Access Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_867",
    "document_id": "23501-i80",
    "chunk_id": 867,
    "text": "If the UE is in CM-IDLE the AMF can wait until the UE in CM-CONNECTED state as described in clause 523 When the UE establishes a NAS signalling connection eg through a Service Request procedure or through a UE registration procedure the AMF reconfigures the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_868",
    "document_id": "23501-i80",
    "chunk_id": 868,
    "text": "If there is an existing PDU Session associated with the Alternative S-NSSAI for the S-NSSAI being available again or not congested anymore the AMF updates the SMFs of the PDU Sessions by Nsmf_PDUSession_UpdateSMContext service operation causing the PDU Session to be transferred to the replaced S-NSSAI The event trigger in SMF for interacting with PCF is described in clause 6135 of TS 23503 45 - If the SMF determines that the PDU Session is to be retained eg if the anchor UPF can be reused with the replaced S-NSSAI and SSC mode 1 the SMF sends the replaced S-NSSAI ie does not include Alternative S-NSSAI to the UPF in the N4 message to the NG-RAN in N2 message and to the supporting UE in PDU Session Modification Command message The S-NSSAI provided to the RAN and to the UPF is the replaced S-NSSAI - If the SMF determines that the PDU Session is to be re-established the SMF sends the replaced S-NSSAI ie does not include Alternative S-NSSAI to the supporting UE either in PDU Session Modification Command if the PDU Session is of SSC mode 3 or in PDU Session Release if the PDU Session is of SSC mode 2 or SSC mode 1 to trigger the re-establishment of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_869",
    "document_id": "23501-i80",
    "chunk_id": 869,
    "text": "The UE includes the replaced S-NSSAI in the PDU Session Establishment message During a handover procedure if an S-NSSAI has to be replaced with an Alternative S-NSSAI the handover procedure including any PDU session associated with the S-NSSAI to be replaced shall continue unaffected by the Network Slice Replacement Any Network Slice Replacement for the S-NSSAI shall not take place during the handover During NSSAA re-authentication procedure for an S-NSSAI if the S-NSSAI has to be replaced with Alternative S-NSSAI the AMF shall continue with the NSSAA procedure unaffected by the Network Slice Replacement and the AMF executes the Network Slice Replacement after the NSSAA procedure is completed If NSAC for maximum number of PDU sessions is configured for the replaced S-NSSAI andor the Alternative S-NSSAI the SMF performs NSAC by interacting with the NSACF of the replaced S-NSSAI andor the NSACF of the Alternative S-NSSAI based on operator determined policies configured in the SMF eg for the increase of Alternative S-NSSAI and the decrease of replaced S-NSSAI 51520 Support of",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_870",
    "document_id": "23501-i80",
    "chunk_id": 870,
    "text": "Network Slice Instance Replacement The Network Slice Instance Replacement is used when a PDU Session for a given S-NSSAI is established using a selected Network Slice instance and the S-NSSAI corresponding to this Network Slice instance is associated with multiple Network Slice instances In this case the network may change the Network Slice instance for the S-NSSAI if the selected Network Slice instance is no longer available eg due to overload The AMF may subscribe with the NSSF for notifications when any of the Network Slice instances served by the AMF is congested or no longer available In case of roaming the NSSF of VPLMN subscribes with the NSSF of the HPLMN for notifications When the NSSF notifies the AMF that a Network Slice instance is congested or no longer available for some of PDU Sessions associated with the Network Slice instance that is no longer available the AMF may delete old NSI ID corresponding to the Network Slice instance that is no longer available and the SMF of the PDU Sessions selected by using such old NSI ID is informed by the AMF to release the PDU Sessions Subsequently the SMF triggers the impacted UEs to establish new PDU sessions associated with the same S-NSSAI as described in clause 5692 for PDU Sessions of SSC Mode 2 and SSC Mode 3 The AMF selects a new Network Slice instance for the given S-NSSAI during PDU Session Establishment 516 Support for specific services 5161 Public Warning System",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_871",
    "document_id": "23501-i80",
    "chunk_id": 871,
    "text": "The functional description for supporting Public Warning System for 5G System can be found in TS 23041 46 5162 SMS over NAS 51621 General This clause includes feature description for supporting SMS over NAS in 5G System Support for SMS incurs the following functionality - Support for SMS over NAS transport between UE and AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_872",
    "document_id": "23501-i80",
    "chunk_id": 872,
    "text": "This applies to both 3GPP and Non 3GPP accesses - Support for AMF determining the SMSF for a given UE - Support for subscription checking and actual transmission of MOMT-SMS transfer by the SMSF - Support for MOMT-SMS transmission for both roaming and non-roaming scenarios - Support for selecting proper domains for MT SMS message delivery including initial delivery and re-attempting in other domains 51622 SMS over NAS transport 5G System supports SMS over NAS via both 3GPP access and non-3GPP access During Registration procedure a UE that wants to use SMS provides an SMS supported indication over NAS signalling indicating the UEs capability for SMS over NAS transport SMS supported indication indicates whether UE can support SMS delivery over NAS If the core network supports SMS functionality the AMF includes SMS allowed indication to the UE and whether SMS delivery over NAS is accepted by the network SMS is transported via NAS transport message which can carry SMS messages as payload 5163 IMS support 51631 General IP-Connectivity Access Network specific concepts when using 5GS to access IMS can be found in TS 23228 15 5GS supports IMS with the following functionality - Indication toward the UE if IMS voice over PS session is supported - Capability to transport the P-CSCF addresses to UE - Paging Policy Differentiation for IMS as defined in TS 23228 15 - IMS emergency service as defined in TS 23167 18 - Domain selection for UE originating sessions - Terminating domain selection for IMS voice - Support of P-CSCF restoration procedure clause 51639 - NRF based P-CSCF discovery clause 516311 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_873",
    "document_id": "23501-i80",
    "chunk_id": 873,
    "text": "The NRF based P-CSCF discovery has no impact on the UE ie the UE does not need to know how P-CSCF IP addresses is discovered in the network - NRF based HSS discovery clause 516312 51632 IMS voice over PS Session Supported Indication over 3GPP access The serving PLMN AMF shall send an indication toward the UE during the Registration procedure over 3GPP access to indicate if an IMS voice over PS session is supported or not supported in 3GPP access and non-3GPP access A UE with IMS voice over PS voice capability over 3GPP access should take this indication into account when performing voice domain selection as described in clause 51635",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_874",
    "document_id": "23501-i80",
    "chunk_id": 874,
    "text": "The serving PLMN AMF may only indicate IMS voice over PS session supported over 3GPP access in one of the following cases - If the network and the UE are able to support IMS voice over PS session in the current Registration Area with a 5G QoS Flow that supports voice as specified in clause 57 - If the network or the UE are not able to support IMS voice over PS session over NR connected to 5GC but is able for one of the following - If the network and the UE are able to support IMS voice over PS session over E-UTRA connected to 5GC and the NG-RAN supports a handover or redirection to E-UTRA connected to 5GC for this UE at QoS Flow establishment for IMS voice - If the UE supports handover to EPS the EPS supports IMS voice and the NG-RAN supports a handover to EPS for this UE at QoS Flow establishment for IMS voice or - If the UE supports redirection to EPS the EPS supports IMS voice and the NG-RAN supports redirection to EPS for this UE at QoS Flow establishment for IMS voice - If the network is not able to provide a successful IMS voice over PS session over E-UTRA connected to 5GC but is able for one of the following - If the UE supports handover to EPS the EPS supports IMS voice and the NG-RAN supports a handover to EPS for this UE at QoS Flow establishment for IMS voice or - If the UE supports redirection to EPS the EPS supports IMS voice and the NG-RAN supports redirection to EPS for this UE at QoS Flow establishment for IMS voice",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_875",
    "document_id": "23501-i80",
    "chunk_id": 875,
    "text": "The serving PLMN provides this indication based eg on local policy UE capabilities HPLMN whether IP address preservation is possible whether NG-RAN to UTRAN SRVCC is supported and how extended NG-RAN coverage is and the Voice Support Match Indicator from the NG-RAN see clause 428a of TS 23502 3 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_876",
    "document_id": "23501-i80",
    "chunk_id": 876,
    "text": "The terms UE supports handover to EPS or UE supports redirection to EPS used above also consider the case that the UE has signalled that S1 mode is enabled In case the UE has signalled that S1 mode is disabled for a network that only supports IMS voice via EPS Fallback the AMF will not indicate that IMS voice over PS session is supported over 3GPP access A voice centric UE ensures its voice service as described in clauses 51635 and 51636 The AMF in serving PLMN shall indicate that IMS voice over PS is supported only if the serving PLMN has a roaming agreement that covers support of IMS voice with the HPLMN This indication is per Registration Area NOTE 2 If the network supports EPS fallback for voice the 5GC can be configured not to perform the Voice Support Match Indicator procedure in order to set the IMS voice over PS session Supported Indication",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_877",
    "document_id": "23501-i80",
    "chunk_id": 877,
    "text": "The serving SNPN provides the IMS voice over PS indication based eg on local policy UE capabilities whether IP address preservation is possible and how extended NR coverage is This indication is per Registration Area NOTE 3 Since over 3GPP access in SNPN access mode there is only support for NR and the voice centric UE cannot reselect to another RAT in the same registered SNPN if the first Registration Area that the UE tries to register from cannot support IMS voice it is recommended that support for IMS voice is provided homogeneously in the whole SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_878",
    "document_id": "23501-i80",
    "chunk_id": 878,
    "text": "if at all 51632a IMS voice over PS Session Supported Indication over non-3GPP access The serving PLMN AMF shall send an indication toward the UE during the Registration procedure over non-3GPP access to indicate whether an IMS voice over PS session is supported or not supported via non-3GPP access A UE with IMS voice over PS voice capability over non-3GPP access should take this indication received in the Registration procedure performed over either 3GPP access or Non-3GPP access into account when performing the selection between N3IWFTNGF and ePDG described in clause 636",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_879",
    "document_id": "23501-i80",
    "chunk_id": 879,
    "text": "The serving PLMN AMF may only indicate IMS voice over PS session supported over non-3GPP access if the network is able to provide a successful IMS voice over PS session over N3IWFTNGF connected to 5GC with a 5G QoS Flow that supports voice as specified in clause 57 51633 Homogeneous support for IMS voice over PS Session supported indication 5GC shall support the usage of Homogeneous Support of IMS Voice over PS Sessions indication between AMF and UDM When the AMF initiates Nudm_UECM_Registration operation to the UDM it shall - if IMS Voice over PS Sessions is supported homogeneously in all TAs in the serving AMF for the UE include the Homogeneous Support of IMS Voice over PS Sessions indication set to Supported - if none of the TAs of the serving AMF supports IMS Voice over PS Sessions for the UE include the Homogeneous Support of IMS Voice over PS Sessions indication set to Not supported - if IMS Voice over PS Sessions support is either non-homogeneous or unknown not include the Homogeneous Support of IMS Voice over PS Sessions indication The AMF shall be able to provide the Homogeneous Support of IMS Voice over PS Sessions indication as described above to the UDM using Nudm_UECM_Update operation as specified in clause 42222 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_880",
    "document_id": "23501-i80",
    "chunk_id": 880,
    "text": "The UDM shall take this indication into account when doing Terminating Access Domain Selection T-ADS procedure for IMS voice NOTE A TA supports IMS Voice over PS Sessions if the serving AMF indicates IMS voice over PS Session Supported Indication over 3GPP access to the UE as described in clause 51632 In order to support routing of incoming IMS voice calls to the correct domain the network-based T-ADS see TS 23292 63 and TS 23221 23 requires that the Homogeneous Support of IMS Voice over PS Sessions indication is set to Supported for all registered TAs of the UE or Not supported for all registered TAs of the UE 51634 P-CSCF address delivery At PDU Session Establishment procedure related to IMS SMF shall support the capability to send the P-CSCF addresses to UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_881",
    "document_id": "23501-i80",
    "chunk_id": 881,
    "text": "The SMF is located in VPLMN if LBO is used This is sent by visited SMF if LBO is used For Home routed this information is sent by the SMF in HPLMN P-CSCF addresses shall be sent transparently through AMF and in the case of Home Routed also through the SMF in VPLMN The P-CSCF IP addresses may be locally configured in the SMF or discovered using NRF as described in clause 516311 NOTE 1 Other options to provide P-CSCF to the UE as defined in TS 23228 15 is not excluded NOTE 2 PDU Session for IMS is identified by APN or DNN In the case of SNPN access the SMF is always located in the serving SNPN no support for Home Routed traffic therefore the serving SMF sends the P-CSCF addresses to the UE 51635 Domain selection for UE originating sessions calls For UE originating calls the 5GC capable UE performs access domain selection The UE shall be able to take following factors into account for access domain selection decision - The state of the UE in the IMS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_882",
    "document_id": "23501-i80",
    "chunk_id": 882,
    "text": "The state information shall include Registered Unregistered - The IMS voice over PS session supported indication as defined in clause 51632 - Whether the UE is expected to behave in a voice centric or data centric way for 5GS - UE capability of supporting IMS PS voice - UE capability for operating in dual-registration mode with selective PDU Session transfer as defined in clause 517233 - Whether 3GPP PS Data Off is active or not and whether IMS voice is included in 3GPP PS Data Off Exempt Services or not as defined in clause 524 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_883",
    "document_id": "23501-i80",
    "chunk_id": 883,
    "text": "In this release of the specification the exact logic of which PDU sessions are kept in which system for Dual Registration UE with selective transfer of certain PDU Sessions as defined in clause 517233 is left up to UE implementation The voice centric UE will keep the PDU Session used for IMS services to a system that supports voice over IMS The voice centric UE can re-register with the IMS if needed when the IMS PDU session is transferred between 5GS and EPS To allow for appropriate domain selection for originating voice calls the UE shall attempt Initial Registration in 5GC If the UE fails to use IMS for voice eg due to IMS voice over PS session supported indication indicates voice is not supported in 5G System the UE behaves as described below for voice centric for 5GS or data centric for 5GS - A UE set to voice centric for 5GS shall always try to ensure that Voice service is possible A voice centric 5GC capable and EPC capable UE unable to obtain voice service in 5GS shall not select a cell connected only to 5GC By disabling capabilities to access 5GS the UE re-selects to E-UTRAN connected to EPC first if available When the UE selects E-UTRAN connected to EPC the UE performs Voice Domain Selection procedures as defined in TS 23221 23 - A UE set to data centric for 5GS does not need to perform any reselection if voice services cannot be obtained NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_884",
    "document_id": "23501-i80",
    "chunk_id": 884,
    "text": "The related radio capabilities in order for the voice centric UE to not reselect to NR or E-UTRA cell connected to 5GC ie avoid ping pong will be defined by RAN WGs 51636 Terminating domain selection for IMS voice When requested by IMS the UDMHSS shall be able to query the serving AMF for T-ADS related information T-ADS is a functionality located in the IMS and is performed as specified in TS 23221 23",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_885",
    "document_id": "23501-i80",
    "chunk_id": 885,
    "text": "The AMF shall respond to the query with the following information unless the UE is detached - whether or not IMS voice over PS Session is supported in the registration area s where the UE is currently registered - whether or not IMS voice over PS Session Supported Indication over non-3GPP access is supported in the WLAN where the UE is currently registered - the time of the last radio contact with the UE and - the current Access Type and RAT type 51637 UEs usage setting If the UE is configured to support IMS voice the UE shall include the information element UEs usage setting in Registration Request messages The UEs usage setting indicates whether the UE behaves in a voice centric or data centric way as defined in clause 51635 A UE supporting IMS voice over 3GPP access connected to 5GC and that is EPS capable shall also support IMS voice over E-UTRA connected to EPC NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_886",
    "document_id": "23501-i80",
    "chunk_id": 886,
    "text": "Depending on operators configuration the UEs usage setting can be used by the network to choose the RFSP Index in use see clause 5343 As an example this enables the enforcement of selective idle mode camping over E-UTRA for voice centric UEs 51638 Domain and Access Selection for UE originating SMS 516381 UE originating SMS for IMS Capable UEs supporting SMS over IP To allow for appropriate domain selection for SMS delivery it should be possible to provision UEs with the following HPLMN operator preferences on how an IMS enabled UE is supposed to handle SMS services - SMS is not to be invoked over IP networks the UE does not attempt to deliver SMS over IP networks The UE attempts to deliver SMS over NAS signalling - SMS is preferred to be invoked over IP networks the UE attempts to deliver SMS over IP networks If delivery of SMS over IP networks is not available the UE attempts to deliver SMS over NAS signalling 516382 Access Selection for SMS over NAS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_887",
    "document_id": "23501-i80",
    "chunk_id": 887,
    "text": "It should be possible to provision UEs with the HPLMN SMS over NAS operator preferences on access selection for delivering SMS over NAS signalling Based on the SMS over NAS preference - SMS is preferred to be invoked over 3GPP access for NAS transport the UE attempts to deliver MO SMS over NAS via 3GPP access if the UE is both registered in 3GPP access and non-3GPP access - SMS is preferred to be invoked over non-3GPP access for NAS transport the UE attempts to deliver MO SMS over NAS via non-3GPP access if the UE is both registered in 3GPP access and non-3GPP access",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_888",
    "document_id": "23501-i80",
    "chunk_id": 888,
    "text": "If delivery of SMS over NAS via non-3GPP access is not available the UE attempts to deliver SMS over NAS via 3GPP access 51639 SMF support for P-CSCF restoration procedure For the support of P-CSCF restoration the SMF behaves as described in TS 23380 61 516310 IMS Voice Service via EPS Fallback or RAT fallback in 5GS In order to support various deployment scenarios for obtaining IMS voice service the UE and NG-RAN may support the mechanism to direct or redirect the UE from NG-RAN either towards E-UTRA connected to 5GC RAT fallback or towards EPS E-UTRAN connected to EPC System fallback Following principles apply for IMS Voice Service -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_889",
    "document_id": "23501-i80",
    "chunk_id": 889,
    "text": "The serving AMF indicates toward the UE during the Registration procedure that IMS voice over PS session is supported - If a request for establishing the QoS Flow for IMS voice reaches the NG-RAN the NG-RAN responds indicating rejection of the establishment request and the NG-RAN may trigger one of the following procedures depending on UE capabilities N26 availability network configuration and radio conditions - Redirection to EPS - Handover procedure to EPS - Redirection to E-UTRA connected to 5GC or - Handover to E-UTRA connected to 5GC - If needed Network Provided Location Information is provided as described in clauses 41361 and 41362 of TS 23502 3 - The ongoing IMS voice session is not impacted by a change of the IMS voice over PS session indicator from supported to unsupported eg the UE receives during RAT Fallback or EPS Fallback the IMS voice over PS session indicator indicating that IMS voice over PS sessions are not supported NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_890",
    "document_id": "23501-i80",
    "chunk_id": 890,
    "text": "Any change in IMS voice over PS session indicator applies to new IMS sessions initiated only after the ongoing IMS voice session is terminated During any release of RRC connection including after EPSRAT fallback is performed the eNB or NG-RAN node may provide to the UE dedicated idle mode priorities for NR as defined in TS 36331 51 taking into account RFSP PLMNs contained in Handover Restriction List and local operator policy If the UE remains ECMCM-CONNECTED after the voice call has ended the eNB or NG-RAN node may trigger handover to NR connected to 5GC if configured to do so taking into account local operator policy and Handover Restriction List 516311 P-CSCF discovery and selection P-CSCF selection functionality may be used by the SMF to select the P-CSCF for an IMS PDU Session of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_891",
    "document_id": "23501-i80",
    "chunk_id": 891,
    "text": "The SMF can utilize the Network Repository Function to discover the P-CSCF instances The NRF provides the IP address or the FQDN of P-CSCF instances to the SMF The P-CSCF selection function in the SMF selects the P-CSCF instances based on the available P-CSCF instances obtained from NRF or based on the configured P-CSCF information in the SMF If the SMF receives FQDNs from the NRF or is configured with FQDNs the SMF shall resolve these to IP addresses for sending to the UE in the PDU session response The following factors may be considered during the P-CSCF discovery and selection - S-NSSAI of the PDU Session - UE location information - Local operator policies - Availability of candidate P-CSCFs - UE IP address - Access Type - Proximity to location of selected UPF - Selected Data Network Name DNN 516312 HSS discovery and selection HSS discovery and selection functionality is used by the I-CSCFS-CSCFIMS-AS to select an HSS that manages the users IMS subscriptions and has the ability to serve the IMS services for the UE see clause AA33 of TS 23228 15 and clause 631 for details 5164 Emergency Services 51641 Introduction Emergency Services are provided to support IMS emergency sessions Emergency Services refers to functionalities provided by the serving network when the network is configured to support Emergency Services Emergency Services are provided to normally registered UEs and to Emergency Registered UEs that can be either normally registered or in limited service state Depending on local regulation receiving Emergency Services in limited service state does not require a valid subscription Depending on local regulation and on operators policy the network may allow or reject a registration request for Emergency Services ie Emergency Registration from UEs that have been identified to be in limited service state Four different behaviours of Emergency Services as defined in clause 43121 of TS 23401 26 are supported Emergency Services shall not be provided to a UE over 3GPP access and non-3GPP access concurrently Transfer from one Access Type to the other takes place as follows - a UE may be Emergency or normally Registered and have an emergency PDU session over non-3GPP access or may be attached with an emergency session to ePDG over untrusted WLAN as defined in TS 23402 43 when 3GPP access becomes available In which case the UE may have to register over 3GPP access and check first the support for Emergency Services over the 3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_892",
    "document_id": "23501-i80",
    "chunk_id": 892,
    "text": "RAT it has selected eg based on Emergency Services Support indication Emergency Services Fallback AS broadcast indicator If there is native support for Emergency Services in the selected 3GPP RAT the UE will attempt to transfer the emergency PDU session from non-3GPP access to 3GPP access see clause 492 or clause 493 of TS 23502 3 If there is no native support for Emergency Services in the selected RAT but Emergency Services Fallback to another RAT in 5GS or to another System where Emergency Services is supported based on the conditions defined in clause 516411 the UE may trigger first Emergency Services Fallback see clause 41342 of TS 23502 3 and then attempt to transfer the emergency PDU session from non-3GPP access to 3GPP access see clause 492 of TS 23502 3 During the session transfer the UE may be registered to receive emergency services over both 3GPP access and non-3GPP access concurrently NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_893",
    "document_id": "23501-i80",
    "chunk_id": 893,
    "text": "The conditions upon which the UE determines that 3GPP access becomes available are implementation dependent A UE may only attempt to use Emergency Services over non-3GPP access if it is unable to use Emergency Services over 3GPP access as specified in TS 23167 18 The UE is only allowed to have one PDU session for Emergency services at a time A PDU Session cannot be changed between a PDU Session for Non-Emergency services and a PDU Session for Emergency services PDU session for emergency services can be transferred from one Access Type to another as specified in clause 51649 To provide Emergency Services the AMF is configured with Emergency Configuration Data that are applied to Emergency Services that are established by an AMF based on request from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_894",
    "document_id": "23501-i80",
    "chunk_id": 894,
    "text": "The AMF Emergency Configuration Data contains the S-NSSAI and Emergency DNN which is used to derive an SMF In addition the AMF Emergency Configuration Data contains UE-AMBR and may also contain the statically configured SMF for the Emergency DNN The SMF may also store Emergency Configuration Data that contains statically configured UPF information for the Emergency DNN NOTE 2 The Network slices associated with emergency services are assumed to be configured consistently in the AMF ie emergency configuration data and NG-RAN nodes within the corresponding Registration Area where emergency services are to be supported When the UE is camped normally in the cell ie not in limited service state during Registration procedure described in clause 4222 of TS 23502 3 the serving AMF includes an indication for Emergency Services Support within the Registration Accept to the UE For 3GPP access the Emergency Services Support indication is valid within the current Registration Area per RAT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_895",
    "document_id": "23501-i80",
    "chunk_id": 895,
    "text": "ie this is to cover cases when the same registration area supports multiple RATs and they have different capability The Emergency Services Support is configured in the AMF according to local regulations and network capabilities AMF includes Emergency Services Support indicator in the Registration Accept message to indicate that the UE can setup emergency PDU Session to obtain emergency services The AMF may include additional local emergency numbers associated with the serving network for the UE further defined in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_896",
    "document_id": "23501-i80",
    "chunk_id": 896,
    "text": "During Registration procedures over 3GPP access in a PLMN the 5GC includes the Emergency Services Support indicator valid for the current Registration Area and indicating per RAT that Emergency Services are supported if any of the following conditions is true within the current Registration Area - the Network is able to support Emergency Services natively over 5GS - E-UTRA connected to 5GC supports IMS Emergency Services eg voice and the NG-RAN is able to trigger handover or redirection from NR to E-UTRA connected to 5GC at QoS Flow establishment for IMS Emergency Services eg voice - NG-RAN is able to trigger handover to EPS at QoS Flow establishment for IMS Emergency Services eg voice - NG-RAN is able to trigger redirection to EPS at QoS Flow establishment for IMS Emergency Services eg voice or - NG-RAN is able to trigger 5G SRVCC handover to UTRAN for IMS Emergency Services ie voice During Registration procedures over non-3GPP access the 5GC indicates that Emergency Services are supported if the Network is able to support Emergency Services natively over 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_897",
    "document_id": "23501-i80",
    "chunk_id": 897,
    "text": "In the case of SNPN during Registration procedures over 3GPP access the 5GC includes the Emergency Services Support indicator valid for the current Registration Area indicating that Emergency Services are supported if the following condition is true within the current Registration Area - the Network is able to support Emergency Services natively over 5GS The 5GC includes an indication per RAT whether it supports Emergency Services Fallback as defined in clause 516411 to another RAT in 5GS or to another System where Emergency Services are supported natively The Emergency Services Fallback support indicator is valid within the current Registration Area per RAT NOTE 3 If a certain RAT is restricted for Emergency Services the restriction of the corresponding RAT for Emergency Services Support is configured in the RAN Node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_898",
    "document_id": "23501-i80",
    "chunk_id": 898,
    "text": "This helps the RAN node to determine whether to set up Dual Connectivity for Emergency Services UEs that are in limited service state as specified in TS 23122 17 or that camp normally on a cell but failed to register successfully to the network under conditions specified in TS 24501 47 initiate the Registration procedure by indicating that the registration is to receive Emergency Services referred to as Emergency Registration and a Follow-on request is included in the Registration Request to initiate PDU Session Establishment procedure with a Request Type indicating Emergency Request UEs that had registered for normal services and do not have emergency PDU Session established and that are subject to Mobility Restriction in the present area or RAT eg because of restricted tracking area shall initiate the UE Requested PDU Session Establishment procedure to receive Emergency Services ie with a Request Type indicating Emergency Request Based on local regulation the network supporting Emergency Services for UEs in limited service state provides Emergency Services to these UE regardless whether the UE can be authenticated has roaming or Mobility Restrictions or a valid subscription For Emergency Services over 3GPP access via PLMN other than eCall over IMS the UEs in limited service state that do not operate in SNPN access mode determine that the cell supports Emergency Services over NG-RAN from a broadcast indicator in AS The cell connected to EPC and 5GC broadcasts separate broadcast indicator for EPC and 5GC to indicate support of emergency services by the EPC and 5GC If the UE supports SNPN access mode is in limited service state is not operating in SNPN access mode needs to make an emergency call and cannot find an acceptable cell in any PLMN the UE may activate SNPN access mode and attempt to camp on an acceptable cell of any available SNPN supporting emergency calls irrespective of SNPN ID or GIN as defined in TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_899",
    "document_id": "23501-i80",
    "chunk_id": 899,
    "text": "For Emergency Services over untrusted non-3GPP access other than eCall over IMS the UE in limited service state selects any N3IWF as specified in clause 636 Emergency calls for eCall Over IMS may only be performed if the UE has a USIM For Emergency Services over NR via SNPN other than eCall over IMS the UEs in limited service state that operate in SNPN access mode determine that the cell supports Emergency Services over NR from a broadcast indicator in AS and indication that the SNPN supports Emergency Services If the UE operates in SNPN access mode and is in limited service state the UE shall attempt to camp on an acceptable cell of any available SNPN supporting emergency calls irrespective of SNPN ID or GIN If the UE cannot find acceptable cell on any available SNPN the UE shall deactivate SNPN access mode and camp on any available PLMN cell supporting emergency calls irrespective of PLMN ID as defined in TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_900",
    "document_id": "23501-i80",
    "chunk_id": 900,
    "text": "For NR satellite access if a UE in limited service state is aware of its location the UE selects a PLMN that is allowed to operate in the UE location as specified in TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_901",
    "document_id": "23501-i80",
    "chunk_id": 901,
    "text": "The network may be configured to verify the location of a UE that is registering for emergency services as specified in clause 54114 There is no support for eCall over IMS for SNPNs in this Release A serving network shall provide an Access Stratum broadcast indication from NG-RAN NR or E-UTRA connected to 5GC to UEs indicating whether eCall Over IMS is supported - When an E-UTRA cell is connected to EPC and 5GC the cell broadcasts separate Access stratum broadcast indication for 5GC and EPC to indicate support of eCall over IMS by 5GC and EPC - A UE that is not in limited service state determines that the NG-RAN cell supports eCall Over IMS via 5GC using the broadcast indicator for eCall over IMS Emergency calls for eCall over IMS are not supported over non-3GPP access NOTE 4 The Access Stratum broadcast indicator is determined according to operator policies and minimally indicates that the PLMN or all of the PLMNs in the case of network sharing and at least one emergency centre or PSAP to which an eCall Over IMS can be routed support eCall Over IMS - A UE in limited service state determines that the cell supports eCall Over IMS using both the broadcast indicator for support of Emergency Services over NG-RAN and the broadcast indicator of NG-RAN for eCall over IMS Emergency calls for eCall Over IMS are not supported over Non-3GPP access and NR via SNPN NOTE 5 The broadcast indicator for eCall Over IMS does not indicate whether UEs in limited service state are supported So the broadcast indicator for support of Emergency Services over NG-RAN that indicates limited service state support needs to be applied in addition For a UE that is Emergency Registered if it is unauthenticated the security context is not set up on UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_902",
    "document_id": "23501-i80",
    "chunk_id": 902,
    "text": "In order to receive Emergency Services UEs that camp on a suitable cell in RM-DEREGISTERED state ie without any conditions that result in limited service state or that decide to access 5GC via non-3GPP access and not in limited service state over non-3GPP access initiate the Initial Registration procedure for normal service instead of Emergency Registration Upon successful registration such UEs shall initiate the UE Requested PDU Session Establishment procedure with a Request Type indicating Emergency Request to receive Emergency Services if the AMF indicated support for Emergency Services in 5GC for the RAT the UE is currently camped on when UE is camping on 3GPP access The UEs that camp normally on a cell or that are connected via Non-3GPP access are informed that the PLMN supports Emergency Services over 5G-AN from the Emergency Services Support indicator in the Registration procedure This applies to both 3GPP and non-3GPP Access Types There is no support for Emergency Services for SNPN that is accessed via NWu from a PLMN NOTE 6 The Emergency Services Support indicator in the Registration procedures does not indicate support for eCall Over IMS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_903",
    "document_id": "23501-i80",
    "chunk_id": 903,
    "text": "For a UE that is Emergency Registered normal PLMN or SNPN selection principles apply after the end of the IMS emergency session NOTE 7 For Emergency Services there is no support for inter PLMN mobility thus there is a risk of service disruption due to failed inter PLMN mobility attempts when there is no session continuity eg change of anchor SMFUPF due to mobility for the PDU Session andor based on operator policies NOTE 8 Based on operator policies Inter PLMN mobility with session continuity can be supported for Emergency Services if the anchor SMFUPF for PDU Session supporting Emergency Services does not change The UE shall set the RRC establishment cause to emergency as defined in TS 38331 28 when it requests an RRC Connection in relation to an emergency session In the case of Limited Service state UE shall not include any Network Slice related parameters when communicating with the network When a PLMN or SNPN supports IMS and Emergency Services - all AMFs in that PLMN or SNPN shall have the capability to support Emergency Services - at least one SMF shall have this capability For other emergency scenarios eg UE autonomous selection for initiating Emergency Services refer to TS 23167 18 for domain selection principles For emergency service support in Public network integrated NPNs refer to clause 53035 For emergency support via 5G ProSe UE-to-Network Relaying refer to TS 23304 128 51642 Architecture Reference Model for Emergency Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_904",
    "document_id": "23501-i80",
    "chunk_id": 904,
    "text": "According to clause 42 the non-roaming architectures Figure 423-1 and Figure 423-2 and roaming architecture with the visited operators application function Figure 424-1 and Figure 424-4 apply for Emergency Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_905",
    "document_id": "23501-i80",
    "chunk_id": 905,
    "text": "The other non-roaming and roaming architectures with services provided by the home network do not apply for Emergency Services 51643 Mobility Restrictions and Access Restrictions for Emergency Services When Emergency Services are supported and local regulation requires IMS Emergency Sessions to be provided regardless of Mobility Restrictions or Access Restrictions the Mobility Restrictions or Access Restrictions see clause 5341 should not be applied to UEs receiving Emergency Services Additionally due to Mobility Restrictions or Access Restrictions eg CAG restrictions for normally registered UEs that have established both non-emergency PDU Sessions and emergency PDU Session the AMF indicates to the SMF to perform a local release of all non-emergency PDU Sessions via PDU Session Release procedure as specified in clause 434 of TS 23502 3 The UE locally releases non-emergency PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_906",
    "document_id": "23501-i80",
    "chunk_id": 906,
    "text": "The AMF and the UE behave as if the UE is emergency registered as described in TS 24501 47 When the RAN resources for Emergency Services are established the ARP value for Emergency Services indicates the usage for Emergency Services to the 5G-AN During handover the source NG-RAN and source AMF ignore any UE related restrictions during handover evaluation when there is an active PDU Session associated with emergency service During Mobility Registration Update procedures including a Mobility Registration Update as part of a handover the target AMF ignores any Mobility Restrictions or access restrictions for UE with emergency services where required by local regulation Any non-emergency services are not allowed by the target network when not allowed by the subscription for the target location To allow the UE in limited service state either Emergency Registered or registered for normal service over a given Access Type to get access to normal services over this Access Type after the Emergency Session has ended and when it has moved to a new area that is not stored by the UE as a forbidden area after allowing a period of time for subsequent Emergency Services the UE may explicitly deregister and register for normal services over this Access Type without waiting for the emergency PDU Session Release by the SMF This functionality applies to all mobility procedures 51644 Reachability Management Over 3GPP access an Emergency Registered UE when its Periodic Registration Update timer expires shall not initiate a Periodic Registration Update procedure but shall enter the RM-DEREGISTERED state For such UEs the AMF runs a mobile reachable timer with a similar value to the UEs Periodic Registration Update timer After expiry of this timer the AMF may change the UE RM state for 3GPP Access in the AMF to RM-DEREGISTERED",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_907",
    "document_id": "23501-i80",
    "chunk_id": 907,
    "text": "The AMF assigns the Periodic Registration Update timer value to Emergency Registered UEs This timer keeps the Emergency Registered UE registered for Emergency Services after change to CM-IDLE state to allow for a subsequent Emergency Service without a need for a new Emergency Registration Over non-3GPP access an Emergency Registered UE is only reachable in CM-CONNECTED state since the UE may only use Emergency Services over Non-3GPP access when it is not possible over 3GPP access 3GPP access is assumed to be unavailable for paging the UE 51645 SMF and UPF selection function for Emergency Services When a SMF is selected for Emergency Services the SMF selection function described in clause 632 for normal services is applied to the Emergency DNN or the AMF selects the SMF directly from the AMF Emergency Configuration Data If the SMF selection function described in clause 632 is used it shall always derive a SMF in the Serving PLMN or SNPN which guarantees that the IP address is also allocated by the Serving PLMN or SNPN When a UPF is selected for Emergency Services the UPF selection function described in clause 633 for normal services is applied to the Emergency DNN or the SMF selects the UPF directly from the SMF Emergency Configuration Data",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_908",
    "document_id": "23501-i80",
    "chunk_id": 908,
    "text": "The information in the AMF Emergency Configuration Data and the SMF Emergency Configuration Data is specified in clause 51641 51646 QoS for Emergency Services Local regulation may require supporting emergency calls from an unauthorised UE In such a case the SMF may not have subscription data Additionally the local network may want to provide Emergency Services support differently than what is allowed by a UE subscription Therefore the initial QoS parameters used for establishing Emergency Services are configured in the V-SMF local network in the SMF Emergency Configuration Data",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_909",
    "document_id": "23501-i80",
    "chunk_id": 909,
    "text": "This functionality is used by the UE Requested PDU Session Establishment procedure when establishing Emergency Services 51647 PCC for Emergency Services Dynamic PCC is used for UEs establishing emergency service and shall be used to manage IMS emergency sessions when an operator allows IMS emergency sessions When establishing Emergency Services with a SMF the PCF provides the SMF with the QoS parameters including an ARP value reserved for the Emergency Services to prioritize the QoS Flows when performing admission control as defined in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_910",
    "document_id": "23501-i80",
    "chunk_id": 910,
    "text": "The PCF rejects an IMS session established via the emergency PDU Session if the AF ie P-CSCF does not provide an emergency indication to the PCF 51648 IP Address Allocation Emergency service is provided by the serving PLMN or SNPN The UE and serving PLMN or SNPN must have compatible IP address versions in order for the UE to obtain a local emergency PDU Session 51649 Handling of PDU Sessions for Emergency Services The QoS Flows of a PDU Session associated with the emergency DNN shall be dedicated for IMS emergency sessions and shall not allow any other type of traffic The emergency contexts shall not be changed to non-emergency contexts and vice versa The UPF shall block any traffic that is not from or to addresses of network functions eg P-CSCF providing Emergency Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_911",
    "document_id": "23501-i80",
    "chunk_id": 911,
    "text": "If there is already an emergency PDU Session over a given Access Type 3GPP access or non-3GPP access the UE shall not request another emergency PDU Session over any Access Type except for handing over the existing emergency PDU Session to the other Access Type If the SMF receives a new emergency PDU session establishment request and an emergency PDU Session exists for the same UE over any Access Type the SMF shall remove the existing SM context locally and clear the associated resources in the network and proceed with the new request NOTE If the UE releases emergency PDU session locally and requests for establishment of a new one before the SMF has released the emergency PDU session due to PDU session inactivity as specified in clause 4342 of TS 23502 3 the above duplicate emergency PDU session handling in the network removes the old emergency PDU session as part of establishing a new one This releases all emergency call back resources related with the old emergency PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_912",
    "document_id": "23501-i80",
    "chunk_id": 912,
    "text": "The ARP reserved for emergency service shall only be assigned to QoS Flows associated with an emergency PDU Session If the UE is Emergency Registered over a given access it shall not request a PDU Session to any other DNN over this access 51649a Handling of PDU Sessions for normal services for Emergency Registered UEs For an Emergency Registered UE over a given Access Type - the UE shall not initiate the UE Requested PDU Session Establishment procedure for normal service over this Access Type and - the network shall reject any PDU Session Establishment request for normal service from the UE on this Access Type - the UE may attempt to receive normal service over another Access Type if not otherwise prevented by the present document 516410 Support of eCall Only Mode For service requirements for eCall only mode refer to TS 22101 33",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_913",
    "document_id": "23501-i80",
    "chunk_id": 913,
    "text": "A UE configured for eCall Only Mode shall remain in RM-DEREGISTERED state shall camp on a network cell when available but shall refrain from any Registration Management Connection Management or other signalling with the network The UE may instigate Registration Management and Connection Management procedures in order to establish maintain and release an eCall Over IMS session or a session to any non-emergency MSISDNs or URIs configured in the USIM for test andor terminal reconfiguration services Following the release of either session and after the UE has left RRC_CONNECTED state the UE starts a timer whose value depends on the type of session ie whether eCall or a session to a non-emergency MSISDN or URI for testreconfiguration While the timer is running the UE shall perform normal RMCM procedures and is permitted to respond to paging to accept and establish an incoming session eg from an emergency centre PSAP or HPLMN operator When the timer expires once the UE is not in RRC_CONNECTED state the UE shall perform a UE-initiated Deregistration procedure if still registered and enter RM-DEREGISTERED state NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_914",
    "document_id": "23501-i80",
    "chunk_id": 914,
    "text": "An HPLMN operator can change the eCall Only Mode configuration state of a UE in the USIM An HPLMN operator can also instead add modify or remove a non-emergency MSISDN or URI in the USIM for test andor terminal reconfiguration services This can occur following a UE call to a non-emergency MSISDN or URI configured for reconfiguration When the eCall Only Mode configuration is removed the UE operates as a normal UE that can support eCall over IMS NOTE 2 A test call and a reconfiguration call can be seen as normal non-emergency call by a serving PLMN and normal charging rules can apply depending on operator policy NOTE 3 An MSISDN configured in the USIM for test andor terminal reconfiguration services for eCall Over IMS can differ from an MSISDN configured in the USIM for test services for eCall over the CS domain 516411 Emergency Services Fallback",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_915",
    "document_id": "23501-i80",
    "chunk_id": 915,
    "text": "In order to support various deployment scenarios for obtaining Emergency Services the UE and 5GC may support the mechanism to direct or redirect the UE either towards E-UTRA connected to 5GC RAT fallback when only NR does not support Emergency Services or towards EPS E-UTRAN connected to EPC System fallback when the 5GC does not support Emergency Services Emergency Services fallback may be used when the 5GS does not indicate support for Emergency Services see clause 51641 and indicates support for Emergency Services fallback Following principles apply for Emergency Services Fallback - If the AMF indicates support for Emergency Services fallback in the Registration Accept message then in order to initiate Emergency Service normally registered UE supporting Emergency Services fallback shall initiate a Service Request with Service Type set to Emergency Services fallback as defined in clause 41341 of TS 23502 3 - AMF uses the Service Type Indication within the Service Request to redirect the UE towards the appropriate RATSystem",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_916",
    "document_id": "23501-i80",
    "chunk_id": 916,
    "text": "The 5GS may for Emergency Services trigger one of the following procedures - Handover or redirection to EPS - Handover or redirection to E-UTRA connected to 5GC - After receiving the Service Request for Emergency Fallback the AMF triggers N2 procedure resulting in either CONNECTED state mobility Handover procedure or IDLE state mobility redirection to either E-UTRA5GC or to E-UTRANEPC depending on factors such as N26 availability network configuration and radio conditions In the N2 procedure the AMF based on support for Emergency Services in 5GC or EPC may indicate the target CN for the RAN node to know whether inter-RAT fallback or inter-system fallback is to be performed The target CN indicated in the N2 procedure is also conveyed to the UE in order to be able to perform the appropriate NAS procedures S1 or N1 Mode - When the AS re-keying procedure and the Emergency Fallback procedure collides the AMF gives up the AS re-keying procedure and only initiates the Emergency Fallback procedure NOTE 1 Emergency Services Fallback to EPS can be followed by an onward movement to GERAN or UTRAN via CSFB procedures if the PLMN does not support IMS emergency services NOTE 2 If the UE has signalled that S1 mode is disabled for a network that only supports IMS voice via EPS Fallback the AMF will not indicate that Emergency Services Fallback is supported over 3GPP access Emergency Services fallback is supported only in case of PLMN Emergency Services Fallback is not supported for SNPN 5165 Multimedia Priority Services TS 22153 24 specifies the service requirements for Multimedia Priority Service MPS MPS allows Service Users as per TS 22153 24 priority access to system resources in situations such as during congestion creating the ability to deliver or complete sessions of a high priority nature Service Users are government-authorized personnel emergency management officials andor other authorized users MPS supports priority sessions on an end-to-end priority basis MPS is based on the ability to invoke modify maintain and release sessions with priority and deliver the priority media packets under network congestion conditions MPS is supported in a roaming environment when roaming agreements are in place and where regulatory requirements apply NOTE 1 If a session terminates on a server in the Internet eg web-based service then the remote end and the Internet transport are out of scope for this specification MPS is supported for Service Users using UEs connecting via 3GPP access MPS is also supported for Service Users using UEs that connect via Trusted or Untrusted non-3GPP access for MPS N3IWF selection is according to clause 636 for PLMN access A Service User may use an MPS-subscribed UE or any other UE to obtain MPS An MPS-subscribed UE obtains priority access to the Radio Access Network by using the Unified Access Control mechanism according to TS 22261 2 This mechanism provides preferential access to UEs based on its assigned Access Identity If an MPS-subscribed UE belongs to the special Access Identity as defined in TS 22261 2 the UE has preferential access to the network compared to ordinary UEs in periods of congestion MPS subscription allows users to receive priority services if the network supports MPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_917",
    "document_id": "23501-i80",
    "chunk_id": 917,
    "text": "The same MPS subscription applies to access via 3GPP access and Trusted or Untrusted non-3GPP access MPS subscription entitles a USIM with special Access Identity MPS subscription includes indication for support of priority PDU connectivity service including MPS for Data Transport Service and IMS priority service support for the end user Priority Level regarding QoS Flows and IMS are also part of the MPS subscription information The usage of Priority Level is defined in TS 22153 24 TS 23503 45 and TS 23228 15 The UE determines whether to apply MPS exceptions for Non-Allowed Areas based on MPS subscription ie USIM with special Access Identity or MPS priority received from the AMF as defined in TS 23502 3 over 3GPP or Trusted or Untrusted non-3GPP access NOTE 2 The same MPS subscription in the UDM andor on the USIM is used for priority treatment of 3GPP procedures when the access is Trusted or Untrusted non-3GPP NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_918",
    "document_id": "23501-i80",
    "chunk_id": 918,
    "text": "The term Priority PDU connectivity services is used to refer to 5G System functionality that corresponds to the functionality as provided by LTEEPC Priority EPS bearer services in clause 43183 of TS 23401 26 MPS includes signalling priority and media priority All MPS-subscribed UEs get priority for QoS Flows eg used for IMS signalling when established to the DN that is configured to have priority for a given Service User by setting MPS-appropriate values in the QoS profile in the UDM Service Users are treated as On Demand MPS subscribers or not based on regionalnational regulatory requirements On Demand service is based on Service User invocationrevocation explicitly and applied to the media QoS Flows being established When not On Demand MPS service does not require invocation and provides priority treatment for all QoS Flows only to the DN that is configured to have priority for a given Service User after attachment to the 5G network MPS for Data Transport Service is an on-demand service that may be invokedrevoked by an authorized Service User using a UE with a subscription for MPS ie according to its MPS profile or using a UE that does not have a subscription for MPS using methods not in scope of this specification MPS for Data Transport Service requires explicit invocation The Service User invokes the service by communicating with an AF The authorization of an MPS for Data Transport Service request is done by the AF or the PCF according to clause 61311 of TS 23503 45 Upon successful authorization the PCF performs the necessary actions to achieve appropriate ARP and 5QI settings for the QoS Flows see clause 61311 of TS 23503 45 MPS for Data Transport Service enables the prioritization of all traffic on the QoS Flow associated with the default QoS rule and other QoS Flows upon AF request The QoS modification to the QoS Flow associated with the default QoS rule and other QoS Flows is done based on operator policy and regulatory rules by means of local PCF configuration NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_919",
    "document_id": "23501-i80",
    "chunk_id": 919,
    "text": "According to regionalnational regulatory requirements and operator policy On-Demand MPS including MPS for Data Transport Service Service Users can be assigned the highest priority NOTE 5 If no configuration is provided MPS for Data Transport Service applies only to the QoS Flow associated with the default QoS rule NOTE 6 MPS for DTS controls the priority of traffic on QoS Flows independent of the applications being used Other mechanisms eg Priority PDU connectivity service can be used to control the priority of traffic on other QoS Flows under the control of specific data applications based on operator policy NOTE 7 MPS for Data Transport Service can be applied to any DNN other than the well-known DNN for IMS For MPS for Data Transport Service the AF may also create an SDF for priority signalling between the UE and the AF see clause 61311 of TS 23503 45 Priority treatment is applicable to IMS based multimedia services and Priority PDU connectivity service including MPS for Data Transport Service Priority treatment for MPS includes priority message handling including priority treatment during authentication security and Mobility Management procedures Priority treatment for MPS session requires appropriate ARP and 5QI plus 5G QoS characteristics setting for QoS Flows according to the operators policy NOTE 8 Use of QoS Flows for MPS with QoS characteristics signalled as part of QoS profile enables the flexible assignment of 5G QoS characteristics eg Priority Level for MPS When an MPS session is requested by a Service User the following principles apply in the network - QoS Flows employed in an MPS session shall be assigned ARP value settings appropriate for the priority of the Service User - Setting ARP pre-emption capability and vulnerability for MPS QoS Flows subject to operator policies and depending on nationalregional regulatory requirements - Pre-emption of non-Service Users over Service Users during network congestion situation subject to operator policy and nationalregional regulations The terminating network identifies the priority of the MPS session and applies priority treatment including paging with priority to ensure that the MPS session can be established with priority to the terminating user either a Service User or normal user MPS priority mechanisms can be classified as subscription-related invocation-related and those applied to existing QoS Flows Subscription related mechanisms as described in clause 5222 are further divided into two groups those which are always applied and those which are conditionally applied Invocation-related mechanisms as described in clause 5223 are further divided into three groups those that apply for mobile originated SIP callsessions those that apply for mobile terminated SIP callsessions and those that apply for the Priority PDU connectivity services including MPS for Data Transport Service Methods applied to existing QoS Flows focus on handover and congestion control and are described in clause 5224 NOTE 9",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_920",
    "document_id": "23501-i80",
    "chunk_id": 920,
    "text": "The network can hide its topology from the AF supporting MPS for Data Transport Service At the same time the UE needs to provide its locally known IP address to the AF supporting MPS for Data Transport Service to support interactions with the applicable PCF Thus there can be no NAT of the UE IP address between the UPF and the AF supporting MPS for Data Transport Service For WLAN access the UE may notify the TNANN3IWF of its MPS subscription before the NAS Registration Request Based on operator policy the TNANN3IWF may use this indication to provide this UE with priority treatment in the case of congestionoverload before receipt of the NAS Registration Request with an MPS priority establishment cause 5166 Mission Critical Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_921",
    "document_id": "23501-i80",
    "chunk_id": 921,
    "text": "According to TS 22280 37 a Mission Critical Service MCX Service is a communication service reflecting enabling capabilities Mission Critical Applications and provided to end users from Mission Critical Organizations and mission critical applications for other businesses and organizations eg utilities railways An MCX Service is either Mission Critical Push",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_922",
    "document_id": "23501-i80",
    "chunk_id": 922,
    "text": "To Talk MCPTT as defined in TS 23379 38 Mission Critical Video MCVideo as defined in TS 23281 39 or Mission Critical Data MCData as defined in TS 23282 40 and represents a shared underlying set of requirements between two or more MCX Service types MCX Services are not restricted only to the ones defined in this clause and such services can also have priority treatment if defined via operators policy andor local regulation MCX Services are based on the ability to invoke modify maintain and release sessions with priority and deliver the priority media packets under network congestion conditions As specified in clause 68 of TS 22261 2 MCX Users require 5GS functionality that allows for real-time dynamic secure and limited interaction with the QoS and policy framework for modification of the QoS and policy framework by authorized users The limited interaction is based on operator policy and provides specific limitations on what aspects of the QoS and policy framework an authorized MCX User can modify MCX Services are supported in a roaming environment when roaming agreements are in place and where regulatory requirements apply An MCX-subscribed UE obtains priority access to the Radio Access Network by using the Unified Access Control mechanism according to TS 22261 2 This mechanism provides preferential access to UEs based on its assigned Access Identity If an MCX-subscribed UE belongs to the special Access Identity as defined in TS 22261 2 the UE has preferential access to the network compared to ordinary UEs in periods of congestion MCX subscription allows users to receive priority services if the network supports MCX MCX subscription entitles a USIM with special Access Identity NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_923",
    "document_id": "23501-i80",
    "chunk_id": 923,
    "text": "For Mission Critical Services that require low latency and zero packet loss even for the first downlink packets periodic keep-alive packets during interruptions of media transmission eg Floor Idle as specified in TS 23379 38 referenced by TS 23289 184 which is sent over user plane of PDU session can be used so that the UE is kept in RRC_CONNECTED state without being paged when unicast transmission is used It is up to the implementation the periodicity of the keep-alive packets configured in the AF can consider NG-RANs configuration NOTE 2 For support of Mission Critical Services that require low latency and zero packet loss when using MBS see TS 23247 121 MCX Services leverage the foundation of the 5G QoS Model as defined in clause 57 and 5G Policy Control as defined in clause 514 It requires that the necessary subscriptions are in place for both the 5G QoS Profile and the necessary Policies In addition MCX Services leverage priority mechanism as defined in clause 522",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_924",
    "document_id": "23501-i80",
    "chunk_id": 924,
    "text": "The terminating network identifies the priority of the MCX Service session and applies priority treatment including paging with priority to ensure that the MCX Service session can be established with priority to the terminating user either an MCX User or normal user Priority treatment for MCX Service includes priority message handling including priority treatment during authentication security and Mobility Management procedures Priority treatment for MCX Service sessions require appropriate ARP and 5QI plus 5G QoS characteristics setting for QoS Flows according to the operators policy NOTE 3 Use of QoS Flows for MCX Service sessions with non-standardized 5QI values enables the flexible assignment of 5G QoS characteristics eg Priority Level When a MCX Service session is requested by an MCX User the following principles apply in the network - QoS Flows employed in a MCX Service session shall be assigned ARP value settings appropriate for the priority of the MCX User - Setting ARP pre-emption capability and vulnerability of QoS Flows related to a MCX Service session subject to operator policies and depending on nationalregional regulatory requirements - Pre-emption of non-MCX Users over MCX Users during network congestion situations subject to operator policy and nationalregional regulations Priority treatment is applicable to IMS based multimedia services and priority PDU connectivity services Relative PDU priority decisions for MCX Service sessions are based on real-time data of the state of the network andor based on modification of the QoS and policy framework by authorized users as described in clause 68 of TS 22261 2 517 Interworking and Migration 5171 Support for Migration from EPC to 5GC 51711 General Clause 5171 describes the UE and network behaviour for the migration from EPC to 5GC Deployments based on different 3GPP architecture options ie EPC based or 5GC based and UEs with different capabilities EPC NAS and 5GC NAS may coexist at the same time within one PLMN It is assumed that a UE that is capable of supporting 5GC NAS procedures may also be capable of supporting EPC NAS ie the NAS procedures defined in TS 24301 13 to operate in legacy networks eg in the case of roaming The UE will use EPC NAS or 5GC NAS procedures depending on the core network by which it is served In order to support smooth migration it is assumed that the EPC and the 5GC have access to a common subscriber database that is HSS in the case of EPC and the UDM in the case of 5GC acting as the master data base for a given user as defined in TS 23002 21",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_925",
    "document_id": "23501-i80",
    "chunk_id": 925,
    "text": "The PCF has access to the UDR that acts as a common subscriber database for a given user identified by a SUPI using the Nudr services defined in TS 23502 3 Figure 51711-1 Architecture for migration scenario for EPC and 5G CN A UE that supports only EPC based Dual Connectivity with secondary RAT NR - always performs initial access through E-UTRA LTE-Uu but never through NR - performs EPC NAS procedures over E-UTRA ie Mobility Management Session Management etc as defined in TS 24301 13 A UE that supports camping on 5G Systems with 5GC NAS - performs initial access either through E-UTRAN that connects to 5GC or NR towards 5GC - performs initial access through E-UTRAN towards EPC if supported and needed - performs EPC NAS or 5GC NAS procedures over E-UTRAN or NR respectively ie Mobility Management Session Management etc depending on whether the UE requests 5GC access or EPC access if the UE also supports EPC NAS When camping on an E-UTRA cell connected to both EPC and 5GC a UE supporting EPC NAS and 5GC NAS shall select a core network type EPC or 5GC and initiate the corresponding NAS procedure as specified in TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_926",
    "document_id": "23501-i80",
    "chunk_id": 926,
    "text": "In order to support different UEs with different capabilities in the same network ie both UEs that are capable of only EPC NAS possibly including EPC based Dual Connectivity with NR as secondary RAT and UEs that support 5GC NAS procedures in the same network - eNB that supports access to 5GC shall broadcast that it can connect to 5GC Based on that the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_927",
    "document_id": "23501-i80",
    "chunk_id": 927,
    "text": "AS layer indicates E-UTRA connected to 5GC capability to the UE NAS layer In addition the eNB broadcasts the supported CIoT 5GS Optimisations that the UE uses for selecting a core network type - It is also expected that the UE AS layer is made aware by the UE NAS layer whether a NAS signalling connection is to be initiated to the 5GC Based on that UE AS layer indicates to the RAN whether it is requesting 5GC access ie 5GC requested indication The RAN uses this indication to determine whether a UE is requesting 5GC access or an EPC access RAN routes NAS signalling to the applicable AMF or MME accordingly NOTE The UE that supports EPC based Dual Connectivity with secondary RAT only does not provide this 5GC requested indication at Access Stratum when it performs initial access and therefore eNB uses the default CN selection mechanism to direct this UE to an MME",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_928",
    "document_id": "23501-i80",
    "chunk_id": 928,
    "text": "The 5GC network may steer the UE from 5GC based on - Core Network type restriction eg due to lack of roaming agreements described in clause 53411 - Availability of EPC connectivity - UE indication of EPC Preferred Network Behaviour and - Supported Network Behaviour The UE that wants to use one or more of these functionalities not supported by 5G System when in CM-IDLE may disable all the related radio capabilities that allow the UE to access 5G System The triggers to disable and re-enable the 5GS capabilities to access 5G System in this case are left up to UE implementation 51712 User Plane management to support interworking with EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_929",
    "document_id": "23501-i80",
    "chunk_id": 929,
    "text": "In order to support the interworking with EPC the SMFPGW-C provides information over N4 to the UPFPGW-U related to the handling of traffic over S5-U Functionality defined in TS 23503 45 for traffic steering control on SGi-LANN6 can be activated in UPFPGW-U under consideration of whether the UE is connected to EPC or 5GC When the UE is connected to EPC and establishesreleases PDN connections the following differences apply to N4 compared to when the UE is connected to 5GC - The CN Tunnel Info is allocated for each EPS Bearer - In addition to the Service Data Flow related information the SMFPGW-C shall be able to provide the GBR and MBR values for each GBR bearer of the PDN connection to the UPFPGW-U If the UE does not have preconfigured rules for associating an application to a PDN connection ie the UE does not have rules in UE local configuration and is not provisioned with ANDSF rules the UE should use a matching URSP rule as defined in TS 23503 45 if available to derive the parameters eg APN for the PDN connection establishment and associating an application to the PDN connection NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_930",
    "document_id": "23501-i80",
    "chunk_id": 930,
    "text": "The mapping between the parameters in the URSP rules and the parameters used for PDN connection establishment is defined in TS 24526 110 51713 QoS handling for home routed roaming During mobility from EPS to 5GS the handling of QoS constraints in V-SMF is specified in clauses 411122 and 411133 of TS 23502 3 and follows the same principle as described in clause 57111 5172 Interworking with EPC 51721 General Interworking with EPC in this clause refers to mobility procedures between 5GC and EPCE-UTRAN except for clause 51724 Network slicing aspects for EPS Interworking are specified in clause 5157 In order to interwork with EPC the UE that supports both 5GC and EPC NAS can operate in single-registration mode or dual-registration mode -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_931",
    "document_id": "23501-i80",
    "chunk_id": 931,
    "text": "In single-registration mode UE has only one active MM state either RM state in 5GC or EMM state in EPC and it is either in 5GC NAS mode or in EPC NAS mode when connected to 5GC or EPC respectively UE maintains a single coordinated registration for 5GC and EPC Accordingly the UE maps the EPS-GUTI to 5G GUTI during mobility between EPC and 5GC and vice versa following the mapping rules in Annex B To enable re-use of a previously established 5G security context when returning to 5GC the UE also keeps the native 5G-GUTI and the native 5G security context when moving from 5GC to EPC -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_932",
    "document_id": "23501-i80",
    "chunk_id": 932,
    "text": "In dual-registration mode UE handles independent registrations for 5GC and EPC using separate RRC connections In this mode UE maintains 5G-GUTI and EPS-GUTI independently In this mode UE provides native 5G-GUTI if previously allocated by 5GC for registrations towards 5GC and it provides native EPS-GUTI if previously allocated by EPC for AttachTAU towards EPC In this mode the UE may be registered to 5GC only EPC only or to both 5GC and EPC Dual-registration mode is intended for interworking between EPSE-UTRAN and 5GSNR A dual-registered UE should not send its E-UTRA connected to 5GC and E-UTRAN radio capabilities to NR access when connected to 5GSNR to avoid being handed over to 5GC-connected E-UTRA or to E-UTRAN NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_933",
    "document_id": "23501-i80",
    "chunk_id": 933,
    "text": "This is to prevent the dual registered UE from being connected to the same E-UTRA cell either connected to EPC or 5GC simultaneously using separate RRC connections via single RAN node as a result of handover If a dual- registered UE implementation chooses to send its E-UTRA capability when connected to 5GSNR the UE and the network behaviour when UE enters a 5GC-connected E-UTRA is not further specified If however the UE is registered with 5GSNR only the UE can send its E-UTRA capability in order to allow inter-RAT handover to E-UTRA5GC and Dual Connectivity with multiple RATs If a dual-registered UE had not sent its E-UTRA connected to 5GC and E-UTRAN radio capabilities to 5GS and the UE needs to initiate emergency services it shall locally re-enable its E-UTRA connected to 5GC and E-UTRAN radio capabilities in order to perform domain selection for emergency services as defined in TS 23167 18 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_934",
    "document_id": "23501-i80",
    "chunk_id": 934,
    "text": "However even in this case the UE is still not expected to connect to E-UTRANEPC and E-UTRA5GC simultaneously using separate RRC connection via single RAN node as a result of the domain selection for emergency services The support of single registration mode is mandatory for UEs that support both 5GC and EPC NAS During E-UTRAN Initial Attach UE supporting both 5GC and EPC NAS shall indicate its support of 5G NAS in UE Network Capability described in clause 411152 of TS 23502 3 During registration to 5GC UE supporting both 5GC and EPC NAS shall indicate its support of EPC NAS NOTE 3 This indication may be used to give the priority towards selection of SMFPGW-C for UEs that support both EPC and 5GC NAS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_935",
    "document_id": "23501-i80",
    "chunk_id": 935,
    "text": "If the UE supports 5GC NAS at PDN connection establishment in EPC the UE may allocate a PDU Session ID and sends it via PCO regardless of N1 mode status ie enabled or disabled in the UE NOTE 4 UE providing a PDU Session ID at PDN connection establishment even when N1 mode is disabled allows for IP address preservation during EPC to 5GC mobility once the UE re-enables N1 mode NOTE 5 For the case the MME has selected a standalone PGW for a PDN connection if the UE re-enables N1 mode and reports the change in UE Network Capability the MME can initiate PDN disconnection with reactivation required as described in clause 4110a8 of TS 23502 3 to allow selection of SMFPGW-C thus session continuity at EPC to 5GC mobility If the EPC supports Ethernet PDU Session Type and the 5GSM Capabilities indicate that the UE supports Ethernet PDN type in EPC then PDU Session type Ethernet is transferred to EPC as Ethernet Otherwise PDU Session types Ethernet and Unstructured are transferred to EPC as non-IP PDN type when supported by UE and network If the UE or EPC does not support Ethernet PDN type in EPC the UE sets the PDN type to non-IP when it moves from 5GS to EPS and after the transfer to EPS and the UE and the SMF shall maintain information about the PDU Session type used in 5GS ie information indicating that the PDN Connection with non-IP PDN type corresponds to PDU Session type Ethernet or Unstructured respectively This is done to ensure that the appropriate PDU Session type will be used if the UE transfers to 5GS PDN type non-IP is transferred to 5GS as Unstructured PDU Session type if it is successfully transferred It is assumed that if a UE supports Ethernet PDU Session type andor Unstructured PDU Session type in 5GS it will also support non-IP PDN type in EPS If this is not the case the UE shall locally delete any EBIs corresponding to the EthernetUnstructured PDU Sessions to avoid that the EthernetUnstructured PDU Sessions are transferred to EPS MTU size consideration for PDU Sessions and PDN Connections towards a SMFPGW-C follows the requirements in clause 56104 Networks that support interworking with EPC may support interworking procedures that use the N26 interface or interworking procedures that do not use the N26 interface Interworking procedures with N26 support provides IP address continuity on inter-system mobility to UEs that support 5GC NAS and EPC NAS and that operate in single registration mode Networks that support interworking procedures without N26 shall support procedures to provide IP address continuity on inter-system mobility to UEs operating in both single-registration mode and dual-registration mode In such networks AMF shall provide the indication that interworking without N26 is supported to UEs during initial Registration in 5GC or MME may optionally provide the indication that interworking without N26 is supported in the Attach procedure in EPC as defined in TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_936",
    "document_id": "23501-i80",
    "chunk_id": 936,
    "text": "If the network does not support interworking with EPC network shall not indicate support for interworking without N26 to the UE When the HSSUDM is required to provide the subscription data to the MME for each APN only one SMFPGW-C FQDN and associated APN is provided to the MME according to TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_937",
    "document_id": "23501-i80",
    "chunk_id": 937,
    "text": "For interworking without N26 interface - if the PDU session supports interworking the SMFPGW-C stores the SMFPGW-C FQDN to SMF context in HSSUDM when the SMF is registered to HSSUDM - For an APN the HSSUDM selects one of the stored SMFPGW-C FQDN based on operators policy For interworking with N26 interface - For a DNN AMF determines PDU sessions associated with 3GPP access in only one SMFPGW-C supporting EPS interworking via EBI allocation procedure as described in clause 411141 of TS 23502 3 - If the network supports EPS interworking of non-3GPP access connected to 5GC the AMF serving 3GPP access notifies the UDM to store the association between DNN and SMFPGW-C FQDN which supports EPS interworking as Intersystem continuity context to avoid MME receiving inconsistent SMFPGW-C FQDN from AMF and HSSUDM -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_938",
    "document_id": "23501-i80",
    "chunk_id": 938,
    "text": "The AMF updates Intersystem continuity context if the SMFPGW-C and DNN association is changed due to the AMF selecting another SMFPGW-C for EPS interworking for the same DNN - If the SMFPGW-C FQDN and associated DNN exists in Intersystem continuity context the HSSUDM provides MME with SMFPGW-C FQDN and associated APN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_939",
    "document_id": "23501-i80",
    "chunk_id": 939,
    "text": "It does not assume that the HSSUDM is aware of whether N26 is deployed in the serving network The HSSUDM check the Intersystem continuity context first If no SMFPGW-C FQDN associated with an DNN exists in Intersystem continuity context the HSSUDM selects one of the SMFPGW-C FQDN for the APN from SMF context based on operators policy In entire clause 5172 the terms initial attach handover attach and TAU for the UE procedures in EPC can alternatively be combined EPSIMSI Attach and combined TALA depending on the UE configuration defined in TS 23221 23 If a UE in MICO mode moves to E-UTRAN connected to EPC and any of the triggers defined in clause 5413 occur then the UE shall locally disable MICO mode and perform the TAU or Attach procedure as defined in clause 5172",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_940",
    "document_id": "23501-i80",
    "chunk_id": 940,
    "text": "The UE can renegotiate MICO when it returns to 5GS during re-registration procedure IP address preservation for IP PDU sessions cannot be ensured on subsequent mobility from EPCE-UTRAN to GERANUTRAN to a UE that had initially registered in 5GS and moved to EPCE-UTRAN NOTE 6 The SMFPGW-C might not include the GERANUTRAN PDP Context anchor functionality Also 5GC does not provide GERANUTRAN PDP Context parameters to the UE when QoS Flows of PDU Session are setup or modified in 5GS Hence the UE might not be able to activate the PDP contexts when it transitions to GERANUTRAN IP address preservation for IP PDU sessions cannot be ensured on subsequent mobility from EPCE-UTRAN to 5GS for a 5GS NAS capable UE that had initially established a PDP context via GERANUTRAN and moved to EPCE-UTRAN IP address preservation for IP PDU session mobility between EPCE-UTRAN and 5GS may be re-ensured as specified in clause 51724 when UE moves from GERANUTRAN into EPCE-UTRAN NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_941",
    "document_id": "23501-i80",
    "chunk_id": 941,
    "text": "The PGW acting as a GGSN might not support SMFPGW-C functionality GPRS does not support 5GS parameters transfer between UE and SMFPGW-C eg providing of PDU session ID and 5GS QoS information When a PDU session is moved from 5GS to EPS the SMFPGW-C keeps the registration and subscription in HSSUDM until the corresponding PDN connection is released The SMFPGW-C receives notification of subscription update regarding the 5G parameters eg DNNs S-NSSAIs which are associated with the established PDN connections connecting via EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_942",
    "document_id": "23501-i80",
    "chunk_id": 942,
    "text": "If the subscription regarding DNN QoS profile or PDN connection type associated with the PDN connection is updated then the MME receives the subscription update and triggers corresponding actions according to TS 23401 26 If the SMFPGW-C receives subscription updates eg change of 5GS Subscribed NSSAI from the UDM the SMFPGW-C triggers corresponding actions for the PDN connection This may include depending on the modified parameter to - update the UPF eg for a change of Framed Route information or - release the PDN connection with an appropriate cause eg for change of EPS5GS interworking support for subscription removal of S-NSSAI associated with the PDN connection - do nothing about changes to DNN andor PDU Session type that are handled by the MME",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_943",
    "document_id": "23501-i80",
    "chunk_id": 943,
    "text": "If header compression is used for Control Plane CIoT EPS5GS Optimisations and when the UE moves from EPS to 5GS or from 5GS to EPS the UE may initiate the PDU Session Modification Procedure or UE requested bearer resource modification procedure to renegotiate the header compression configuration and to establish the compression context between the UE and MMESMF see TS 23401 26 and TS 24501 47 If the UE is moving from 5GS to EPS and the RAT type is also moving from a broadband RAT eg NR or WB-E-UTRA to NB-IoT in EMM-IDLE state the UE should set the mapped EPS bearer context for which the EPS bearer is a dedicated EPS bearer to state BEARER CONTEXT INACTIVE as for NB-IoT UEs in EPS only support the default bearers In addition UE shall locally deactivate the related bearers according to the maximum number of supported UP resources and send the latest bearer context status in the TAU Request If APN Rate Control is used when the UE moves from EPC to 5GC then the P-GWSCEF and UE store the current APN Rate Control Status for an APN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_944",
    "document_id": "23501-i80",
    "chunk_id": 944,
    "text": "If while connected to 5GC the last PDU Session to a DNN that is the same as the APN identified in the APN Rate Control Status is released then the APN Rate Control Status may be stored in the AMF in addition to the Small Data Rate Control Status and the UE discards the APN Rate Control Status The APN Rate Control Status is stored in the AMF so it can be provided to the MME during mobility to EPC and subsequently applied at establishment of a new first PDN Connection to the same APN if valid The APN Rate Control Status is provided to the UPFPGW-U if a first new PDU Session is established towards the DNN that is the same as the APN identified in the APN Rate Control Status if the UE moves back to EPC taking into account its validity period The UE may be provided with initial APN Rate Control parameters by the SMF when a first new PDU Session is established for a DNN and S-NSSAI that supports interworking with EPS and the DNN matches an APN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_945",
    "document_id": "23501-i80",
    "chunk_id": 945,
    "text": "The SMF provides the APN Rate Control Status for the APN that matches the DNN if available at the SMF otherwise the configured APN Rate Control parameters for the APN that matches the DNN are provided as the initially applied parameters If the initially applied parameters differ from the configured APN Rate Control parameters and the first APN Rate Control validity period expires the UE is updated with the configured APN Rate Control parameters once the UE has moved to EPC NOTE 8 If the APN Rate Control Status is provided to a UPFPGW-U it is not used for Small Data Rate Control while the UE is connected to 5GC it is only used as the APN Rate Control Status if the UE moves to EPC NOTE 9 Encoding of APN and DNN specified in TS 23003 19 allows the comparison of EPS APN and 5GS DNN If a Service Gap timer is running in the AMF when the UE moves from 5GC to EPC the AMF stops the running Service Gap timer If the UE returns to 5GC from EPC the AMF provides the Service Gap Time to the UE as described in clause 53116",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_946",
    "document_id": "23501-i80",
    "chunk_id": 946,
    "text": "If a Service Gap timer is running in the MME when the UE moves from EPC to 5GC the MME stops the running Service Gap timer If the UE returns to E-UTRAN connected to EPC from 5GC the MME provides the Service Gap Time to the UE as described in TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_947",
    "document_id": "23501-i80",
    "chunk_id": 947,
    "text": "If a Service Gap timer is running in the UE when the UE moves to from 5GC to EPC and if Service Gap Time is received from the MME the UE stores the received Service Gap Time for later use when the timer needs to be started next time and the Service Gap timer that was started before the system change is kept running in the UE and applied for EPC If a Service Gap timer is running in the UE when the UE moves to 5GC and if Service Gap Time is received from the AMF the UE stores the received Service Gap Time for later use when the timer needs to be started next time and the Service Gap timer that was started before the system change is kept running in the UE and applied in 5GS For UE currently served by EPC a SMFPGW-C may support L2TP tunnelling on N6 as described in clause 58216 51722 Interworking Procedures with N26 interface 517221 General NOTE 1 Additional network slicing and Interworking with EPS with N26 aspects are specified in clause 5157",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_948",
    "document_id": "23501-i80",
    "chunk_id": 948,
    "text": "Interworking procedures using the N26 interface enables the exchange of MM and SM states between the source and target network The N26 interface may be either intra-PLMN or inter-PLMN eg to enable inter-PLMN mobility When interworking procedures with N26 is used the UE operates in single-registration mode For the 3GPP access the network keeps only one valid MM state for the UE either in the AMF or MME For the 3GPP access either the AMF or the MME is registered in the HSSUDM The support for N26 interface between AMF in 5GC and MME in EPC is required to enable seamless session continuity eg for voice services for inter-system change The UEs subscription may include restriction for Core Network Type EPC and RAT restriction for E-UTRA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_949",
    "document_id": "23501-i80",
    "chunk_id": 949,
    "text": "If so the UDM provides these restrictions to the AMF The AMF includes RAT and Core Network type restrictions in the Handover Restriction List to the NR The AMF and NR use these restrictions to determine if mobility of the UE to EPS or E-UTRA connected to EPS should be permitted When the UE moves from 5GS to EPS the SMF determines which PDU Sessions can be relocated to the target EPS eg based on capability of the deployed EPS operator policies for which PDU Session seamless session continuity should be supported etc The SMF can release the PDU Sessions that cannot be transferred as part of the handover or Idle mode mobility However whether the PDU Session is successfully moved to the target network is determined by target EPS Similarly the UEs subscription may include restriction for Core Network Type 5GC and RAT restriction for NR If so the HSS provides these restrictions to the MME",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_950",
    "document_id": "23501-i80",
    "chunk_id": 950,
    "text": "The MME includes RAT and Core Network type restrictions in the Handover Restriction List to the E-UTRAN The MME and E-UTRAN use these restrictions to determine if mobility of the UE to 5GS or NR connected to 5GS should be permitted If the SMFPGW-C receives the PDU session ID from UE via PCO and know 5GC is not restricted for the PDN connection by user subscription the SMFPGW-C sends the mapped QoS parameters to UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_951",
    "document_id": "23501-i80",
    "chunk_id": 951,
    "text": "When the UE moves from EPS to 5GS for the case when the MME has selected SMFPGW-C even for PDN connections that cannot be relocated to the target 5GS the SMFPGW-C determines which PDN Connections can be relocated to the target 5GS eg based on capability of the deployed 5GS subscription and operator policies for which PDN Connection seamless session continuity should be supported etc The SMFPGW-C and NG-RAN can reject the PDN Connections that cannot be transferred as part of the handover or Idle mode mobility NOTE 2 At inter-PLMN scenarios in case the V-SMF receives an operator specific QCI value whetherhow the remapping is done is implementation specific according to the local policy and according to an inter-PLMN agreement between the involved operators If remapping at inter-PLMN mobility between HPLMN and VPLMN is to be performed the V-SMF chooses a 5QI value based on inter-PLMN agreement between the VPLMN and the HPLMN and updates the QoS Flows accordingly The remapping can result in service degradation For the case when the MME has selected standalone P-GW for a PDN connection for which session continuity is not supported and the AMF cannot retrieve the address of the corresponding SMF during EPS to 5GS mobility the AMF does not move the PDN connection to 5GS NOTE 2 When applying the AMF planned removal procedure or the procedure to handle AMF failures see clause 5212 implementations are expected to update the DNS configuration to enable MMEs to discover alternative AMFs if the MME tries to retrieve a UE context from an AMF that has been taken out of service or has failed This addresses the scenario of UEs performing 5GS to EPS Idle mode mobility and presenting a mapped GUTI pointing to an AMF that has been taken out of service or has failed In the case of mobility from 5GS to EPS if the MME lacks certain capability eg MME not supporting 15 EPS bearers the 5GC shall not transfer the UE EPS bearers andor EPS PDN connections that are not supported by the EPC network If the MME does not support 15 EPS bearers the AMF determines which EBIs cannot be transferred to EPS and retrieves the EPS bearer contexts from the SMFPGW-C for the EBIs that can be transferred to EPS NOTE 3 How the AMF determines which EBIs can be transferred to EPS is according to local configuration eg according to DNN S-NSSAI ARP associated with an EBI In the case of mobility from 5GS to EPS if the mobility is a result of the PCF modifying the RFSP Index value for the UE to indicate that EPCE-UTRAN access is prioritized over the 5GS access the AMF may be sent with a RFSP Index in Use Validity Time by the PCF as specified in TS 23503 45 If the AMF receives RFSP Index in Use Validity Time and selects the RFSP Index in use identical to the authorized RFSP Index as specified in clause 5343 then the AMF provides the MME with the RFSP Index in use and the RFSP Index in Use Validity Time which indicates the time by which the RFSP Index in use will be used in the MME as specified in clause 411158 of TS 23502 3 NOTE 4 The RFSP Index in Use Validity Time is to allow the UE to stay in EPS for a period of time to avoid the potential ping-pong issue ie 5GS keeps sending the UE to EPS based on authorized RFSP Index from PCF and the EPS keeps sending the UE back to 5GS immediately based on the subscribed RFSP Index NOTE 5 The RFSP Index in Use Validity Time applies only to EPS but not to 5GS therefore in the case of mobility from EPS to 5GS the RFSP Index in Use Validity Time if received from MME is ignored by the AMF 517222 Mobility for UEs in single-registration mode When the UE supports single-registration mode and network supports interworking procedure with the N26 interface -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_952",
    "document_id": "23501-i80",
    "chunk_id": 952,
    "text": "For idle mode mobility from 5GS to EPS the UE performs either TAU or Attach procedure with EPS GUTI mapped from 5G-GUTI sent as old Native GUTI as described in clause 4111321 of TS 23502 3 and indicates that it is moving from 5GC The UE includes in the RRC message a GUMMEI mapped from the 5G-GUTI and indicates it as a native GUMMEI and should in addition indicate it as Mapped from 5G-GUTI The MME retrieves the UEs MM and SM context from 5GC For connected mode mobility from 5GS to EPS either inter-system handover or RRC Connection Release with Redirection to E-UTRAN is performed At inter-system handover the AMF selects target MME based on 2 octet TAC format used in the Target ID as specified in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_953",
    "document_id": "23501-i80",
    "chunk_id": 953,
    "text": "During the TAU or Attach procedure the HSSUDM cancels any AMF registration associated with the 3GPP access but not AMF registration associated with the non-3GPP access an AMF that was serving the UE over both 3GPP and non-3GPP accesses does not consider the UE as deregistered over non 3GPP access - For the first TAU after 5GC initial Registration the UE and MME for the handling of UE Radio Capabilities follow the procedures as defined in clause 5112 of TS 23401 26 for first TAU after GERANUTRAN Attach NOTE 1 MMEs supporting interworking with N26 interface are not required to process the indication from the UE that it is moving from 5GC and will assume that the UE is moving from another MME -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_954",
    "document_id": "23501-i80",
    "chunk_id": 954,
    "text": "For idle mode mobility from EPC to 5GC the UE performs mobility Registration procedure with the 5G GUTI mapped from EPS GUTI and indicates that it is moving from EPC The UE derives GUAMI from the native 5G-GUTI and includes GUAMI in the RRC message to enable RAN to route to the corresponding AMF if available If the UE holds no native 5G-GUTI then the UE provides in the RRC message a GUAMI mapped from the EPS GUTI and indicates it as Mapped from EPS The AMF and SMF retrieve the UEs MM and SM context from EPC For connected mode mobility from EPC to 5GC either inter-system handover or RRC Connection Release with Redirection to NG-RAN is performed At inter-system handover the MME selects target AMF based on TAC used in the Target ID as specified in TS 38413 34 During the Registration procedure the HSSUDM cancels any MME registration NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_955",
    "document_id": "23501-i80",
    "chunk_id": 955,
    "text": "During a transition period the source eNB may be configured via OM to know that the MME is not upgraded and thus supports only 2 octet TAC The Target ID for the NG-RAN node is set as Target eNB ID in the existing IEs as defined in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_956",
    "document_id": "23501-i80",
    "chunk_id": 956,
    "text": "For both idle mode and connected mode mobility from EPC to 5GC - The UE includes the native 5G-GUTI as an additional GUTI in the Registration request the AMF uses the native 5G-GUTI to retrieve MM context identified by the 5G-GUTI from old AMF or from UDSF if UDSF is deployed and the old AMF is within the same AMF set - If this is the first mobility event for a PDU Session that was established while being connected to EPC the UE shall trigger the PDU Session Modification procedure and - should indicate the support of Reflective QoS to the network ie SMF if the UE supports Reflective QoS functionality If the UE indicated support of Reflective QoS the network may provide a Reflective QoS Timer RQ Timer value to the UE - shall indicate the number of supported packet filters for signalled QoS rules if the UE supports more than 16 packet filters for the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_957",
    "document_id": "23501-i80",
    "chunk_id": 957,
    "text": "The network shall store this information so that subsequent mobility events do not require another signalling of it - should indicate the support of Multi-homed IPv6 PDU session to the network ie SMF if the UE supports Multi-homed IPv6 PDU session If the UE indicated support of Multi-homed IPv6 PDU session the network shall consider that this PDU session is supported to use multiple IPv6 prefixes - should provide the UE Integrity Protection Maximum Data Rate to the network ie SMF The network shall consider that the maximum data rate per UE for user-plane integrity protection supported by the UE is valid for the lifetime of the PDU session 51723 Interworking Procedures without N26 interface 517231 General For interworking without the N26 interface IP address preservation is provided to the UEs on inter-system mobility by storing and fetching SMFPGW-C and corresponding APNDNN information via the HSSUDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_958",
    "document_id": "23501-i80",
    "chunk_id": 958,
    "text": "In such networks AMF also provides an indication that interworking without N26 is supported to UEs during Initial Registration in 5GC or MME may optionally provide an indication that interworking without N26 is supported in the Attach procedure in EPC as defined in TS 23502 3 and TS 23401 26 The UE provides an indication that it supports Request Type flag handover for PDN connectivity request during the attach procedure as described in clause 5321 of TS 23401 26 and during initial Registration and Mobility Registration Update in 5GC NOTE 1 The UE support of Request Type flag handover for PDN connectivity request during the attach procedure is needed for IP address preservation in the case of interworking without N26 The indication that interworking without N26 is valid for the entire Registered PLMN and for PLMNs equivalent to the Registered PLMN that are available in the Registration Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_959",
    "document_id": "23501-i80",
    "chunk_id": 959,
    "text": "The same indication is provided to all UEs served by the same PLMN UEs that operate in interworking without N26 may use this indication to decide whether to register early in the target system UEs that only support single registration mode may use this indication as described in clause 517232 UE that support dual registration mode uses this indication as described in clause 517233 Interworking procedures without N26 interface use the following two features 1 When UE performs Initial Attach in EPC with or without Handover indication in PDN CONNECTIVITY Request message and indicates that it is moving from 5GC the MME indicates to the HSSUDM not to cancel the registration of AMF if any 2 When UE performs Initial Registration in 5GC and indicates that it is moving from EPC the AMF indicates to the HSSUDM not to cancel the registration of MME if any To support mobility both for single and dual registration mode UEs the following also are supported by the network 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_960",
    "document_id": "23501-i80",
    "chunk_id": 960,
    "text": "When PDU Session are created in 5GC the SMFPGW-C which supports EPS interworking stores the SMFPGW-C FQDN along with DNN in the HSSUDM 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_961",
    "document_id": "23501-i80",
    "chunk_id": 961,
    "text": "The HSSUDM provides the information about dynamically allocated SMFPGW-C and APNDNN information to the target CN network If there are multiple SMFPGW-C serving the UE for the same DNN which support EPS interworking in 5GS the HSSUDM select one of them according to operators policy and provides together with the associated APN to the MME 5 When PDN connections are created in EPC the MME stores the SMFPGW-C and APN information in the HSSUDM NOTE 2 Items 3 4 and 5 are also supported in networks that support interworking with N26 procedures This enables a VPLMN that does not deploy N26 interface to provide IP address preservation to roamed-in single-registration mode UEs from a HPLMN that only supports interworking with N26 procedures When the network serving the UE supports 5GS-EPS interworking procedures without N26 interface the SMF shall not provide the UEs with mapped target system parameters of the target system when UE is in the source network A UE that operates in dual registration mode ignores any received mapped target system parameters eg QoS parameters bearer IDsQFI PDU Session ID etc 517232",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_962",
    "document_id": "23501-i80",
    "chunk_id": 962,
    "text": "Mobility for UEs in single-registration mode When the UE supports single-registration mode and network supports interworking procedure without N26 interface -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_963",
    "document_id": "23501-i80",
    "chunk_id": 963,
    "text": "For mobility from 5GC to EPC the UE with at least one PDU Session established in 5GC may either - if supported and if it has received the network indication that interworking without N26 is supported perform Attach in EPC with a native EPS GUTI if available otherwise with IMSI with Request type Handover in PDN CONNECTIVITY Request message clause 5321 of TS 23401 26 and indicating that the UE is moving from 5GC and subsequently moves all its other PDU Session using the UE requested PDN connectivity establishment procedure with Request Type handover flag clause 5102 of TS 23401 26 or - perform TAU with 4G-GUTI mapped from 5G-GUTI sent as old Native GUTI clause 533 of TS 23401 26 indicating that it is moving from 5GC in which case the MME instructs the UE to re-attach IP address preservation is not provided in this case - for the first TAU after 5GC initial Registration the UE and MME for the handling of UE Radio Capabilities follow the procedures as defined in clause 5112 TS 23401 26 for first TAU after GERANUTRAN Attach NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_964",
    "document_id": "23501-i80",
    "chunk_id": 964,
    "text": "The first PDN connection may be established during the E-UTRAN Initial Attach procedure see TS 23401 26 NOTE 2 At inter-PLMN mobility to a PLMN that is not an equivalent PLMN the UE always uses the TAU procedure - For mobility from 5GC to EPC the UE with no PDU Session established in 5GC - performs Attach in EPC clause 5321 of TS 23401 26 indicating that the UE is moving from 5GC -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_965",
    "document_id": "23501-i80",
    "chunk_id": 965,
    "text": "For mobility from EPC to 5GC the UE performs Mobility Registration Update in 5GC with 5G-GUTI mapped from EPS GUTI and a native 5G-GUTI if available as Additional GUTI and indicating that the UE is moving from EPC In this case the AMF determines that old node is an MME but proceeds as if the Registration is of type initial registration The UE may either - if supported and if it has received the network indication interworking without N26 supported move all its PDN connections from EPC using the UE initiated PDU Session Establishment procedure with Existing PDU Sessions flag clause 43221 of TS 23502 3 or - re-establish PDU Sessions corresponding to the PDN connections that it had in EPS IP address preservation is not provided in this case NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_966",
    "document_id": "23501-i80",
    "chunk_id": 966,
    "text": "The additional native 5G-GUTI enables the AMF to find the UEs 5G security context if available NOTE 4 When single-registration mode UE uses interworking procedures without N26 the registration states during the transition period eg while UE is transferring all PDU Sessions PDN Connections on the target side are defined in Stage 3 specifications - If the network determines that the UE is changing RAT type if the UE requests to relocate the PDU session from EPC to 5GC or 5GC to EPC the SMFMME uses the PDU session continuity at inter RAT mobility or PDN continuity at inter-RAT mobility information respectively in the subscription to determine whether to maintain the PDU sessionPDN connection if being handed over or reject the PDU session request with the relevant cause - If the UE requested to move the PDU session and the PDN continuity at inter RAT mobility information indicated disconnect the PDN connection with a reactivation request the network should provide a suitable cause code to the UE so that it can request a new PDU session 517233 Mobility for UEs in dual-registration mode To support mobility in dual-registration mode the support of N26 interface between AMF in 5GC and MME in EPC is not required A UE that supports dual registration mode may operate in this mode when it receives an indication from the network that interworking without N26 is supported For UE operating in dual-registration mode the following principles apply for PDU Session transfer from 5GC to EPC - UE operating in Dual Registration mode may register in EPC ahead of any PDU Session transfer using the Attach procedure indicating that the UE is moving from 5GC without establishing a PDN Connection in EPC if the EPC supports EPS Attach without PDN Connectivity as defined in TS 23401 26 Support for EPS Attach without PDN Connectivity is mandatory for UE supporting dual-registration procedures NOTE 1 Before attempting early registration in EPC the UE needs to check whether EPC supports EPS Attach without PDN Connectivity by reading the related SIB in the target cell - UE performs PDU Session transfer from 5GC to EPC using the UE initiated PDN connection establishment procedure with handover indication in the PDN Connection Request message clause 5102 of TS 23401 26 - If the UE has not registered with EPC ahead of the PDU Session transfer the UE can perform Attach in EPC with handover indication in the PDN Connection Request message clause 5321 of TS 23401 26 - UE may selectively transfer certain PDU Sessions to EPC while keeping other PDU Sessions in 5GC - UE may maintain the registration up to date in both 5GC and EPC by re-registering periodically in both systems If the registration in either 5GC or EPC times out eg upon mobile reachable timer expiry the corresponding network starts an implicit detach timer NOTE 2 Whether UE transfers some or all PDU Sessions on the EPC side and whether it maintains the registration up to date in both EPC and 5GC can depend on UE capabilities that are implementation dependent The information for determining which PDU Sessions are transferred on EPC side and the triggers can be pre-configured in the UE and are not specified in this Release of the specification The UE does not know before-hand ie before trying to move a given PDU session to EPC whether that PDU session can be transferred to EPC NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_967",
    "document_id": "23501-i80",
    "chunk_id": 967,
    "text": "The Start of Unavailability Period andor Unavailability Period Duration that the UE determines for NR satellite access with discontinuous network coverage in 5GS see clause 5414 and determines for satellite access with discontinuous coverage in EPS see clause 41382 of TS 23401 26 can be different between 5GS and EPS For UE operating in dual-registration mode the following principles apply for PDN connection transfer from EPC to 5GC - UE operating in Dual Registration mode may register in 5GC ahead of any PDN connection transfer using the Registration procedure indicating that the UE is moving from EPC clause 42222 of TS 23502 3 - UE performs PDN connection transfer from EPC to 5GC using the UE initiated PDU Session Establishment procedure with Existing PDU Session indication clause 43221 of TS 23502 3 - UE may selectively transfer certain PDN connections to 5GC while keeping other PDN Connections in EPC - UE may maintain the registration up to date in both EPC and 5GC by re-registering periodically in both systems If the registration in either EPC or 5GC times out eg upon mobile reachable timer expiry the corresponding network starts an implicit detach timer NOTE 4 Whether UE transfers some or all PDN connections on the 5GC side and whether it maintains the registration up to date in both 5GC and EPC can depend on UE capabilities that are implementation dependent The information for determining which PDN connections are transferred on 5GC side and the triggers can be pre-configured in the UE and are not specified in this Release of the specification The UE does not know before-hand ie before trying to move a given PDN connection to 5GC whether that PDN connection can be transferred to 5GC NOTE 5 If EPC does not support EPS Attach without PDN Connectivity the MME detaches the UE when the last PDN connection is released by the PGW as described in clause 5441 of TS 23401 26 in relation to transfer of the last PDN connection to non-3GPP access When sending a control plane request for MT services eg MT SMS the network routes it via either the EPC or the 5GC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_968",
    "document_id": "23501-i80",
    "chunk_id": 968,
    "text": "In absence of UE response the network should attempt routing the control plane request via the other system NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_969",
    "document_id": "23501-i80",
    "chunk_id": 969,
    "text": "The choice of the system through which the network attempts to deliver the control plane request first is left to network configuration 517234 Redirection for UEs in connected state When the UE supports single-registration mode or dual-registration mode without N26 interface - If the UE is in CM-CONNECTED state in 5GC the NG-RAN may perform RRC Connection Release with Redirection to E-UTRAN based on certain criteria eg based on local configuration in NG-RAN or triggered by the AMF upon receiving Handover Request message from NG-RAN - If the UE is in ECM-CONNECTED state in EPC the E-UTRAN may perform RRC Connection release with redirection to NG-RAN based on certain criteria eg based on local configuration in E-UTRAN or triggered by the MME upon receiving handover request from E-UTRAN 51724 Mobility between 5GS and GERANUTRAN IP address preservation upon direct mobility between 5GS and GERANUTRAN is not supported Upon mobility from 5GS to GERANUTRAN eg upon leaving NG-RAN coverage the UE shall perform the AGb mode GPRS Attach procedure or Iu mode GPRS Attach procedure see TS 23060 56",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_970",
    "document_id": "23501-i80",
    "chunk_id": 970,
    "text": "As a UE option to support IP address preservation at mobility from EPC to 5GS for PDN connections without 5GS related parameters a 5GS capable UE may - Following mobility from GERANUTRAN to EPS release those PDN connections and re-establish them as specified in clause 4111541 of TS 23502 3 so that they support interworking to 5GS NOTE 1 It is recommended that a UE using this option does not do this behaviour after every change to EPS in PLMNs that do not support 5GS nor for APNs that do not support mobility to 5GS and that such a UE supports storage of the 5GS related parameters while in GERANUTRAN Whether and how the UE is aware of which PLMNs support 5GS and which APNs do not support mobility to 5GS is out of scope of this specification To support mobility from EPC to 5GS to EPC to GERANUTRAN for PDN connections established in EPC NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_971",
    "document_id": "23501-i80",
    "chunk_id": 971,
    "text": "For the use of N7 or N40 interfaces while the UE is in GERANUTRAN access the SMFPGW-C selected by the MME using the existing selection procedures described in clause 4110a of TS 23502 3 and clause 438 of TS 23401 26 needs to support functionality eg signalling of GERANUTRAN cell identification over N7 specified in Annex L - in signalling sent on the N26 interface the MME should send the TI and BSS Container in the EPS Bearer Context see Table 731-3 of TS 29274 101 if there is any of the EPS bearer to the SMF V-SMF I-SMF via the AMF in the Bearer Context within the PDN Connection IE in the Forward Relocation Request and",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_972",
    "document_id": "23501-i80",
    "chunk_id": 972,
    "text": "Context Response messages TS 29274 101 the SMF V-SMF I-SMF should store the TI and BSS Container and the SMF V-SMF I-SMF should provide the TI and BSS Container to the AMF as part of a procedure to deliver SM context to AMF so that the AMF sends the TI and BSS Container of the related EPS bearer in the Bearer Context within the EPS PDN Connection information in any subsequent Forward Relocation Request and Context Response message sent to an MME NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_973",
    "document_id": "23501-i80",
    "chunk_id": 973,
    "text": "At mobility from EPC the SMFPGW-C V-SMF I-SMF receives the TI and BSS Container as part of the UE EPS PDN Connection information from the AMF and stores the TI At mobility to EPC the SMFPGW-C V-SMF I-SMF provides the AMF with the TI and BSS Container as part of the UE EPS PDN Connection information The SMFPGW-C V-SMF I-SMF is not meant to understand the TIBSS Container nor to use it for any other purpose than providing it back to AMF GERANUTRAN Mobility Management Bearer Synchronisation procedures will release any dedicated QoS Flows established in 5GS and then the SMFPGW-C deletes the PCC rules associated with those QoS Flows and informs the PCF about the removed PCC rules as described in clause 411 of TS 23502 3 When the UE accesses the network via GERANUTRAN over GnGp interface Secondary PDP Context Activation Procedure is not supported and the SMFPGW-C rejects the Secondary PDP Context Activation request if UE requested it IP address preservation at mobility from EPC to GERANUTRAN for PDU sessions established in 5GS is not supported With regard to interworking between 5GS and the Circuit Switched domain when the GERAN or UTRAN network is operating in NMO II",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_974",
    "document_id": "23501-i80",
    "chunk_id": 974,
    "text": "ie no Gs interface between MSC and SGSN - upon mobility from 5GS to GERANUTRAN the UE shall either - act as if it is returning after a loss of GERANUTRAN coverage and eg only perform a periodic LAU if the periodic LAU timer has expired or - perform a Location Update to the MSC If the UE is registered for IMS voice and is configured using Device Management or initial provisioning to perform additional mobility management procedures when it has moved from a RAT that supports IMS voice over PS sessions to one that does not see TS 23060 56 it shall follow this option Upon mobility from GERANUTRAN to 5GS eg upon selecting an NG-RAN cell the UE shall perform the Registration procedure of initial registration type as described in TS 23502 3 The UE shall indicate a 5G-GUTI as UE identity in the Registration procedure if it has a stored valid native 5G-GUTI eg from an earlier registration in the 5G System",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_975",
    "document_id": "23501-i80",
    "chunk_id": 975,
    "text": "Otherwise the UE shall indicate a SUCI If a UE in MICO mode moves to GERANUTRAN and any of the triggers defined in clause 5413 occur then the UE shall locally disable MICO mode and perform the AGb mode GPRS Attach procedure or Iu mode GPRS Attach procedure see TS 23060 56 The UE can renegotiate MICO when it returns to 5GS during re-registration procedure In Single Registration mode expiry of the periodic RAU timer or the periodic LAU timer shall not cause the UE to change RAT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_976",
    "document_id": "23501-i80",
    "chunk_id": 976,
    "text": "The 5G SRVCC from NG-RAN to UTRAN is specified in the TS 23216 88 After the 5G SRVCC to UTRAN all the PDU sessions of the UE are released 51725 Secondary DN authentication and authorization in EPS Interworking case Secondary authenticationauthorization by a DN-AAA server during the establishment of a PDN connection over 3GPP access to EPC is supported based on following principles - It is optional for the UE to support EAP-based secondary authentication and authorization by DN-AAA over EPC - A SMFPGW-C shall be used to serve DNNs requiring secondary authenticationauthorization by a DN-AAA server - For secondary authenticationauthorization by a DN-AAA server the SMFPGW-C runs the same procedures with PCF UDM and DN-AAA and uses the same corresponding interfaces regardless of whether the UE is served by EPS or 5GS - The interface towards the UE is different usage of NAS for EPS instead of NAS for 5GS between the EPS and 5GS cases This is further specified in Annex H of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_977",
    "document_id": "23501-i80",
    "chunk_id": 977,
    "text": "In this Release EAP based Secondary authentication by a DN-AAA server during the establishment of a PDN connection over non-3GPP access to EPC is not supported 5173 Interworking with EPC in presence of Non-3GPP PDU Sessions When a UE is simultaneously connected to the 5GC over a 3GPP access and a non-3GPP access it may have PDU Sessions associated with 3GPP access and PDU Sessions associated with non-3GPP access When inter-system handover from 5GS to EPS is performed for PDU Sessions associated with 3GPP access the PDU Sessions associated with non-3GPP access are kept anchored by the network in 5GC and the UE may either - keep PDU Sessions associated with non-3GPP access in 5GS 5GCN3IWF or TNGF ie the UE is then registered both in EPS and for non-3GPP access in 5GS or - locally or explicitly release PDU Sessions associated with non-3GPP access or - once in EPS transfer PDU Sessions associated with non-3GPP access to E-UTRAN by triggering PDN connection establishment with Request Type Handover as specified in TS 23401 26 5174 Network sharing support and interworking between EPS and 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_978",
    "document_id": "23501-i80",
    "chunk_id": 978,
    "text": "The detailed description for supporting network sharing and interworking between EPS and 5GS is described in clauses 411121 411122 411132 and 411133 of TS 23502 3 5175 Service Exposure in Interworking Scenarios 51751 General Clause 435 shows the Service Exposure Network Architecture in scenarios where for EPC-5GC Interworking is required In scenarios where interworking between 5GS and EPC is possible the network configuration is expected to associate UEs with SCEFNEF nodes for Service Capability Exposure",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_979",
    "document_id": "23501-i80",
    "chunk_id": 979,
    "text": "The SCEFNEF hides the underlying 3GPP network topology from the AF eg SCSAS and hides whether the UE is served by 5GC or EPC If the service exposure function that is associated with a given service for a UE is configured in the UEs subscription information then an SCEFNEF identity shall be used to identify the exposure function For example if a UE is capable of switching between EPC and 5GC then the SCEF ID that is associated with any of the UEs APN configurations should point to an SCEFNEF node For external exposure of services related to specific UEs the SCEFNEF resides in the HPLMN Depending on operator agreements the SCEFNEF in the HPLMN may have interfaces with NFs in the VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_980",
    "document_id": "23501-i80",
    "chunk_id": 980,
    "text": "The SCEFNEF exposes over N33 the same API as the SCEF supports over T8 If CAPIF is not supported the AF is locally configured with the API termination points for each service If CAPIF is supported the AF obtains the service API information from the CAPIF core function via the Availability of service APIs event notification or Service Discover Response as specified in TS 23222 64",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_981",
    "document_id": "23501-i80",
    "chunk_id": 981,
    "text": "The common state information shall be maintained by the combined SCEFNEF node in order to meet the external interface requirements of the combined node The common state information includes at least the following data that needs to be common for the SCEF and NEF roles of SCEFNEF - SCEFNEF ID must be the same towards the AF - SCEFNEF common IP address and port number - Monitoring state for any ongoing monitoring request - Configured set of APIs supported by SCEF NEF - PDN ConnectionPDU Session State and NIDD Configuration Information including Reliable Data Service state information - Network Parameter Configuration Information eg Maximum Response Time and Maximum Latency The SCEFNEF need not perform the same procedures for the configuration of monitoring events towards the HSSUDM twice",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_982",
    "document_id": "23501-i80",
    "chunk_id": 982,
    "text": "For example if the HSSUDM is deployed as a combined node a monitoring event only need to be configured by the SCEFNEF just once The SCEFNEF may configure monitoring events applicable to both EPC and 5GC using only 5GC procedures towards UDM In this case the SCEFNEF shall indicate that the monitoring event is also applicable to EPC ie the event must be reported both by 5GC and EPC and may include a SCEF address ie if the event needs to be configured in a serving node in the EPC and the corresponding notification needs to be sent directly to the SCEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_983",
    "document_id": "23501-i80",
    "chunk_id": 983,
    "text": "If the HSS and UDM are deployed as separate network entities UDM shall use HSS services to configure the monitoring event in EPC as defined in TS 23632 102 The UDM shall return an indication to SCEFNEF of whether the configuration of the monitoring event in EPC was successful In the case that the UDM reports that the configuration of a monitoring event was not possible in EPC then the SCEFNEF may configure the monitoring event using EPC procedures via the HSS as defined in TS 23682 36 NOTE 1 The SCEFNEF uses only 5GC procedures to configure monitoring events in EPC and 5GC NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_984",
    "document_id": "23501-i80",
    "chunk_id": 984,
    "text": "In terms of the CAPIF the SCEFNEF is considered a single node 51752 Support of interworking for Monitoring Events 517521 Interworking with N26 interface In addition to the interworking principles documented in clause 51722 the following applies for interworking with N26 - When UE moves from EPS to 5GS when the AMF registers in UDM if no event subscription via UDM is available the AMF indicates the situation to the UDM and in this case the UDM can decide if the event subscriptions should be provisioned otherwise if the AMF has event subscription information after the registration procedure is completed the AMF may inform the UDM of the currently subscribed events and UDM will do synchronization if needed - When UE moves from 5GS to EPS the MME gets monitoring event configuration from HSS during as part of mobility procedure as specified in clause 411132 of TS 23502 3 517522 Interworking without N26 interface In addition to the interworking principles documented in clause 51723 the additional behaviour at EPS to 5GS mobility in clause 517521 also applies When SCEFNEF performs the procedure of monitoring via the AMF as described in clause 415324 Exposure with bulk subscription in TS 23502 3 if the AMF determines the interworking without N26 interface is supported during mobility from 5GS to EPS the AMF shall subscribe on behalf of SCEFNEF for UDMHSS notification of MME ID as described in clause 712 to trigger the SCEFNEF to configure the monitoring request to the new MME For single-registration mode when UEs mobility from 5GS to EPS happens and Serving MME sends Update Location Request to the UDMHSS the UDMHSS provides Serving MME ID to the SCEFNEF which is the notification endpoint based on the subscription request from AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_985",
    "document_id": "23501-i80",
    "chunk_id": 985,
    "text": "Then the SCEFNEF performs the procedure of configuring monitoring via the MME for the same Monitoring Events as described in clause 5621 of TS 23682 36 When SCEFNEF performs the procedure of monitoring via the UDMHSS as described in clause 415322 of TS 23502 3 when UEs mobility between 5GS and EPS happens the UDMHSS performs the procedure of configuring monitoring at the MME as described in clause 5611 of TS 23682 36 and at the AMF as described in clause 415321 of TS 23502 3 51753 Availability or expected level of a service API A service related with common north-bound API may become unavailable due to UE being served by a CN node not supporting the service If the availability or expected level of support of a service API associated with a UE changes for example due to a mobility between 5GC and EPC the AF shall be made aware of the change NOTE 1 If CAPIF is supported and the service APIs become unavailable for the 5GC or EPC network the AF obtains such information from the CAPIF core function If the SCEFNEF receives the subscription request from the AF for the availability or expected level of support of a service API the SCEFNEF subscribes a CN Type Change event for the UE or Group of UEs to the HSSUDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_986",
    "document_id": "23501-i80",
    "chunk_id": 986,
    "text": "If the HSSUDM receives the subscription for CN Type Change event the HSSUDM includes the latest CN type for the UE or Group of UEs in the response for the subscription If the HSSUDM detects that the UE switches between being served by the MME and the AMF the CN Type Change event is triggered and the HSSUDM notifies the latest CN type for the UE or Group of UEs to the SCEFNEF Based on the CN type information the SCEFNEF can determine the availability or expected level of support of a given service The AF will be informed of such information via a subscriptionnotification service operation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_987",
    "document_id": "23501-i80",
    "chunk_id": 987,
    "text": "The AF can subscribe for the availability or expected level of support of a service API with report type indicating either One-time report or Continuous report If there is no CN type information for the UE in the SCEFNEF the SCEFNEF subscribes monitoring event for a new CN Type Change event for the UE or Group of UEs to the HSSUDM otherwise SCEFNEF determines the CN type locally in the following conditions - If the AF subscribes with report type indicating One-time report the SCEFNEF may consider the Freshness Timer of the latest CN type information for the UE or Group of UEs The Freshness Timer is a parameter that is configured based on local SCEFNEF policy When a subscription request with One-time report type is received the SCEFNEF checks if there is the latest CN type information received from the HSSUDM for the indicated UE ID or External Group ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_988",
    "document_id": "23501-i80",
    "chunk_id": 988,
    "text": "If the elapsed time for the CN type information since the last reception is less than the Freshness Timer then the SCEFNEF may respond to the AF with the latest CN type information in order to avoid repeated query to HSSUDM - The SCEFNEF has established a direct connection with MME or AMF or SMF When the UE or all members of a Group of UEs are being served by a MME EPC is determined as CN type When the UE or all members of a Group of UEs are being served by an AMF 5GC is determined as CN type When the UE is registered both in EPC and 5GC or some members of a Group of UEs are registered in EPC while some members are registered in 5GC 5GCEPC is determined as CN type NOTE 2 If 5GCEPC is determined as the CN type serving the UE or the group of UEs the SCEFNEF determines that service APIs for both 5GC and EPC are available to the UE or the group of UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_989",
    "document_id": "23501-i80",
    "chunk_id": 989,
    "text": "5176 Void 5177 Configuration Transfer Procedure between NG-RAN and E-UTRAN 51771 Architecture Principles for Configuration Transfer between NG-RAN and E-UTRAN The purpose of the Configuration Transfer between NG-RAN and E-UTRAN is to enable the transfer the RAN configuration information between the gNB and eNodeB via MME and AMF In order to make the information transparent for the MME and AMF the information is included in a transparent container The source and target RAN node addresses which allows the Core Network nodes to route the messages The mechanism depicted in Figure 51771-1 Figure 51771-1 Configuration Transfer between gNB and E-UTRAN basic network architecture The NG-RAN transparent containers are transferred from the source NG-RAN node to the destination E-UTRAN node and vice versa by use of Configuration Transfer messages An ENB Configuration Transfer message is used from the E-UTRAN node to the MME over S1 interface as described in TS 36413 100 the destination RAN node includes the en-gNB Identifier and may include a TAI associated with the en-gNB",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_990",
    "document_id": "23501-i80",
    "chunk_id": 990,
    "text": "If MME is aware that the en-gNB serves cells which provide access to 5GC the MME relays the request towards a suitable AMF via inter-system signalling based on a broadcast 5G TAC An AMF Configuration Transfer message is used from the AMF to the NG-RAN over N2 interface A Configuration Transfer message is used by the gNB node to the AMF over N2 interface for the reply and a Configuration Transfer Tunnel message is used to tunnel the transparent container from AMF to MME over the N26 interface MME relays this reply to the target eNB using a MME CONFIGURATION TRANSFER message Transport of the RAN containers in E-UTRAN is specified in TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_991",
    "document_id": "23501-i80",
    "chunk_id": 991,
    "text": "Each Configuration Transfer message carrying the transparent container is routed and relayed independently by the core network nodes Any relation between messages is transparent for the AMF and MME ie a requestresponse exchange between applications for example SON applications is routed and relayed as two independent messages by the AMF and MME 51772",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_992",
    "document_id": "23501-i80",
    "chunk_id": 992,
    "text": "Addressing routing and relaying 517721 Addressing All the Configuration Transfer messages contain the addresses of the source and destination RAN nodes An gNB node is addressed by the Target NG-RAN node identifier as described in TS 38413 34 An eNodeB is addressed by the Target eNodeB identifier as described in TS 36413 100 517722 Routing The source RAN node sends a message to its core network node including the source and destination addresses MME uses the destination address to route the message to the correct AMF via N26 interface AMF uses the destination address to route the message to the correct MME via N26 interface The AMF connected to the destination RAN node decides which RAN node to send the message to based on the destination address The MME connected to the destination RAN node decides which RAN node to send the message to based on the destination address 517723 Relaying The AMF performs relaying between N2 and N26 messages as described in TS 38413 34 and TS 29274 101",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_993",
    "document_id": "23501-i80",
    "chunk_id": 993,
    "text": "The MME performs relaying between S1 and N26 message as described in TS 36413 100 and TS 29274 101 5178 URSP Provisioning in EPS When the UE registers in 5GS the UE includes the Indication of URSP Provisioning Support in EPS in the UE Policy Container carried in Registration Request On receiving this indication in the UE Policy Container the PCF will enable the provisioning of the URSP to UE in EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_994",
    "document_id": "23501-i80",
    "chunk_id": 994,
    "text": "The UE may include the indication of URSP Provisioning Support in EPS in PCO or ePCO to the SMFPGW-C during - Initial Attach with default PDN connection establishment according to clause 5321 of TS 23401 26 - Any UE requested PDN connectivity request to an additional PDN according to clause 5102 of TS 23401 26 - Any UE requested bearer resource modification procedure according to clause 545 of TS 23401 26 If the SMFPGW-C receives the indication of URSP Rule provisioning in EPS from the UE and it supports URSP provisioning in EPS it provides the Indication of URSP Provisioning Support in EPS in ePCO in the Create Session Response message to the UE The UE may also include the indication of URSP Provisioning Support in EPS in ePCO in the UE Requested PDU Session Establishment procedure according to clause 6412 of TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_995",
    "document_id": "23501-i80",
    "chunk_id": 995,
    "text": "If the SMFPGW-C receives the indication of URSP Rule provisioning in EPS from the UE and the network supports URSP provisioning in EPS it provides the Indication of URSP Provisioning Support in EPS in ePCO in the PDU Session Establishment Accept message to the UE see clause 6413 of TS 24501 47 Then the UE and the SMFPGW-C considers that the PDU Session is associated with the URSP provisioning in EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_996",
    "document_id": "23501-i80",
    "chunk_id": 996,
    "text": "The SMFPGW-C provides the Indication of URSP Provisioning Support in EPS to the PCF during the SM Policy Association Establishment procedure When the UE receives an indication of URSP provisioning support in EPS in the PDN Connectivity Accept message or in PDU Session Establishment Accept and this PDN connection or the corresponding transferred PDN connection is not released then for any subsequent PDN connectivity requests the UE does not include an indication of URSP Provisioning Support in EPS When the UE receives the Indication of URSP Provisioning Support in EPS included in ePCO in the PDN Connectivity Accept message then the UE initiates the UE requested bearer resource modification with or without QoS update procedure and includes the UE Policy Container ePCO in the Request Bearer Resource Modification message the UE Policy Container in ePCO will be further forwarded by MME to SMFPGW-C When the UE Policy Container ePCO is received by SMFPGW-C it forwards transparently the UE Policy Container to PCF for the PDU Session then the PCF for the PDU Session establishes the UE Policy Association with PCF for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_997",
    "document_id": "23501-i80",
    "chunk_id": 997,
    "text": "The PCF for the UE generates the corresponding URSP rules in a similar way as it is done in 5GS and sends the URSP rules to UE in the UE Policy Container as described in clause 4110a5 of TS 23502 3 If the PDN connection which is used for the exchange of UE Policy Container for URSP provisioning is released the PCF for the PDU Session terminates the SM Policy Association which then triggers the release of the UE Policy Association with PCF for the UE see clause 4110a2a8 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_998",
    "document_id": "23501-i80",
    "chunk_id": 998,
    "text": "The UE may use the Request Bearer Resource Modification message over another PDN connection to include the Indication of URSP Provisioning Support in EPS If the UE receives Indication of URSP Provisioning Support in EPS included in ePCO then the UE sends a UE requested bearer resource modification with or without QoS update procedure and includes the UE Policy Container ePCO in the Request Bearer Resource Modification message This triggers the establishment of the UE Policy Association the UE may receive URSP rules in this PDN connection NOTE 1 The UE includes the Indication of URSP Provisioning Support in EPS in PCO or ePCO in the PDN connectivity request according to clause 6611 of TS 24301 13 NOTE 2 The MME and Serving-GW can be configured to prioritize the selection of a SMFPGW-C that support URSP Rule provisioning in EPS NOTE 3 When URSP provisioning in EPS is required the network deployment ensures that the MME supports ePCO",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_999",
    "document_id": "23501-i80",
    "chunk_id": 999,
    "text": "If the UE does not receive the Indication of URSP Provisioning Support in EPS in ePCO in the PDN Connectivity Accept message then the UE does not initiate the UE requested bearer resource modification procedure to send the UE Policy Container The UE may include an indication of URSP Provisioning Support in EPS in a subsequent PDN connectivity request The PDN Connection used by UE and SMFPGW-C to convey UE Policy Container PCO shall be kept when the UE is in the CONNECTED mode When the UE is attached to EPS the PCF for the PDU Session retrieves the PCRTs for UE Policy from PCF for the UE and subscribes to the applicable PCRTs to SMFPGW-C The PCF for the PDU Session may send the UE Policy Container in the same PDN connection in which the UE Policy Container was received or in any additional PDN connection established with a SMFPGW-C supporting URSP delivery in EPS During EPS to 5GS mobility with N26 the UE Policy Association is terminated by PCF for PDU Session towards the PCF for the UE when it receives the indication of RAT type change from the SMFPGW-C The PCF for the PDU Session maintains Indication of URSP Provisioning Support in EPS while the SM Policy Association is established During 5GS to EPS mobility with N26 the PCF for the PDU Session determines whether the UE supports URSP delivery in EPS by checking the indication of URSP Provisioning Support in EPS that is locally stored If the UE and at least one of the SMFPGW-C for which the UE maintains a PDU session support URSP delivery in EPS the PCF for the PDU session establishes a UE Policy Association with the PCF for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1000",
    "document_id": "23501-i80",
    "chunk_id": 1000,
    "text": "The PCF for the PDU Session discovers the address of PCF for the UE serving the UE by querying BSF The PCF for the UE recovers the information about the PSI list in the UE and the subscribed PCRTs in 5GS from former UE Policy Association for the UE after receiving the UE Policy Association Establishment request including a UE Policy Container only including an indication about the trigger for the UE Policy Association Establishment 5GS to EPS mobility After the 5GS to EPS mobility if PCF for the UE needs to provision the URSP to UE the PCF for the UE sends the UE Policy Container in Npcf_UEPolicyControl_UpdateNotify Request to the PCF for the PDU Session as described in clause 4110a2a10 of TS 23502 3 In case there are more than one PDN connections for the UE then the PCF for the PDU Session selects any of the ongoing PDN Connections via a SMFPGW-C supporting URSP delivery in EPS for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1001",
    "document_id": "23501-i80",
    "chunk_id": 1001,
    "text": "Then via the selected PDN Connection the SMFPGW-C sends the UE Policy Container via ePCO to UE by initiating the PDN GW initiated bearer modification without QoS update procedure as defined in clause 543 of TS 23401 26 NOTE 4 At 5GS to EPS mobility with N26 the guard timer in the AMF as specified in clauses 411121 and 411132 of TS 23502 3 ensures that the UE Policy Association remains until the PCF for the UE detects that a UE Policy Association establishment is received from a PCF for the PDU Session indicating 5GS to EPS mobility NOTE 5 In the case that the UE is still registered and reachable over non-3GPP access the PCF for UE can have two UE policy associations for one UE and based on local configuration the PCF can decide to use one of the UE policy associations to update URSP rule to the UE The UE can receive URSP Rules over any of these two accesses NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1002",
    "document_id": "23501-i80",
    "chunk_id": 1002,
    "text": "In the case that during the 5GS to EPS mobility there are more than one PCF for the PDU session maintaining PDN connections for the UE every involved PCF for the PDU session can establish a UE Policy Association towards the PCF for the UE In such case when the PCF for the UE needs to provision the URSP to UE the PCF for the UE first selects one of those UE Policy Associations for the delivery of URSP rules to the UE in EPS When the UE moves from 5GS to EPS the PDN connection corresponding to a PDU Session supporting URSP provisioning in EPS is considered as supporting URSP provisioning in EPS When the UE moves from EPC to 5GS the PDU Session corresponding to a PDN connection supporting URSP provisioning in EPS is considered as supporting URSP provisioning in EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1003",
    "document_id": "23501-i80",
    "chunk_id": 1003,
    "text": "The UE can receive ePCO with UE Policy Container over any of the established PDN connections and then response over the same PDN connection When the PCF for the UE decides to update the URSPs in the UE via EPS the PCF for the UE sends the updated URSP rules in UE Policy Container to the PCF for the PDU Session then the PCF for the PDU Session forwards it to the SMFPGW-C The SMFPGW-C transfers the received UE Policy Container via ePCO to the UE by triggering PDN-GW initiated Bearer without QoS Modification procedure as described in clause 543 of TS 23401 26",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1004",
    "document_id": "23501-i80",
    "chunk_id": 1004,
    "text": "After update the UE policy provided by the PCF the UE response about the delivery result via ePCO to the network The SMFPGW-C transparently forwards the UE response to the PCF for the PDU Session via Update Bearer Response message and then the PCF for the PDU Session forwards it to the PCF for the UE via Npcf_UEPolicyControl_Update Request If the SMFPGW-C receives a rejection for Update Bearer Request message eg due to paging failure the delivery failure result is sent to PCF for the PDU Session and the PCF for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1005",
    "document_id": "23501-i80",
    "chunk_id": 1005,
    "text": "To request to forward the result of delivery of UE policies Result of UE Policy Container delivery via EPS PCRT is applied to the PCF for the PDU Session and the SMFPGW-C as described in clause 4110a2a10 of TS 23502 3 518 Network Sharing 5181 General concepts A network sharing architecture shall allow multiple participating operators to share resources of a single shared network according to agreed allocation schemes The shared network includes a radio access network The shared resources include radio resources The shared network operator allocates shared resources to the participating operators based on their planned and current needs and according to service level agreements In this Release of the specification only the 5G Multi-Operator Core Network 5G MOCN network sharing architecture in which only the RAN is shared in 5G System is supported 5G MOCN for 5G System including UE RAN and AMF shall support operators ability to use more than one PLMN ID ie with same or different country code MCC some of which is specified in TS 23122 17 and different network codes MNC or combinations of PLMN ID and NID 5G MOCN supports NG-RAN Sharing with or without multiple Cell Identity broadcast as described in TS 38300 27 5G MOCN also supports the following sharing scenarios involving non-public networks ieNG-RAN can be shared by any combination of PLMNs PNI-NPNs with CAG and SNPNs each identified by PLMN ID and NID NOTE 1 PNI-NPNs without CAG are not explicitly listed above as it does not require additional NG-RAN sharing functionality compared to sharing by one or multiple PLMNs In all non-public network sharing scenarios each Cell Identity as specified in TS 38331 28 is associated with one of the following configuration options - one or multiple SNPNs - one or multiple PNI-NPNs with CAG or - one or multiple PLMNs only NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1006",
    "document_id": "23501-i80",
    "chunk_id": 1006,
    "text": "This allows the assignment of multiple cell identities to a cell and also allows the cell identities to be independently assigned ie without need for coordination by the network sharing partners between PLMNs andor non-public networks NOTE 3 Different PLMN IDs or combinations of PLMN ID and NID can also point to the same 5GC When same 5GC supports multiple SNPNs identified by PLMN ID and NID it is up to the operators policy whether they are used as equivalent SNPNs for a UE NOTE 4 There is no standardized mechanism to avoid paging collisions if the same 5G-S-TMSI is allocated to different UEs by different PLMNs or SNPNs of the shared network as the risk of paging collision is assumed to be very low If such risk is to be eliminated then PLMNs and SNPNs of the shared network needs to coordinate the value space of the 5G-S-TMSI to differentiate the PLMNs and SNPNs of the shared network Figure 5181-1 A 5G Multi-Operator Core Network 5G MOCN in which multiple CNs are connected to the same NG-RAN 5182 Broadcast system information for network sharing If a shared NG-RAN is configured to indicate available networks PLMNs andor SNPNs for selection by UEs each cell in the shared radio access network shall in the broadcast system information include available core network operators in the shared network The Broadcast System Information broadcasts a set of PLMN IDs andor PLMN IDs and NIDs and one or more additional set of parameters per PLMN eg cell-ID Tracking Areas CAG Identifiers All 5G System capable UEs that connect to NG-RAN support reception of multiple PLMN IDs and per PLMN specific parameters All SNPN-enabled UEs support reception of multiple combinations of PLMN ID and NID and SNPN-specific parameters The available core network operators PLMNs andor SNPNs shall be the same for all cells of a Tracking Area in a shared NG-RAN network UEs not set to operate in SNPN access mode decode the broadcast system information and take the information concerning available PLMN IDs into account in PLMN and cell re-selection procedures UEs set to operate in SNPN access mode decode the broadcast system information and take the information concerning available PLMN IDs and NIDs into account in network and cell re-selection procedures Broadcast system information is specified in TS 38331 28 for NR TS 36331 51 for E-UTRA and related UE access stratum idle mode procedures in TS 38304 50 for NR and TS 36304 52 for E-UTRA 5182a PLMN list and SNPN list handling for network sharing The AMF prepares lists of PLMN IDs or SNPN IDs suitable as target PLMNs or target SNPNs for use at idle mode cell reselection and for use at handover and RRC Connection Release with redirection The AMF - provides the UE with the list of PLMNs or list of SNPNs that the UE shall consider as Equivalent to the serving PLMN or the serving SNPN see TS 23122 17 and - provides the NG-RAN with a prioritised list of permitted PLMNs or a prioritized list of permitted SNPNs When prioritising these PLMNs or SNPNs the AMF may consider the following information HPLMN of the UE or the subscribed SNPN of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1007",
    "document_id": "23501-i80",
    "chunk_id": 1007,
    "text": "the serving PLMN or the serving SNPN a preferred target PLMN eg based on last used EPS PLMN or a preferred target SNPN or the policies of the operators For a UE registered in an SNPN the AMF shall not provide a list of equivalent PLMNs to the UE and shall not provide a list of permitted PLMNs to NG-RAN For a UE registered in a PLMN the AMF shall not provide a list of equivalent SNPNs to the UE and shall not provide a list of permitted SNPNs to NG-RAN 5183 Network selection by the UE NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1008",
    "document_id": "23501-i80",
    "chunk_id": 1008,
    "text": "This clause applies to UEs not operating in SNPN access mode Network selection for UEs set to operate in SNPN access mode is described in clause 53024 A UE that has a subscription to one of the sharing core network operators shall be able to select this core network operator while within the coverage area of the shared network and to receive subscribed services from that core network operator Each cell in shared NG-RAN shall in the broadcast system information include the PLMN-IDs concerning available core network operators in the shared network When a UE performs an Initial Registration to a network one of available PLMNs shall be selected to serve the UE UE uses all the received broadcast PLMN-IDs in its PLMN reselection processes which is specified in TS 23122 17 UE shall inform the NG-RAN of the selected PLMN so that the NG-RAN can route correctly The NG-RAN shall inform the core network of the selected PLMN As per any network after Initial Registration to the shared network and while remaining served by the shared network the network selection procedures specified in TS 23122 17 may cause the UE to perform a reselection of another available PLMN UE uses all of the received broadcast PLMN-IDs in its cell and PLMN reselection processes 5184 Network selection by the network The NG-RAN uses the selected PLMNSNPN provided by the UE at RRC establishment or provided by the AMFsource NG-RAN at N2Xn handover to select target cells for future handovers and radio resources in general appropriately The network should not move the UE to another available PLMNSNPN eg by handover as long as the selected PLMNSNPN is available to serve the UEs location In the case of handover or network controlled release to a PLMN in a shared network - When multiple PLMN IDs are broadcasted in a cell selected by NG-RAN NG-RAN shall select a target PLMN taking into account the prioritized list of PLMN IDs provided via Mobility Restriction List from AMF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1009",
    "document_id": "23501-i80",
    "chunk_id": 1009,
    "text": "For Xn based HO procedure Source NG-RAN indicates the selected PLMN ID to the target NG-RAN see TS 38300 27 - For N2 based HO procedure the NG-RAN indicates a selected PLMN ID to the AMF as part of the TAI sent in the HO required message Source AMF uses the TAI information supplied by the source NG-RAN to select the target AMFMME The source AMF should forward the selected PLMN ID to the target AMFMME The target AMFMME indicates the selected PLMN ID to the target NG-RANeNB so that the target NG-RANeNB can select target cells for future handover appropriately - For RRC connection release with redirection to E-UTRAN procedure NG-RAN decides the target network by using PLMN information as defined in the first bullet A change in serving PLMN is indicated to the UE as part of the UE registration with the selected network via 5G-GUTI in 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1010",
    "document_id": "23501-i80",
    "chunk_id": 1010,
    "text": "In the case of handover or network controlled release to an SNPN in a shared network the following applies - When multiple SNPN IDs are broadcasted in a cell selected by NG-RAN NG-RAN shall select a target SNPN taking into account the prioritized list of SNPN IDs provided via Mobility Restriction List from AMF - For Xn based HO procedure Source NG-RAN indicates the selected SNPN ID to the target NG-RAN see TS 38300 27 - For N2 based HO procedure the NG-RAN indicates a selected SNPN ID to the AMF together with the TAI sent in the HO required message Source AMF uses the selected SNPN ID together with the TAI information supplied by the source NG-RAN to select the target AMF The source AMF should forward the selected SNPN ID to the target AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1011",
    "document_id": "23501-i80",
    "chunk_id": 1011,
    "text": "The target AMF indicates the selected SNPN ID to the target NG-RAN so that the target NG-RAN can select target cells for future handover appropriately A change in serving SNPN is indicated to the UE as part of the UE registration with the selected network 5185 Network Sharing and Network Slicing As defined in clause 5151 a Network Slice is defined within a PLMN or SNPN Network sharing is performed among different PLMNs andor SNPNs In the case of network sharing each PLMN or SNPN sharing the NG-RAN defines and supports its PLMN- or SNPN- specific set of slices that are supported by the common NG-RAN 519 Control Plane Load Control Congestion and Overload Control 5191 General In order to ensure that the network functions within 5G System are operating under nominal capacity for providing connectivity and necessary services to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1012",
    "document_id": "23501-i80",
    "chunk_id": 1012,
    "text": "Thus it supports various measures to guard itself under various operating conditions eg peak operating hour extreme situations It includes support for load re-balancing overload control and NAS level congestion control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1013",
    "document_id": "23501-i80",
    "chunk_id": 1013,
    "text": "A 5GC NF is considered to be in overload when it is operating over its nominal capacity resulting in diminished performance including impacts to handling of incoming and outgoing traffic 5192 TNLA Load Balancing and TNLA Load Re-Balancing AMF can support load balancing and re-balancing of TNL associations between 5G-AN and AMF by using mechanisms specified in clause 5211 5193 AMF Load Balancing The AMF Load Balancing functionality permits UEs that are entering into an AMF RegionAMF Set to be directed to an appropriate AMF in a manner that achieves load balancing between AMFs This is achieved by setting a Weight Factor for each AMF such that the probability of the 5G-AN selecting an AMF is proportional to Weight Factor of the AMF The Weight Factor is typically set according to the capacity of an AMF node relative to other AMF nodes The Weight Factor is sent from the AMF to the 5G-AN via NGAP messages see TS 38413 34 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1014",
    "document_id": "23501-i80",
    "chunk_id": 1014,
    "text": "An operator may decide to change the Weight Factor after the establishment of NGAP connectivity as a result of changes in the AMF capacities eg a newly installed AMF may be given a very much higher Weight Factor for an initial period of time making it faster to increase its load NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1015",
    "document_id": "23501-i80",
    "chunk_id": 1015,
    "text": "It is intended that the Weight Factor is NOT changed frequently eg in a mature network changes on a monthly basis could be anticipated eg due to the addition of 5G-AN or 5GC nodes NOTE 3 Weight Factors for AMF Load Balancing are associated with AMF Names Load balancing by 5G-AN node is only performed between AMFs that belong to the same AMF set ie AMFs with the same PLMN AMF Region ID and AMF Set ID value The 5G-AN node may have their Load Balancing parameters adjusted eg the Weight Factor is set to zero if all subscribers are to be removed from the AMF which will route new entrants to other AMFs within an AMF Set 5194 AMF Load Re-Balancing The AMF load re-balancing functionality permits cross-section of its subscribers that are registered on an AMF within an AMF Set to be moved to another AMF within the same AMF set with minimal impacts on the network and end users AMF may request some or all of the 5G-AN nodes to redirect a cross-section of UEs returning from CM-IDLE state to be redirected to another AMF within the same AMF set if the 5G-AN is configured to support this The AMF may request some or all of the 5G-AN nodes to redirect the UEs served by one of its GUAMIs to a specific target AMF within the same AMF set or to any different AMF within the same AMF set When indicating a specific target AMF the AMF should ensure that the load re-balancing will not cause overload in the target AMF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1016",
    "document_id": "23501-i80",
    "chunk_id": 1016,
    "text": "This requirement can be fulfilled by the AMF itself or by the OAM For UEs in CM-IDLE state when UE subsequently returns from CM-IDLE state and the 5G-AN receives an initial NAS message with a 5G S-TMSI or GUAMI pointing to an AMF that requested for redirection the 5G-AN should select the specific target AMF provided by the original AMF or a different AMF from the same AMF set and forward the initial NAS message For UEs in CONNECTED mode similar mechanisms for AMF Management can be used to move the UE to another AMF in the same AMF set as described in clause 5212 except that the old AMF deregisters itself from NRF The newly selectedtarget AMF which is now the serving AMF will re-assign the GUTI using its own GUAMIs to the UEs It is not expected that the 5G-AN node rejects any request or enables access control restriction when it receives a request for redirection for load control from the connected AMFs When the AMF wants to stop redirection the AMF can indicate that it can serve all UEs in CM-IDLE state to stop the redirection NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1017",
    "document_id": "23501-i80",
    "chunk_id": 1017,
    "text": "An example use for the AMF load re-balancing functionality is for the AMF to pro-actively re-balance its load prior to reaching overload ie to prevent overload situation NOTE 2 Typically AMF Load Re-Balancing is not needed when the AMF becomes overloaded because the Load Balancing function should have ensured that the other AMFs within the AMF Set are similarly overloaded 5195 AMF Control Of Overload 51951 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1018",
    "document_id": "23501-i80",
    "chunk_id": 1018,
    "text": "The AMF shall contain mechanisms for avoiding and handling overload situations This includes the following measures - N2 overload control that could result in RRC reject RRC Connection Release and unified access barring - NAS congestion control 51952 AMF Overload Control Under unusual circumstances if AMF has reached overload situation the AMF activates NAS level congestion control as specified in Clause 5197 and AMF restricts the load that the 5G-AN nodes are generating if the 5G-AN is configured to support overload control N2 overload control can be achieved by the AMF invoking the N2 overload procedure see TS 38300 27 and TS 38413 34 to all or to a proportion of the 5G-AN nodes with which the AMF has N2 connections The AMF may include the S-NSSAIs in NGAP OVERLOAD START message sent to 5G-AN nodes to indicate the Network Slices with which NAS signalling is to be restricted To reflect the amount of load that the AMF wishes to reduce the AMF can adjust the proportion of 5G-AN nodes which are sent NGAP OVERLOAD START message and the content of the overload start procedure When NGAP OVERLOAD START is sent by multiple AMFs or from the same AMF set in the same PLMN towards the 5G-AN it should be ensured that the signalling load is evenly distributed within the PLMN and within each AMF set A 5G-AN node supports restricting of 5G-AN signalling connection when a signalling connection establishment are attempted by certain UEs which are registered or attempting to register with the 5GC as specified in TS 38331 28 and TS 36331 51 Additionally a 5G-AN node provides support for the barring of UEs as described in TS 22261 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1019",
    "document_id": "23501-i80",
    "chunk_id": 1019,
    "text": "These mechanisms are further specified in TS 38331 28 and TS 36331 51 For 3GPP Access Type the signalling connection establishment attempt includes a RRC Connection Resume procedure from RRC_INACTIVE By sending the NGAP OVERLOAD START message the AMF can request the 5G-AN node to apply the following behaviour for UEs that the AMF is serving a Restrict 5G-AN signalling connection requests that are not for emergency not for exception reporting and not for high priority mobile originated services or b Restrict 5G-AN signalling connection requests for uplink NAS signalling transmission to that AMF c Restrict 5G-AN signalling connection requests where the Requested NSSAI at AS layer only includes the indicated S-NSSAIs in the NGAP OVERLOAD START message This applies also to RRC_INACTIVE Connection Resume procedure where the Allowed NSSAI in the stored UE context in the RAN only includes S-NSSAIs included in the NGAP OVERLOAD",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1020",
    "document_id": "23501-i80",
    "chunk_id": 1020,
    "text": "START d only permit 5G-AN signalling connection requests for emergency sessions and mobile terminated services for that AMF or e only permit 5G-AN signalling connection requests for high priority sessions exception reporting and mobile terminated services for that AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1021",
    "document_id": "23501-i80",
    "chunk_id": 1021,
    "text": "The above applies for RRC Connection Establishment procedure and RRC Connection Resume procedures over 3GPP access as well as for the UE-N3IWF connection establishment over untrusted Non-3GPP access and for the UE-TNGF connection establishment over trusted Non-3GPP access The AMF can provide a value that indicates the percentage of connection requests to be restricted in the NGAP OVERLOAD START and the 5G-AN node may consider this value for congestion control When restricting a 5G-AN signalling connection the 5G-AN indicates to the UE an appropriate wait timer that limits further 5G-AN signalling connection requests until the wait timer expires During an overload situation the AMF should attempt to maintain support for emergency services and for MPS When the AMF is recovering the AMF can either - send a NGAP OVERLOAD START message with a new percentage value that permits more connection requests to be successful or - send a NGAP OVERLOAD STOP message to the same 5G-AN nodes the NGAP OVERLOAD START was previously sent",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1022",
    "document_id": "23501-i80",
    "chunk_id": 1022,
    "text": "5196 SMF Overload Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1023",
    "document_id": "23501-i80",
    "chunk_id": 1023,
    "text": "The SMF shall contain mechanisms for avoiding and handling overload situations This can include the following measures - SMF overload control that could result in rejections of NAS requests The SMF overload control may be activated by SMF due to congestion situation at SMF eg configuration by a restart or recovery condition of a UPF or by a partial failure or recovery of a UPF for a particular UPFs Under unusual circumstances if the SMF has reached overload situation the SMF activates NAS level congestion control as specified in clause 5197 The SMF may restrict the load that the AMFs are generating if the AMF is configured to enable the overload restriction 5197 NAS level congestion control 51971 General NAS level congestion control may be applied in general ie for all NAS messages per DNN per S-NSSAI per DNN and S-NSSAI or for a specific group of UEs NAS level congestion control is achieved by providing the UE a back-off time To avoid that large amounts of UEs initiate deferred requests almost simultaneously the 5GC should select each back-off time value so that the deferred requests are not synchronized When the UE receives a back-off time the UE shall not initiate any NAS signalling with regards to the applied congestion control until the back-off timer expires or the UE receives a mobile terminated request from the network or the UE initiates signalling for emergency services or high priority access AMFs and SMFs may apply NAS level congestion control but should not apply NAS level congestion control for procedures not subject to congestion control 51972 General NAS level congestion control This clause only applies to NAS Mobility Management congestion control Under general overload conditions the AMF may reject NAS messages from UEs using any 5G-AN When a NAS request is rejected a Mobility Management back-off time may be sent by the AMF to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1024",
    "document_id": "23501-i80",
    "chunk_id": 1024,
    "text": "While the Mobility Management back-off timer is running the UE shall not initiate any NAS request except for Deregistration procedure and procedures not subject to congestion control eg high priority access emergency services and mobile terminated services After any such Deregistration procedure the back-off timer continues to run While the Mobility Management back-off timer is running the UE is allowed to perform Mobility Registration Update if the UE is already in CM-CONNECTED state If the UE receives a paging request or a NAS notification message from the AMF while the Mobility Management back off timer is running the UE shall stop the Mobility Management back-off timer and initiate the Service Request procedure or the Mobility Registration Update procedure over 3GPP access andor non-3GPP access as applicable Over non-3GPP access if the UE is in CM-IDLE state when the back-off timer is stopped it shall initiate the UE-triggered Service Request procedure as soon as it switches back to CM-CONNECTED state In order to allow the UE to report the PS Data Off status change in PDU Session Modification Request message the UE behaves as follows while keeping the NAS MM back-off timer running in the UE - When the UE is in CM-IDLE state and has not moved out of the Registration Area the UE is allowed to send a Service Request message with an indication that the message is exempted from NAS congestion control When the UE is in CM-IDLE mode and has moved out of the Registration Area the UE is allowed to send a Mobility Registration Update request message with a Follow-on request and with an indication that the message is exempted from NAS congestion control - When the UE is in CM-CONNECTED state the UE sends a PDU Session Modification Request with PS Data Off status change carried in UL NAS Transport message with an indication that the message is exempted from NAS congestion control When the NAS MM congestion control is activated at AMF if the UE indicates that the NAS MM message is exempted from NAS congestion control the AMF shall not reject the NAS MM message and shall forward the NAS SM message to the corresponding SMF with an indication that the NAS SM message was indicated to be exempted from NAS congestion control The SMF ensures that the NAS SM message is not subject to congestion control otherwise the SMF rejects the message eg the SMF shall reject PDU Session Modification received if it is not for Data Off status reporting The Mobility Management back-off timer shall not impact CellRATAccess Type and PLMN change CellRATTAAccess Type change does not stop the Mobility Management back-off timer The Mobility Management back-off timer shall not be a trigger for PLMN reselection or SNPN reselection The back-off timer is stopped as defined in TS 24501 47 when a new PLMN or SNPN that is not an equivalent PLMN or is not an equivalent SNPN is accessed To avoid that large amounts of UEs initiate deferred requests almost simultaneously the AMF should select the Mobility Management back-off timer value so that the deferred requests are not synchronized If the UE required to report 5GSM Core Network Capability change or the Always-on PDU Session Requested indication while the NAS MM congestion control timer was running and was unable to initiate MM signalling the UE defers the related MM signalling until the MM congestion control timer expires and initiates after the expiry of the timer In the case of a UE with scheduled communication pattern the AMF may consider the UEs communication pattern while selecting a value for the Mobility Management back-off timer so that the UE does not miss its only scheduled communication window The AMF should not reject Registration Request message for Mobility Registration Update that are performed when the UE is already in CM-CONNECTED state The AMF may reject the Service Request message and a UL NAS Transfer with a Mobility Management back-off time when the UE is already in CM-CONNECTED state If UE receives a DL NAS Transfer message from the AMF while the Mobility Management back off timer is running the UE shall stop the Mobility Management back-off timer For CM-IDLE state mobility the AMF may reject Registration Request messages for Mobility Registration Update by including a Mobility Management back off time value in the Registration Reject message If UE registered in the same PLMN for 3GPP access and non-3GPP access and receives a Mobility Management back-off time from the AMF the back-off time and corresponding start and stop is applied equally to both 3GPP access and non-3GPP access If UE registered in different PLMNs for 3GPP access and non-3GPP access respectively and receives a Mobility Management back-off time the back-off time is only applied to the PLMN that provides the time to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1025",
    "document_id": "23501-i80",
    "chunk_id": 1025,
    "text": "If the AMF rejects Registration Request messages or Service Request with a Mobility Management back-off time which is larger than the sum of the UEs Periodic Registration Update timer and the Implicit Deregistration timer the AMF should adjust the mobile reachable timer andor Implicit Deregistration timer such that the AMF does not implicitly deregister the UE while the Mobility Management back-off timer is running NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1026",
    "document_id": "23501-i80",
    "chunk_id": 1026,
    "text": "This is to minimize signalling after the Mobility Management back-off timer expires If the AMF deregisters the UE with an indication of re-registration required the UE behaviour for handling the back-off timers is as specified in TS 24501 47 51973 DNN based congestion control DNN based congestion control is designed for the purpose of avoiding and handling of NAS SM signalling congestion for the UEs with a back-off timer associated with or without a DNN regardless of the presence of an S-NSSAI Both UE and 5GC shall support the functionality to enable DNN based congestion control SMFs may apply DNN based congestion control towards the UE by rejecting PDU Session Establishment Request message or PDU Session Modification Request message except for those sent for the purpose of reporting 3GPP PS Data Off status change for a specific DNN with a running back-off timer The SMF may release PDU Sessions belonging to a congested DNN by sending a PDU Session Release Command message towards the UE with a DNN back-off timer If a DNN back-off time is set in the PDU Session Release Command message the cause value of reactivation requested shall not be set If NWDAF is deployed the SMF may make use of Session Management Congestion Control Experience analytics provided by NWDAF as defined in clause 612 of TS 23288 86 to determine back-off timer provided to UEs NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1027",
    "document_id": "23501-i80",
    "chunk_id": 1027,
    "text": "For example the SMF can apply a short back-off timer to the UEs in the list of high-experienced UEs while the SMF can apply a long back-off timer to the UEs in the list of low-experienced UEs When DNN based congestion control is activated at AMF eg configured by OAM the AMF provides a NAS Transport Error message for the NAS Transport message carrying an SM message and in the NAS Transport Error message it includes a DNN back-off timer The UE associates the received back-off time with the DNN ie no DNN DNN only which the UE included in the uplink NAS MM message carrying the corresponding NAS SM request message The UE associates the received back-off time with the DNN ie no DNN DNN only in any PLMN unless the DNN associated with the back-off timer is an LADN DNN in which case the UE only associates it to the PLMN in which the back-off time was received The UE behaves as follows when the DNN back-off timer is running - If a DNN is associated with the back-off timer the UE shall not initiate any Session Management procedures for the congested DNN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1028",
    "document_id": "23501-i80",
    "chunk_id": 1028,
    "text": "The UE may initiate Session Management procedures for other DNNs The UE shall not initiate any Session Management procedure for the corresponding APN when UE moves to EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1029",
    "document_id": "23501-i80",
    "chunk_id": 1029,
    "text": "The UE may initiate Session Management procedures for other APNs when the UE moves to EPS - If no DNN is associated with the back-off timer the UE may only initiate Session Management requests of any PDU Session Type for a specific DNN - Upon CellTAPLMNRAT change change of untrusted non-3GPP access network or change of Access Type the UE shall not stop the back-off timer - The UE is allowed to initiate the Session Management procedures for high priority access and emergency services - The UE is allowed to initiate the Session Management procedure for reporting Data Off status change to the network - If the UE receives a network initiated Session Management message other than PDU Session Release Command for the congested DNN associated to a running back-off timer the UE shall stop the back-off timer and respond to the 5GC - If the UE receives a PDU Session Release Command message for the congested DNN it shall stop the back-off timer unless it receives a new back-off time from SMF - The UE is allowed to initiate PDU Session Release procedure ie sending PDU Session Release Request message The UE shall not stop the back-off timer when the related PDU Session is released - The list above is not an exhaustive list ie more details of the above actions and further conditions if any are specified in TS 24501 47 If UE initiates one of the Session Management procedures that are exempted from NAS congestion control the UE indicates that the carried NAS SM message is exempted from NAS congestion control in the UL NAS Transport message as described in TS 24501 47 When the DNN based congestion control is activated at AMF if the UE indicates that the NAS SM message in the UL NAS Transport message is exempted from NAS congestion control the AMF shall not apply DNN based congestion control on the UL NAS Transport message and shall forward the NAS SM message to the corresponding SMF with an indication that the message was received with exemption indication The SMF evaluates whether the NAS SM message is allowed to be exempted from DNN based congestion control If it is not the SMF rejects the message eg the SMF shall reject PDU Session Modification received if it is not for Data Off status reporting The UE shall maintain a separate back-off timer for each DNN that the UE may use To avoid that large amounts of UEs initiate deferred requests almost simultaneously the 5GC should select the back-off timer value so that deferred requests are not synchronized If the UE required to report 5GSM Core Network Capability change or",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1030",
    "document_id": "23501-i80",
    "chunk_id": 1030,
    "text": "the Always-on PDU Session Requested indication while DNN based congestion control was running and was unable to initiate SM signalling the UE defers the related SM signalling until the DNN based congestion control timer expires and initiates the necessary SM signalling after the expiry of the timer The DNN based Session Management congestion control is applicable to the NAS SM signalling initiated from the UE in the Control Plane The Session Management congestion control does not prevent the UE from sending and receiving data or initiating Service Request procedures for activating User Plane connection towards the DNNs that are under Session Management congestion control 51974 S-NSSAI based congestion control S-NSSAI based congestion control is designed for the purpose of avoiding and handling of NAS signalling congestion for the UEs with back-off timer associated with or without an S-NSSAI regardless of the presence of a DNN The UE associates the received back-off time with the S-NSSAI and DNN ie no S-NSSAI and no DNN no S-NSSAI S-NSSAI only an S-NSSAI and a DNN which was included in the uplink NAS MM message carrying the corresponding NAS SM request message for the PLMN which is under congestion S-NSSAI based congestion control is applied as follows - If an S-NSSAI is determined as congested then the SMF may apply S-NSSAI based congestion control towards the UE for SM requests except for those sent for the purpose of reporting 3GPP PS Data Off status change for a specific S-NSSAI and provides a back-off time and an indication of HPLMN congestion - If the UE receives an S-NSSAI based back-off time without an indication of HPLMN congestion the UE shall apply the S-NSSAI back-off timer only in the PLMN in which the back-off time was received If the UE receives S-NSSAI based back-off time with an indication of HPLMN congestion the UE shall apply the S-NSSAI based back-off timer in the PLMN in which the back-off time was received and in any other PLMN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1031",
    "document_id": "23501-i80",
    "chunk_id": 1031,
    "text": "The SMF may release PDU Sessions belonging to a congested S-NSSAI by sending a PDU Session Release Request message towards the UE with a back-off time associated either to the S-NSSAI only ie with no specific DNN or a combination of the S-NSSAI and a specific DNN If NWDAF is deployed the SMF may make use of Session Management Congestion Control Experience analytics provided by NWDAF as defined in clause 612 of TS 23288 86 to determine back-off timer provided to UEs NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1032",
    "document_id": "23501-i80",
    "chunk_id": 1032,
    "text": "For example the SMF can apply a short back-off timer to the UEs in the list of high-experienced UEs while the SMF can apply a long back-off timer to the UEs in the list of low-experienced UEs - If S-NSSAI based congestion control is activated at AMF eg configured by OAM and an S-NSSAI is determined as congested then the AMF applies S-NSSAI based congestion control towards the UE for UE-initiated Session Management requests In this case the AMF provides a NAS Transport Error message for the NAS Transport message carrying the SM message and in the NAS Transport Error message it includes a back-off timer If NWDAF is deployed the AMF may determine that S-NSSAI is congested based on the network slice load level analytics defined in TS 23288 86 - The UE behaves as follows in the PLMN where the S-NSSAI based congestion control applies when the back-off timer is running -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1033",
    "document_id": "23501-i80",
    "chunk_id": 1033,
    "text": "If the back-off timer was associated with an S-NSSAI only ie not associated with an S-NSSAI and a DNN the UE shall not initiate any Session Management procedures for the congested S-NSSAI - If the back-off timer was associated with an S-NSSAI and a DNN then the UE shall not initiate any Session Management procedures for that combination of S-NSSAI and DNN - If the UE receives a network-initiated Session Management message other than PDU Session Release Command for the congested S-NSSAI the UE shall stop this back-off timer and respond to the 5GC - If the UE receives a PDU Session Release Command message for the congested S-NSSAI it shall stop the back-off timer unless it receives a new back-off time from SMF - Upon CellTAPLMNRAT change change of untrusted non-3GPP access network or change of Access Type the UE shall not stop the back-off timer for any S-NSSAI or any combination of S-NSSAI and DNN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1034",
    "document_id": "23501-i80",
    "chunk_id": 1034,
    "text": "The UE is allowed to initiate the Session Management procedures for high priority access and emergency services for the S-NSSAI - The UE is allowed to initiate the Session Management procedure for reporting Data Off status change for the S-NSSAI or the combination of S-NSSAI and DNN - If the back-off timer is not associated to any S-NSSAI the UE may only initiate Session Management procedures for specific S-NSSAI - If the back-off timer is not associated to any S-NSSAI and DNN the UE may only initiate Session Management procedures for specific S-NSSAI and DNN - The UE is allowed to initiate PDU Session Release procedure eg sending PDU Session Release Request message The UE shall not stop the back-off timer when the related PDU Session is released - The list above is not an exhaustive list ie more details of the above actions and further conditions if any are specified in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1035",
    "document_id": "23501-i80",
    "chunk_id": 1035,
    "text": "The UE shall maintain a separate back-off timer for each S-NSSAI and for each combination of S-NSSAI and DNN that the UE may use If UE initiates one of the Session Management procedure that are exempt from NAS congestion control the UE indicates that the carried NAS SM message is exempted from NAS congestion control in the UL NAS Transport message as described in TS 24501 47 When the S-NSSAI based congestion control is activated at AMF if the UE indicates that the NAS SM message in the UL NAS Transport message is exempted from NAS congestion control the AMF shall not apply S-NSSAI based congestion control on the UL NAS Transport message and shall forward the NAS SM message to the corresponding SMF with an indication that the message was received with exemption indication The SMF evaluates whether that the NAS SM message is allowed to be exempted from S-NSSAI based congestion control If it is not the SMF rejects the message eg the SMF shall reject PDU Session Modification received if it is not for Data Off status reporting The back-off timer associated with an S-NSSAI or a combination of an S-NSSAI and a DNN shall only apply to congestion control for Session Management procedures when UE is in 5GS To avoid that large amounts of UEs initiate deferred requests almost simultaneously the 5GC should select the value of the back-off timer for the S-NSSAI based congestion control so that deferred requests are not synchronized If the UE required to report 5GSM Core Network Capability change or the Always-on PDU Session Requested indication while S-NSSAI based congestion control timer was running and was unable to initiate SM signalling the UE defers the related SM signalling until the S-NSSAI based congestion control timer expires and initiates the necessary SM signalling after the expiry of the timer The S-NSSAI based congestion control does not prevent the UE from sending and receiving data or initiating Service Request procedure for activating User Plane connection for a PDU Session associated to the S-NSSAI that is under the congestion control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1036",
    "document_id": "23501-i80",
    "chunk_id": 1036,
    "text": "51975 Group specific NAS level congestion control The group specific NAS level congestion control applies to a specific group of UEs Group specific NAS level congestion control is performed at the 5GC only and it is transparent to UE The AMF or SMF or both may apply NAS level congestion control for a UE associated to an Internal-Group Identifier see clause 597 NOTE 5GC logic for Group specific NAS level congestion control is not described in this Release of the specification 51976 Control Plane data specific NAS level congestion control Under overload conditions the AMF may restrict requests from UEs for data transmission via Control Plane CIoT 5GS Optimisation A Control Plane data back-off timer may be returned by the AMF eg in Registration Accept messages Service Reject message or Service Accept message While the Control Plane data back-off timer is running the UE shall not initiate any data transfer via Control Plane CIoT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1037",
    "document_id": "23501-i80",
    "chunk_id": 1037,
    "text": "5GS Optimisation ie the UE shall not send any Control Plane Service Request with uplink data as defined in TS 24501 47 The AMF shall store the Control Plane data back-off timer per UE and shall not process any further requests other than exception reporting and a response to paging for Data Transport via a Control Plane Service Request from that UE while the Control Plane data back-off timer is still running NOTE 1 The Control Plane data back-off timer does not affect any other mobility management or session management procedure NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1038",
    "document_id": "23501-i80",
    "chunk_id": 1038,
    "text": "The Control Plane data back-off timer does not apply to user plane data communication If the UE is allowed to send exception reporting the UE may send an initial NAS Message for exception reporting even if Control Plane data back-off timer is running The UE may respond to paging with an initial NAS Message without uplink data even if the Control Plane data back-off timer is running If the AMF receives an initial NAS Message in reponse to a paging and the AMF has a Control Plane data back-off timer running for the UE and the AMF is not overloaded and AMF decides to accept the Control Plane Service Request then the AMF shall respond with Service Accept without the Control Plane data back-off timer and stop the Control Plane data back-off timer If the UE receives a Service Accept without the Control Plane data back-off timer from the AMF while the Control Plane data back-off timer is running the UE shall stop the Control Plane data back-off timer The Control Plane data back-off timer in the UE and the AMF is stopped at PLMN change",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1039",
    "document_id": "23501-i80",
    "chunk_id": 1039,
    "text": "If the AMF receives a Control Plane Service Request with uplink data and decides to send the UE a Control Plane data back-off timer the AMF may decide to process the Control Plane Service Request with uplink data ie decrypt and forward the data payload or not based on the following - If the UE has indicated Release Assistance Information that no further Uplink and Downlink Data transmissions are expected then the AMF may process integrity checkdecipherforward the received Control Plane data packet and send a Service Accept to the UE with Control Plane data back-off timer The UE interprets this as successful transmission of the Control Plane data packet starts the Control Plane data back-off timer -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1040",
    "document_id": "23501-i80",
    "chunk_id": 1040,
    "text": "For all other cases the AMF may decide to not process the received Control Plane data packet and send a Service Reject to the UE with Control Plane data back-off timer The UE interprets this indication as unsuccessful delivery of the control plane data packet and starts the Control Plane data back-off timer The AMF may take into consideration whether the PDU Session is set to Control Plane only to make the decision whether to reject the packet and send Service Reject or move the PDU Session to user plane and process the data packet as described in next bullet - Alternatively if UE has not provided Release Assistance Information and the PDU Session not set to Control Plane only and UE supports N3 data transfer then the AMF may initiate establishment of N3 bearer according to the procedure defined in clause 423 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1041",
    "document_id": "23501-i80",
    "chunk_id": 1041,
    "text": "In this case the AMF may also return a Control Plane data back-off timer within the Service Accept The AMF only includes the Control Plane data back-off timer if the UE has indicated support for Control Plane CIoT 5GS optimizations in the Registration Request 520 External Exposure of Network Capability The Network Exposure Function NEF supports external exposure of capabilities of network functions External exposure can be categorized as Monitoring capability Provisioning capability PolicyCharging capability Analytics reporting capability and Member UE selection capability The Monitoring capability is for monitoring of specific event for UE in 5G System and making such monitoring events information available for external exposure via the NEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1042",
    "document_id": "23501-i80",
    "chunk_id": 1042,
    "text": "The Provisioning capability is for allowing external party to provision of information which can be used for the UE in 5G System The PolicyCharging capability is for handling access and mobility management QoS and charging policies for the UE based on the request from external party The Analytics reporting capability is for allowing an external party to fetch or subscribeunsubscribe to analytics information generated by 5G System this is further defined in TS 23288 86 The Member UE selection capability is for allowing an external party to acquire one or more lists of candidate UEs among the list of target member UEs provided by the AF and additional information that is based on the assistance information generated by 5G System based on some defined filtering criteria the details are explained in clause 41513 in TS 23502 3 Monitoring capability is comprised of means that allow the identification of the 5G network function suitable for configuring the specific monitoring events detect the monitoring event and report the monitoring event to the authorised external party Monitoring capability can be used for exposing UEs mobility management context such as UE location reachability roaming status and loss of connectivity Monitoring capability can also be used for exposing QoS monitoring result AMF stores URRP-AMF information in the MM context to determine the NFs that are authorised to receive direct notifications from the AMF UDM stores URRP-AMF information locally to determine authorised monitoring requests when forwarding indirect notifications The Monitoring capability also allows AF to subscribe to the group status changes for a group either a 5G VN group as described in clause 5292 as well as a group configured by OAM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1043",
    "document_id": "23501-i80",
    "chunk_id": 1043,
    "text": "In this case the AF is notified if the group member list is updated or a group member is no longer subscribed to the group Provisioning capability allows an external party to provision the Expected UE Behaviour or the 5G-VN group information or DNN and S-NSSAI specific Group Parameters or ECS Address Configuration Information or service specific information to 5G NF via the NEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1044",
    "document_id": "23501-i80",
    "chunk_id": 1044,
    "text": "The provisioning comprises of the authorisation of the provisioning external third party receiving the provisioned external information via the NEF storing the information and distributing that information among those NFs that use it The externally provisioned data can be consumed by different NFs depending on the data In the case of provisioning the Expected UE Behaviour the externally provisioned information which is defined as the Expected UE Behaviour parameters in clause 41563 of TS 23502 3 or Network Control parameter in clause 41563a of TS 23502 3 consists of information on expected UE movement Expected UE Behaviour parameters or expected Network Configuration parameter The provisioned Expected UE Behaviour parameters may be used for the setting of mobility management or session management parameters of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1045",
    "document_id": "23501-i80",
    "chunk_id": 1045,
    "text": "In the case of provisioning the 5G-VN group information the externally provisioned information is defined as the 5G-VN group parameters in clause 41567 of TS 23502 3 and it consists of some information on the 5G-VN group In the case of the provisioning the DNN and S-NSSAI specific Group Parameters the externally provisioned information is defined in clause 415614 of TS 23502 3 and clause 520b In the case of provisioning ECS address the externally provisioned information is defined as the ECS Address Configuration Information in clause 41563d of TS 23502 3 The affected NFs are informed via the subscriber data update as specified in clause 41562 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1046",
    "document_id": "23501-i80",
    "chunk_id": 1046,
    "text": "The externally provisioned information which is defined as the Service Parameters in clause 41567 of TS 23502 3 consists of service specific information used for supporting the specific service in 5G system The provisioned Service Parameters may be delivered to the UEs The affected NFs are informed of the data update PolicyCharging capability is comprised of means that allow the request for session and charging policy enforce QoS policy apply accounting functionality and requests to influence access and mobility management policies It can be used for specific QoSpriority handling for the session of the UE and for setting applicable charging party or charging rate Analytics reporting capability is comprised of means that allow discovery of type of analytics that can be consumed by external party the request for consumption of analytics information generated by NWDAF Member UE selection capability is comprised of means that allows filtering and providing one or more lists of candidate UEs among the list of target member UEs provided by the AF and additional information that can be consumed by external party the request for consumption of UE list generated by external party An NEF may support CAPIF functions for external exposure as specified in clause 6251",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1047",
    "document_id": "23501-i80",
    "chunk_id": 1047,
    "text": "An NEF may support exposure of NWDAF analytics as specified in TS 23288 86 The NEF may support exposure of 5GS andor UE availability and capabilities for time synchronization service as specified in clause 52718 An NEF may support exposure of event based notifications and reports for NSACF as specified in clause 51511",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1048",
    "document_id": "23501-i80",
    "chunk_id": 1048,
    "text": "An AF may only be able to identify the target UE of an AF request for external exposure of 5GC capabilities eg Data Provisioning or for Event Exposure for a specific UE by providing the UEs address information In this case the NEF first needs to retrieve the Permanent identifier of the UE before trying to fulfil the AF request The NEF may determine the Permanent identifier of the UE as described in clause 4153213 of TS 23502 3 based on - the address of the UE as provided by the AF this may be an IP address or a MAC address - the corresponding DNN andor S-NSSAI information this may have been provided by the AF or determined by the NEF based on the requesting AF this is needed if the UE address is an IP address The NEF may provide a UE Identifier in the GPSI format of MSISDN to an authenticated and authorized AF - that fulfils the conditions described in clause 41510A of TS 23502 3 and - that has explicitly requested a translation from the UE address to a unique UE identifier via Nnef_UEId service when the UE MSISDN exposure is allowed and authorized by the operator or - the NEF may provide an AF specific UE Identifier to the AF - that has explicitly requested a translation from the address of the UE to a unique UE identifier via Nnef_UEId service or - that has implicitly requested a translation from the address of the UE to an AF specific UE Identifier by requesting external exposure about an individual UE identified by its address The AF may have its own means to maintain the AF specific UE Identifier through eg an AF session After the retrieval of an AF specific UE Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1049",
    "document_id": "23501-i80",
    "chunk_id": 1049,
    "text": "the AF shall not keep maintaining a mapping between this identifier and the UE IP address as this mapping may change The AF specific UE Identifier shall not correspond to a MSISDN it is represented as a GPSI in the form of an External Identifier When used as an AF specific UE identifier the External Identifier provided by the 5GCN shall be different for different AF NOTE 1 This is to protect user privacy NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1050",
    "document_id": "23501-i80",
    "chunk_id": 1050,
    "text": "The AF specific UE identifier is ensured to be unique across different AFs as defined in TS 23003 19 by configuration Such configuration is assumed to be coordinated between the different involved entities eg NEFs and UDMUDR NOTE 3 Based on policies the NEF can be configured to enforce restriction on the usage of AF specific UE identifier eg rejection of a service request from AF not authorized to use the UE identifier 520a Data Collection from an AF An NF that needs to collect data from an AF may subscribeunsubscribe to notifications regarding data collected from an AF either directly from the AF or via NEF The data collected from an AF is used as input for analytics by the NWDAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1051",
    "document_id": "23501-i80",
    "chunk_id": 1051,
    "text": "The details for the data collected from an AF as well as interactions between NEF AF and NWDAF are described in TS 23288 86 520b Support exposure of DNN and S-NSSAI specific Group Parameters 520b1 Group attribute provisioning A group may be a 5G VN group managed as defined in clause 5292 as well as a group configured by OAM An AF may provision DNN and S-NSSAI specific attributes for a group of UEs - LADN Service area which consists of Tracking Area identities or geographical information it is applicable to each UE member within the group and for a specific DNN and S-NSSAI - Default QoS the QoS refers to 5QI ARP and 5QI Priority Level as defined in clause 5727 and it is applicable to each UE member within the group and for a specific DNN and S-NSSAI 520b2 Support LADN service area for a group The procedure as defined in clause 41562 of TS 23502 3 is applicable for provisioning of LADN service area for a group with the following clarifications and enhancements -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1052",
    "document_id": "23501-i80",
    "chunk_id": 1052,
    "text": "The AF request additionally contains the LADN service area as part of DNN and S-NSSAI specific Group Parameters and the LADN service area is stored in UDR as subscription data and delivered to AMF If the AMF receives the LADN service area for a group the AMF configures the DNN of the group as LADN DNN - If the AF provides the LADN service area in the form of geographical information the NEF maps the geographical information to a list of TAs before sending the service area to the UDM LADN per DNN and S-NSSAI as defined in clause 565a is applicable for enforcement of LADN service area 520b3 Support QoS for a group The procedure as defined in clause 41562 of TS 23502 3 is applicable for provisioning of default QoS for a DNN and S-NSSAI for a group of UEs with the following clarifications and enhancements - The AF request contains the Default QoS for the group and the UDM stores such QoS in the UDR and uses such QoS to set 5GS Subscribed QoS profile in Session Management Subscription data for each UE within the group NOTE When a UE belongs to multiple groups simultaneously and AFs provision different Default QoS for the same DNN and S-NSSAI but different groups UDM selects a QoS profile among the groups the UE belongs to for a DNN and S-NSSAI to set the 5GS subscribed QoS profile How the UDM selects a QoS profile is based on implementation and configuration The UDM can eg select a QoS profile with a higher 5QI Priority Level or higher ARP priority level Mechanisms as defined in clause 5727 are used to enforce the 5GS Subscribed QoS profile for a DNN and S-NSSAI for each UE within a group 520b4 Void 520b5 Void 520c Provisioning of traffic characteristics and monitoring of performance characteristics for a group NEF provisioning capability as defined in clause 520 allows an AF to perform provisioning of traffic characteristics and monitoring of performance characteristics for a UE or group of UEs as specified in clause 415614 of TS 23502 3 and clause 61328 of TS 23503 45 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1053",
    "document_id": "23501-i80",
    "chunk_id": 1053,
    "text": "The AF may use application layer functionalities to handle requests for UE-to-UE traffic as defined by SA WG6 The NEF determines whether or not to invoke the TSCTSF in the same way as for AF session with required QoS procedure as described in step 2 of clause 41566 in TS 23502 3 In the case that the TSCTSF is used the TSCTSF receives the AF requested QoS information from the NEF and handles it as described in clause 415614 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1054",
    "document_id": "23501-i80",
    "chunk_id": 1054,
    "text": "In the case that TSCTSF is not used the AF request is handled as described in clause 415614 of TS 23502 3 and clause 61328 of TS 23503 45 When the TSCTSF receives the AF requested QoS information from NEF or the PCFs receive the AF requested QoS information from UDR the TSCTSF or PCF s manage the AF requested QoS information for each UE group member within the group as follows - TSCTSF translates the GPSI or ExternalInternal Group ID into a list of SUPIs by invoking Nudm_SDM_Get service - Determine which of these UE group members have active PDU Sessions matching the DNN and S-NSSAI and determine the relevant UE address - Manage the request status activated de-activated failed for each UE group member within the group - Apply the AF requested QoS information if the UE group member is registered or has active PDU Session matching the DNN and S-NSSAI Set the status to activated if the QoS resources are assigned for the UE group member otherwise failed - Set the status to de-activated if the UE group member is not registered or has no active PDU Session matching the DNN and S-NSSAI - Delete the request status for the UE group member if the UE group member is removed from the group and further revokes AF request QoS information if the request status is activated - Check whether to apply the AF requested QoS information and update the request status for the UE group member if the UE group member is newly added to the group - When the AF requested QoS information contains temporal invalidity condition as described in clause 61328 of TS 23503 45 - Revoke AF requested QoS information for each UE group member which is marked as active so to eg to remove or modify PCC rules as defined in clause 41652 of TS 23502 3 if the start-time is reached - Apply AF requested QoS information for each UE group member that has active PDU Sessions matching the DNN and S-NSSAI eg to add or modify PCC rules as defined in clause 41652 of TS 23502 3 if the end-time is reached 520d User Plane Direct 5GS Information Exposure 520d1 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1055",
    "document_id": "23501-i80",
    "chunk_id": 1055,
    "text": "In order to expose network information the user plane direct 5GS information exposure function may be applied The user plane direct 5GS information exposure function allows the UPF to report the network information directly to consumer based on the instructions provided by SMF NOTE In the scenario of Edge Computing as described in TS 23548 130 the consumer can be the L-NEF or local AF when the local AF is trusted When the exposed network information is provided by the UPF the PSA UPF may be instructed to report network information via Nupf_EventExposure service eg directly to an AF ie bypassing the SMF and the PCF or the UPF may be instructed to report the information to the consumer via SMFPCFNEF as described in clause 58218 When the exposed network information is provided by the NG-RAN the NG-RAN may be instructed by the SMF to report the information via the GTP-U tunnels between the NG RAN and PSA UPF as defined in clause 545",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1056",
    "document_id": "23501-i80",
    "chunk_id": 1056,
    "text": "The User Plane Direct 5GS Information Exposure may be used for exposing the following information - QoS Monitoring information see clause 545 - TSC Management Information see clause 5283 521 Architectural support for virtualized deployments 5210 General 5GC supports different virtualized deployment scenarios including but not limited to the options below - A Network Function instance can be deployed as distributed redundant stateless and scalable NF instance that provides the services from several locations and several execution instances in each location - This type of deployments would typically not require support for addition or removal of NF instances for redundancy and scalability In the case of an AMF this deployment option may use enablers like addition of TNLA removal of TNLA TNLA release and rebinding of NGAP UE association to a new TNLA to the same AMF - A Network Function instance can also be deployed such that several network function instances are present within a NF set provide distributed redundant stateless and scalability together as a set of NF instances - This type of deployments may support for addition or removal of NF instances for redundancy and scalability In the case of an AMF this deployment option may use enablers like addition of AMFs and TNLAs removal of AMFs and TNLAs TNLA release and rebinding of NGAP UE associations to a new TNLA to different AMFs in the same AMF set - The SEPP although not a Network Function instance can also be deployed distributed redundant stateless and scalable - The SCP although not a Network Function instance can also be deployed distributed redundant and scalable Also deployments taking advantage of only some or any combination of concepts from each of the above options is possible 5211 Architectural support for N2 52111 TNL associations 5G-AN node shall have the capability to support multiple TNL associations per AMF ie AMF name An AMF shall provide the 5G-AN node with the weight factors for each TNL association of the AMF The AMF shall be able to request the 5G-AN node to add or remove TNL associations to the AMF The AMF shall be able to indicate to the 5G-AN node the set of TNL associations used for UE-associated signalling and the set of TNL associations used for non-UE associated signalling NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1057",
    "document_id": "23501-i80",
    "chunk_id": 1057,
    "text": "The TNL associations indicated for UE-associated and non-UE associated signalling can either be overlap or be different 52112 NGAP UE-TNLA-binding While a UE is in CM-Connected state the 5G-AN node shall maintain the same NGAP UE-TNLA-binding ie use the same TNL association and same NGAP association for the UE unless explicitly changed or released by the AMF An AMF shall be able to update the NGAP UE-TNLA-binding ie change the TNL association for the UE in CM-CONNECTED state at any time The NGAP UE-TNLA-binding can also be updated when a UE-specific NGAP message initiated by AMF is received via a new TNL association An AMF shall be able to update the NGAP UE-TNLA-binding ie change the TNL association for the UE in response to an N2 message received from the 5G-AN by triangular redirection eg by responding to the 5G-AN node using a different TNL association An AMF shall be able to command the 5G-AN node to release the NGAP UE-TNLA-binding for a UE in CM-CONNECTED state while maintaining N3 user-plane connectivity for the UE at any time 52113 N2 TNL association selection The 5G-AN node shall consider the following factors for selecting a TNL association for the AMF for the initial N2 message eg N2 INITIAL UE MESSAGE - Availability of candidate TNL associations - Weight factors of candidate TNL associations The AMF may use any TNL association intended for non-UE associated signalling for initiation of the N2 Paging procedure 5212 AMF Management 52121",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1058",
    "document_id": "23501-i80",
    "chunk_id": 1058,
    "text": "AMF AdditionUpdate The 5G System should support establishment of association between AMF and 5G-AN node A new AMF can be added to an AMF set and association between AMF and GUAMI can be created andor updated as follows - AMF shall be able to dynamically update the NRF with the new or updated GUAMIs to provide mapping between GUAMIs and AMF information Association between GUAMIs and AMF is published to NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1059",
    "document_id": "23501-i80",
    "chunk_id": 1059,
    "text": "In addition to deal with planned maintenance and failure an AMF may optionally provide backup AMF information ie it act as a backup AMF if the indicated GUAMI associated AMF is unavailable It is assumed that the backup AMF and the original AMF are in the same AMF set as they have access to the same UE context Based on that information one GUAMI is associated with an AMF optionally with a backup AMF used for planned removal andor another same or different backup AMF used for failure - Upon successful update the NRF considers the new andor updated GUAMIs for providing AMF discovery results to the requester Requester can be other CP network functions - The new AMF provides its GUAMI to 5G-AN and 5G-AN store this association If the association between the same GUAMI and another AMF exists in the 5G-AN eg due to AMF planned removal the previously stored AMF is replaced by the new AMF for the corresponding GUAMI association Information about new AMF should be published and available in the DNS system It should allow 5G-AN to discover AMF and setup associations with the AMF required N2 setup procedure should allow the possibility of AMFs within the AMF Set to advertise the same AMF Pointer andor distinct AMF Pointer values to the 5G-AN node To support the legacy EPC core network entity ie MME to discover and communicate with the AMF the information about the AMF should be published and available in the DNS system Furthermore GUMMEI and GUAMI encoding space should be partitioned to avoid overlapping values in order to enable MME discover an AMF without ambiguity 52122 AMF planned removal procedure 521221 AMF planned removal procedure with UDSF deployed An AMF can be taken graciously out of service as follows - If an UDSF is deployed in the network then the AMF stores the context for registered UEs in the UDSF The UE context includes the AMF UE NGAP ID that is unique per AMF set In order for the AMF planned removal procedure to work graciously 5G-S-TMSI shall be unique per AMF Set",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1060",
    "document_id": "23501-i80",
    "chunk_id": 1060,
    "text": "If there are ongoing transactions eg N1 procedure for certain UEs AMF stores the UE contexts in the UDSF upon completion of an ongoing transaction - The AMF deregister itself from NRF indicating due to AMF planned removal NOTE 1 It is assumed that the UE contexts from the old AMF include all event subscriptions with peer CP NFs NOTE 2 Before removal of AMF the overload control mechanism can be used to reduce the amount of ongoing transaction An AMF identified by GUAMIs shall be able to notify the 5G-AN that it will be unavailable for processing transactions by including GUAMIs configured on this AMF Upon receipt of the indication that an AMFidentified by GUAMIs is unavailable 5G-AN shall take the following action - 5G-AN should mark this AMF as unavailable and not consider the AMF for selection for subsequent N2 transactions until 5G-AN learns that it is available eg as part of discovery results or by configuration -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1061",
    "document_id": "23501-i80",
    "chunk_id": 1061,
    "text": "During NGAP Setup procedure the AMF may include an additional indicator that the AMF will rebind or release the NGAP UE-TNLA-binding on a per UE-basis for UEs in CM-CONNECTED state If that indicator is included and the 5G-AN supports timer mechanism the 5G-AN starts a timer to control the release of NGAP UE-TNLA-binding For the duration of the timer or until the AMF releases or re-binds the NGAP UE-TNLA-binding the AN does not select a new AMF for subsequent UE transactions Upon timer expiry the 5G-AN releases the NGAP UE UE-TNLA-bindings with the corresponding AMF for the respective UEs for subsequent N2 message the 5G-AN should select a different AMF from the same AMF set when the subsequent N2 message needs to be sent NOTE 3 For UEs in CM-CONNECTED state after indicating that the AMF is unavailable for processing UE transactions and including an indicator that the AMF releases the NGAP UE-TNLA-bindings on a per UE-basis the AMF can either trigger a re-binding of the NGAP UE associations to an available TNLA on a different AMF in the same AMF set or use the NGAP UE-TNLA-binding per UE release procedure defined in TS 23502 3 to release the NGAP UE-TNLA-binding on a per UE-basis while requesting the AN to maintain N3 user plane connectivity and UE context information NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1062",
    "document_id": "23501-i80",
    "chunk_id": 1062,
    "text": "The support and the use of timer mechanism in 5G-AN is up to implementation - If the instruction does not include the indicator for UEs in CM-CONNECTED state 5G-AN considers this as a request to release the NGAP UE-TNLA-binding with the corresponding AMF for the respective UEs while maintaining N3 user plane connectivity and UE context information For subsequent N2 message the 5G-AN should select a different AMF from the same AMF set when the subsequent N2 message needs to be sent - For UEs in CM-IDLE state when it subsequently returns from CM-IDLE state and the 5G-AN receives an initial NAS message with a 5G S-TMSI or GUAMI pointing to an AMF that is marked unavailable the 5G-AN should select a different AMF from the same AMF set and forward the initial NAS message If the 5G-AN cant select an AMF from the same AMF set the 5G-AN selects another new AMF as described in clause 635 An AMF identified by GUAMIs shall be able to instruct other peer CP NFs subscribed to receive such a notification that it will be unavailable for processing transactions by including GUAMIs configured on this AMF If the CP NFs register with NRF for AMF unavailable notification then the NRF shall be able to notify the subscribed NFs to receive such a notification that AMF identified by GUAMIs will be unavailable for processing transactions Upon receipt of the notification that an AMF GUAMIs is unavailable the other CP NFs shall take the following actions - CP NF should mark this AMF identified by GUAMIs as unavailable and not consider the AMF for selection for subsequent MT transactions until the CP NF learns that it is available eg as part of NF discovery results or via NF status notification from NRF - Mark this AMF as unavailable while not changing the status of UEs associated to this AMF UEs previously served by the corresponding AMF still remain registered in the network and AMF Set information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1063",
    "document_id": "23501-i80",
    "chunk_id": 1063,
    "text": "For the UEs that were associated to the corresponding AMF when the peer CP NF needs to initiate a transaction towards the AMF that is marked unavailable CP NF should select another AMF from the same AMF set as in clause 635 and forward the transaction together with the old GUAMI The new AMF retrieves UE context from the UDSF If CP NF needs to send a notification to new AMF which is associated with a subscription from the old AMF the CP NF shall exchange the old AMF information embedded in the Notification Address with the new AMF information and use that Notification Address for subsequent communication NOTE 5 If the CP NF does not subscribe to receive AMF unavailable notification either directly from the AMF or via NRF the CP NF may attempt forwarding the transaction towards the old AMF and detect that the AMF is unavailable after certain number of attempts When it detects unavailable it marks the AMF and its associated GUAMIs as unavailable CP NF should select another AMF from the same AMF set as in clause 635 and forward the transaction together with the old GUAMI The new AMF retrieves UE context from the UDSF and process the transaction Following actions should be performed by the newly selected AMF - When there is a transaction with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1064",
    "document_id": "23501-i80",
    "chunk_id": 1064,
    "text": "the newly selected AMF retrieves the UE context from the UDSF based on SUPI 5G-GUTI or AMF UE NGAP ID and processes the UE message accordingly and updates the 5G-GUTI towards the UE if necessary For UEs in CM-CONNECTED state it may also update the NGAP UE association with a new AMF UE NGAP ID towards the 5G-AN and replace the GUAMI in the UE context stored at the 5G-AN with the new GUAMI associated with the newly selected AMF if the 5G-GUTI has been updated The AMF also informs the NG-RAN of the new UE Identity Index Value derived from the new 5G-GUTI - When there is a transaction with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1065",
    "document_id": "23501-i80",
    "chunk_id": 1065,
    "text": "the new selected AMF updates the peer NFs that subscribed to receive AMF unavailability notification from old AMF with the new selected AMF information - If the new AMF is aware of a different AMF serving the UE by implementation specific means it forwards the uplink N2 signalling of the UE to that AMF directly if necessary the 5G-AN shall be able to receive the message from a different AMF or it rejects the transaction from the peer CP NFs with a cause to indicate that new AMF has been selected the peer CP NFs resend the transaction to the new AMF NOTE 6 This bullet above addresses situations where 5G-AN node selects an AMF and CP NFs select another AMF for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1066",
    "document_id": "23501-i80",
    "chunk_id": 1066,
    "text": "concurrently It also addresses the situation where CP NFs select an AMF for the UE concurrently - If the UE is in CM-IDLE state and the new AMF does not have access to the UE context the new AMF selects one available AMF from the old AMF set as described in clause 635 The selected AMF retrieves the UE context from the UDSF and provides the UE context to the new AMF If the new AMF doesnt receive the UE context then the AMF may force the UE to perform Initial Registration 521222 AMF planned removal procedure without UDSF An AMF can be taken graciously out of service as follows - The AMF can forward registered UE contexts UE contexts grouped by the same GUAMI value to target AMFs within the same AMF set including the source AMF name used for redirecting UEs MT transaction The UE context includes the per AMF Set unique AMF UE NGAP ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1067",
    "document_id": "23501-i80",
    "chunk_id": 1067,
    "text": "In order for the AMF planned removal procedure to work graciously 5G-S-TMSI shall be unique per AMF set If there are ongoing transactions eg N1 procedure for certain UEs AMF forwards the UE contexts to the target AMF upon completion of an ongoing transaction - The AMF deregister itself from NRF indicating due to AMF planned removal NOTE 1 It is assumed that the UE contexts from the old AMF include all event subscriptions with peer CP NFs NOTE 2 Before removal of AMF the overload control mechanism can be used to reduce the amount of ongoing transaction An AMF shall be able to instruct the 5G-AN that it will be unavailable for processing transactions by including GUAMIs configured on this AMF and its corresponding target AMFs The target AMF shall be able to update the 5G-AN that the UEs served by the old GUAMIs are now served by target AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1068",
    "document_id": "23501-i80",
    "chunk_id": 1068,
    "text": "The target AMF provides the old GUAMI value that the 5G-AN can use to locate UE contexts served by the old AMF Upon receipt of the indication that an old AMF is unavailable 5G-AN shall take the following action - 5G-AN should mark this AMF as unavailable and not consider the AMF for selection for subsequent N2 transactions until 5G-AN learns that it is available eg as part of discovery results or by configuration The associated GUAMIs are marked as unavailable - During NGAP Setup the AMF may include an additional indicator that the AMF will rebind or release the NGAP UE-TNLA-binding on per UE-basis If that indicator is included and the 5G-AN supports timer mechanism the 5G-AN starts a timer to control the release of NGAP UE-TNLA-bindings For the duration of the timer or until the AMF releases or re-binds the NGAP UE-TNLA-binding the AN does not select a new AMF for subsequent transactions Upon timer expiry the 5G-AN releases the NGAP UE-TNLA-bindings with the corresponding AMF for the respective UEs for subsequent N2 message the 5G-AN uses GUAMI which points to the target AMF that replaced the old unavailable AMF to forward the N2 message to the corresponding target AMFs NOTE 3 For UEs in CM-CONNECTED state after indicating that the AMF is unavailable for processing UE transactions and including an indicator that the AMF releases the NGAP UE-TNLA-binding on a per UE-basis the AMF can either trigger a re-binding of the NGAP UE associations to an available TNLA on a different AMF within the same AMF set or use the NGAP UE-TNLA-binding per UE release procedure defined in TS 23502 3 to release the NGAP UE-TNLA-binding on a per UE-basis while requesting the AN to maintain N3 user plane connectivity and UE context information NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1069",
    "document_id": "23501-i80",
    "chunk_id": 1069,
    "text": "The support and the use of timer mechanism in 5G-AN is up to implementation If the instruction does not include the indicator for UEs in CM-CONNECTED state 5G-AN considers this as a request to release the NGAP UE UE-TNLA-bindings with the corresponding AMF for the respective UEs while maintaining N3 user plane connectivity and UE context information For subsequent N2 message the 5G-AN uses GUAMI based resolution which points to the target AMF that replaced the old unavailable AMF to forward the N2 message to the corresponding target AMFs -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1070",
    "document_id": "23501-i80",
    "chunk_id": 1070,
    "text": "For UEs in CM-IDLE state when it subsequently returns from CM-IDLE state and the 5G-AN receives an initial NAS message with a 5G S-TMSI or GUAMI based resolution the 5G-AN uses 5G S-TMSI or GUAMI which points to the target AMF that has replaced the old unavailable AMF and the 5G-AN forwards N2 message An AMF shall be able to instruct other peer CP NFs subscribed to receive such a notification that it will be unavailable for processing transactions by including GUAMIs configured on this AMF and its corresponding target AMFs The target AMF shall update the CP NF that the old GUAMIs is now served by target AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1071",
    "document_id": "23501-i80",
    "chunk_id": 1071,
    "text": "The old AMF provides the old GUAMI value to target AMF and the target AMF can use to locate UE contexts served by the old AMF If the CP NFs register with NRF for AMF unavailable notification then the NRF shall be able to notify the subscribed NFs to receive such a notification along with the corresponding target AMFs that AMF identified by GUAMIs will be unavailable for processing transactions Upon receipt of the notification that an AMF is unavailable the other CP NFs shall take the following action - Mark this AMF and its associated GUAMIs as unavailable while not changing the status of UEs associated to this AMF UEs previously served by the corresponding AMF still remain registered in the network and AMF Set information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1072",
    "document_id": "23501-i80",
    "chunk_id": 1072,
    "text": "For the UEs that were associated to the corresponding AMF when the peer CP NF needs to initiate a transaction towards the AMF that is marked unavailable and the old unavailable AMF was replaced by the target AMF CP NF should forward the transaction together with the old GUAMI to the target AMFs If CP NF needs to send a notification to new AMF which is associated with a subscription from the old AMF the CP NF shall exchange the old AMF information embedded in the Notification Address with the new AMF information and use that Notification Address for subsequent communication NOTE 5 If the CP NF does not subscribe to receive AMF unavailable notification either directly with the AMF or via NRF the CP NF may attempt forwarding the transaction towards the old AMF and detect that the AMF is unavailable after certain number of attempts When it detects unavailable it marks the AMF and its associated GUAMIs as unavailable The following actions should be performed by the target AMF - To allow AMF process ongoing transactions for some UEs even after it notifies unavailable status to the target AMF the target AMF keeps the association of the old GUAMIs and the old AMF for a configured time During that configured period if target AMF receives the transaction from the peer CP NFs and cannot locate UE context it rejects the transaction with old AMF name based on that association and the indicated AMF is only used for the ongoing transaction The peer CP NFs resend the transaction to the indicated AMF only for the ongoing transaction For subsequent transactions peer CP NFs should use the target AMF When the timer is expired the target AMF deletes that association information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1073",
    "document_id": "23501-i80",
    "chunk_id": 1073,
    "text": "When there is a transaction with the UE the target AMF uses SUPI 5G-GUTI or AMF UE NGAP ID to locate UE contexts and processes the UE transactions accordingly and updates the 5G-GUTI towards the UE if necessary For UEs in CM-CONNECTED state it may also update the NGAP UE association with a new AMF UE NGAP ID towards the 5G-AN and replace the GUAMI in the UE context stored at the 5G-AN with the new GUAMI associated with the newly selected AMF if the 5G-GUTI has been updated The AMF also informs the NG-RAN of the new UE Identity Index Value derived from the new 5G-GUTI - Target AMF shall not use old GUAMI to allocate 5G-GUTI for UEs that are being served by Target AMF 52123 Procedure for AMF Auto-recovery",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1074",
    "document_id": "23501-i80",
    "chunk_id": 1074,
    "text": "In order to try and handle AMF failure in a graceful manner ie without impacting the UE AMF can either back up the UE contexts in UDSF or per GUAMI granularity in other AMFs serving as backup AMF for the indicated GUAMI NOTE 1 Frequency of backup is left to implementation For deployments without UDSF for each GUAMI the backup AMF information in association to the GUAMI is configured in the AMF The AMF sends this information to 5G-AN and other CP NFs during the N2 setup procedure or the first per NF interaction with other CP NFs In the case that an AMF fails and the 5G-ANpeer CP NFs detect that the AMF has failed or the 5G-ANpeer CP NFs receives notification from another AMF in the same AMF set that this AMF has failed following actions are taken - The OAM deregister the AMF from NRF indicating due to AMF failure - 5G-AN marks this AMF as failed and not consider the AMF for selection until explicitly notified - For UEs in CM-CONNECTED state 5G-AN considers failure detection or failure notification as a trigger to release the NGAP UE-TNLA-bindings with the corresponding AMF for the respective UEs while maintaining N3 user plane connectivity and other UE context information For subsequent N2 message if the backup AMF information of the corresponding failed AMF is not available the 5G-AN should select a different AMF as in clause 635 from the same AMF set when the subsequent N2 message needs to be sent for the UEs If no other AMF from the AMF set is available then it can select an AMF implementation dependent from the same AMF Region as in clause 635",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1075",
    "document_id": "23501-i80",
    "chunk_id": 1075,
    "text": "If backup AMF information of the corresponding failed AMF is available the 5G-AN forwards the N2 message to the backup AMF NOTE 2 One AMF in the AMF set may be configured to send this failure notification message - For UEs in CM-IDLE state when it subsequently returns from CM-IDLE state and the 5G-AN receives an initial NAS message with a S-TMSI or GUAMI pointing to an AMF that is marked failed if the backup AMF information of the corresponding failed AMF is not available the 5G-AN should select a different AMF from the same AMF set and forward the initial NAS message If no other AMF from the AMF set is available then it can select an AMF implementation dependent from the same AMF Region as in clause 635",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1076",
    "document_id": "23501-i80",
    "chunk_id": 1076,
    "text": "If backup AMF information of the corresponding failed AMF is available the 5G-AN forwards the N2 message to the backup AMF - Peer CP NFs consider this AMF as unavailable while retaining the UE context - For the UEs that were associated to the corresponding AMF when the peer CP NF needs to initiate a transaction towards the AMF if backup AMF information of the corresponding failed AMF is not available CP NF should select another AMF from the same AMF set and forward the transaction together with the old GUAMI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1077",
    "document_id": "23501-i80",
    "chunk_id": 1077,
    "text": "If neither the backup AMF nor any other AMF from the AMF set is available then CP NF can select an AMF from the same AMF Region as in clause 635 If backup AMF information of the corresponding failed AMF is available the CP NF forwards transaction to the backup AMF If CP NF needs to send a notification to new AMF which is associated with a subscription from the old AMF the CP NF shall exchange the old AMF information embedded in the Notification Address with the new AMF information and use that Notification Address for subsequent communication - When the 5G-AN or CP NFs need to select a different AMF from the same AMF set - For deployments with UDSF any AMF from the same AMF set can be selected - For deployments without UDSF the backup AMF is determined based on the GUAMI of the failed AMF Following actions should be taken by the newly selected AMF - For deployments with UDSF when there is a transaction with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1078",
    "document_id": "23501-i80",
    "chunk_id": 1078,
    "text": "the newly selected AMF retrieves the UE context from the UDSF using SUPI 5G-GUTI or AMF UE NGAP ID and it processes the UE message accordingly and updates the 5G-GUTI towards the UE if necessary - For deployments without UDSF backup AMF the newly selected AMF based on the failure detection of the old AMF instructs peer CP NFs and 5G-AN that the UE contexts corresponding to the GUAMI of the failed AMF is now served by this newly selected AMF The backup AMF shall not use old GUAMI to allocate 5G-GUTI for UEs that are being served by Target AMF The backup AMF uses the GUAMI to locate the respective UE Contexts - When there is a transaction with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1079",
    "document_id": "23501-i80",
    "chunk_id": 1079,
    "text": "the new AMF updates the peer NFs that subscribed to receive AMF unavailability notification from old AMF with the new AMF information - If the new AMF is aware of a different AMF serving the UE by implementation specific means it redirects the uplink N2 signalling to that AMF or reject the transaction from the peer CP NFs with a cause to indicate that new AMF has been selected The peer CP NFs may wait for the update from the new AMF and resend the transaction to the new AMF NOTE 3 This bullet above addresses situations where 5G-AN node selects an AMF and other CP NFs select an AMF for the UE concurrently It also addresses the situation where CP NFs select an AMF for the UE concurrently NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1080",
    "document_id": "23501-i80",
    "chunk_id": 1080,
    "text": "It is assumed that the UE contexts from the old AMF include all event subscriptions with peer CP NFs - If the UE is in CM-IDLE state and the new AMF does not have access to the UE context the new AMF selects one available AMF from the old AMF set as described in clause 635 The selected AMF retrieves the UE context from the UDSF and provides the UE context to the new AMF If the new AMF doesnt receive the UE context then the AMF may force the UE to perform Initial Registration - If the UE is in CM-CONNECTED state the new AMF may also update the NGAP UE association with a new AMF UE NGAP ID towards the 5G-AN and replace the GUAMI in the UE context stored at the 5G-AN with the new GUAMI associated with the newly selected AMF if the 5G-GUTI has been updated NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1081",
    "document_id": "23501-i80",
    "chunk_id": 1081,
    "text": "The above N2 TNL association selection and AMF management is applied to the selected PLMN 5213 Network Reliability support with Sets 52131 General A Network Function instance can be deployed such that several network function instances are present within an NF Set to provide distribution redundancy and scalability together as a Set of NF instances The same is also supported for NF Services This can be achieved when the equivalent NFs and NF Services share the same context data or by Network FunctionNF Service Context Transfer procedures as specified in clause 426 of TS 23502 3 NOTE A NF can be replaced by an alternative NF within the same NF Set in the case of scenarios such as failure load balancing load re-balancing Such a network reliability design shall work in both communication modes ie Direct Communication and Indirect Communication In the Direct Communication mode the NF Service consumer is involved in the reliability related procedures In Indirect Communication mode the SCP is involved in the reliability related procedures 52132 NF Set and NF Service Set Equivalent Control Plane NFs may be grouped into NF Sets eg several SMF instances are grouped into an SMF Set NFs within a NF Set are interchangeable because they share the same context data and may be deployed in different locations eg different data centres In the case of SMF multiple instances of SMFs within an SMF Set need to be connected to the same UPF - If the N4 association is established between a SMF instance and an UPF each N4 association is only managed by the related SMF instance - If only one N4 association is established between a SMF Set and an UPF any SMF in the SMF Set should be able to manage the N4 association with the UPF Furthermore for a given UE and PDU Session any SMF in the SMF Set should be able to control the N4 session with the UPF however at any given time only one SMF in the SMF Set will control the UPF for a given UEs PDU Session A Control Plane NF is composed of one or multiple NF Services Within a NF a NF service may have multiple instances These multiple NF Service instances can be grouped into NF Service Set if they are interchangeable with each other because they share the same context data NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1082",
    "document_id": "23501-i80",
    "chunk_id": 1082,
    "text": "The actual mapping of instances to a given Set is up to deployment 52133 Reliability of NF instances within the same NF Set The NF producer instance is the NF instance which host the NF Service Producer When the NF producer instance is not available another NF producer instance within the same NF Set is selected For Direct Communication mode the NF Service consumer may subscribe to status change notifications of NF instance from the NRF If the NF Service consumer is notified by the NRF or detects by itself eg request is not responded that the NF producer instance is not available anymore another available NF producer instance within the same NF Set is selected by the NF Service consumer For Indirect Communication mode the SCP or NF Service consumer may subscribe to status change notifications of NF instance from the NRF and selects another NF producer instance within the same NF Set if the original NF producer instance serving the UE is not available anymore NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1083",
    "document_id": "23501-i80",
    "chunk_id": 1083,
    "text": "It is up to the implementation on how the SCP knows a NF producer instance is not available anymore 52134 Reliability of NF Services When multiple NF Service instances within a NF Service Set are exposed to the NF Service consumer or SCP and the failure of NF Service instance is detected or notified by the NRF ie it is not available anymore the NF Service consumer or SCP selects another NF Service instance of the same NF Service Set within the NF instance if available Otherwise the NF Service consumer or SCP selects a different NF instance within the same NF Set NOTE The NF Producer instance can change the NF Service instance in the response to the service request When multiple NF Service instances within a NF Service Set are exposed to the NF Service consumer or SCP as a single NF Service the reliability ie the selection of an alternative NF Service instance is handled within the NF instance 5214 Network FunctionNF Service Context Transfer 52141",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1084",
    "document_id": "23501-i80",
    "chunk_id": 1084,
    "text": "General Network FunctionNF Service Context Transfer Procedures allow transfer of Service Context of a NFNF Service from a Source NFNF Service Instance to the Target NFNF Service Instance eg before the Source NFNF Service can gracefully close its NFNF Service Service Context Transfer procedures are supported as specified in clause 426 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1085",
    "document_id": "23501-i80",
    "chunk_id": 1085,
    "text": "Source NF OAM system determines when Source NF needs to transfer UE contexts to an NF in another NF set Source NF should initiate this only for UEs that are not active in order to limit and avoid impacting services offered to corresponding UEs 522 System Enablers for priority mechanism 5221 General The 5GS and the 5G QoS model allow classification and differentiation of specific services such as listed in clause 516 based on subscription-related and invocation-related priority mechanisms These mechanisms provide abilities such as invoking modifying maintaining and releasing QoS Flows with priority and delivering QoS Flow packets according to the QoS characteristics under network congestion conditions Subscription-related Priority Mechanisms include the ability to prioritize flows based on subscription information including the prioritization of RRC Connection Establishment based on Unified Access Control mechanisms and the establishment of prioritized QoS Flows Invocation-related Priority Mechanisms include the ability for the service layer to requestinvoke the activation of prioritized QoS Flows through an interaction over RxN5 and packet detection in the UPF QoS Mechanisms applied to established QoS Flows include the ability to fulfil the QoS characteristics of QoS Flows through preservation of differentiated treatment for prioritized QoS Flow and resource distribution prioritization Messages associated with priority services that are exchanged over service-based interfaces may include a Message Priority header to indicate priority information as specified in TS 23502 3 and TS 29500 49",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1086",
    "document_id": "23501-i80",
    "chunk_id": 1086,
    "text": "In addition the separation of concerns between the service classification provided by the core network through the association of Service Data Flows to QoS and the enforcing of QoS differentiation in RAN through the association of QoS Flows to Data Radio bearers supports the prioritization of QoS Flows when a limitation of the available data radio bearers occurs In addition it also includes the ability for the service layer to provide instructions on how to perform pre-emption of media flows with the same priority assigned through an interaction over Rx as defined in TS 23503 45 5222 Subscription-related Priority Mechanisms Subscription-related mechanisms which are always applied - RAN During initial Access Network Connection Establishment the Establishment Cause is set to indicate that special treatment is to be applied by the RAN in the radio resource allocation as specified in clause 52 for 3GPP access - UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1087",
    "document_id": "23501-i80",
    "chunk_id": 1087,
    "text": "As defined in clause 523 of TS 23502 3 the UE subscription data in the UDM contains an MPS subscription indication ie MPS priority and an MCX subscription indication ie MCX priority for the UE that has subscription to MPS and MCX respectively The MPS priority and the MCX priority if available are provided to the AMF via the Registration or the UE Configuration Update procedure as defined in clause 42 of TS 23502 3 - AMF Following Access Network Connection Establishment the receipt of the designated Establishment Cause ie high priority access by the AMF will result in priority handling of the Initial UE Message received as part of the Registration procedures of clause 422 of TS 23502 3 If the AMF did not receive a designated Establishment Cause ie high priority access but when the AMF determines that there is a MPS priority or MCX priority in the UDM for that UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1088",
    "document_id": "23501-i80",
    "chunk_id": 1088,
    "text": "the AMF shall provide priority handling for that UE at that time and shall provide the MPS priority or MCX priority to the UE via the Registration or the UE Configuration Update procedure as defined in clause 42 of TS 23502 3 In addition certain exemptions to Control Plane Congestion and Overload Control are provided as specified in clause 519 Subscription-related mechanisms which are conditionally applied - UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1089",
    "document_id": "23501-i80",
    "chunk_id": 1089,
    "text": "When barring control parameters are broadcast by the RAN access barring based on Access Identityes configured in the USIM andor an Access Category is applied prior to an initial upstream transmission for the UE which provides a mechanism to limit transmissions from UEs categorized as non-prioritized while allowing transmissions from UEs categorized as prioritized such as MPS subscribed UEs during the RRC Connection Establishment procedure as specified in clause 52 - UDM One or more ARP priority levels are assigned for prioritized or critical services The ARP of the prioritized QoS Flows for each DN is set to an appropriate ARP priority level The 5QI is from the standard value range as specified in clause 5727",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1090",
    "document_id": "23501-i80",
    "chunk_id": 1090,
    "text": "In addition Priority Level may be configured for the standardized 5QIs and if configured it overwrites the default value specified in the QoS characteristics Table 574-1 - PCF The IMS Signalling Priority information is set for the subscriber in the UDM and the PCF modifies the ARP of the QoS Flow used for IMS signalling for each DN which supports prioritized services leveraging on IMS signalling to an appropriate ARP priority level assigned for that service - SMFAMF Based on the QoS parameters eg ARPs 5QI of a PDU Session the SMF may provide a PDU Session Priority to the AMF The AMF stores the information for further PDU Session related priority handling ie for determination of the Message Priority header of subsequent message related to the PDU Session NOTE For a UE with MPS subscription the MPS priority per DN can be different eg only certain specific DNs has MPS priority while other DNs have no MPS priority 5223 Invocation-related Priority Mechanisms",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1091",
    "document_id": "23501-i80",
    "chunk_id": 1091,
    "text": "The generic mechanisms used based on invocation-related Priority Mechanisms for prioritised services are based an interaction with an Application Function and between the Application Function and the PCF over RxN5 interface These mechanisms apply to mobile originated as well as mobile terminated SIP callsessions clause 521 of TS 23228 15 and Priority PDU connectivity services including MPS for Data Transport Service NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1092",
    "document_id": "23501-i80",
    "chunk_id": 1092,
    "text": "Clause 521 of TS 23228 15 is applicable to 5GS with the understanding that the term PCRF corresponds to PCF in the 5GS Invocation-related mechanisms for Mobile Originations eg via SIPIMS - PCF When an indication for a session arrives over the RxN5 Interface and the UE does not have priority for the signalling QoS Flow the PCF derives the ARP and 5QI parameters plus associated QoS characteristics as appropriate of the QoS Flow for Signalling as per Service Provider policy as specified in clause 61311 of TS 23503 45 - PCF For sessions such as MPS when establishing or modifying a QoS Flow for media as part of the session origination procedure the PCF selects the ARP and 5QI parameters plus associated QoS characteristics as appropriate to provide priority treatment to the QoS Flows - PCF When all active sessions to a particular DN are released and the UE is not configured for priority treatment to that particular PDU Session for a DN the PCF will downgrade the IMS Signalling QoS Flows from appropriate settings of the ARP and 5QI parameters plus associated QoS characteristics as appropriate to those entitled by the UE based on subscription - SMFAMF Based on the QoS parameters eg ARP 5QI of a PDU Session the SMF may provide a PDU Session Priority to the AMF The AMF stores the information for further PDU Session related priority handling ie for determination of the Message Priority header of subsequent message related to the PDU Session Invocation-related mechanisms for Mobile Terminations eg via SIPIMS - PCF When an indication for a session arrives over the RxN5 Interface mechanisms as described above for Mobile Originations are applied - UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1093",
    "document_id": "23501-i80",
    "chunk_id": 1093,
    "text": "If an IP packet arrives at the UPF for a UE that is CM-IDLE the UPF sends a Data Notification including the information to identify the QoS Flow for the DL data packet to the SMF as specified in clause 4233 of TS 23502 3 - SMF If a Data Notification message arrives at the SMF for a QoS Flow associated with an ARP priority level value that is entitled for priority use delivery of priority indication during the Paging procedure is provided by inclusion of the ARP in the N11 interface N1N2MessageTransfer message as specified in clause 4233 of TS 23502 3 Based on the QoS parameters eg ARP 5QI of a PDU Session the SMF may also provide a PDU Session Priority to the AMF - AMF If an N1N2MessageTransfer message arrives at the AMF containing an ARP priority level value that is entitled for priority use the AMF handles the request with priority and includes the Paging Priority IE in the N2 Paging message set to a value assigned to indicate that there is an IP packet at the UPF entitled to priority treatment as specified in clause 4233 of TS 23502 3 If a PDU Session Priority is provided by the SMF the AMF stores the information for further PDU Session related priority handling eg for determination of the Message Priority header of subsequent message related to the PDU Session - SMF For a UE that is not configured for priority treatment upon receiving the N7 Session Management Policy Modification message from the PCF with an ARP priority level that is entitled for priority use the SMF sends an N1N2MessageTransfer to update the ARP for the Signalling QoS Flows as specified in clause 4332 of TS 23502 3 Based on the QoS parameters eg ARP 5QI of a PDU Session the SMF may also provide Session Priority to the AMF - AMF Upon receiving the N1N2MessageTransfer message from the SMF with an ARP priority level that is entitled for priority use the AMF updates the ARP for the Signalling QoS Flows as specified in clause 4332 of TS 23502 3 - RAN Inclusion of the Paging Priority in the N2 Paging message triggers priority handling of paging in times of congestion at the RAN as specified in clause 4233 of TS 23502 3 - SMFAMF Based on the QoS parameters eg ARP 5QI of a PDU Session the SMF may provide a PDU Session Priority to the AMF The AMF stores the information for further PDU Session related priority handling ie for determination of the Message Priority header of subsequent message related to the PDU Session Invocation-related mechanisms for the Priority PDU connectivity services - PCF If the state of the Priority PDU connectivity services is modified from disabled to enabled the QoS Flows controlled by the Priority PDU connectivity services are establishedmodified to have the service appropriate settings of the ARP and 5QI parameters plus associated QoS characteristics as appropriate using the PDU Session Modification procedure as specified in clause 433 of TS 23502 3 - PCF If the state of Priority PDU connectivity services is modified from enabled to disabled the QoS Flows controlled by the Priority PDU connectivity services are modified from Priority PDU connectivity service appropriate settings of the ARP and 5QI parameters plus associated QoS characteristics as appropriate to those entitled by the UE as per subscription using the PDU Session Modification procedure as specified in clause 433 of TS 23502 3 Invocation-related mechanisms for MPS for Data Transport Service - MPS for Data Transport Service follows the same steps as those for Priority PDU connectivity services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1094",
    "document_id": "23501-i80",
    "chunk_id": 1094,
    "text": "The QoS Flows that will be subject to MPS for Data Transport Service are based on operator policy and regulations by means of local PCF configuration NOTE 2 If no configuration is provided MPS for Data Transport Service applies to the QoS Flow associated with the default QoS rule 5224 QoS Mechanisms applied to established QoS Flows Mechanisms applied to established QoS Flows - RAN QoS Flows requested in the Xn Handover Request or N2 Handover Request which are marked as entitled to priority by virtue of inclusion of an ARP value from the set allocated by the Service Provider for prioritised services are given priority over requests for QoS Flows which do not include an ARP from the set as specified in clause 49 of TS 23502 3 - SMF Congestion management procedures in the SMF will provide priority to QoS Flows established for sessions during periods of extreme overload Prioritised services are exempt from any session management congestion controls See clause 519 - AMF Congestion management procedures in the AMF will provide priority to any Mobility Management procedures required for the prioritised services during periods of extreme overload Prioritised services are exempt from any Mobility Management congestion controls See clause 5195 - QoS Flows whose ARP parameter is from the set allocated by the Service Provider for prioritised services use shall be exempt from release during QoS Flow load rebalancing - RAN UPF IMS Signalling Packets associated with prioritised services use are handled with priority Specifically during times of severe congestion when it is necessary to drop packets on the IMS Signalling QoS Flow or QoS Flow supporting MPS for Data Transport Service signalling to ensure network stability these FEs shall drop packets not associated with priority signalling such as MPS or Mission Critical services before packets associated with priority signalling See clauses 5165 and 5166 - RAN UPF During times of severe congestion when it is necessary to drop packets on a media QoS Flow to ensure network stability these FEs shall drop packets not associated with priority sessions such as MPS or Mission Critical services before packets associated with priority sessions See clauses 5165 and 5166 523 Supporting for Asynchronous Type Communication Asynchronous type communication ATC enables 5GC to delay synchronizing UE context with the UE so as to achieve an efficient signalling overhead and increase system capacity The support of ATC is optional for the AMF 5GC supports asynchronous type communication with the following functionality - Capability to store the UE context based on the received message and synchronize the UE context with the involved network functions or UE later For network function eg PCF UDM etc triggered signalling procedure eg network triggered Service Request procedure network triggered PDU Session Modification procedure etc if the UE CM state in the AMF is CM-IDLE state and the requesting network function indicates to the AMF the ATC is allowed for the signalling if the AMF supports the ATC feature the AMF may update and store the UE context based on the received message without paging UE immediately When the UE CM state in the AMF enters CM-CONNECTED state the AMF forwards N1 and N2 message to synchronize the UE context with the RAN andor the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1095",
    "document_id": "23501-i80",
    "chunk_id": 1095,
    "text": "If the originating NF does not require immediate delivery it may indicate that the AMF is allowed to use ATC NOTE Pre-Rel-17 AMF implementation cannot decode the indication that ATC is allowed 524 3GPP PS Data Off This feature when activated by the user prevents traffic via 3GPP access of all IP packets Unstructured and Ethernet data except for those related to 3GPP PS Data Off Exempt Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1096",
    "document_id": "23501-i80",
    "chunk_id": 1096,
    "text": "The 3GPP PS Data Off Exempt Services are a set of operator services defined in TS 22011 25 and TS 23221 23 that are the only allowed services when the 3GPP PS Data Off feature has been activated by the user The 5GC shall support 3GPP PS Data Off operation in both non-roaming and roaming scenarios UEs may be configured with up to two lists of 3GPP PS Data Off Exempt Services and the lists are provided to the UEs by HPLMN via Device Management or UICC provisioning When the UE is configured with two lists one list is valid for the UEs camping in the home PLMN and the other list is valid for any VPLMN the UE is roaming in When the UE is configured with a single list without an indication to which PLMNs the list is applicable then this list is valid for the home PLMN and any PLMN the UE is roaming in NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1097",
    "document_id": "23501-i80",
    "chunk_id": 1097,
    "text": "The operator needs to ensure coordinated lists of 3GPP Data Off Exempt Services provisioned in the UE and configured in the network The UE reports its 3GPP PS Data Off status in PCO Protocol Configuration Option to H-SMF during UE requested PDU Session Establishment procedure for establishment of a PDU Session associated with 3GPP access andor non-3GPP access The UE does not need to report PS Data Off status during the PDU Session Establishment procedure for handover of the PDU Session between 3GPP access and non 3GPP access if 3GPP PS Data Off status is not changed since the last report The PS Data Off status for a PDU Session does not affect data transfer over non-3GPP access If 3GPP PS Data Off is activated the UE prevents the sending of uplink IP packets Unstructured and Ethernet data except for those related to 3GPP PS Data Off Exempt Services based on the pre-configured lists of Data Off Exempt Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1098",
    "document_id": "23501-i80",
    "chunk_id": 1098,
    "text": "If 3GPP PS Data Off is activated for a UE with MA PDU Sessions established through the ATSSS feature see clause 532 the data transferred over the non-3GPP access of the MA PDU sessions are unaffected which is ensured by the policy for ATSSS Control as specified in clause 5323 The UE shall immediately report a change of its 3GPP PS Data Off status in PCO by using UE requested PDU Session Modification procedure This also applies to the scenario of inter-RAT mobility to NG-RAN and to scenarios where the 3GPP PS Data Off status is changed when the session management back-off timer is running as specified in clause 51973 and clause 51974",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1099",
    "document_id": "23501-i80",
    "chunk_id": 1099,
    "text": "For UEs in Non-Allowed Area or not in Allowed Area as specified in clause 5341 the UE shall also immediately report a change of its 3GPP PS Data Off status for the PDU Session For UEs moving out of LADN area and the PDU Session is still maintained as specified in clause 565 the UE shall also immediately report a change of its 3GPP PS Data Off status for the PDU Session The additional behaviour of the SMF for 3GPP PS Data Off is controlled by local configuration or policy from the PCF as defined in TS 23503 45 NOTE 2 For the PDU Session used for IMS services the 3GPP Data Off Exempt Services are enforced in the IMS domain as specified TS 23228 15 Policies configured in the H-SMFPCF need to ensure those services are always allowed when the 3GPP Data Off status of the UE is set to activated 525 Support of OAM Features 5251 Support of Tracing Signalling",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1100",
    "document_id": "23501-i80",
    "chunk_id": 1100,
    "text": "Based ActivationDeactivation of Tracing 5GS supports tracing as described in TS 32421 66 5GS support may include subscriber tracing tracing targeting a SUPI or equipment tracing tracing targeting a PEI but also other forms of tracing further described in TS 32421 66 and TS 32422 192 NOTE 1 TS 23501 TS 23502 3 TS 23503 45 only describe how 5GS signalling supports delivery of Trace Requirements about a UE Signalling Based ActivationDeactivation of Tracing OAM delivery of tracing requirements as well as the transfer of tracing results to one or more Operations Systems are out of scope of these documents The content of Trace Requirements about a UE eg trace reference address of the Trace Collection Entity etc is defined in TS 32421 66 Trace Requirements about a UE may be configured in subscription data of the UE and delivered together with other subscription data by the UDM towards the AMF the SMF andor the SMSF The AMF propagates Trace Requirements about a UE received from the UDM to network entities not retrieving subscription information from UDM ie to the 5G-AN to the AUSF and to the PCF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1101",
    "document_id": "23501-i80",
    "chunk_id": 1101,
    "text": "The AMF also propagates Trace Requirements to the SMF and to the SMSF If the I-SMF or V-SMF is needed for the PDU session the AMF propagates Trace Requirements to the I-SMF or V-SMF The I-SMF or V-SMF also propagates Trace Requirements received from the AMF to the I-UPF or V-UPF over N4 Trace Requirements about a UE may be sent by the AMF to the 5G-AN as part of - the N2 procedures used to move the UE from CM-IDLE to CM-CONNECTED or - the N2 procedures to request a Hand-over from a target NG-RAN or - a stand-alone dedicated N2 procedure when tracing is activated while the UE is CM-CONNECTED Trace Requirements about a UE sent to a 5G-AN shall not contain information on the SUPI or on the PEI of the UE Trace Requirements are directly sent from Source to Target NG-RAN in the case of Xn Hand-Over The SMF propagates Trace Requirements about a UE received from the UDM to the UPF over N4 and to the PCF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1102",
    "document_id": "23501-i80",
    "chunk_id": 1102,
    "text": "The SMF provides Trace Requirements to the PCF when it has selected a different PCF than the one received from the AMF Once the SMF or the SMSF has received subscription data Trace Requirements received from UDM supersede Trace requirements received from the AMF Trace Requirements are exchanged on N26 between the AMF and the MME 5252 Support of OAM-based 5G VN group management 5GS supports 5G LAN-type service as defined in clause 529 5G LAN-type service includes the 5G VN group management that can be configured by a network administrator The parameters for 5G VN group is defined in clause 529 The 5G VN group parameters about a UE may be configured in subscription data of the UE and delivered together with other subscription data by the UDM towards the AMF and SMF 5253 Signalling Based Activation of QoE Measurement Collection 5GS may support QoE Measurement Collection QMC as described in TS 28405 190 5GS may support Signalling based activation and Management based activation as specified in TS 38300 27 and TS 28405 190 To enable signalling based activation in NR the QMC Configuration information is configured in subscription data of the UE 5GC provides the QMC Configuration information to the NG-RAN as described in TS 23502 3 526 Configuration Transfer Procedure",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1103",
    "document_id": "23501-i80",
    "chunk_id": 1103,
    "text": "The purpose of the Configuration Transfer is to enable the transfer of information between two RAN nodes at any time via NG interface and the Core Network An example of application is to exchange the RAN nodes IP addresses in order to be able to use Xn interface between the NG-RAN node for Self-Optimised Networks SON as specified in TS 38413 34 5261 Architecture Principles for Configuration Transfer Configuration Transfer between two RAN node provides a generic mechanism for the exchange of information between applications belonging to the RAN nodes In order to make the information transparent for the Core Network the information is included in a transparent container that includes source and target RAN node addresses which allows the Core Network nodes to route the messages The mechanism is depicted in figure 526 1 Figure 526-1 inter NG-RAN Configuration Transfer basic network architecture The NG-RAN transparent containers are transferred from the source NG-RAN node to the destination NG-RAN node by use of Configuration Transfer messages A Configuration Transfer message is used from the NG-RAN node to the AMF over N2 interface a AMF Configuration Transfer message is used from the AMF to the NG-RAN over N2 interface and a Configuration Transfer Tunnel message is used to tunnel the transparent container from a source AMF to a target AMF over the N14 interface Each Configuration Transfer message carrying the transparent container is routed and relayed independently by the core network nodes 5262 Addressing routing and relaying 52621 Addressing All the Configuration Transfer messages contain the addresses of the source and destination RAN nodes An NG-RAN node is addressed by the Target NG-RAN node identifier 52622",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1104",
    "document_id": "23501-i80",
    "chunk_id": 1104,
    "text": "Routing The following description applies to all the Configuration Transfer messages used for the exchange of the transparent container The source RAN node sends a message to its core network node including the source and destination addresses The AMF uses the destination address to route the message to the correct AMF via the N14 interface The AMF connected to the destination RAN node decides which RAN node to send the message to based on the destination address 52623 Relaying The AMF performs relaying between N2 and N14 messages as described in TS 38413 34 TS 29518 71 527 Enablers for Time Sensitive Communications Time Synchronization and Deterministic Networking 5270 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1105",
    "document_id": "23501-i80",
    "chunk_id": 1105,
    "text": "This clause describes 5G System features that can be used independently or in combination to enable time-sensitive communication time synchronization and deterministic networking - Delay-critical GBR - A hold and forward mechanism to schedule traffic as defined in IEEE Std 8021Q 98 for Ethernet PDU Sessions in DS-TT and NW-TT see clause 5274 to de-jitter flows that have traversed the 5G System if the 5G System is to participate transparently as a bridge in a TSN network - TSC Assistance Information describes TSC flow traffic characteristics as described in clause 5272 that may be provided optionally for use by the gNB to allow more efficiently schedule radio resources for periodic traffic and applies to PDU Session type Ethernet and IP - Time Synchronization describes how 5GS can operate as a PTP Relay IEEE Std 8021AS 104 as a Boundary Clock or as Transparent Clock IEEE Std 1588 126 for PDU Session type Ethernet and IP and how 5GS can detect and report the status of the time synchronization - RAN feedback for BAT offset and adjusted periodicity describes a mechanism supported by NG-RAN and 5G CN that enables AF to adapt to received BAT offset and adjusted periodicity from NG-RAN for a given traffic flow The 5G System integration as a bridge in an IEEE 8021 TSN network as described in clause 528 can make use of all features listed above To support any of the above features to enable time-sensitive communication time synchronization and deterministic networking during the PDU Session establishment the UE shall request to establish a PDU Session as an always-on PDU Session and the PDU Sessions are established as Always-on PDU session as described in clause 5613",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1106",
    "document_id": "23501-i80",
    "chunk_id": 1106,
    "text": "In this release of the specification to use any of the above features to enable time-sensitive communication time synchronization and deterministic networking - Home Routed PDU Sessions are not supported - PDU Sessions are supported only for SSC mode 1 - Service continuity is not supported when the UE moves from 5GS to EPS ie interworking with EPS is not supported for a PDU Session for time synchronization or TSC or deterministic networking 5271 Time Synchronization 52711 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1107",
    "document_id": "23501-i80",
    "chunk_id": 1107,
    "text": "For supporting time synchronization service the 5GS is configured to operate in one or multiple PTP instances and to operate in one of the following modes if supported for each PTP instance 1 as time-aware system as described in IEEE Std 8021AS 104 2 as Boundary Clock as described in IEEE Std 1588 126 provisioned by the profiles supported by this 3GPP specification including SMPTE Profile for Use of IEEE Std 1588 126 Precision Time Protocol in Professional Broadcast Applications ST 2059-22015 127 NOTE 1 Via proper configuration of the IEEE Std 1588 126 data set members the 5G internal system clock can become the time source for the PTP grandmaster function for the connected networks in the case of mode 1 and mode 2 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1108",
    "document_id": "23501-i80",
    "chunk_id": 1108,
    "text": "In some cases where the 5G internal system clock is the time source for the PTP grandmaster function for the connected networks it might not be required for the UE to receive gPTP or PTP messages over user plane The UE and DS-TT uses the 5G timing information and generates the necessary gPTP or PTP message for the end station if needed this is implementation specific 3 as peer-to-peer Transparent Clock as described in IEEE Std 1588 126 provisioned by the profiles supported by this 3GPP specification including SMPTE Profile for Use of IEEE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1109",
    "document_id": "23501-i80",
    "chunk_id": 1109,
    "text": "Std 1588 Precision Time Protocol in Professional Broadcast Applications ST 2059-22015 127 or 4 as end-to-end Transparent Clock as described in IEEE Std 1588 126 provisioned by the profiles supported by this 3GPP specification including SMPTE Profile for Use of IEEE Std 1588 Precision Time Protocol in Professional Broadcast Applications ST 2059-22015 127 NOTE 3 When the GM is external the operation of 5GS as Boundary Clock assumes that profiles that are supported by the 5GS allows the exemption specified in clauses 959 and 9510 of IEEE Std 1588 126 where the originTimestamp or preciseOriginTimestamp in case of two-step operation is not required to be updated with the syncEventEgressTimestamp and a Local PTP Clock locked to the external GM As described in clause 527122 only correctionField is updated with the 5GS residence time and link delay in a similar operation as specified by IEEE Std 8021AS 104",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1110",
    "document_id": "23501-i80",
    "chunk_id": 1110,
    "text": "The configuration of the time synchronization service in 5GS for option 1 by TSN AF and CNC is described in clause 5283 and for options 1-4 by AFNEF and TSCTSF in clause 52718 and clause 5283 The 5GS shall be modelled as an IEEE Std 8021AS 104 or IEEE Std 1588 126 compliant entity based on the above configuration NOTE 4 This release of the specification does not support the PTP management mechanism or PTP management messages as described in clause 15 in IEEE Std 1588 126 The DS-TT and NW-TT at the edge of the 5G system may support the IEEE Std 8021AS 104 or other",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1111",
    "document_id": "23501-i80",
    "chunk_id": 1111,
    "text": "IEEE Std 1588 126 profiles operations respective to the configured mode of operation The UE gNB UPF NW-TT and DS- TTs are synchronized with the 5G GM ie the 5G internal system clock which shall serve to keep these network elements synchronized The TTs located at the edge of 5G system fulfil some functions related to IEEE Std 8021AS 104 and may fulfil some functions related to IEEE Std 1588 126 eg gPTP support and timestamping Figure 5271-1 illustrates the 5G and PTP grandmaster GM clock distribution model via 5GS Figure 5271-1 5G system is modelled as PTP instance for supporting time synchronization Figure 5271-1 depicts the two synchronizations systems considered the 5G Clock synchronization and the gPTP domain synchronization - 5G Access Stratum-based Time Distribution Used for NG RAN synchronization and also distributed to the UE The 5G Access Stratum-based Time Distribution over the radio interface towards the UE is specified in TS 38331 28",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1112",
    "document_id": "23501-i80",
    "chunk_id": 1112,
    "text": "This method may be used to either further distribute the 5G timing to devices connected to a UE using implementation-specific means or to support the operation of the gPTP-based time distribution method - gPTP-based Time Distribution Provides timing among entities in a gPTP domain This process follows the applicable profiles of IEEE Std 8021AS 104 or IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1113",
    "document_id": "23501-i80",
    "chunk_id": 1113,
    "text": "This method relies on the 5G access stratum-based time distribution method to synchronize the UEDS-TT and on the 5GS time synchronization to synchronize the gNB which in turn may synchronize the DS-TT and the NW-TT The gNB needs to be synchronized to the 5G GM clock The 5GS supports two methods for determining the grandmaster PTP Instance and the time-synchronization spanning tree - Method a BMCA procedure - Method b local configuration This is further described in clause 52716 52712 Distribution of timing information 527121 Distribution of 5G internal system clock The 5G internal system clock shall be made available to all user plane nodes in the 5G system The UPF and NW-TT may get the 5G internal system clock via the underlying PTP compatible transport network with mechanisms outside the scope of 3GPP The 5G internal system clock shall be made available to UE with signalling of time information related to absolute timing of radio frames as described in TS 38331 28",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1114",
    "document_id": "23501-i80",
    "chunk_id": 1114,
    "text": "The 5G internal system clock shall be made available to DS-TT by the UE 527122 Distribution of grandmaster clock and time-stamping 5271221 Distribution of gPTP Sync and Follow_Up messages The mechanisms for distribution of TSN GM clock and time-stamping described in this clause are according to IEEE Std 8021AS 104 NOTE 1 It means Externally-observable behaviour of the 5GS bridge needs to comply with IEEE Std 8021AS 104",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1115",
    "document_id": "23501-i80",
    "chunk_id": 1115,
    "text": "For downlink Time Synchronization upon reception of a downlink gPTP message from NW-TT port in Follower state the NW-TT makes an ingress timestamping TSi for each gPTP event Sync message and uses the cumulative rateRatio received inside the gPTP message payload carried within Sync message for one-step operation or Follow_up message for two-step operation to calculate the link delay from the upstream TSN node gPTP entity connected to NW-TT expressed in TSN GM time as specified in IEEE Std 8021AS 104 NW-TT then calculates the new cumulative rateRatio ie the cumulative rateRatio of the 5GS as specified in IEEE Std 8021AS 104 and modifies the gPTP message payload carried within Sync message for one-step operation or Follow_up message for two-step operation as follows - Adds the link delay from the upstream TSN node in TSN GM time to the correction field - Replaces the cumulative rateRatio received from the upstream TSN node with the new cumulative rateRatio - Adds TSi in the Suffix field of the gPTP packet as described in clause H2 The UPFNW-TT uses the ingress port number of the NW-TT and domainNumber and sdoId in the received gPTP message to assign the gPTP message to a PTP instance in the NW-TT If the NW-TT does not have a matching PTP instance the UPFNW-TT discards the message The UPFNW-TT then forwards the gPTP message from TSN network to the PTP ports in DS-TTs in Leader state within this PTP instance via PDU sessions terminating in this UPF that the UEs have established to the TSN network The UPFNW-TT also forwards the gPTP message to the PTP ports in NW-TT in Leader state within this PTP instance All gPTP messages are transmitted on a QoS Flow that complies with the residence time upper bound requirement specified in IEEE Std 8021AS 104 NOTE 2 Leader and Follower terms in this specification maps to Master and Slave terms respectively for gPTP time synchronization as specified in IEEE Std 8021AS 104 and IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1116",
    "document_id": "23501-i80",
    "chunk_id": 1116,
    "text": "This terminology can require update depending on the IEEE 1588 WG response to SA WG2 NOTE 3 The sum of the UE-DS-TT residence time and the PDB of the QoS Flow needs to be lower than the residence time upper bound requirement for a time-aware system specified in IEEE Std 8021AS 104 in the following cases a If the PTP port in DS-TT is in Follower state and a PTP port in the NW-TT is in Leader state or b a PTP port in DS-TT is in Leader state and a PTP port in NW-TT is in Follower state NOTE 4 If the PTP port in DS-TT is in a Follower state and a PTP port in another DS-TT is in Leader state then the sum of the residence time for these two DS-TT ports and the PDB of the QoS flow of the two PDU Sessions needs to be lower than the residence time upper bound requirement for a time-aware system specified in IEEE Std 8021AS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1117",
    "document_id": "23501-i80",
    "chunk_id": 1117,
    "text": "104 A UE receives the gPTP messages and forwards them to the DS-TT The DS-TT then creates egress timestamping TSe for the gPTP event Sync messages for external TSN working domains The difference between TSi and TSe is considered as the calculated residence time spent within the 5G system for this gPTP message expressed in 5GS time The DS-TT then uses the rateRatio contained inside the gPTP message payload carried within Sync message for one-step operation or Follow_up message for two-step operation to convert the residence time spent within the 5GS in TSN GM time and modifies the payload of the gPTP message that it sends towards the downstream TSN node gPTP entity connected to DS-TT as follows - Adds the calculated residence time expressed in TSN GM time to the correction field - Removes Suffix field that contains TSi If the ingress DS-TT has indicated support of the IEEE Std 8021AS 104 PTP profile as described in clause K21 and the network has configured a PTP instance with the IEEE Std 8021AS 104 PTP profile for the ingress DS-TT the ingress DS-TT performs the following operations for received UL gPTP messages for the PTP instance - Adds the link delay from the upstream TSN node gPTP entity connected to DS-TT in TSN GM time to the correction field - Replaces the cumulative rateRatio received from the upstream TSN node gPTP entity connected to DS-TT with the new cumulative rateRatio - Adds TSi in the Suffix field of the gPTP packet The UE transparently forwards the gPTP message from DS-TT to the UPFNW-TT If the ingress DS-TT port is in Passive state the UPFNW-TT discards the gPTP messages If the ingress DS-TT port is in Follower state the UPFNW-TT forwards the gPTP messages as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1118",
    "document_id": "23501-i80",
    "chunk_id": 1118,
    "text": "In the case of synchronizing end stations behind NW-TT the egress port is in UPFNW-TT For the received UL gPTP messages the egress UPFNW-TT performs the following actions - Adds the calculated residence time expressed in TSN GM to the correction field - Removes Suffix field that contains TSi - In the case of synchronizing TSN end stations behind DS-TT the egress TT is DS-TT of the other UE and the UPFNW-TT uses the port number of the ingress DS-TT and domainNumber and sdoId in the received gPTP message to assign the gPTP message to a PTP instance in the NW-TT If the NW-TT does not have a matching PTP instance the UPFNW-TT discards the message The UPFNW-TT then forwards the received UL gPTP message to the PTP ports in DS-TTs in Leader state within this PTP instance The egress DS-TT performs same actions as egress UPFNW-TT in previous case 5271222 Distribution of PTP Sync and Follow_Up messages",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1119",
    "document_id": "23501-i80",
    "chunk_id": 1119,
    "text": "This clause applies if DS-TT and NW-TT support distribution of PTP Sync and Follow_Up messages PTP support by DS-TT and NW-TT may be determined as described in clause K21 The mechanisms for distribution of PTP GM clock and time-stamping described in this clause are according to IEEE Std 1588 126 for Transparent clock and for the case of Boundary clock when the GM is external where the originTimestamp or preciseOriginTimestamp is not updated by the 5GS as described by the exemption in clause 52711 If the 5GS acts as the GM with a PTP instance type Boundary clock then the 5GS updates the originTimestamp or preciseOriginTimestamp in case of two-step operation with the 5GS internal clock as described in clause 52717 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1120",
    "document_id": "23501-i80",
    "chunk_id": 1120,
    "text": "This means externally-observable behaviour of the PTP instance in 5GS needs to comply with IEEE Std 1588 126 Upon reception of a PTP event message from the upstream PTP instance the ingress TT ie NW-TT or DS-TT makes an ingress timestamping TSi for each PTP event ie Sync message The PTP port in the ingress TT measures the link delay from the upstream PTP instance as described in clause H4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1121",
    "document_id": "23501-i80",
    "chunk_id": 1121,
    "text": "The PTP port in the ingress TT modifies the PTP message payload carried within Sync message for one-step operation or Follow_Up message for two-step operation as follows - if the PTP port in the ingress TT has measured the link delay Adds the measured link delay from the upstream PTP instance in PTP GM time to the correction field - if the PTP port in the ingress TT has measured the link delay and rateRatio is used Replaces the cumulative rateRatio received from the upstream PTP instance with the new cumulative rateRatio - Adds TSi in the Suffix field of the PTP message as described in clause H2 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1122",
    "document_id": "23501-i80",
    "chunk_id": 1122,
    "text": "If the 5GS is configured to use the Cumulative frequency transfer method for synchronizing clocks as described in clause 1610 in IEEE Std 1588 126 ie when the cumulative rateRatio is measured then the PTP port in the ingress TT uses the cumulative rateRatio received inside the PTP message payload carried within Sync message for one-step operation or Follow_Up message for two-step operation to correct the measured link delay to be expressed in PTP GM time as specified in IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1123",
    "document_id": "23501-i80",
    "chunk_id": 1123,
    "text": "The PTP port in the ingress TT then calculates the new cumulative rateRatio ie the cumulative rateRatio of the 5GS as specified in IEEE Std 1588 126 NOTE 3 If 5GS acts as an end-to-end Transparent Clock since the end-to-end Transparent Clock does not support peer-to-peer delay mechanism the residence time can be calculated with the residence time spent within the 5GS in 5G GM time and if needed with a correction factor for instance as specified in Equation 6 of clause 1222 of IEEE Std 1588 126 this gives a residence time expressed in PTP GM time that is used to update the correction field of the received PTP Sync or Follow_Up message The PTP port in the ingress TT then forwards the PTP message to the UPFNW-TT The UPFNW-TT further distributes the PTP message as follows - If the 5GS is configured to operate as Boundary Clock as described in IEEE Std 1588 126 the UPFNW-TT uses the port number of the ingress DS-TT and domainNumber and sdoId in the received PTP message to assign the PTP message to a PTP instance in the NW-TT If the NW-TT does not have a matching PTP instance the UPFNW-TT discards the message The UPFNW-TT then regenerates the Sync and Follow_Up for two-step operation messages based on the received Sync and Follow_Up messages for the PTP ports in Leader state in NW-TT and DS-TTs within this PTP instance The NW-TTUPF forwards the regenerated Sync and Follow_Up for two-step operation messages to the Leader ports in NW-TT and the PDU sessions related to the Leader ports in the DS-TTs within this PTP instance -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1124",
    "document_id": "23501-i80",
    "chunk_id": 1124,
    "text": "If the 5GS is configured to operate as a Transparent Clock as described in IEEE Std 1588 126 the UPFNW-TT uses the port number of the ingress TT and domainNumber and sdoId in the received PTP message to assign the PTP message to a PTP instance in the NW-TT If the NW-TT does not have a matching PTP instance the UPFNW-TT discards the message The UPFNW-TT then forwards the received Sync messages to PTP ports in DS-TTs within this PTP instance via corresponding PDU Sessions terminating to this UPF and to NW-TT ports within this PTP instance except toward the ingress PTP port in the ingress TT NOTE 4 If 5GS acts as a Transparent Clock the 5GS does not maintain the PTP port states the ingress PTP messages received on a PTP Port are retransmitted on all other PTP Ports of the Transparent Clock subject to the rules of the underlying transport protocol NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1125",
    "document_id": "23501-i80",
    "chunk_id": 1125,
    "text": "Due to the exemption described in clause 52711 when the PTP instance in 5GS is configured to operate as a Boundary Clock the 5GS does not need to synchronize its Local PTP Clock to the external PTP grandmaster The PTP instance in 5GS measures the link delay and residence time and communicates these in a correction field The externally observable behaviour of 5GS still conforms to the specifications for a Boundary Clock as described in IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1126",
    "document_id": "23501-i80",
    "chunk_id": 1126,
    "text": "The PTP port in the egress TT then creates egress timestamping TSe for the PTP event ie Sync messages for external PTP network The difference between TSi and TSe is considered as the calculated residence time spent within the 5G system for this PTP message expressed in 5GS time The PTP port in the egress TT then uses the rateRatio contained inside the PTP message payload if available carried within Sync message for one-step operation or Follow_Up message for two-step operation to convert the residence time spent within the 5GS in PTP GM time The PTP port in the egress TT modifies the payload of the PTP message Sync message for one-step operation or Follow_Up message for two-step operation that it sends towards the downstream PTP instance as follows - Adds the calculated residence time to the correction field - Removes Suffix field of the PTP message that contains TSi NOTE 6 If 5GS acts as an end-to-end Transparent Clock since the end-to-end Transparent Clock does not support peer-to-peer delay mechanism the residence time is calculated with the residence time spent within the 5GS in 5G GM time and if needed corrected for instance with the factor as specified in Equation 6 of clause 1222 of IEEE Std 1588 126 to get it expressed in PTP GM time The residence time is used to update the correction field of the received PTP event eg Sync or Follow_Up message 52713 Support for multiple gPTP domains This clause describes support for multiple domains for gPTP and PTP and for GM clocks connected to DS-TT and NW-TT and only applies if DS-TT and NW-TT support the related functionality PTP support and support of gPTP for GM clocks connected to DS-TT by DS-TT and NW-TT may be determined as described in clause K21",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1127",
    "document_id": "23501-i80",
    "chunk_id": 1127,
    "text": "Each gPTP domain sends its own gPTP messages The gPTP message carries a specific PTP domainNumber that indicates the time domain they are referring to The PTP port in ingress TT makes ingress timestamping TSi for the gPTP event messages of all domains and forwards the gPTP messages of all domains to the UPFNW-TT that further distributes the gPTP messages to the egress TTs as specified in clause 527122 The PTP port in the egress TT receives the original PTP GM clock timing information and the corresponding TSi via gPTP messages for one or more gPTP domains The PTP port in the egress TT then makes egress timestamping TSe for the gPTP event messages for every gPTP domain Ingress and egress time stamping are based on the 5G system clock at NW-TT and DS-TT NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1128",
    "document_id": "23501-i80",
    "chunk_id": 1128,
    "text": "An end-station can select PTP timing information of interest based on the domainNumber in the gPTP message The process described in clause 527122 is thus repeated for each gPTP domain between a DS-TT and the NW-TT it is connected to NOTE 2 If all gPTP domains can be made synchronous and the synchronization can be provided by the 5G clock the NW-TT or DS-TTs generates the gPTP event messages of all domains using 5G clock as described in clause 52717 NOTE 3 This Release of the specification supports multiple gPTP domains as defined in IEEE Std 8021AS 104",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1129",
    "document_id": "23501-i80",
    "chunk_id": 1129,
    "text": "If a 5GS TSN bridge supports stream gates andor transmission gates as defined in IEEE Std 8021Q 98 then they operate based on a single given gPTP domain 52714 DS-TT and NW-TT Time Synchronization functionality This clause describes the support of Time Synchronization functionality supported by the 5G System Synchronization between UPFNW-TT and NG-RAN is outside scope of 3GPP DS-TT and NW-TT may support the following PTP instance types - Boundary Clock as defined in IEEE Std 1588 126 as described in clause 52711 - End-to-End Transparent Clock as defined in IEEE Std 1588 126 as described in clause 52711 - Peer-to-Peer Transparent Clock as defined in IEEE Std 1588 126 as described in clause 52711 - PTP Relay instance as defined in IEEE Std 8021AS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1130",
    "document_id": "23501-i80",
    "chunk_id": 1130,
    "text": "104 Editors note Support for external networks operating with IEEE Std 1588-2008 107 is for further study DS-TT and NW-TT may support the following transports for PTP - IPv4 as defined in IEEE Std 1588 126 Annex C - IPv6 as defined in IEEE Std 1588 126 Annex D IEEE Std 8023 131 Ethernet as defined in IEEE Std 1588 126 Annex E For operation as a Boundary clock or as a Transparent Clock DS-TT and NW-TT may support the following path and link delay measurement methods - Delay request-response mechanism as described in clause 113 of IEEE Std 1588 126 - Peer-to-peer delay mechanism as defined in clause 114 of IEEE Std 1588 126 DS-TT and NW-TT may support acting as a PTP grandmaster ie may support generating gPTP Announce Sync and Follow_Up messages DS-TT and NW-TT supporting gPTP shall support one or more PTP profiles as described in clause 203 of IEEE Std 1588 126 ie - Default PTP Profiles in IEEE Std 1588",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1131",
    "document_id": "23501-i80",
    "chunk_id": 1131,
    "text": "126 Annex I - IEEE Std 8021AS 104 PTP profile for transport of timing as defined in IEEE Std 8021AS 104 Annex F - SMPTE Profile for Use of IEEE Std 1588 126 Precision Time Protocol in Professional Broadcast Applications ST 2059-22015 127 TSN AF and TSCTSF may determine the PTP functionalities supported by DS-TT and NW-TT and may configure PTP instances in DS-TT and NW-TT using port and user plane node management information exchange as described in Annex K clause K2 NOTE How the TSN AF or TSCTSF assigns NW-TT ports of one NW-TT to different PTP instances is up to implementation 52715 Detection of gPTP Sync and Announce timeouts The procedure described in this clause is applicable when the PTP instance in 5GS is configured to operate as a time-aware system or as a Boundary Clock and the PTP grandmaster is external to the 5GS and the BMCA procedure Method a is used as described in clause 52716 The NW-TT processes Announce messages according to IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1132",
    "document_id": "23501-i80",
    "chunk_id": 1132,
    "text": "In particular the NW-TT shall compute and maintain the time when the Announce and Sync timeout events occur for the PTP port in a Follower state When the 5GS is configured to operate as a time-aware system the NW-TT shall determine the Sync and Announce message interval for the PTP Port at the other end of the link to which the Follower PTP Port in 5GS is attached as described in IEEE Std 8021AS 104 When the 5GS is configured to operate as a Boundary Clock the NW-TT shall determine Announce interval based on the configuration of the Follower port in 5GS as described in IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1133",
    "document_id": "23501-i80",
    "chunk_id": 1133,
    "text": "The configuration of PTP instances in DS-TT and NW-TT for Sync and Announce timeouts is described in clause K2 Upon detection of the Sync or Announce timeout event the NW-TT shall re-evaluate the DS-TT and NW-TT port states as described in clause 52716 52716 Distribution of Announce messages and best master clock selection The procedure described in this clause is applicable if DS-TT and NW-TT support operating as a Boundary Clock described in IEEE Std 1588 126 or as a time-aware system support of the IEEE 8021AS 104 PTP profile and when the PTP instance in 5GS is configured to operate as a time-aware system or as a Boundary Clock Whether DS-TTNW-TT support operating as a Boundary Clock or as a time-aware system may be determined as described in clause K21",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1134",
    "document_id": "23501-i80",
    "chunk_id": 1134,
    "text": "The externally-observable behaviour of the Announce message handling by 5GS needs to comply with IEEE Std 8021AS 104 or IEEE Std 1588 126 respective to the configured mode of operation The DS-TT forwards the received Announce messages to NW-TT over User plane The NW-TT port forwards the received Announce messages from N6 interface to NW-TT The NW-TT maintains the PTP port state for each DS-TT port and NW-TT port The PTP port states may be determined by NW-TT either via - Method a BMCA procedure - Method b local configuration When Method b is used the following applies - When the PTP GM is external to the 5GS for one of the NW-TT or DS-TT ports per each PTP domain the PTP port state is Follower and for all other NW-TT and DS-TT ports of the same PTP domain the PTP port state is set either to Passive or Leader depending on implementation - When the 5GS is configured as a grandmaster for a gPTP domain for the connected networks all NW-TT ports and DS-TT ports are set to Leader state for that gPTP domain The local configuration of PTP port states in DS-TT and NW-TT for Method b is described in clause K2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1135",
    "document_id": "23501-i80",
    "chunk_id": 1135,
    "text": "When the Method a is used PTP port states are determined by BMCA procedure the NW-TT needs to process the received Announce messages from NW-TT ports and over user plane from the DS-TTs for BMCA procedure determine port states within the 5GS and maintain the Leader-Follower hierarchy The DS-TT maintains the Disabled Initializing and Faulty if applicable state for the PTP ports in DS-TT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1136",
    "document_id": "23501-i80",
    "chunk_id": 1136,
    "text": "While in Disabled Initializing or Faulty state the port in the DS-TT discards any gPTP messages it may receive from the upstream PTP instance or from the NW-TT via user plane When the 5GS Clock is determined as a grandmaster for a gPTP domain the Announce messages are distributed as described in clause 52717 When the grandmaster is external to the 5GS the NW-TT regenerates the Announce messages based on the Announce messages received from Follower port in NW-TT or DS-TT for the Leader ports in NW-TT and DS-TTs The NW-TTUPF forwards the regenerated Announce messages to the PDU sessions related to the Leader ports in the DS-TTs NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1137",
    "document_id": "23501-i80",
    "chunk_id": 1137,
    "text": "The TSN AF or TSCTSF can use the portDSportState in the Time synchronization information for each DS-TT port element in UMIC to read and get notified for the port state changes for the PTP ports in DS-TTs and the portDSportState in PMIC to read and get notified for the port state changes for the PTP ports in NW-TT Based on the change of the port states TSN AF or TSCTSF can determine that an external Grandmaster PTP Instance is found to be used instead of the GM in 5GS or the GM in 5GS is selected as the Grandmaster PTP Instance and TSN AF or TSCTSF can disable or enable the gPTP grandmaster functionality in DS-TTs respectively NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1138",
    "document_id": "23501-i80",
    "chunk_id": 1138,
    "text": "The TSN AF or TSCTSF can use the portDSportState in PMIC to read and get notified for the port state changes for the PTP ports in DS-TT for the port state Disabled Initializing or Faulty if applicable The TSCTSF or TSN AF can use the portDSportEnable to indicate to the NW-TT that the DS-TT port is disabled This avoids unnecessary gPTP traffic over User Plane to a DS-TT port in Disabled Initializing or Faulty state 52717 Support for PTP grandmaster function in 5GS The 5GS that is configured to operate as a time-aware system or Boundary Clock may support acting as a PTP grandmaster for a gPTP domain The configuration of PTP instances in DS-TT and NW-TT for PTP grandmaster function is described in clause K2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1139",
    "document_id": "23501-i80",
    "chunk_id": 1139,
    "text": "The following options may be supported per DS-TT for the 5GS to generate the Sync Follow_Up and Announce messages for the Leader ports on the DS-TT a NW-TT generates the Sync Follow_Up and Announce messages on behalf of DS-TT eg if DS-TT does not support this The NW-TTUPF forwards the generated Sync Follow_Up and Announce messages to the PDU sessions related to the Leader ports on the DS-TTs The NW-TT timestamps the gPTP event message when the event message is sent to the PDU Session and adds TSi corresponding to the timestamp to the Sync message and the OriginTimestamp corresponding to the timestamp to Sync message if one-step operation is used or PreciseOriginTimestamp corresponding to the timestamp to Follow_Up message if two-step operation is used and sets the cumulative rateRatio value with 1 The OriginTimestamp or PreciseOriginTimestamp shall be set by NW-TTUPF to the 5GS internal clock When DS-TTs receive the Sync Follow_Up messages it modifies the payload of the Sync Follow_Up message as described for the PTP port in the egress TT in clause 5271222 b DS-TT generates the Sync Follow_Up and Announce messages in this DS-TT The OriginTimestamp or PreciseOriginTimestamp shall be set by DS-TT to the 5GS internal clock",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1140",
    "document_id": "23501-i80",
    "chunk_id": 1140,
    "text": "In both options the NW-TT generates the Sync Follow_Up and Announce messages for the Leader ports on the NW-TT 52718 Exposure of Time Synchronization 5G System supports time synchronization service that can be activated and deactivated by AF Exposure of time synchronization comprises the following capabilities -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1141",
    "document_id": "23501-i80",
    "chunk_id": 1141,
    "text": "The AF may learn 5GS andor UE availability and capabilities for time synchronization service - The AF controls activation and deactivation of the time synchronization service for the target UEs - The AF may subscribe to time synchronization service status for the target UEs The AF may use the service-specific parameters to control the time synchronization service for targeted UEs These parameters are specified in clause 41593 and 41594 of TS 23502 3 for gPTP-based and 5G access stratum-based time synchronization services respectively The AF may subscribe for 5GS andor UE availability and capabilities for time synchronization service The AF indicates in the request the DNN S-NSSAI and in addition the AF may indicate a list of UE identities or group identity to limit the subscription only to corresponding UEs If the AF does not indicate DNN S-NSSAI the NEF determines the DNN S-NSSAI based on the AF Identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1142",
    "document_id": "23501-i80",
    "chunk_id": 1142,
    "text": "The TSCTSF directly or via NEF exposes the 5GS andor UE availability and capabilities for synchronization service to the AF as described in clause 41592 of TS 23502 3 The exposed information includes the list of user plane node identities the list of UE identities and may include the supported capabilities for gPTP time synchronization service per user plane node and UE The AF request to control the gPTP time synchronization service is sent to the TSCTSF directly or via NEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1143",
    "document_id": "23501-i80",
    "chunk_id": 1143,
    "text": "The request is targeted to a set of AF-sessions that are associated with the exposure of UE availability and capabilities for synchronization service The AF may request to use a specific PTP instance type when requesting the gPTP-based time synchronization distribution method IEEE Std 1588 126 or IEEE Std 8021AS 104 operation ie as a Boundary Clock peer-to-peer Transparent Clock or end-to-end Transparent Clock or as a PTP relay instance The request to control the gPTP time synchronization service may contain other service parameters as specified in Table 41593-1 in clause 41593 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1144",
    "document_id": "23501-i80",
    "chunk_id": 1144,
    "text": "The AF may request to use the 5G access stratum as a time synchronization distribution method In this case the time source is provided by the 5GS 5G-AN provides the 5GS time to the UE via 3GPP radio access UEDS-TT may provide 5G access stratum timing information to end stations using implementation specific means The request to control the 5G access stratum time distribution including the parameters such AF requests may contain is described in clause 41594 of TS 23502 3 The AF or NEF selects the TSCTSF as specified in clause 6324 The AF request may include a time synchronization error budget see also clause 52719 The time synchronization error budget defines an upper bound for time synchronization errors introduced by 5GS The AF uses the procedure for configuring the gPTP instance in 5GS as described in clause 41593 of TS 23502 3 and uses the procedure for providing the 5G access stratum time distribution as described in clause 41594 of TS 23502 3 for the UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1145",
    "document_id": "23501-i80",
    "chunk_id": 1145,
    "text": "The TSCTSF uses the Time Synchronization parameters Table 41593-1 in TS 23502 3 as received from the AF directly or via NEF to control the gPTP time synchronization service When IEEE Std 1588 126 or IEEE Std 8021AS 104 operation have been selected the TSCTSF determines the necessary gPTP parameters to activate and control the service in DS-TTs and NW-TTs For this purpose the TSCTSF uses the PMIC or UMIC to manage the IEEE Std 1588 126 or IEEE Std 8021AS 104 operation in the DS-TTs or NW-TTs respectively see clause 52714 The TSCTSF may indicate whether it can support the service or not as per the requested acceptance criteria eg based on the known timing synchronization status attribute thresholds also pre-configured at gNB and provide notification when there is a service status update if the AF subscribes to service status updates see also clause 527112",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1146",
    "document_id": "23501-i80",
    "chunk_id": 1146,
    "text": "The TSCTSF uses the Time Synchronization parameters Table 41594-1 of TS 23502 3 as received from the AF directly or via NEF to control the 5G access stratum time synchronization distribution as described in clause 41594 of TS 23502 3 For handling gPTP traffic the PCF according to PCC rule authorization chooses a 5QI and dynamically set the PDB andor MDBV according to requirements for gPTP protocol The PCF provides the SMF with a PCC rule generated based on the AF request to control the gPTP time synchronization service The SMF may take the information in the PCC rule to modify a PDU Session to create or modify or release a QoS Flow for transmitting the gPTP messages The PCF acknowledges the policy request to the TSCTSF The TSCTSF may report the result of the time synchronization request to the AF directly or via NEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1147",
    "document_id": "23501-i80",
    "chunk_id": 1147,
    "text": "The AF may provide a temporal validity condition to the TSCTSF directly or via NEF when the AF activates or modifies the time synchronization service Temporal validity condition contains the start-time and stop-time in absolute time value attributes that describe the time period when the time synchronization service is active for the targeted AF sessions The TSCTSF manages the temporal validity condition as described in clauses 41593 and 41594 of TS 23502 3 The AF may provide clock quality detail level and clock quality acceptance criteria to the TSCTSF directly or via NEF when the AF activates or modifies the time synchronization service For ASTI based time synchronization services the TSCTSF provides the clock quality reporting control information to AMF see also clause 527112",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1148",
    "document_id": "23501-i80",
    "chunk_id": 1148,
    "text": "The AF may provide a requested coverage area for the time synchronization service to the TSCTSF directly or via NEF when the AF activates or modifies the time synchronization service The requested coverage area defines a spatial validity condition for the service using a geographical area eg a civic address or shapes or a list of Tracking Area Identities TAIs see also clause 527110 52719 Support for derivation of Uu time synchronization error budget The AF may request a specific time synchronization error budget when requesting a time synchronization service employing the gPTP-based or 5G access stratum-based time distribution method If the AF includes a time synchronization error budget in its request the TSCTSF uses it to derive an error budget available for the NG-RAN to provide the 5G access stratum time via the Uu interface to each targeted UE referred to as Uu time synchronization error budget hereafter The Time Synchronization Subscription data may optionally contain the authorized Uu time synchronization error budget When the TSCTSF receives an AF request with a specific time synchronization error budget for the time synchronization service the TSCTSF validates the Uu time synchronization error budget as described in clause 527111 To derive the Uu time synchronization error budget for each targeted UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1149",
    "document_id": "23501-i80",
    "chunk_id": 1149,
    "text": "the TSCTSF takes the following into account - selected time synchronization distribution method ie 5G access stratum-based time distribution or gPTP-based time distribution - Uu time synchronization error budget in the Time Synchronization Subscription data defined in clause 527111 - in the case of the gPTP-based time distribution - whether 5GS operates as a boundary clock and acts as a GM - whether a clock connected to the DS-TTNW-TT acts as a GM - PTP port states - a CN part and a Device part of the time synchronization error budget both parts may be predefined at the TSCTSF or calculated by the 5GS using the implementation-specific means If the AF does not include a time synchronization error budget the TSCTSF uses a preconfigured time synchronization error budget to derive the Uu time synchronization error budget TheTSCTSF provides a 5G access stratum time distribution indication and the derived Uu time synchronization error budget to NG-RAN as described in clause 41594 of TS 23502 3 Based on this NG-RAN provides the 5G access stratum time to the UE according to the Uu interface time synchronization error budget as provided by the TSCTSF if supported by UE and NG-RAN During Handover Service Request mobility registration and AM policy modification procedure the AMF may provide the 5G access stratum time distribution indication and the Uu time synchronization error budget to NG-RAN as described in clause 41594 of TS 23502 3 if needed NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1150",
    "document_id": "23501-i80",
    "chunk_id": 1150,
    "text": "This release of the specification assumes that deployments ensure that the targeted UEs and the NG-RAN nodes serving those UEs support Rel-17 propagation delay compensation as defined in TS 38300 27 527110 Support for coverage area filters for time synchronization service This feature enables the AF to request time synchronization service for a UE or a group of UEs in a specific geographical area so called coverage area The requested coverage area contains a list of Tracking Area TA or a geographical area eg a civic address or shapes that the NEF transforms to list of TAs based on pre-configuration TSCTSF checks with the UDM if the UE is allowed to receive the time synchronization service requested by AF and may update the Time Synchronization Coverage Area as described in clause 527111 The coverage area defines a spatial validity condition for the targeted UEs that is resolved at the TSCTSF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1151",
    "document_id": "23501-i80",
    "chunk_id": 1151,
    "text": "In order to do that the TSCTSF may either a discover the AMFs serving the list of TAs that comprise the spatial validity using Nnrf_NFDiscovery_Request service from the NRF and subsequently the TSCTSF subscribes to the discovered AMFs to receive notifications about presence of the UE in an Area of Interest events as described in clause 5344",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1152",
    "document_id": "23501-i80",
    "chunk_id": 1152,
    "text": "The subscription is targeted to Any UE To reduce the number of Area of Interest reports based on presence of UE for the discovered AMFs the TSCTSF may provide additional filtering information eg List of UE IDs DNNsS-NNSAIs to limit the subscription to the indicated UE identities or UEs having a PDU Session with the given DNNS-NSSAI as specified in clause 5344 b determine the serving AMF for each of the targeted UEs using the UDM and subscribe to the serving AMF to receive notification about presence of the UE in an Area of Interest as described in clause 5344 An Area of Interest AoI for each AMF is represented by a list of TAs wherein the Area of Interest is identical to the Time Synchronization Coverage Area Based on the outcome provided by the AMF about the UEs presence in the AoI the TSCTSF determines if the time synchronization service is activated or deactivated For access stratum distribution activationdeactivation the TSCTSF will enabledisable access stratum time distribution to the UE at the serving NG-RAN node reusing the procedures in clause 41594 of TS 23502 3 For gPTP distribution activationdeactivation the TSCTSF will modify the PTP instance configuration by means of sending a PMIC to the impacted UEDS-TTs and UMIC to the impacted UPFNW-TT as described in clause K22",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1153",
    "document_id": "23501-i80",
    "chunk_id": 1153,
    "text": "If the time synchronization service is modified based on the reports of UE presence in the Area of Interest the TSCTSF informs the AF for the impacted UEs by indicating the PTP port state for the related DS-TT PTP port in the case of gPTP based time distribution or notifying the AF with the indication of 5G access status time distribution status enabled or disabled for ASTI based time distribution If the Time Synchronization Coverage Area requested by the AF includes at least one TA that is a part of UEs Registration Area RA the 5GS may provide the AF-requested time synchronization service to the targeted UE within its RA ie all TAs of the RA shall be treated as a Time Synchronization Coverage Area even if some of the TAs were not requested by the AF NOTE 1 This ensures that 1 there is no impact on the Registration Area RA of UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1154",
    "document_id": "23501-i80",
    "chunk_id": 1154,
    "text": "ifwhen the AMF receives a time synchronization service request with a spatial validity condition ie for specific geographical area and 2 the UE can continue receiving the time synchronization service when it moves within the RA in the RRC_IDLE state NOTE 2 Since the RA can be specific to the UE the result can be different Time Synchronization Coverage Area for different DS-TT ports of different UEs within a PTP instance 527111 Controlling time synchronization service based on the Subscription The distribution of timing information 5G access stratum-based time distribution and gPTP-based time distribution for a UE may be controlled based on subscription data stored in the UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1155",
    "document_id": "23501-i80",
    "chunk_id": 1155,
    "text": "The gPTP-based or 5G access stratum-based time synchronization service may be provided to a UE based on the UEs subscription which is specified in the TS 23502 3 clause 52331 The Access and Mobility Subscription data include the following information for the control of 5G access stratum-based time distribution - the Access Stratum Time Synchronization Service Authorization which indicates whether the UE should be provisioned with 5G system internal clock timing information over access stratum as specified in TS 38331 28 - optionally the Uu time synchronization error budget - optionally one or more periods of start and stop times defining the times when the UE should be provisioned with 5G system internal clock timing information - optionally a Time Synchronization Coverage Area comprising a list of TAs where the UE shall be provisioned with 5G system internal clock timing information - optionally a clock quality detail level indicating whether and which clock quality information to provide to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1156",
    "document_id": "23501-i80",
    "chunk_id": 1156,
    "text": "It comprises one of the following values clock quality metrics or acceptablenot acceptable indication - optionally the clock quality acceptance criteria for the UE It may be defined based on one or more attributes listed in Table 527112-1 During the Registration procedure the AMF retrieves the subscription from UDM If the AMF receives 5G access stratum-based time synchronization service subscription for the given UE the AMF controls the 5G access stratum-based time distribution - If the 5G access stratum-based time synchronization service is allowed for the UE the AMF provides the 5G access stratum time distribution indication to the NG-RAN so that it can provide 5G timing information to the UE - The AMF may provide a Uu time synchronization error budget to the NG-RAN as described in clause 52719 If the UEs subscription contains a Uu time synchronization error budget then AMF sends it to NG-RAN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1157",
    "document_id": "23501-i80",
    "chunk_id": 1157,
    "text": "Otherwise the AMF uses the pre-configured Uu time synchronization error budget and sends it to NG-RAN - If the UEs subscription contains Coverage Area defined as a list of TAs the AMF configures the NG-RAN to provide the 5G timing information to UE only when the UE is in the Coverage Area as described in clause 527110 - If the AMF receives the start and stop times then the AMF enables and disables the 5G access stratum time distribution indication to the NG-RAN according to the expiry of start and stop times if the UE is in CM-CONNECTED state If the UE is in CM-IDLE state when a Start time condition is met the AMF pages the UE and provides the 5G access stratum time distribution indication to NG-RAN as part of the subsequent service request procedure initiated by the UE in the response to the paging - If the AMF receives the clock quality detail level then the AMF configures the NG-RAN to provide clock quality detail information reporting to UE as described in clause 527112",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1158",
    "document_id": "23501-i80",
    "chunk_id": 1158,
    "text": "The AMF may instruct the UE to reconnect to the network when the UE detects that the RAN timing synchronization status has changed while the UE is in RRC_INACTIVE or RRC_IDLE as described in clause 527112 - If the AMF receives the same parameters both in the Access and Mobility Subscription data from UDM and in the AM Policy from PCF the AMF shall use the value received from the AM policy The Time Synchronization Subscription data is the subscription data for the control of gPTP-based time distribution and 5G access stratum-based time distribution and includes the following information - the AF request Authorization indicating whether the UE is authorized for an AF-requested 5G access stratum-based time distribution and gPTP-based time distribution services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1159",
    "document_id": "23501-i80",
    "chunk_id": 1159,
    "text": "The indication is provided separately for each service - allowed or not allowed for gPTP based time synchronization service per DNNS-NSSAI and UE identity - allowed or not allowed for ASTI based time synchronization services per UE identity - If the AF request Authorization is set to allowed the Time Synchronization Subscription data may contain additional information for authorization of gPTP- and ASTI- based time synchronization services this information is optional and may be provided separately for authorization of each service - optionally a list of TAs which specifies an area a so-called Authorized Time Synchronization Coverage Area in which an AF may request time synchronization services - optionally one or more periods of authorized start and stop times which indicates the allowed time period during which an AF may request time synchronization services - optionally authorized Uu time synchronization error budget which indicates the limit the AF may request - optionally allowed or not allowed for clock quality detail level equals to clock quality metrics which indicates whether clock quality metrics information may be provided to the UE - optionally allowed or not allowed for clock quality detail level equals to acceptablenot acceptable indication which indicates whether an acceptablenot acceptable indication may be provided to the UE - optionally one or more sets of clock quality acceptance criteria for the UE using the TSS attributes as defined in clause 527112 NOTE 1 If the clock quality detail level set to acceptablenot acceptable indication is allowed clock quality acceptance criteria need to be provided - one or more Subscribed time synchronization service IDs each containing the DNNS-NSSAI and a reference to a PTP instance configuration pre-configured at the TSCTSF eg PTP profile PTP domain etc - optionally for each PTP instance configuration one or more periods of start and stop times defining active times of time synchronization service for the PTP instance - optionally for each PTP instance configuration a Time Synchronization Coverage Area defining a list of TAs where the gPTP-based time synchronization is available for the UEs in the PTP instance - optionally for each PTP instance configuration Uu time synchronization error budget The TSCTSF retrieves the Time Synchronization Subscription data from UDM If the TSCTSF receives the Time Synchronization Subscription data for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1160",
    "document_id": "23501-i80",
    "chunk_id": 1160,
    "text": "the TSCTSF controls the Time Synchronization Service including gPTP-based time distribution and 5G access stratum-based time distribution - The TSCTSF retrieves the Time Synchronization Subscription data from the UDM when the TSCTSF receives an AF request for the time synchronization service either ASTI or gPTP According to the AF request Authorization in the UEs Time Synchronization Subscription data the TSCTSF determines whether the UE is authorized for an AF-requested time synchronization service - If the UEs Time Synchronization Subscription data contains an Authorized Time Synchronization Coverage Area ie a list of TAs defining the restricted area for AF request TSCTSF checks whether the AF requested Coverage Area satisfies the authorized area If the requested Coverage Area see clause 527110 is within the Authorized Time Synchronization Coverage Area the TSCTSF uses the requested Coverage Area",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1161",
    "document_id": "23501-i80",
    "chunk_id": 1161,
    "text": "If the Authorized Time Synchronization Coverage Area is inside of the requested Coverage Area the TSCTSF uses the Authorized Time Synchronization Coverage Area If the requested Coverage Area partly overlaps with the Authorized Time Synchronization Coverage Area the TSCTSF uses the intersection of them If there is no overlap between them the TSCTSF shall reject the AF request - If the AF requested Coverage Area satisfies the authorized area totally or partly TSCTSF notifies to AF with the Time Synchronization Service information based on the Authorized Time Synchronization Coverage Area TSCTSF subscribes to UEs presence in the Area of Interest at the discovered AMFs if the UEs moves out of the Time Synchronization Coverage Area requested by AF or updated by TSCTSF the TSCTSF shall disable Time Synchronization Service and notifies to AF - If the UEs Time Synchronization Subscription data contains authorized Uu time synchronization error budget the TSCTSF checks whether the Uu time synchronization error budget derived from AF request satisfies ie equal or larger than the authorized Uu time synchronization error budget -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1162",
    "document_id": "23501-i80",
    "chunk_id": 1162,
    "text": "If the UEs Time Synchronization Subscription data contains periods of authorized start and stop times the TSCTSF checks whether the AF requested temporal validity condition satisfies ie within any of the periods of authorized start and stop times If such period is found the TSCTSF uses the start and stop times of the AF request - If the UEs Time Synchronization Subscription data contains a clock quality detail level and clock quality acceptance criteria if applicable the TSCTSF checks whether the AF-requested clock quality information to be reported complies with the authorized clock quality detail level and the clock quality acceptance criteria if applicable in the UEs Time Synchronization Subscription data Each parameter in the AF-requested clock quality is evaluated individually if the TSCTSF determines that at least one parameter is not acceptable the TSCTSF rejects the AF request If the Traceable to GNSS in the subscription data is Yes the AF request for Traceable to GNSS is allowed Otherwise the AF request for Traceable to GNSS is not allowed If the Traceable to UTC in the subscription data is Yes the AF request for Traceable to UTC is allowed Otherwise the AF request for Traceable to UTC is not allowed For Frequency stability and Clock Accuracy AF is not allowed to request value which is lower than value in subscription data - If the AF request is authorized the TSCTSF proceeds as specified in clause 52718 and in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1163",
    "document_id": "23501-i80",
    "chunk_id": 1163,
    "text": "Otherwise the TSCTSF rejects the AF request - The TSCTSF retrieves the Time Synchronization Subscription data from the UDM when it receives notification from the PCF that a UE has established a PDU Session that is potentially impacted by gPTP-based time synchronization service - The TSCTSF retrieves the PTP instance configurations referenced from the Subscribed time synchronization service IDs The PTP instance configurations are stored locally in the TSCTSF The TSCTSF determines if one or more of the PTP instance configurations match with the DNNS-NSSAI of the given PDU Session If no PTP instance exists for the given PTP instance configuration the TSCTSF initializes the PTP instance in 5GS as described in clause K22 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1164",
    "document_id": "23501-i80",
    "chunk_id": 1164,
    "text": "The TSCTSF configures a PTP port in DS-TT and adds it to the corresponding PTP instance in NW-TT as described in clause K22 - If the PTP instance configuration referenced by UEs Time Synchronization Subscription data contains an Uu time synchronization error budget then the TSCTSF uses it to derive an Uu time synchronization error budget available for the NG-RAN to provide the 5G access stratum time for the UE as specified in clause 52719 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1165",
    "document_id": "23501-i80",
    "chunk_id": 1165,
    "text": "If the PTP instance configuration referenced by the Time Synchronization Subscription data for the UE contains start and stop times the TSCTSF upon expiry of start time creates the PTP instance and adds the PTP port in DS-TT to the PTP instance Upon expiry of stop time if this is the last period of start and stop times in the PTP instance configuration the TSCTSF deletes the PTP instance otherwise the TSCTSF temporarily removes the PTP port in DS-TT from the corresponding PTP instance as specified in clause 41593 of TS 23502 3 - If the PTP instance configuration referenced by the Time Synchronization Subscription data for the UE contains a Time Synchronization Coverage Area the TSCTSF subscribes to UEs Presence in Areas of Interest corresponding to the Time Synchronization Coverage Area at the discovered AMFs When the TSCTSF determines that the UE has moved inside or outside of the Time Synchronization Coverage Area the TSCTSF adds or temporarily removes the PTP port in DS-TT from the corresponding PTP instance 527112 Support for network timing synchronization status monitoring While the time synchronization service is offered by the 5GS based on 5G access stratum-based time distribution or gPTP-based time distribution the network timing synchronization status of the nodes involved in the operation eg gNBs andor UPFNW-TTs may change gNBs and UPFNW-TT can detect timing synchronization degradation or improvement locally The support for network timing synchronization status monitoring enables the 5GS to modify time synchronization service for a UE or a group of UEs depending on the current synchronization status and notify service updates There may be three consumers of this information - TSCTSF may receive node-level information about timing synchronization status from gNB andor UPFNW-TT directly from OAM or alternatively if supported by a node using control plane signalling at node level Node level signalling uses UMIC for UPFNW-TT case and an AMF service to report N2 node level information for the gNB case In the latter case the TSCTSF may provide a list of gNB IDs or a list of TAs in the subscription request for RAN timing synchronization status reporting and the AMF controls the gNB node level reporting and subscription using NGAP messages see TS 38413 34 - AF may subscribe to time synchronization status notifications for a UE or group of UEs for which the AF requests or has requested time synchronization service for 5G access stratum time distribution or gPTP services - For 5G access stratum time synchronization service the UE may receive clock quality information from the gNB based on UE subscription data stored in the UDM see clause 527111 or AF request for clock quality reporting to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1166",
    "document_id": "23501-i80",
    "chunk_id": 1166,
    "text": "When activating time synchronization for a UE TSCTSF forwards the clock quality detail level if available to the AMF via PCF using AM Policy Association Modification If the UE indicates its support for reconnection to the network due to changes in RAN timing synchronization status as specified in clause 544a and the AMF receives Clock Quality Reporting Control Information CQRCI either from TSCTSF via PCF or from the UDM as part of the subscription data the AMF instructs the UE to transition to the RRC_CONNECTED state when the UE detects that the gNB timing synchronization status has changed while the UE is in the RRC_INACTIVE or RRC_IDLE state When the UE wants to access the 5GS the UE shall perform Unified Access Control as defined in TS 38331 28 gNBs and TSCTSF may be pre-configured with thresholds for each Timing Synchronization Status TSS attribute if supported that is described in Table 527112-1 gNBs may include a reference report ID in SIB information if supported A reference report ID consists of a scope of the TSS and an Event ID A scope of the TSS supports providing TSS information for all cells or a group of cells within a single gNB",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1167",
    "document_id": "23501-i80",
    "chunk_id": 1167,
    "text": "Event ID is an integer indicating that the gNBs clock quality has changed resulting in at least one TSS attribute exceeding or meeting again the pre-configured threshold Uniqueness of Event ID value is ensured by combining it with a gNB ID as specified in TS 38300 27 The RAN timing synchronization status information includes the gNB node-level information about timing synchronization operation status as described in TS 38300 27 When the gNB is monitoring RAN timing synchronization status the gNB determines the reporting triggers as described in TS 38401 42",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1168",
    "document_id": "23501-i80",
    "chunk_id": 1168,
    "text": "The gNB notifies the TSCTSF either using N2 node level signalling via AMF or via OAM about timing synchronization status changes based on the pre-configured thresholds with the scope of the timing synchronization status ie gNB ID or a list of Cell IDs within a single gNB and the corresponding network timing synchronization status attributes as described in Table 527112-1 The gNB may support only one or more network timing synchronization status attributes Upon reception of the notification the TSCTSF determines whether the TSS attribute meets status improvement or exceeds status degradation the preconfigured threshold value The gNB indicates the status change to the UEs via the reference report ID change in SIB information - When the network timing synchronization status exceeds any of the pre-configured thresholds or meets the threshold again the gNB changes the reference report ID in SIB information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1169",
    "document_id": "23501-i80",
    "chunk_id": 1169,
    "text": "Either event serves as a notification for the UEs reading the SIB information that there is new TSS information available NOTE 1 NG-RAN is assumed not to provide clock quality metrics better than the pre-configured threshold ie if a clock quality metric is better than the corresponding threshold the NG-RAN reports the threshold value to the UE in an RRC message instead NOTE 2 It is assumed the pre-configured thresholds in the gNBs are sufficient to meet UE time sync performance requirement which are configured by the operator - If supported the UE in the RRC_INACTIVE or RRC_IDLE state compares the reference report ID in SIB information with its locally stored reference report ID to determine whether it has the latest available clock quality information already or it needs to transit to the RRC_CONNECTED state to retrieve it -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1170",
    "document_id": "23501-i80",
    "chunk_id": 1170,
    "text": "If the UE is instructed by AMF via the Registration procedure or the UE Configuration Update procedure to reconnect to the network in the case when the UE determines that the reference report ID has changed the UE in the RRC_INACTIVE or RRC_IDLE state if supported by the UE reconnects to the network RAN may delay or prioritize UEs transition to the RRC_CONNECTED state using the UAC framework 28 ie UEs are not expected to transition to the RRC_CONNECTED state immediately after determining that the clock quality information has changed and receiving instructions from the AMF After the UE has reconnected to the network the gNB uses unicast RRC signalling to provision the clock quality information to the UEs The network timing synchronization status information from gNB or UPFNW-TT to the TSCTSF may contain the following information as described in the Table 527112-1 The details for gNB timing synchronization status information are specified in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1171",
    "document_id": "23501-i80",
    "chunk_id": 1171,
    "text": "However it is up to gNB to determine whether to provide its timing synchronization status reporting and which of the information elements to include in the TSS report to the TSCTSF ie based on the implementation gNB may report all or some or none of the information elements from Table 527112-1 Table 527112-1 Information elements that gNB or UPFNW-TT timing synchronization status information may contain all optional The TSCTSF determines the UEs impacted by gNBs timing synchronization status change or UPF timing synchronization status change only for the case when UPFNW-TT is involved in providing time information to DS-TT by comparing the received timing synchronization status information with a clock quality acceptance criteria provided by the AF The TSCTSF evaluates whether the received timing synchronization status is acceptable or not acceptable for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1172",
    "document_id": "23501-i80",
    "chunk_id": 1172,
    "text": "Each TSS attribute in the clock quality acceptance criteria is evaluated individually if the TSCTSF determines that at least one reported value is not acceptable or there is at least one attribute present in the clock quality acceptance criteria is not reported then the TSCTSF shall consider the timing synchronization status as not acceptable for the UE - For the gNB case when the TSCTSF receives information about timing synchronization status change the TSCTSF uses the NRF to discover the AMFs serving the impacted gNBs and subscribes to receive notifications for UEs presence in Area of Interest information from AMF as described in clause 5344 The Area of Interest is set to the scope of the timing synchronization status ie gNB ID or a group of cells within the gNB specified with a list of Cell IDs that has reported status degradation ie the pre-configured thresholds are exceeded in the gNB",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1173",
    "document_id": "23501-i80",
    "chunk_id": 1173,
    "text": "The subscription is targeted to any UE in the AMF the TSCTSF may provide additional filtering information as specified in clause 5344 eg List of UE IDs DNNsS-NNSAIs to limit the subscription to the indicated UE identities UEs having a PDU Session with the given DNNsS-NSSAIs The TSCTSF correlates information about impacted gNBs and the UE location information received from the AMF If the gNB notifies the TSCTSF for the status improvement ie the pre-configured thresholds are met in the gNB the TSCTSF modifies the subscription to remove the corresponding Area of Interest from the subscription -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1174",
    "document_id": "23501-i80",
    "chunk_id": 1174,
    "text": "For UPF case the TSCTSF determines the UEs for which the impacted UPFNW-TT is configured to send gPTP messages on behalf of DS-TT see clause 52717 If the gNBs or UPFs timing synchronization status change the TSCTSF may perform the following - For AFs that subscribe for 5G access stratum time synchronization service or gPTP time synchronization service status update ie change in support status of the clock quality acceptance criteria provided by the AF and specified using TSS attributes from Table 527112-1 the TSCTSF may provide notification towards the AF when there is a change in support status for a UE or group of UEs - Deactivatingreactivatingupdating time synchronization services - gPTP time synchronization service case For UEs that are part of a PTP instance and which are impacted by NG-RAN or UPF time synchronization status degradation or improvement - If TSCTSF determines that the clock quality acceptance criteria provided by AF can still be met then TSCTSF may update the clock quality information sent in Announce messages see clause 762 of IEEE 1588 8 for the PTP instance using existing procedures and existing PMICUMIC information The handling of Announce messages follows existing procedures as described in clause 52716 - If TSCTSF determines that the clock quality acceptance criteria provided by AF cannot be met then TSCTSF informs the AF for the corresponding PTP ports being inactive due to the result of fulfilling the clock quality acceptance criteria and the TSCTSF temporarily removes the UEDS-TT from the PTP instance using the procedure in clause K221 and clause K224",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1175",
    "document_id": "23501-i80",
    "chunk_id": 1175,
    "text": "The AF may send a service update or delete request see clause 41593 of TS 23502 3 - If TSCTSF determines that the clock quality acceptance criteria provided by AF can be met again then TSCTSF informs the AF about the result adds the DS-TT PTP port to the PTP instance again and re-activates the Grandmaster functionality For 5G access stratum time synchronization service clock quality reporting control information CQRCI manages the gNBs timing synchronization status reporting to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1176",
    "document_id": "23501-i80",
    "chunk_id": 1176,
    "text": "The TSCTSF may retrieve CQRCI from UDM or receive CQRCI from AF request The TSCTSF needs to check whether the AF requested CQRCI is allowed as defined in clause 527111 When AMF provides the 5G access stratum time distribution indication and the Uu time synchronization error budget to gNB the AMF also includes the clock quality reporting control information CQRCI provided by the TSCTSF via AM policy or retrieved from UDM If the AMF receives CQRCI both in the Access and Mobility Subscription data from UDM and in the AM Policy from PCF the AMF shall use the value received from the AM policy CQRCI contains the following fields - Clock quality detail level It indicates whether and which clock quality information to provide to the UE and can take one of the following values clock quality metrics or acceptablenot acceptable indication - If the clock quality detail level equals clock quality metrics the NG-RAN provides clock quality metrics to the UE that reflect its current timing synchronization status ie one or more of the following information elements clock accuracy traceability to UTC traceability to GNSS frequency stability parent time source synchronization state as defined in Table 527112-1 NG-RAN is locally configured which of the clock quality metrics supported by NG-RAN are provided to UEs - If the clock quality detail level equals acceptablenot acceptable indication NG-RAN provides clock quality acceptance criteria for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1177",
    "document_id": "23501-i80",
    "chunk_id": 1177,
    "text": "The gNB provides an acceptable indication to the UE if the gNBs timing synchronization status matches the acceptance criteria received from the AMF otherwise the gNB indicates not acceptable to the UE Clock quality acceptance criteria can be defined based on one or more information elements listed in Table 527112-1 If AF includes clock quality acceptance criteria in its request towards TSCTSF the AF shall be notified about the result once TSCTSF determines whether the clock quality acceptance criteria can be met or not Based on the notification the AF may decide to modify the service if preferred eg disable the service upon status degradation or enable it again upon status improvement When determining the clock quality metrics for a UE and when determining whether clock quality is acceptable or not acceptable for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1178",
    "document_id": "23501-i80",
    "chunk_id": 1178,
    "text": "the gNB considers whether propagation delay compensation is performed NOTE 3 In this Release UE capabilities and internal inaccuracies are assumed to be budgeted by the client network operator when agreeing the required clock accuracy with the 5G network operator To provision clock quality information to the UEs a gNB uses unicast RRC signalling - For UEs in the RRC_CONNECTED state the gNB uses unicast RRC signalling - UEs that are not in the RRC_CONNECTED state first need to establish or resume the RRC connection to receive the clock quality information from the gNB via unicast RRC signalling During N2 Handover and Xn handover Service Request mobility registration and AM policy modification procedure the AMF may provide the CQRCI to NG-RAN 5271a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1179",
    "document_id": "23501-i80",
    "chunk_id": 1179,
    "text": "Periodic deterministic communication This clause describes 5G System features that allow support of periodic deterministic communication where the traffic characteristics are known a-priori and a schedule for transmission from the UE to a downstream node or from the UPF to an upstream node is provided via external protocols outside the scope of 3GPP eg IEEE 8021 TSN The features include the following - Providing TSC Assistance Information TSCAI that describe TSC flow traffic characteristics as described in clause 5272 at the gNB ingress and the egress of the UE for traffic in downlink and uplink direction respectively - Support for hold forward buffering mechanism see clause 5274 in DS-TT and NW-TT to de-jitter flows that have traversed the 5G System 5272 TSC Assistance Information TSCAI and TSC Assistance Container TSCAC 52721 General TSC Assistance Information TSCAI is defined in Table 5272-1 and describes TSC traffic characteristics for use in the 5G System It can also be used for services such as XR services ARVR applications and interactive media services as specified in clause 537 TSCAI may be used by the 5G-AN if provided by SMF The knowledge of TSC traffic pattern is useful for 5G-AN as it allows more efficiently scheduling of QoS Flows that have a periodic deterministic traffic characteristics either via Configured Grants Semi-Persistent Scheduling or with Dynamic Grants TSCAI can be provided for both GBR and non-GBR QoS flows The TSCTSF determines the TSC Assistance Container defined in Table 5272-2 based on information provided by an AFNEF or a DetNet controller as described in clause 52723 and provides it to the PCF for IP type and Ethernet type PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1180",
    "document_id": "23501-i80",
    "chunk_id": 1180,
    "text": "In the case of integration with IEEE TSN network the TSN AF determines TSC Assistance Container as described in clause 52722 and provides it to the PCF for Ethernet PDU Sessions The PCF receives the TSC Assistance Container from the TSCTSF or the TSN AF and forwards it to the SMF as part of PCC rule as described in clause 61323a of TS 23503 45 The SMF binds a PCC rule with a TSC Assistance Container to a QoS Flow as described in clause 61324 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1181",
    "document_id": "23501-i80",
    "chunk_id": 1181,
    "text": "The SMF uses the TSC Assistance Container to derive the TSCAI for that QoS Flow and sends the derived TSCAI to the NG-RAN The Periodicity Periodicity Range Burst Arrival Time BAT BAT Window and Survival Time components of the TSCAI are specified by the SMF with respect to the 5G clock The SMF is responsible for mapping the Burst Arrival Time BAT Window Periodicity and Periodicity Range from an external clock when available to the 5G clock based on the time offset and cumulative rateRatio when available between the external clock time and 5GS time as measured and reported by the UPF The SMF determines the TSCAI as described in clause 52724 A Survival Time which indicates the time period an application can survive without any data burst may be provided by TSN AFAF or by the TSCTSF either in terms of maximum number of messages message is equivalent to all packets of a data burst or in terms of time units Only a single data burst is expected within a single time period referred to as the periodicity The SMF may send an update of the TSCAI to the NG-RAN as defined in clauses 4332 49122 and 49132 of TS 23502 3 or as defined in clause 53782 Table 5272-1 TSC Assistance Information TSCAI Table 5272-2 TSC Assistance Container TSCAC 52722 TSC Assistance Container determination based on PSFP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1182",
    "document_id": "23501-i80",
    "chunk_id": 1182,
    "text": "In the case of integration with IEEE TSN network the TSN AF determines a TSC Assistance Container defined in Table 5272-2 and provides it to the PCF The determination of TSC Assistance Container based on Per-Stream Filtering and Policing PSFP information applies only to Ethernet type PDU Sessions NOTE 1 This clause assumes that PSFP information as defined in IEEE Std 8021Q 98 and Table K31-1is provided by CNC PSFP information may be provided by CNC if TSN AF has declared PSFP support to CNC TSN AF indicates the support for PSFP to CNC only if all the DS-TT and NW-TT ports of the 5GS Bridge have indicated support of PSFP Means to derive the TSC Assistance Container if PSFP is not supported by 5GS andor the CNC are beyond the scope of this specification The TSN AF may be able to identify the ingress port and thereby the PDU Session as described in clause 5282",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1183",
    "document_id": "23501-i80",
    "chunk_id": 1183,
    "text": "The TSN AF interfaces towards the CNC for the PSFP IEEE Std 8021Q 98 managed objects that correspond to the PSFP functionality implemented by the DS-TT and the NW-TT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1184",
    "document_id": "23501-i80",
    "chunk_id": 1184,
    "text": "Thus when PSFP information is provided by the CNC the TSN AF may extract relevant parameters from the PSFP configuration The TSN AF calculates traffic pattern parameters such as burst arrival time with reference to the ingress port and periodicity TSN AF also obtains the flow direction as specified in clause 5282 Survival Time may be pre-configured in TSN AF TSN AF may enable aggregation of TSN streams if the TSN streams belong to the same traffic class terminate in the same egress port and have the same periodicity and compatible Burst arrival time When Survival Time information is provided for a TSN stream then it should not be aggregated with other TSN streams into a single QoS Flow or if they are aggregated then the Survival Time parameter shall not be provided One set of parameters and one TSC Assistance Container are created by the TSN AF for multiple TSN streams to enable aggregation of TSN streams to the same QoS Flow Annex I describe how the traffic pattern information is determined NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1185",
    "document_id": "23501-i80",
    "chunk_id": 1185,
    "text": "Further details of aggregation of TSN streams including determination of burst arrival times that are compatible so that TSN streams can be aggregated are left for implementation NOTE 3 In order for the TSN AF to get Burst Arrival Time Periodicity on a per TSN stream basis support for IEEE Std 8021Q 98 as stated in clause 4482 Per-Stream Filtering and Policing PSFP with stream gate operation is a prerequisite For a UE-UE TSC stream the TSN AF divides the stream into one uplink stream and one or more downlink streams as defined in clause 5282",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1186",
    "document_id": "23501-i80",
    "chunk_id": 1186,
    "text": "The TSN AF binds the uplink and downlink streams to the PDU Sessions and provides the streams on AF Session basis to the PCFs The TSN AF calculates traffic pattern parameters for the UL and the DL stream using the PSFP configuration if provided respectively - For the uplink stream the Flow Direction is set to uplink and traffic pattern parameters such as burst arrival time with reference to the ingress port and periodicity is determined as described in Annex I - For downlink stream the Flow Direction is set to downlink the burst arrival time is set to sum of burst arrival time of the UL stream and 5GS Bridge delay of PDU Session carrying the UL stream and the periodicity is determined as described in Annex I 52723 TSC Assistance Container determination by TSCTSF The TSCTSF constructs TSC Assistance Container defined in Table 5272-2 based on information provided directly or via NEF by the AF for IP or Ethernet type PDU Sessions or by the DetNet controller for IP type PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1187",
    "document_id": "23501-i80",
    "chunk_id": 1187,
    "text": "In the case of an AF request the AF may provide Flow Direction Burst Arrival Time optional at the UEDS-TT uplink or UPFNW-TT downlink Maximum Burst Size Periodicity Survival Time optional and a Time Domain optional to the TSCTSF If the AF is able to adjust the burst sending time the AF may in addition provide a BAT Window or the Capability for BAT adaptation to the TSCTSF Addtionally if the AF is able to adjust the periodicity the AF may also provide the Periodicity Range along with the Periodicity to the TSCTSF Based on these parameters the TSCTSF constructs a TSC Assistance Container and provides it to PCF If the AF provides to the TSCTSF a Burst Arrival Time or Periodicity without corresponding Time Domain the TSCTSF sets the Time Domain 5GS in the TSC Assistance Container If the AF is able to adjust the transmission time and periodicity then in addition to above parameters it may provide a BAT Window optional or the capability for BAT adaptation optional or Periodicity Range optional to the TSCTSF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1188",
    "document_id": "23501-i80",
    "chunk_id": 1188,
    "text": "The Maximum Burst Size is signalled separately ie it is not part of the TSC Assistance Container The AF provides these parameters to the NEF and the NEF forwards these parameters to the TSCTSF The AF trusted by the operator provides these parameters to the TSCTSF directly In the case of Deterministic Networking the TSCTSF constructs the TSC Assistance Container based on information provided by the DetNet controller as defined in clause 61323b of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1189",
    "document_id": "23501-i80",
    "chunk_id": 1189,
    "text": "The TSCTSF sends the TSC Assistance Container to the PCF as follows - The TSCTSF uses the UE IP addressDS-TT port MAC address to identify the PCF and N5 association related to the PDU Session of a UEDS-TT 52724 TSCAI determination based on TSC Assistance Container The SMF determines the TSCAI defined in Table 5272-1 for the QoS Flow based on the TSC Assistance Container of the PCC rule bound to the QoS Flow This clause is applicable irrespective of whether the TSC Assistance Container is determined by the TSN AF or by the TSCTSF The Burst Arrival Time and Periodicity component of the TSCAI that the SMF sends to the 5G-AN are specified with respect to the 5G clock The SMF is responsible for mapping the Burst Arrival Time and Periodicity in the TSC Assistance Container from an external clock to the 5G clock based on the time offset and cumulative rateRatio when available between external time and 5GS time as measured and reported by the UPF The SMF may correct the TSCAI based on the UPF report for time offset and cumulative rateRatio between external PTP time and 5GS time as measured and reported by the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1190",
    "document_id": "23501-i80",
    "chunk_id": 1190,
    "text": "The TSCAI parameter determination in SMF is done as follows - For traffic in downlink direction the SMF corrects the Burst Arrival Time in the TSC Assistance Container based on the latest received time offset measurement from the UPF and sets the TSCAI Burst Arrival Time as the sum of the corrected value and the static value for the CN PDB as defined in clause 5734 representing the latest possible time when the first packet of the data burst arrives at the AN - For traffic in uplink direction the SMF corrects the Burst Arrival Time in the TSC Assistance Container based on the latest received time offset measurement from the UPF and sets the TSCAI Burst Arrival Time as the sum of the corrected value and UE-DS-TT Residence Time representing the latest possible time when the first packet of the data burst arrives at the egress of the UE How the SMF corrects the Burst Arrival Time if the UE-DS-TT Residence Time has not been provided by the UE is up to SMF implementation -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1191",
    "document_id": "23501-i80",
    "chunk_id": 1191,
    "text": "The SMF corrects the Periodicity in the TSC Assistance Container using the cumulative rateRatio if the cumulative rateRatio was previously received from the UPF and sets the TSCAI Periodicity as the corrected value Otherwise the SMF sets the received Periodicity in the TSCAI without any correction - The SMF sets the TSCAI Flow Direction as the Flow Direction in the TSC Assistance Container - If Survival Time is provided in terms of maximum number of messages the SMF converts maximum number of messages into time units by multiplying its value by the TSCAI Periodicity and sets the TSCAI Survival Time to the calculated value If Survival Time is provided in time units the SMF corrects the Survival Time using the cumulative rateRatio if the cumulative rateRatio was previously received from the UPF and sets the TSCAI Survival Time to the corrected value Otherwise SMF sets the TSCAI Survival Time without correction - If the TSC Assistance Container contains a BAT Window the SMF sets and corrects the indicated earliest and latest possible arrival time of the first packet in the same way it is described for the correction of the Burst Arrival Time above - If the TSC Assistance Container contains a Capability for BAT adaptation the SMF sets the Capability for BAT adaptation in the TSCAI When the SMF determines that the TSCAI contains the Capability for BAT adaptation without a BAT the SMF enables notification control for the QoS Flow in order to receive the BAT offset along with the GFBR can no longer be guaranteed notification described in clause 5724 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1192",
    "document_id": "23501-i80",
    "chunk_id": 1192,
    "text": "If the TSC Assistance Container contains a Periodicity Range the SMF sets and corrects the Periodicity Range in the same way it is described for the correction of the Periodicity above If a dynamic value for the CN PDB is configured in NG-RAN or received from the SMF as defined in clause 5734 the NG-RAN shall adjust the Burst Arrival Time in the TSCAI for the downlink direction by adding the dynamic value for the CN PDB and deducting the static value for the CN PDB of the corresponding 5QI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1193",
    "document_id": "23501-i80",
    "chunk_id": 1193,
    "text": "Depending on whether the Time Domain is provided in the TSC Assistance container SMF may perform the following - the SMF provisions the UPFNW-TT to report the clock drifting between 5G clock and the external GM clock for the gPTP time domain number that is configured to the NW-TT - the SMF provisions the UPFNW-TT to report the clock drifting between 5G clock and the external GM clock for the given Time Domain number The SMF uses the N4 Association Setup or Update procedures as described in clause 443 of TS 23502 3 to provision the UPF to report the clock drifting If the SMF has clock drift information for a Time Domain and if the Time Domain matches with the Time Domain in the TSC Assistance Container ie clock drift between 5G timing and AF supplied Time Domain determined based on UPF reporting or Time Domain information is not provided in the TSC Assistance Container then the SMF may adjust the TSCAI information so that it reflects the 5GS Clock as described in clause 52721 If the SMF does not have synchronization information for a requested Time Domain in the TSC Assistance Container or the Time Domain in the TSC Assistance Container is set to a value 5GS then the TSCAI information will be used without adjustment In the case of drift between external GM clock and 5G clock the UPF updates the offset to SMF using the N4 Report Procedure as defined in clause 4434 of TS 23502 3 If the cumulative rateRatio is available and in the case of change of cumulative rateRatio between external PTP time and 5G time the UPF updates the cumulative rateRatio to SMF using the N4 Report Procedure as defined in clause 4434 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1194",
    "document_id": "23501-i80",
    "chunk_id": 1194,
    "text": "The SMF may then trigger a PDU Session Modification as defined in clause 433 of TS 23502 3 in order to update the TSCAI to the NG-RAN without requiring AN or N1 specific signalling exchange with the UE NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1195",
    "document_id": "23501-i80",
    "chunk_id": 1195,
    "text": "In order to prevent frequent updates from the UPF the UPF sends the offset or the cumulative rateRatio only when the difference between the current measurement and the previously reported measurement is larger than a threshold as described in clause 4434 of TS 23502 3 52725 RAN feedback for Burst Arrival Time offset and adjusted Periodicity 527251 Overview If the NG-RAN receives a TSCAI containing a BAT Window or the Capability for BAT adaptation for a QoS Flow the NG-RAN can determine a BAT offset in order to align the arrival of the traffic bursts with the next expected transmission opportunity over the air interface in each direction ie DL or UL The BAT offset can take a positive or a negative values If the NG-RAN receives a TSCAI containing a Periodicity Range for a QoS Flow the NG-RAN can determine an adjusted Periodicity along with above specified BAT offset in order to align the periodicity of the traffic bursts with the expected time interval between subsequent transmission opportunities over the air interface in each direction ie DL or UL If the TSCAI contained a value range the adjusted Periodicity should be any value between the lower bound and upper bound If the TSCAI contained a list of Periodicity values the adjusted Periodicity should be one of these values NG-RAN may support the following feedback mechanisms - Proactive RAN feedback for adaptation of Burst Arrival Time and Periodicity NG-RAN may provide a Burst Arrival Time offset and an adjusted Periodicity as part of QoS flow establishment or modification as illustrated in clause 527252 - Reactive RAN feedback for Burst Arrival Time adaptation NG-RAN may provide a Burst Arrival Time offset after QoS flow establishment as illustrated in clause 527253 527252 Proactive RAN feedback for adaptation of Burst Arrival Time and Periodicity",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1196",
    "document_id": "23501-i80",
    "chunk_id": 1196,
    "text": "If the NG-RAN receives a Burst Arrival Time and Burst Arrival Time Window in the TSCAI for a QoS Flow the 5GS will perform the following actions - The NG-RAN can determine a BAT offset in order to align the expected arrival of the traffic bursts as indicated in the BAT with the time when the next transmission over the air interface in each direction ie DL or UL is expected The BAT offset shall always be provided by NG-RAN and it shall be within the BAT Window The BAT offset is calculated with reference to the BAT - If the BAT offset is provided from NG-RAN to the SMF in the response to the QoS Flow establishment or modification request the SMF provides the BAT offset to the PCF and the PCF notifies the AF as described in clause 61323a of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1197",
    "document_id": "23501-i80",
    "chunk_id": 1197,
    "text": "The SMF also updates the BAT value of the locally stored TSCAI based on the received BAT offset NOTE 1 SMF updates the locally stored TSCAI so that after a handover SMF provides the updated BAT adjusted by the BAT offset to the target NG-RAN node - The SMF may adjust the BAT offset received from NG-RAN based on the clock drifting report from UPF as specified in clause 4434 of TS 23502 3 NOTE 2 The feedback from RAN implies that the RAN accepts the BAT offset If the AF requested BAT is acceptable for NG-RAN the NG-RAN provides a BAT offset of zero - If the RAN also receives a Periodicity Range along with the Periodicity in the TSCAI for a QoS flow the 5GS will further perform the following actions -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1198",
    "document_id": "23501-i80",
    "chunk_id": 1198,
    "text": "The RAN may determine an adjusted periodicity in order to align the periodicity of the traffic bursts with the expected time interval between subsequent transmission opportunities over the air interface in each direction ie DL or UL If the RAN determines an adjusted periodicity the RAN provides it together with a BAT offset mentioned above The adjusted periodicity shall be within the Periodicity Range and the BAT offset is based on the adjusted periodicity - The adjusted periodicity is forwarded to the AF via the SMF and the PCF together with a BAT offset in the same way it is described above The SMF also updates the periodicity value of the locally stored TSCAI based on the received adjusted periodicity NOTE 3 SMF updates the locally stored TSCAI so that after a handover SMF provides the adjusted periodicity to the target NG-RAN node - If interworking with a TSN network deployed in the transport network is supported the SMFCUC uses the adjusted periodicity if provided and BAT offset accepted by the RAN to adjust the related parameters in the TalkerListener Group and the TalkerListener Group is as described in Annex M clause M1 How the related parameters are adjusted is left to the implementation 527253 Reactive RAN feedback for Burst Arrival Time adaptation If the RAN receives the capability for BAT adaptation without a Burst Arrival Time in the TSCAI and notification control is enabled for this QoS Flow the 5GS will perform the following actions - If NG-RAN determines that the PDB of the QoS flow cannot be fulfilled in DL and UL direction then if supported NG-RAN shall determine a BAT offset value which reduces the time between the arrival of the traffic bursts and the time of the next possible transmission over the air interface for DL and UL respectively NG-RAN shall not provide a BAT offset with the same value until the PDB of the QoS Flow can be fulfilled again NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1199",
    "document_id": "23501-i80",
    "chunk_id": 1199,
    "text": "NG-RAN determines BAT offset value in reference to the current arrival time of the bursts experienced by RAN in DL and by UE in UL Further details on BAT offset determination for DL and UL are defined in TS 38331 28 - The BAT offset is provided from NG-RAN to the SMF when sending the notification towards the SMF that the GFBR can no longer be guaranteed described in clause 5724 The SMF provides the BAT offset to the PCF and the PCF provides the BAT offset to the AF as part of notifying the AF as described in clause 61323a of TS 23503 45 5273 Support for TSC QoS Flows TSC QoS Flows use a Delay-critical GBR resource type and TSC Assistance Information TSC QoS Flows may use standardized 5QIs pre-configured 5QIs or dynamically assigned 5QI values which requires signalling of QoS characteristics as part of the QoS profile as specified in clause 572",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1200",
    "document_id": "23501-i80",
    "chunk_id": 1200,
    "text": "For each instance of Periodicity within each Period defined by periodicity value TSC QoS Flows are required to transmit only one burst of maximum size MDBV within the 5G-AN PDB Known QoS Flow traffic characteristics provided in the TSCAI may be used to optimize scheduling in the 5GS The following is applicable for the QoS profile defined for TSC QoS Flows 1 The TSC Burst Size may be used to set the MDBV as follows The maximum TSC Burst Size is considered as the largest amount of data within a time period that is equal to the value of 5G-AN PDB of the 5QI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1201",
    "document_id": "23501-i80",
    "chunk_id": 1201,
    "text": "The maximum value of TSC Burst Size should be mapped to a 5QI with MDBV that is equal or higher When integration with IEEE TSN applies this 5QI also shall have a PDB value that satisfies the bridge delay capabilities see clause 5275 for more details reported for the corresponding traffic class For TSC QoS Flows the Maximum Burst Size of the aggregated TSC streams to be allocated to this QoS Flow can be similarly mapped to a 5QI with MDBV value that is equal or higher If interworking with a TSN network deployed in the transport network is supported the maximum value of TSC Burst Size should be mapped to a 5QI with MDBV that is equal 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1202",
    "document_id": "23501-i80",
    "chunk_id": 1202,
    "text": "The PDB is explicitly divided into 5G-AN PDB and CN PDB as described in clause 5734 Separate delay budgets are necessary for calculation of expected packet transmit times on 5G System interfaces For the TSC QoS Flow the5G-AN PDB is set to value of 5QI PDB minus the CN PDB as described in clause 5734 The CN PDB may be static value or dynamic value and is up to the implementation of 5GS bridge 3 When integration with IEEE TSN applies the Maximum Flow Bitrate calculated by the TSN AF as per Annex I1 may be used to set GBR In this case MBR is set equal to GBR 4 ARP is set to a pre-configured value 5 5QI value is derived using QoS mapping tables and TSN QoS information as described in clause 5284 in the case of integration with IEEE TSN network or using QoS Reference parameters and Requested PDB Burst Size Priority parameters as described in clause 41566 or clause 41566a of TS 23502 3 in the case of AF requested Time Sensitive Communication 5274 Hold and Forward Buffering mechanism DS-TT ports and NW-TT ports support a hold and forward mechanism to schedule traffic as defined in IEEE Std 8021Q 98 if 5GS is to participate transparently as a bridge in a TSN network That is the hold and forward buffering mechanism in this release of the specification provides externally observable behaviour identical to scheduled traffic with up to eight queues clause 8684 in IEEE Std 8021Q 98 and with protected windows Annex Q2 in IEEE Std 8021Q 98",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1203",
    "document_id": "23501-i80",
    "chunk_id": 1203,
    "text": "Frames are only transmitted from a given buffer according to the open time interval of the corresponding transmission gate otherwise frames are hold back which corresponds to a closed transmission gate The protected windows scheme implies that only a single transmission gate is open at any single time Thus the Hold and Forward buffering mechanism allows PDB based 5GS QoS to be used for TSC traffic For Ethernet frames that contain a VLAN tag DS-TT and NW-TT determine the priority based on the PCP value contained in the VLAN tag For Ethernet frames that do not contain a VLAN tag DS-TT and NW-TT apply a priority value of 0 To achieve externally observable behaviour according to the protected windows scheme 5GS provides AdminControlList AdminBaseTime AdminCycleTime and TickGranularity as defined in IEEE Std 8021Q 98 on a per Ethernet port basis to DS-TT and NW-TT for the hold and forward buffering mechanism as described in clause 5283 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1204",
    "document_id": "23501-i80",
    "chunk_id": 1204,
    "text": "The details of how Hold and Forward buffering mechanism is provided by the DS-TT and NW-TT is up to implementation 5275 5G System Bridge delay This clause applies if 5GS is integrated as a bridge into an IEEE TSN network In order for the 5G System to participate as a TSN bridge according to transmission gate schedules specified the 5GS Bridge is required to provide Bridge Delays as defined in IEEE Std 8021Q 98 for each port pair and traffic class of the 5GS bridge to an IEEE 8021 TSN system In order to determine 5GS Bridge Delays the following components are needed 1 UE-DS-TT Residence Time 2 Per traffic class minimum and maximum delays between the UE and the UPFNW-TT that terminates the N6 interface including UPF and NW-TT residence times independent of frame length that a given 5GS deployment supports The per-traffic class delays between the UE and the UPFNW-TT are pre-configured in the TSN AF see clause 5284 The TSN AF calculates the 5GS independentDelayMin and independentDelayMax values for each port pair and for each traffic class using the above components If the UE-DS-TT Residence Time has not been provided by the UE then the TSN AF uses a locally configured minimum UE-DS-TT Residence Time for the calculation of independentDelayMin and a locally configured maximum UE-DS-TT Residence Time for the calculation of independentDelayMax The dependentDelayMin and dependentDelayMax for 5GS Bridge specify the time range for a single octet of an Ethernet frame to transfer from ingress to egress and include the time to receive and store each octet of the frame which depends on the link speed of the ingress Port as per IEEE Std 8021Q 98 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1205",
    "document_id": "23501-i80",
    "chunk_id": 1205,
    "text": "Further details how TSN AF determines dependentDelayMin and dependentDelayMax are up to implementation Since residence times may vary among UEs and per traffic class delay between the UE and the UPFNW-TT may vary among UPFs the 5GS Bridge Delay is determined after the PDU Session Establishment for the corresponding UPF and the UE by the TSN AF The TSN AF deduces the related port pairs from the port number of the DS-TT Ethernet port and port number of the NW-TT Ethernet ports of the same 5GS Bridge when the TSN AF receives the 5GS Bridge information for a newly established PDU Session and calculates the bridge delays per port pair Additionally TSN AF deduces the port pairs consisting of two DS-TT ports connecting to the same 5GS bridge and determines the 5GS bridge delay as sum of bridge delays related to PDU Sessions of two DS-TT ports 528 Support of integration with TSN Time Sensitive Communications Time Synchronization and Deterministic Networking 5280 General Clause 528 defines the 5GS integration in TSN DN as a 5GS bridge In this scenario 5GS is deployed in a TSN DN to provide wireless connectivity From the perspective of the TSN DN the 5GS is modelled as a Layer 2 Ethernet Bridge of the TSN DN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1206",
    "document_id": "23501-i80",
    "chunk_id": 1206,
    "text": "In addition to supporting interoperation with TSN 5GS also supports Time Sensitive Communication Time Synchronization and integration with Deterministic Networking 5281 5GS bridge management for TSN 5GS acts as a Layer 2 Ethernet Bridge When integrated with IEEE TSN network 5GS functions acts as one or more TSN Bridges of the TSN network The 5GS Bridge is composed of the ports on a single UPF ie PSA side the user plane tunnel between the UE and UPF and the ports on the DS-TT side For each 5GS Bridge of a TSN network the port on NW-TT support the connectivity to the TSN network the ports on DS-TT side are associated to the PDU Session providing connectivity to the TSN network The granularity of the 5GS TSN bridge is per UPF for each network instance or DNNS-NSSAI The bridge ID of the 5GS TSN bridge is bound to the UPF ID of the UPF as identified in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1207",
    "document_id": "23501-i80",
    "chunk_id": 1207,
    "text": "The TSN AF stores the binding relationship between a port on UEDS-TT side and a PDU Session during reporting of 5GS TSN bridge information The TSN AF also stores the information about ports on the UPFNW-TT side The UPFNW-TT forwards traffic to the appropriate egress port based on the traffic forwarding information From the TSN AF point of view a 5GS TSN bridge has a single NW-TT entity within UPF and the NW-TT may have multiple ports that are used for traffic forwarding NOTE 1 How to realize single NW-TT entity within UPF is up to implementation NOTE 2 Ethernet PDU Session type in this release of the specification may be subject to the constraint that it supports a single N6 interface in a UPF associated with the N6 Network Instance",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1208",
    "document_id": "23501-i80",
    "chunk_id": 1208,
    "text": "There is only one PDU Session per DS-TT port for a given UPF All PDU Sessions which connect to the same TSN network via a specific UPF are grouped into a single 5GS bridge The capabilities of each port on UEDS-TT side and UPFNW-TT side are integrated as part of the configuration of the 5GS Bridge and are notified to TSN AF and delivered to CNC for TSN bridge registration and modification NOTE 3 It is assumed that all PDU Sessions which connect to the same TSN network via a specific UPF are handled by the same TSN AF Figure 5281-1 Per UPF based 5GS bridge NOTE 4 If a UE establishes multiple PDU Sessions terminating in different UPFs then the UE is represented by multiple 5GS TSN bridges In order to support IEEE 8021Q features related to TSN including TSN scheduled traffic clause 8684 in IEEE Std 8021Q 98 over 5GS Bridge the 5GS supports the following functions - Configure the bridge information in 5GS - Report the bridge information of 5GS Bridge to TSN network after PDU Session establishment - Receiving the configuration from TSN network as defined in clause 5282 - Map the configuration information obtained from TSN network into 5GS QoS information eg 5QI TSC Assistance Information of a QoS Flow in corresponding PDU Session for efficient time-aware scheduling as defined at clause 5282",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1209",
    "document_id": "23501-i80",
    "chunk_id": 1209,
    "text": "The bridge information of 5GS Bridge is used by the TSN network to make appropriate management configuration for the 5GS Bridge The bridge information of 5GS Bridge includes at least the following - Information for 5GS Bridge - Bridge ID Bridge ID is to distinguish between bridge instances within 5GS The Bridge ID can be derived from the unique bridge MAC address as described in IEEE Std 8021Q 98 or set by implementation specific means ensuring that unique values are used within 5GS - Number of Ports - list of port numbers - Capabilities of 5GS Bridge as defined in IEEE Std 8021Q 98 - 5GS Bridge delay per port pair per traffic class including 5GS Bridge delay dependent and independent of frame size and their maximum and minimum values independentDelayMax independentDelayMin dependentDelayMax dependentDelayMin ingress port number egress port number and traffic class - Propagation delay per port txPropagationDelay including transmission propagation delay egress port number - VLAN Configuration Information NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1210",
    "document_id": "23501-i80",
    "chunk_id": 1210,
    "text": "This Release of the specification does not support the modification of VLAN Configuration Information at the TSN AF - Topology of 5GS Bridge as defined in IEEE Std 8021AB 97 - LLDP Configuration Information - Chassis ID subtype and Chassis ID of the 5GS Bridge - LLDP Discovery Information for each discovered neighbor of each NW-TT port and DS-TT port - Traffic classes and their priorities per port as defined in IEEE Std 8021Q 98 - Stream Parameters as defined in clause 12311 in IEEE Std 8021Q 98 in order to support PSFP - MaxStreamFilterInstances The maximum number of Stream Filter instances supported by the bridge - MaxStreamGateInstances The maximum number of Stream Gate instances supported by the bridge - MaxFlowMeterInstances The maximum number of Flow Meter instances supported by the bridge optional - SupportedListMax",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1211",
    "document_id": "23501-i80",
    "chunk_id": 1211,
    "text": "The maximum value supported by the bridge of the AdminControlListLength and OperControlListLength parameters The following parameters independentDelayMax and independentDelayMin how to calculate them is left to implementation and not defined in this specification DS-TT and NW-TT report txPropagationDelay to the TSN AF relative to the time base of the TSN GM clock identified by the TSN time domain number received in PMIC If the TSN AF has subscribed for notifications on txPropagationDelay and if the difference to the previously reported txPropagationDelay is larger than the txPropagationDelayDeltaThreshold received in PMIC the corresponding DS-TT or NW-TT informs the TSN AF about the updated txPropagationDelay using PMIC signalling NOTE 6 Configuration of TSN time domain number and txPropagationDelayDeltaThreshold via PMIC is optional for NW-TT NW-TT can instead be pre-configured with the threshold and the single time domain that is used by the CNC for bridge configuration and reporting Bridge ID of the 5GS Bridge port numbers of the Ethernet ports in NW-TT could be preconfigured on the UPF The UPF is selected for a PDU Session serving TSC as described in clause 6333",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1212",
    "document_id": "23501-i80",
    "chunk_id": 1212,
    "text": "This release of the specification requires that each DS-TT port is assigned with a globally unique MAC address NOTE 7 The MAC address of the DS-TT port must not be used in user data traffic it is used for identification of the PDU Session and the associated bridge port within the 3GPP system When there are multiple network instances within a UPF each network instance is considered logically separate The network instance for the N6 interface clause 5612 may be indicated by the SMF to the UPF for a given PDU Session during PDU Session establishment UPF allocates resources based on the Network Instance and S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1213",
    "document_id": "23501-i80",
    "chunk_id": 1213,
    "text": "and it is supported according to TS 29244 65 DNNS-NSSAI may be indicated by the SMF together with the network instance to the UPF for a given PDU Session during PDU Session establishment procedure The TSN AF is responsible to receive the bridge information of 5GS Bridge from 5GS as well as register or update this information to the CNC 5282 5GS Bridge configuration for TSN The configuration information of 5GS Bridge as defined in clause 8684 of IEEE Std 8021Q 98 includes the following - Bridge ID of 5GS Bridge - Configuration information of scheduled traffic on ports of DS-TT and NW-TT - Egress ports of 5GS Bridge eg ports on DS-TT and NW-TT - Traffic classes and their priorities NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1214",
    "document_id": "23501-i80",
    "chunk_id": 1214,
    "text": "In this Release of the specification scheduled traffic clause 8684 in IEEE Std 8021Q 98 is only supported with protected windows see clause Q2 in IEEE Std 8021Q 98 therefore it is enough to support AdminControlList AdminBaseTime AdminCycleTime and TickGranularity for the configuration of the 5GS The configuration information of 5GS Bridge as defined in IEEE Std 8021Q 98 includes the following - Chassis ID of 5GS Bridge - Traffic forwarding information as defined in clause 881 of IEEE Std 8021Q 98 - Destination MAC address and VLAN ID of TSN stream - Port number in the Port MAP as defined in clause 881 of IEEE Std 8021Q 98 - Configuration information per stream according to clause 8651 of IEEE Std 8021Q 98 including - Stream filters - Stream gates NOTE 2 In order to support clause 86521 of IEEE Std 8021Q 98 it is required to support the Stream Identification function as specified by IEEE Std 8021CB 83",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1215",
    "document_id": "23501-i80",
    "chunk_id": 1215,
    "text": "The SMF report the MAC address of the DS-TT port of the related PDU Session to TSN AF via PCF The association between the DS-TT MAC address 5GS Bridge ID and port number on DS-TT is maintained at TSN AF and further used to assist to bind the TSN traffic with the UEs PDU session Two models are supported to configure 5GS QoS for TSN traffic - Based on the assumption that PSFP information is always provided by CNC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1216",
    "document_id": "23501-i80",
    "chunk_id": 1216,
    "text": "In this case the QoS Flows are setup based on the PSFP information provided by CNC NOTE 3 PSFP information may be provided by CNC if TSN AF has declared PSFP support to CNC TSN AF indicates the support for PSFP to CNC only if each DS-TT and NW-TT of the 5GS bridge has indicated support of PSFP - Without requiring PSFP information provided by the CNC In this case pre-configured QoS Flows are used and configured eg during PDU session establishment as described in clause 5284 Additional QoS Flows are setup as necessary based on the PSFP if available as described in this clause When PSFP information is available TSN AF identifies the ingress and egress port for the TSN stream as described in Annex I and determines the DS-TT port MAC addresses identifying the corresponding PDU sessions carrying the TSN stream Flow direction of a TSN stream is determined as follows if the ingress port is a DS-TT port then the Flow direction is UL otherwise if the ingress ports is are NW-TT port the Flow direction is DL Flow direction is part of the TSCAI as defined in clause 5272 The TSN AF uses the stream filter instances of PSFP information to derive the service data flow for TSN streams The TSN AF uses the Priority values in the stream filter instances in PSFP information if available as defined in clause 86521 of IEEE Std 8021Q 98 the 5GS bridge delay information see clause 5275 and may additionally use scheduled traffic information as defined in clause 8684 of IEEE Std 8021Q 98 to derive the TSN QoS information ie priority and delay for a given TSN stream or flow of aggregated TSN streams as specified in clause 5284",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1217",
    "document_id": "23501-i80",
    "chunk_id": 1217,
    "text": "The TSN AF identifies the egress ports for the TSN stream using local configuration or static filtering entry that matches the TSN stream If the TSN AF determines that the TSN stream is for UE-UE communication ie ingress and egress ports are in DS-TTs the TSN AF divides the stream into one uplink stream and one or more downlink streams and provides the streams on AF Session basis to the PCFs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1218",
    "document_id": "23501-i80",
    "chunk_id": 1218,
    "text": "The SMF applies local switching as specified in clause 58213 or clause 58253 in order to enable UPF locally forward uplink stream from one PDU session as downlink stream in another PDU session When CNC configures the PSFP information to the TSN AF TSN AF determines the TSC Assistance Container as described in clause 5272 The TSN AF associates the TSN QoS information and TSC Assistance Container if available with the corresponding service data flow description and provides to the PCF and the SMF as defined in clause 61323 of TS 23503 45 NOTE 4 When the TSN stream priority information from PSFP is not available priority value in stream filters is set to wild card in certain configurations it can be possible to use the scheduled traffic information as defined in clause 8684 of IEEE Std 8021Q 98 to derive the Priority of the TSN stream For example when there is a single downlink stream for a given DS-TT port it can be possible to determine the affected DS-TT port in the downlink and the associated TSN stream priority based on the scheduled traffic information of the affected egress port and to derive an estimated MDBV based on the gate open interval and the assumed ingress port bitrate If TSN AF provides PSFP andor scheduled traffic information to DS-TT and NW-TT then DS-TT and NW-TT execute on this information relative to the time base of the TSN GM clock identified by the TSN time domain number received in PMIC NOTE 5 Configuration of TSN time domain number via PMIC is optional for NW-TT NW-TT can instead be pre-configured with the single time domain that is used by the CNC for bridge configuration and reporting 5283 Port and user plane node management information exchange in 5GS 52831 General Port number for the PDU Session is assigned by the UPF during PDU session establishment The port number for a PDU Session shall be reported to the SMF from the UPF and further stored at the SMF The SMF provides the port number via PCF to the TSN AF or TSCTSF TSN AF or TSCTSF maintains an association between the port number for the PDU Session and the DS-TT port MAC address with Ethernet type PDU session or IP address applicable for TSCTSF only with IP type PDU Session of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1219",
    "document_id": "23501-i80",
    "chunk_id": 1219,
    "text": "If a PDU session for which SMF has reported a port number to TSN AF or TSCTSF is released then SMF informs TSN AF or TSCTSF accordingly The port number for the PDU Session corresponds to the device side port of the 5GS bridgerouter When the device supports the DS-TT functionality the port number represents the DS-TT port number corresponding to the given PDU Session NOTE 1 Port number can refer either to Ethernet port or PTP port In Ethernet type PDU Sessions it is assumed that the PTP port number is the same as the associated Ethernet port number When the DS-TT or the NW-TT functions are used the 5GS shall support transfer of standardized and deployment-specific port management information transparently between TSN AF or TSCTSF and DS-TT or NW-TT respectively inside a Port Management Information Container NW-TT may support one or more ports In this case each port uses separate Port Management Information Container 5GS shall also support transfer of standardized and deployment-specific user plane node management information transparently between TSN AF or TSCTSF and NW-TT respectively inside a User Plane Node Management Information Container Clause K1 lists standardized port management information and user plane node management information respectively If TSN AF is deployed ie if 5GS is integrated with an IEEE TSN network the port and user plane node management information is exchanged between CNC and TSN AF The port management information is related to ports located in DS-TT or NW-TT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1220",
    "document_id": "23501-i80",
    "chunk_id": 1220,
    "text": "The user plane node management information container is related to 5GS bridge management If TSN AF is not deployed the port and user plane node management information is exchanged between TSCTSF and DS-TTNW-TT NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1221",
    "document_id": "23501-i80",
    "chunk_id": 1221,
    "text": "The time synchronization parameters used in Port Management Information Container and User Plane Node Management Information Container are from IEEE Std 1588 126 Edition 2019 and from IEEE Std 8021AS 104 Since the IEEE time synchronization data sets are not exposed care needs to be taken when interoperating with devices supporting Edition 2008 IEEE Std 1588-2008 107 which can be the case when operating under the SMPTE profile ST 2059-22015 127 and using a common management Exchange of port and user plane node management information between TSN AF or TSCTSF and NW-TT or between TSN AF or TSCTSF and DS-TT allows TSN AF or TSCTSF to 1 retrieve port management information for a DS-TT or NW-TT port or user plane node management information 2 send port management information for a DS-TT or NW-TT port or user plane node management information 3 subscribe to and receive notifications if specific port management information for a DS-TT or NW-TT port changes or user plane node management information changes 4 delete selected entries in the following data structures - DS-TT port neighbour discovery configuration for DS-TT port in UMIC using the DS-TT port number to reference the selected entry - Stream Filter Instance Table in PMIC using the Stream Filter Instance ID to reference the selected entry - Stream Gate Instance Table in PMIC using the Stream Gate Instance ID to reference the selected entry - Static Filtering Entries table in UMIC using the MAC address VLAN ID pair to reference the selected entry 5 delete PTP Instances in a DS-TT port or NW-TT port using the PTP Instance ID to reference the selected entry as described in clause K221 Exchange of port management information between TSN AF or TSCTSF and NW-TT or DS-TT is initiated by DS-TT or NW-TT to - notify TSN AF or TSCTSF if port management information has changed that TSN AF or TSCTSF has subscribed for Exchange of user plane node management information between TSN AF or TSCTSF and NW-TT is initiated by NW-TT to - notify TSN AF or TSCTSF if user plane node management information has changed that TSN AF or TSCTSF has subscribed for - notify TSCTSF if time synchronization status information of UPF has changed that the TSCTSF has subscribed for Exchange of port management information is initiated by DS-TT to - provide port management capabilities ie provide information indicating which standardized and deployment-specific port management information is supported by DS-TT TSN AF or TSCTSF indicates inside the Port Management Information Container or user plane node Management Information Container whether it wants to retrieve or send port or user plane node management information or intends to un-subscribe for notifications If the TSN AF or TSCTSF has requested to receive notification of TSC management information and both SMF and UPF support direct reporting the UPF may directly report TSC management information to the TSN AF or TSCTSF using Nupf_EventExposure_Notify 52832 Transfer of port or user plane node management information Port management information is transferred transparently via 5GS between TSN AF or TSCTSF and DS-TT or NW-TT respectively inside a Port Management Information Container PMIC User plane node management information is transferred transparently via 5GS between TSN AF or TSCTSF and NW-TT inside a user plane node Management Information Container UMIC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1222",
    "document_id": "23501-i80",
    "chunk_id": 1222,
    "text": "The transfer of port or user plane node management information is as follows - To convey port management information from DS-TT or NW-TT to TSN AF or TSCTSF - DS-TT provides a PMIC and the DS-TT port MAC address if available to the UE which includes the PMIC as an optional Information Element of an N1 SM container and triggers the UE requested PDU Session Establishment procedure or PDU Session Modification procedure to forward the PMIC to the SMF SMF forwards the PMIC and the port number of the related DS-TT port to TSN AF or TSCTSF as described in clauses 4322 and 4332 of TS 23502 3 - NW-TT provides PMICs andor UMIC to the UPF which may trigger the N4 Session Level Reporting Procedure to forward the PMICs andor UMIC to SMF UPF selects an N4 session corresponding to any of the N4 sessions for this NW-TT SMF in turn forwards the PMICs and the port numbers of the related NW-TT ports or the UMIC to TSN AF or TSCTSF as described in clause 41651 of TS 23502 3 - NW-TT may provide PMICs andor UMIC to the UPF which may trigger UPF Event Exposure Notification to forward the PMICs andor UMIC to TSN AF or TSCTSF UPF directly reports TSC management information event via Nupf_EventExposure_Notify service operation as described in clause 52262 of TS 23502 3 NOTE 1 There has to be at least one established PDU session for DS-TT port before the UPF can report PMICUMIC information towards the TSN AF or TSCTSF - To convey port management information from TSN AF or TSCTSF to DS-TT - TSN AF or TSCTSF provides a PMIC DS-TT port MAC address or UE IP address applicable for TSCTSF only reported for a PDU Session ie MAC address of the DS-TT port or IP address related to the PDU session and the port number of the DS-TT port to manage to the PCF by using the AF Session level Procedure which forwards the information to SMF based on the MAC or IP address using the PCF initiated SM Policy Association Modification procedure as described in clause 41652 of TS 23502 3 SMF determines that the port number relates to a DS-TT port and based on this forwards the PMIC to DS-TT using the network requested PDU Session Modification procedure as described in clause 4332 of TS 23502 3 - To convey port or user plane node management information from TSN AF or TSCTSF to NW-TT - TSN AF or TSCTSF selects a PCF-AF session corresponding to any of the DS-TT MAC or IP addresses applicable for TSCTSF only for the related PDU sessions of this bridge or router and provides a PMICs and the related NW-TT port numbers andor UMIC to the PCF The PCF uses the PCF initiated SM Policy Association Modification procedure to forward the information received from TSN AF or TSCTSF to SMF as described in clause 41652 of TS 23502 3 SMF determines that the included information needs to be delivered to the NW-TT either by determining that the port numbers relates to a NW-TT ports or based on the presence of UMIC and forwards the containers andor related port numbers to NW-TT using the N4 Session Modification procedure described in clause 4413 of TS 23502 3 52833 VLAN Configuration Information for TSN The CNC obtains the 5GS bridge VLAN configuration from TSN AF according to clause 121011 of IEEE Std 8021Q 98",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1223",
    "document_id": "23501-i80",
    "chunk_id": 1223,
    "text": "The TSN AF and UPFNW-TT are pre-configured with same 5GS bridge VLAN configuration NOTE In this Release the VLAN Configuration Information are pre-configured at the TSN AF and the NW-TT and is not exchanged between the TSN AF and the UPFNW-TT 5284 QoS mapping tables for TSN The mapping tables between the traffic class and 5GS QoS Profile is provisioned and further used to find suitable 5GS QoS profile to transfer TSN traffic over the PDU Session QoS mapping procedures are performed in two phases 1 QoS capability report phase as described in clause 5281 and 2 QoS configuration phase as in clause 5282 1 The TSN AF shall be pre-configured eg via OAM with a mapping table",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1224",
    "document_id": "23501-i80",
    "chunk_id": 1224,
    "text": "The mapping table contains TSN traffic classes pre-configured bridge delays ie the preconfigured delay between UE and UPFNW-TT and priority levels Once the PDU session has been setup and after retrieving the information related to UE-DS-TT residence time the TSN AF deduces the port pairs in the 5GS bridge and determines the bridge delay per port pair per traffic class based on the pre-configured bridge delay and the UE-DS-TT residence time as described in clause 5275",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1225",
    "document_id": "23501-i80",
    "chunk_id": 1225,
    "text": "The TSN AF updates bridge delays per port pair and traffic class and reports the bridge delays and other relevant TSN information such as the Traffic Class Table clause 1263 in IEEE Std 8021Q 98 for every port according to the IEEE Std 8021Q 98 to the CNC 2 CNC may distribute PSFP information and transmission gate scheduling parameters to 5GS Bridge via TSN AF which can be mapped to TSN QoS requirements by the TSN AF The PCF mapping table provides a mapping from TSN QoS information see clauses 6212 and 61323 of TS 23503 45 to 5GS QoS profile Based on trigger from TSN AF the PCF may trigger PDU session modification procedure to establish a new 5G QoS Flow or use the pre-configured 5QI for 5G QoS Flow for the requested traffic class according to the selected QoS policies and the TSN AF traffic requirements Figure 5284-1 illustrates the functional distribution of the mapping tables Figure 5284-1 QoS Mapping Function distribution between PCF and TSN AF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1226",
    "document_id": "23501-i80",
    "chunk_id": 1226,
    "text": "The minimum set of TSN QoS-related parameters that are relevant for mapping the TSN QoS requirements are used by the TSN AF traffic classes and their priorities per port TSC Burst Size of TSN streams 5GS bridge delays per port pair and traffic class independentDelayMax independentDelayMin dependentDelayMax dependentDelayMin propagation delay per port txPropagationDelay and UE-DS-TT residence time Once the CNC retrieves the necessary information it proceeds to calculate scheduling and paths The configuration information is then set in the bridge as described in clauses 5282 and 5283 The most relevant information received is the PSFP information and the schedule of transmission gates for every traffic class and port of the bridge At this point it is possible to retrieve the TSN QoS requirements by identifying the traffic class of the TSN stream The traffic class to TSN QoS and delay requirement excluding the UE-DS-TT residence time mapping can be performed using the QoS mapping table in the TSN AF as specified in TS 23503 45 Subsequently in the PCF the 5G QoS Flow can be configured by selecting a 5QI as specified in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1227",
    "document_id": "23501-i80",
    "chunk_id": 1227,
    "text": "This feedback approach uses the reported information to the CNC and the feedback of the configuration information coming from the CNC to perform the mapping and configuration in the 5GS If the Maximum Burst Size of the aggregated TSC streams in the traffic class is provided by CNC via TSN AF to PCF PCF can derive the required MDBV taking the Maximum Burst Size as input If the default MDBV associated with a standardized 5QI or a pre-configured 5QI in the QoS mapping table cannot satisfy the aggregated TSC Burst Size the PCF provides the derived MDBV in the PCC rule and then the SMF performs QoS Flow binding as specified in clause 61324 of TS 23503 45 Maximum Flow Bit Rate is calculated over StreamGateAdminCycleTime as described in Annex I and provided by the TSN AF to the PCF The PCF sets the GBR and MBR values to the Maximum Flow Bitrate value The Maximum Flow Bit Rate is adjusted according to Averaging Window associated with a pre-configured 5QI in the QoS mapping table or another selected 5QI as specified in TS 23503 45 to obtain GBR of the 5GS QoS profile GBR is then used by SMF to calculate the GFBR per QoS Flow QoS mapping table in the PCF between TSN parameters and 5GS parameters should match the delay aggregated TSC burst size and priority while preserving the priorities in the 5GS An operator enabling TSN services via 5GS can choose up to eight traffic classes to be mapped to 5GS QoS profiles Once the 5QIs to be used for TSN streams are identified by the PCF as specified in TS 23503 45 then it is possible to enumerate as many bridge port traffic classes as the number of selected 5QIs When PSFP information is not available to the TSN AF for a given TSN stream eg because of lack of PSFP support in the DS-TTs or the NW-TTs or exceeding the number of supported table entries for PSFP functions or because CNC does not provide PSFP information the 5GS can support the TSN streams using pre-configured mapping from stream priority ie PCP as defined in IEEE Std 8021Q 98 to QoS Flows 5285 Support of integration with IETF Deterministic Networking 52851",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1228",
    "document_id": "23501-i80",
    "chunk_id": 1228,
    "text": "General 5GS acts as a DetNet Router according to the architecture defined in clause 4484 When integrated with an IETF Deterministic Network 5GS acts as one or more routers A 5GS router is composed of the ports on a single UPF ie PSA network side the user plane tunnel between the UE and UPF and the ports on the device side For each 5GS router of a deterministic network the ports on the network side and the ports on device side that are associated to the PDU Sessions support connectivity to the deterministic network The granularity of the 5GS DetNet node is per UPF for each network instance or DNNS-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1229",
    "document_id": "23501-i80",
    "chunk_id": 1229,
    "text": "The TSCTSF stores the binding relationship between a device side port and a PDU Session identified by the UE address The TSCTSF also stores information about ports on the UPFNW-TT side The integration with IETF Deterministic Networking assumes the following - The existing 3GPP routing mechanisms are re-used for DetNet - The existing multicast capabilities can be re-used for DetNet communications - The 5GS integration to IETF DetNet is based on DetNet for IP DetNet for MPLS is not supported - IPbased DetNet traffic is carried in IPtype PDU Sessions - 5GS functions realize the DetNet forwarding sub-layer For the IP case according to clause 1 of IETF RFC 8939 157 no service sub-layer function needs to be defined The 5GS DetNet Router acts as a DetNet transit node as defined in IETF RFC 8655 150 The interface between the TSCTSF and the DetNet controller uses protocols defined in IETF The DetNet configuration is carried in the YANG model 154 over Netconf 155 or Restconf 156 52852 5GS DetNet node reporting The TSCTSF may provide exposure information to the DetNet controller using information collected from the 5GS entities The exposure information can be used by the DetNet controller to build up the network topology information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1230",
    "document_id": "23501-i80",
    "chunk_id": 1230,
    "text": "The exposure may be based on IETF RFC 8343 151 and IETF RFC 8344 152 The TSCTSF may collect the information from the UPFNW-TT via parameters in PMIC as defined in clause 52831 For the device side ports the TSCTSF collects information using parameters provided from SMF to TSCTSF via PCF as described in clause 61323b of TS 23503 45 When the MTU size for IPv4 or IPv6 is not provided to TSCTSF for a port the TSCTSF may use a pre-configured default value for IPv4 or IPv6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1231",
    "document_id": "23501-i80",
    "chunk_id": 1231,
    "text": "In the case of network side ports the TSCTSF may collect information on the type of the interface defined in IETF RFC 8343 151 with values defined in IETF RFC 7224 153 associated with the port In the case of device side ports which correspond to the PDU Sessions that are reported to the TSCTSF the default value of 3GPP WWAN wwanPP for the interface type is assumed The TSCTSF can differentiate network side ports as they are reported from the NW-TT within UMICPMIC while device side ports correspond to the PDU Sessions reported to the TSCTSF in the associated AF sessions For device side ports also information on IP addresses or IP prefixes not directly assigned to the port but reachable via the port may be provided On the device side ports these are related to Framed Routes ie a range of IPv4 addresses or IPv6 prefixes reachable over a single PDU Session as defined in clause 5614 or prefixes delegated by IPv6 prefix delegation as defined in clause 5822",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1232",
    "document_id": "23501-i80",
    "chunk_id": 1232,
    "text": "This additional information helps both the TSCTSF and the DetNet controller to map flows to the correct UE address as described in clause 52853 For the network side ports the TSCTSF may also collect information on the link layer address and neighbor IP nodes The ports are identified by the port number within the 3GPP system The port number may also be used to generate interface identifiers towards the DetNet controller that are unique within the 5GS node NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1233",
    "document_id": "23501-i80",
    "chunk_id": 1233,
    "text": "One possibility to generate unique interface identifiers towards the DetNet controller is to use the port number as the if-Index as defined in IETF RFC 8343 151 Based on the if-Index an interface name is generated eg by using the if-Index as a string possibly adding a substring prefix or postfix based on configuration The if-Index and the name of the interface contain essentially the same information but both can be provided since the name is used as the key in the YANG model while if-Index is usually considered as the basis for interface management of IP nodes The TSCTSF may use the user-plane node ID provided by the UPF to generate an identifier of the 5GS node that is provided to the DetNet controller NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1234",
    "document_id": "23501-i80",
    "chunk_id": 1234,
    "text": "The 5GS node identification can be realized by providing an identifier of the 5GS node to the DetNet controller or the TSCTSF can use different termination points addresses for the signalling between the DetNet controller and the TSCTSF For network side ports the information is transferred in PMIC between the NW-TT and the TSCTSF For device side ports the information is transferred without relying on PMIC using parameters from the SMF via the PCF to the TSCTSF 52853 DetNet node configuration mapping in 5GS The TSCTSF maps the parameters in the DetNet YANG configuration to 5GS parameters as defined in clause 61323b of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1235",
    "document_id": "23501-i80",
    "chunk_id": 1235,
    "text": "The TSCTSF determines the UE address to bind the DetNet configuration as follows - When available the TSCTSF uses the identity of the incoming and outgoing interface to determine the affected UE address and whether the flow is uplink or downlink or UE-to-UE - If there is no incoming interface for UL traffic the TSCTSF may determine the UE address based on the source IP address of the UL traffic in the DetNet configuration or using local configuration to map the DetNet flow information to the UE address If there is no incoming interface for traffic with an outgoing interface on the device side the TSCTSF may determine whether the flow is UE-to-UE based on the source IP address of the traffic in the DetNet configuration or using local configuration NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1236",
    "document_id": "23501-i80",
    "chunk_id": 1236,
    "text": "The incoming interface is optional in the DetNet YANG configuration It is assumed that any IP prefix on the device side is reachable via at most a single device side interface Thus if the flow source IP address is available and belongs to a prefix associated with a device side interface that interface can be uniquely determined as the incoming interface for the flow NOTE 2 If there is no incoming interface for the UL traffic or no incoming interface for traffic with outgoing interface on the device side the details on how the TSCTSF uses local configuration are not specified - When the information on IP addresses or IP prefixes not directly assigned to the port but reachable via the port is available as described in clause 52852 the TSCTSF also takes such info into account - If the flow is UE-to-UE two PDU Sessions will be affected for the flow and the TSCTSF breaks up the requirements to individual requirements for the PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1237",
    "document_id": "23501-i80",
    "chunk_id": 1237,
    "text": "The TSCTSF provides a response to the DetNet controller regarding the success of the configuration setup When both the TSCTSF and the DetNet controller support 3GPP extensions to the IETF draft-ietf-detnet-yang 154 the TSCTSF may provide 5GS specific status code information on the result of the configuration to the DetNet controller NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1238",
    "document_id": "23501-i80",
    "chunk_id": 1238,
    "text": "The 3GPP extension to the IETF draft-ietf-detnet-yang 154 is defined in 3GPP as a YANG model which imports draft-ietf-detnet-yang 154 and adds the 3GPP specific parameters The 3GPP defined YANG model uses the 3GPP namespace as defined in IETF RFC 5279 158 If the status of the flow changes later on for any reason the TSCTSF notifies the DetNet controller Upon release of a PDU Session that is part of the existing DetNet configuration the PCF notifies the TSCTSF of the PDU Session release and TSCTSF notifies the DetNet controller on the status of the flow The 5GS routing is not modified by the configuration received from the DetNet controller Still the TSCTSF may verify whether the explicit routing information provided by the DetNet controller is in line with the 5GS mapping of IP addresses and prefixes to PDU sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1239",
    "document_id": "23501-i80",
    "chunk_id": 1239,
    "text": "The verification may be based on whether the source or destination IP address in the DetNet flow on the given port corresponds to the IP address or prefix associated with the given PDU Session Based on operator configuration the TSCTSF may use other criteria not routing related to determine whether to accept or reject a given DetNet configuration 5GS DetNet Node can forward via its device side interface IP packets destined not only to the UEs IP address or prefix but also to a range of IPv4 addresses or IPv6 IP prefixes according to one or more Framed Routes or prefixes delegated to the UE by IPv6 prefix delegation To facilitate this the additional IP addresses used for framed routes and IPv6 prefix delegation are exposed by the SMF to the TSCTSF via the PCF and the TSCTSF may expose them to the DetNet controller as defined in clause 52852 528a Support for TSN enabled Transport Network 528a1 General When the 5GS supports interworking with IEEE TSN deployed in the transport network the CUC that is collocated with SMF interworks with the CNC in the transport network TN CNC as specified in clause 462 of IEEE Std 8021Q 98",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1240",
    "document_id": "23501-i80",
    "chunk_id": 1240,
    "text": "The SMFCUC provides the stream requirements on QoS Flow basis ie translated Talker group and Listener group information via the UserNetwork-Interface UNI to the TN CNC The TN CNC uses the stream requirements as input to configure respective paths and schedules in TN Based on the results the TN CNC provides a Status group that contains the end station communication-configuration back to the SMFCUC When interworking with TSN deployed in the transport network is applied the dynamic value for the CN PDB of a Delay-critical GBR 5QI shall be considered as described in clause 5734 When the SMF setups a new QoS Flow the SMF signals TSCAI for the QoS Flow to NG-RAN on QoS Flow basis as described in clause 5272 Upon receiving the TSCAI for a QoS Flow from the SMF if the TSCAI includes a BAT in UL direction and the dynamic value for the CN PDB is configured in the NG-RAN as described in clause 5734 the NG-RAN shall provide the 5G-AN PDB in the response to the QoS Flow request The SMFCUC uses 5G-AN-PDB to generate EarliestTransmitOffset as described in Annex M clause M1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1241",
    "document_id": "23501-i80",
    "chunk_id": 1241,
    "text": "The details of providing End Station related information to generate the stream requirements for the QoS Flow by the SMFCUC are described in Annex M clause M1 If the NG-RAN and UPF support the TSN Talker and Listener functionality ie implement the AN-TL and CN-TL respectively the SMFCUC can communicate with the AN-TL and CN-TL via TL-Container The TL-Container conveys the data sets defined in IEEE Std 8021Qdj 146 between the SMFCUC and AN-TL and CN-TL The AN-TL and CN-TL enable the following functions a hold and buffer functionality in a case when the TSCAI contains a BAT in UL andor DL direction b support of stream transformation functionality with respective information exchange with SMFCUC c for SMFCUC to retrieve the InterfaceCapabilities andor EndStationInterfaces from the AN-TL or CN-TL d topology information exchange functionality via LLDP in the TN as described in clause 528a3 NOTE 1 How to realize AN-TL in the base station and CN-TL in UPF is up to implementation NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1242",
    "document_id": "23501-i80",
    "chunk_id": 1242,
    "text": "In this Release of the specification it is assumed that connected mode mobility is not used in deployments with a TSN enabled TN 528a2 Transfer of TL-Container between SMFCUC and AN-TL and CN-TL If NG-RAN and UPF support AN-TL and CN-TL the SMFCUC may use the TL-Container to send a 1 get-request 2 set-request submits the following information elements to the AN-TL or CN-TL - InterfaceConfiguration as described in Annex M clause M1 one InterfaceConfiguration is associated with each QFI in the N3 tunnel - Interface ID Group - TN Stream Identification Information for DataFrameSpecification - TN Stream Identification Information for mask-and-match - Interval only provided together with TimeAwareOffset - MaxFrameSize only provided together with TimeAwareOffset",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1243",
    "document_id": "23501-i80",
    "chunk_id": 1243,
    "text": "The AN-TL or CN-TL may use the TL-Container to send a 1 get-response indicates the following elements of the Talker or Listener group from the AN-TL or CN-TL - EndStationInterfaces list of InterfaceIDs - InterfaceCapabilities - Buffer capability maximum possible buffer duration for a packet of a stream with the maximum size of an Ethernet packet 1522 Bytes that is supported by the AN-TL CN-TL when acting as a Talker 2 set-response reports the processing results for the corresponding set-request to the SMFCUC Details on the TL-Container information are provided in Table M2-1 of clause M2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1244",
    "document_id": "23501-i80",
    "chunk_id": 1244,
    "text": "The SMFCUC may request the NG-RANUPF to report AN-TL or CN-TL information by including a TL-Container with a get-request to the AN-TL or CN-TL respectively The get-request is sent to AN-TL in the N2 SM information and to CN-TL in the N4 Session Establishment as described in clause 4322 of TS 23502 3 If the NG-RANUPF supports AN-TLCN-TL the NG-RANAN-TL and UPFCN-TL responds with a TL-Container including the elements defined for the get-response The SMFCUC may submit TL-Container including a set-request the elements defined for the set-request to NG-RANAN-TL and UPFCN-TL The set-request is sent to AN-TL in the N2 SM information and to CN-TL in the N4 Session Modification request as described in clause 4332 of TS 23502 3 The SMFCUC shall initiate to the CN-TLAN-TL the deletion of TN stream configurations as described in 4342 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1245",
    "document_id": "23501-i80",
    "chunk_id": 1245,
    "text": "The InterfaceConfiguration is associated with the corresponding QFI in the N3 tunnel in the NG-RAN or UPF respectively The AN-TLCN-TL uses the provided configuration for the traffic in the QoS Flow of the given QFI as described in Annex M 528a3 Topology Information for TSN TN NG-RAN and UPF may support u-plane LLDP functionality to provide topology information to the TN When LLDP is supported AN-TL and CN-TL shall perform the LLDP functionality at the u-plane without the need to interact with the c-plane Further there is no need for 5GS interaction with TN CNC directly This is achieved with following measures - AN-TL and CN-TL implement the Transmit Only operation mode as defined in clause 91 of IEEE Std 8021AB 97 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1246",
    "document_id": "23501-i80",
    "chunk_id": 1246,
    "text": "The TSN End Station is pre-configured with parameter set for Transmit Only operating mode as defined in clause 92 of IEEE Std 8021AB 97 - The System Capabilities TLV may also be set to Station Only as defined in clause 858 of IEEE Std 8021AB 97 529 Support for 5G LAN-type service 5291 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1247",
    "document_id": "23501-i80",
    "chunk_id": 1247,
    "text": "The service requirements for 5G LAN-type service are specified in TS 22261 2 A 5G Virtual Network VN group consists of a set of UEs using private communication for 5G LAN-type services 5292 5G VN group management 5G System supports management of 5G VN Group identification and membership ie definition of 5G VN group identifiers and membership and 5G VN Group data ie definition of 5G VN group data The 5G VN Group management can be configured by a network administrator or can be managed dynamically by AF A 5G VN group is characterized by the following - 5G VN group identities External Group ID and Internal Group ID are used to identify the 5G VN group - 5G VN group membership The 5G VN group members are uniquely identified by GPSI The group as described in clause 52331 of TS 23502 3 is applicable to 5G LAN-type services - 5G VN group data The 5G VN group data may include the following parameters PDU session type DNN S-NSSAI and Application descriptor the indication that the 5G VN group is associated with 5G VN group communication Information related with secondary authentication authorization eg to enable IP address assignment by the DN-AAA Maximum Group Data Rate The Information related with secondary authentication authorization corresponds to the procedures described in clause 566 it allows eg the AF to provide DN-AAA server addressing information and possibly to request the SMF to get the UE IP address from the DN-AAA server In order to support dynamic management of 5G VN Group identification and membership the NEF exposes a set of services to manage eg adddeletemodify 5G VN groups and 5G VN members The NEF also exposes services to dynamically manage 5G VN group data An AF can request provisioning of traffic characteristics QoS parameters and monitoring of QoS parameters for a 5G VN group as described in clause 61328 of TS 23503 45 A 5G VN group is identified by the AF using External Group ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1248",
    "document_id": "23501-i80",
    "chunk_id": 1248,
    "text": "The NEF provides the External Group ID to UDM The UDM maps the External Group ID to Internal Group ID For a newly created 5G VN Group an Internal Group ID is determined by the UDM based on implementation specific means NOTE 1 The Internal Group ID determined by UDM has to comply with the format defined in TS 23003 19 The NEF can retrieve the Internal Group ID from UDM via Nudm_SDM_Get service operation External Group ID Group Identifier translation An External Group ID for a 5G VN group corresponds to a unique set of 5G VN group data parameters The 5G VN group configuration is either provided by OAM or provided by an AF to the NEF When configuration is provided by an AF the procedures described in clause 41562 of TS 23502 3 apply for storing the 5G VN group identifiers group membership information and group data in the UDR as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1249",
    "document_id": "23501-i80",
    "chunk_id": 1249,
    "text": "The NEF provides the External Group ID 5G VN group membership information and 5G VN group data to the UDM - The UDM updates the Internal Group ID-list of the corresponding UEs subscription data in UDR if needed - The UDM updates the Group Identifier translation in the Group Subscription data with the Internal Group ID External Group ID and list of group members if needed - The UDM storesupdates the 5G VN group data PDU session type DNN and S-NSSAI Application descriptor the indication that the 5G VN group is associated with 5G VN group communication Information related with secondary authentication authorization Maximum Group Data Rate in UDR NOTE 2 It is assumed that all members of a 5G VN group belong to the same UDM Group ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1250",
    "document_id": "23501-i80",
    "chunk_id": 1250,
    "text": "The NEF can select a UDM instance supporting the UDM Group ID of any of the member GPSIs of the 5G VN group NOTE 3 Shared data mechanisms as defined in TS 29503 122 can be used to support large 5G VN groups An AF may also configure and update the service area QoS for the 5G VN group as described in clause 520b as well as other parameters eg Expected UE Behaviour parameters Network Configuration parameters",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1251",
    "document_id": "23501-i80",
    "chunk_id": 1251,
    "text": "ECS Address Configuration Information etc for a 5G VN group as described in clause 4156 of TS 23502 3 If a UE is member of a 5G VN Group UDM retrieves UE subscription data and corresponding 5G VN group data from UDR and provides the AMF and SMF with UE subscription data with 5G VN group data included If the 5G VN group data contains the indication that the 5G VN group is associated with 5G VN group communication the SMF may apply the 5G VN group communication as defined in clauses 5293 and 5294 for the PDU Sessions accessing to the 5G VN group The PCF generates URSP rules based on 5G VN group data The PCF retrieves 5G VN group data from UDR The PCFs that have subscribed to modifications of 5G VN group data receives a Nudr_DM_Notify notification of 5G VN group data change from the UDR as defined in TS 29505 145 The PCF receives from the AMF at the UE Policy association establishment the Internal Group IDs corresponding to a UE so that PCF identifies the 5G VN group data that needs to be used to generate URSP rules to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1252",
    "document_id": "23501-i80",
    "chunk_id": 1252,
    "text": "If the PCF is made aware of a change of UE Internal Group Identifiers as defined in TS 29525 144 or change of 5G VN group membership as defined in TS 29505 145 or both the PCF then may update the URSP rules for the impacted 5G VN group members NOTE 4 The proper way to obtain the 5G VN group membership changes of a specific UE eg if the UE is added to a new 5G VN group is via the notification of change of UE Internal Group Identifiers from the AMF as specified in TS 29525 144 The subscription in the UDR is for being notified about changes in the 5G VN group data and in the 5G VN group membership of a specific 5G VN group If the PCF receives the Maximum Group Data Rate as part of the 5G VN group data it performs the group related policy control as described in clauses 615 and 62111 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1253",
    "document_id": "23501-i80",
    "chunk_id": 1253,
    "text": "An AF may update the UE Identities of the 5G VN group at any time after the initial provisioning An AF may subscribe to notification of the group status changes for the 5G VN group as described in clause 520",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1254",
    "document_id": "23501-i80",
    "chunk_id": 1254,
    "text": "The DNN S-NSSAI provided within 5G VN group data cannot be modified after the initial provisioning In this Release of the specification the home network of the 5G VN group members is same In this Release of the specification only a 11 mapping between DNN S-NSSAI combination and 5G VN group is supported The PCF delivers 5G VN group configuration information DNN S-NSSAI PDU session type to the UE for each GPSI that belongs to a 5G VN group The 5G VN group configuration information is delivered in the URSP from the PCF to the UE using the UE Configuration Update procedure for transparent UE Policy delivery as described in clause 4243 of TS 23502 3 and clause 6122 of TS 23503 45 5293 PDU Session management Session management as defined for 5GS in clause 56 is applicable to 5G-VN-type services with the following clarification and enhancement -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1255",
    "document_id": "23501-i80",
    "chunk_id": 1255,
    "text": "A UE gets access to 5G LAN-type services via a PDU Session of IP PDU Session type or Ethernet PDU Session type - A PDU Session provides access to one and only one 5G VN group The PDU Sessions accessing to a certain 5G VN group should all anchor at the same network ie the common home network of 5G VN group members - A DNN and S-NSSAI is associated with a 5G VN group - A dedicated SMF a dedicated SMF Set or multiple SMF Sets can be responsible for all the PDU Sessions for communication of a certain 5G VN group Multiple SMF Sets may apply for a 5G VN group extended over a large area bigger than the service area of any SMF Set serving the DNNS-NSSAI of the 5G VN group SMF selection is described in clause 632 NOTE 1 If a dedicated SMF Set is used to serve a 5G VN the network is configured so that the same SMF Set is always selected for a certain 5G VN group eg only one SMF or SMFs in one SMF Set registers on the NRF with the DNNS-NSSAI used for a given 5G VN group NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1256",
    "document_id": "23501-i80",
    "chunk_id": 1256,
    "text": "Having a dedicated SMF serving a 5G VN does not contradict that redundancy solutions can be used to achieve high availability If SMF Sets serve the 5G VN group high availability is achieved by the set functionality - In the case that more than one SMF sets or SMF instances in a SMF Set are responsible for all the PDU Sessions for communication of a certain 5G VN group to enable SMF redundancy for reliability of the 5G VN group communication - The associations between one or more SMF Sets and the DNN S-NSSAI of the associated 5G VN group is registered and discovered in NRF - The SMFs that registered to associate with the DNN S-NSSAI of the 5G VN group should be available in the LADN service area of the 5G VN group -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1257",
    "document_id": "23501-i80",
    "chunk_id": 1257,
    "text": "The UE provides the DNN and S-NSSAI associated with the 5G VN group to access the 5G LAN-type services for that 5G VN using the PDU Session Establishment procedure described in clause 432 of TS 23502 3 - During establishment of the PDU Session secondary authentication as described in clause 566 and in clause 4323 of TS 23502 3 may be performed in order to authenticate and authorize the UE for accessing the DNN and S-NSSAI associated with the 5G VN group Authentication and authorization for a DNN and S-NSSAI using secondary authentication implies authentication and authorization for the associated 5G VN group There is no 5G VN group specific authentication or authorization defined - The SM level subscription data for a DNN and S-NSSAI available in UDM as described in clause 561 applies to the DNN and S-NSSAI associated to a 5G VN group - Session management related policy control for a DNN and S-NSSAI as described in TS 23502 3 is applicable to the DNN and S-NSSAI associated to a 5G VN group",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1258",
    "document_id": "23501-i80",
    "chunk_id": 1258,
    "text": "This includes also usage of URSP for the UE to determine how to route outgoing traffic to a PDU Session for the DNN and S-NSSAI associated to a 5G VN group - Session and service continuity SSC mode 1 SSC mode 2 and SSC mode 3 as described in clause 569 are applicable to N6-based traffic forwarding of 5G VN communication within the associated 5G VN group - A PDU Session provides unicast broadcast and multicast communication for the DNN and S-NSSAI associated to a 5G VN group The PSA UPF determines whether the communication is for unicast broadcast or multicast based on the destination address of the received data and performs unicast broadcast or multicast communication handling -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1259",
    "document_id": "23501-i80",
    "chunk_id": 1259,
    "text": "During the PDU Session Establishment procedure the SMF retrieves SM subscription data related to 5G-VN type service from the UDM as part of the UE subscription data for the DNN and S-NSSAI - In order to realize N19 traffic routing in the case that a single SMF or single SMF Set is serving the 5G VN the SMF or SMF Set correlates PDU sessions established to the same 5G VN group and uses this to configure the UPF with the group level N4-session including packet detection and forwarding rules for N19 tunnelling forwarding NOTE 3 In the case of a SMF Set serving a 5G VN implementation dependent mechanism can be used between SMFs that are part of a SMF Set to control the N19 configuration -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1260",
    "document_id": "23501-i80",
    "chunk_id": 1260,
    "text": "In order to realize N6N19 traffic routing between PSA UPFs in case multiple SMF Sets are serving the 5G VN traffic forwarding between UPFs belonging to different SMF Sets can be realized via User Plane tunnels that are configured using OAM between UPFs served by different SMF Sets How to implement the user plane tunnels and traffic forwarding configured between these UPFs is up to network implementation and deployment and is out of scope of this specification 5294 User Plane handling User Plane management as defined for 5GS in clause 58 is applicable to 5G LAN-type services with the following clarifications - There are three types of traffic forwarding methods allowed for 5G VN communication - N6-based where the ULDL traffic for the 5G VN communication is forwarded tofrom the DN NOTE 1 Optionally a L2TP tunnel can be established over N6 as described in clause 58216 - N19-based where the ULDL traffic for the 5G VN group communication is forwarded between PSA UPFs of different PDU sessions via N19 N19 is based on a shared User Plane tunnel connecting PSA UPFs of a single 5G VN group - Local switch where traffic is locally forwarded by a single UPF if this UPF is the common PSA UPF of different PDU Sessions for the same 5G VN group - For UPFs served by a single SMF Set the SMF instances in the SMF set handles the user plane paths of the 5G VN group including - The SMF instances may prefer to select a single PSA UPF for as many PDU sessions targeting the same 5G VN group as possible in order to implement local switch on the UPF - if needed Establishing N19 tunnels between PSA UPFs served by the same SMF set to support N19-based traffic forwarding -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1261",
    "document_id": "23501-i80",
    "chunk_id": 1261,
    "text": "If multiple SMF Sets are serving a 5G VN user plane forwarding between UPFs served by different SMF Sets can be achieved via the DN ie N6 or via user plane tunnels on N6N19 as described in clause 5293 NOTE 2 The above user plane tunnels may be using GTP-U or IETF VPN For example for IP-type traffic the traffic routing can be based on routing protocols or pre-configured IP address rangesprefixes corresponding different SMF sets for ethernet-type traffic the traffic routing can be based on the learned MAC address over the user plane tunnels between UPFs controlled by different SMF sets etc How to implement such user plane tunnels configured between these UPFs is up to network implementation and deployment -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1262",
    "document_id": "23501-i80",
    "chunk_id": 1262,
    "text": "For Ethernet PDU Session the SMF may instruct the UPFs to classify frames based on VLAN tags and to add and remove VLAN tags on frames received and sent on N6 or N19 or internal interface 5G VN internal as described in clause 56102 NOTE 3 For handling VLAN tags for traffic on N6 TSP ID could also be used as described in clause 6226 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1263",
    "document_id": "23501-i80",
    "chunk_id": 1263,
    "text": "Further description on User Plane management for 5G VN groups is available in clause 58213 When N6-based traffic forwarding is expected after creation of a 5G VN group the AF can influence the traffic routing for all the members of the 5G VN group by providing information identifying the traffic DNAIs suitable for selection and an optional indication of traffic correlation together with a 5G VN External Group ID identifying the 5G VN group in an AF request sent to the PCF as described in clause 567 If the optional indication of traffic correlation is provided it means the PDU sessions of the 5G VN group member UEs should be correlated by a common DNAI in the user plane for the traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1264",
    "document_id": "23501-i80",
    "chunk_id": 1264,
    "text": "The PCF transforms the AF request into policies that apply to PDU Sessions of the 5G VN group and sends the policies to the SMF According to the policies the SMF reselects DNAIs for the PDU Sessions and configures their UP paths to route the traffic to the selected DNAIs If the policies include the traffic correlation indication the SMF reselects a common DNAI for the PDU Sessions so that the traffic of the 5G VN group is routed to the common DNAI NOTE 4 When receiving a new PDU session establishment request for a 5G VN group to avoid unnecessary N19 tunnels between UPFs SMF can check previously selected UPFs for the same 5G VN group and decide whether a previously selected UPF could serve the requested PDU session NOTE 5 N19 tunnels can be established between a new UPF and other UPFs that belongs to a 5G VN group when the new UPF is selected for the 5G VN group during PDU session establishment The N19 tunnels to a UPF can be released during or after PDU session release when there is no more PDU sessions for a 5G VN group in that UPF Establishment or release of the N19 tunnels at the UPF is performed within a group-level N4 Session 530 Support for non-public networks 5301 General A Non-Public Network NPN is a 5GS deployed for non-public use see TS 22261 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1265",
    "document_id": "23501-i80",
    "chunk_id": 1265,
    "text": "An NPN is either - a Stand-alone Non-Public Network SNPN ie operated by an NPN operator and not relying on network functions provided by a PLMN or - a Public Network Integrated NPN PNI-NPN ie a non-public network deployed with the support of a PLMN NOTE An NPN and a PLMN can share NG-RAN as described in clause 518 Stand-alone NPN are described in clause 5302 and Public Network Integrated NPNs are described in clause 5303 5302 Stand-alone Non-Public Networks 53020 General SNPN 5GS deployments are based on - the architecture depicted in clause 423 - the architecture for 5GC with Untrusted non-3GPP access Figure 42821-1 for either access to SNPN services via a PLMN and vice versa or for direct access to SNPN via non-3GPP access - the architecture for 5GC with Trusted non-3GPP access Figure 42821-2 and - the additional functionality covered in clause 5302",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1266",
    "document_id": "23501-i80",
    "chunk_id": 1266,
    "text": "Alternatively a Credentials Holder CH may authenticate and authorize access to an SNPN separate from the Credentials Holder based on the architecture specified in clause 53029 Idle and connected mode mobility is supported as defined in clause 530211 Clauses 53021 to 530211 specify the common SNPN aspects applicable to both 3GPP and non-3GPP access except where stated differently Aspects specific to Untrusted non-3GPP access for SNPN are specified in clause 530212 Aspects specific to Trusted non-3GPP access for SNPN are specified in clause 530213 Aspects specific to N5CW devices accessing SNPN services are specified in clause 530215 The following 5GS features and functionalities are not supported for SNPNs - Interworking with EPS - Emergency services when the UE accesses the SNPN over NWu via a PLMN - Roaming eg roaming between SNPNs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1267",
    "document_id": "23501-i80",
    "chunk_id": 1267,
    "text": "However it is possible for a UE to access an SNPN with credentials from a CH as described in clause 53029 and to move between equivalent SNPNs - Handover between SNPN and PLMN or PNI-NPN - CIoT 5GS Optimizations - CAG and - Proximity based Services ProSe as defined in TS 23304 128 A UE with two or more network subscriptions where one or more network subscriptions may be for a subscribed SNPN can apply procedures specified for Multi-USIM UEs as described in clause 538 The UE shall use a separate PEI for each network subscription when it registers to the network NOTE The number of preconfigured PEIs for a UE is limited If the number of network subscriptions for a UE is greater than the preconfigured number of PEIs the number of network subscriptions that can be registered with the network simultaneously is restricted by the number of pre-configured number of PEIs 53021 Identifiers The combination of a PLMN ID and a Network identifier NID identifies an SNPN NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1268",
    "document_id": "23501-i80",
    "chunk_id": 1268,
    "text": "The PLMN ID used for SNPNs is not required to be unique PLMN IDs reserved for use by private networks can be used for non-public networks eg based on mobile country code MCC 999 as assigned by ITU 78 Alternatively a PLMN operator can use its own PLMN IDs for SNPNs along with NIDs but registration in a PLMN and mobility between a PLMN and an SNPN are not supported using an SNPN subscription given that the SNPNs are not relying on network functions provided by the PLMN The NID shall support two assignment models - Self-assignment NIDs are chosen individually by SNPNs at deployment time and may therefore not be unique but use a different numbering space than the coordinated assignment NIDs as defined in TS 23003 19 - Coordinated assignment NIDs are assigned using one of the following two options 1 The NID is assigned such that it is globally unique independent of the PLMN ID used or 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1269",
    "document_id": "23501-i80",
    "chunk_id": 1269,
    "text": "The NID is assigned such that the combination of the NID and the PLMN ID is globally unique NOTE 2 Which legal entities manage the number space is beyond the scope of this specification NOTE 3 The use of SNPN with self-assignment model NID such that the combination of PLMN ID and NID is not globally unique is not assumed for the architecture described in Figure 530293-1 Figure 530292-1 and for SNPN - SNPN Mobility as described in clause 530211 The GIN shall support two assignment models - Self-assignment GINs are chosen individually and may therefore not be unique It is defined as in TS 23003 19 or - Coordinated assignment GIN uses a combination of PLMN ID and NID and is assigned using one of the following two options as defined in TS 23003 19 1 The GIN is assigned such that the NID is globally unique eg using IANA Private Enterprise Numbers independent of the PLMN ID used or 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1270",
    "document_id": "23501-i80",
    "chunk_id": 1270,
    "text": "The GIN is assigned such that the combination of the NID and the PLMN ID is globally unique NOTE 4 Which legal entities manage the number space for GIN is beyond the scope of this specification An optional human-readable network name helps to identify an SNPN during manual SNPN selection The human-readable network name and how it is used for SNPN manual selection is specified in TS 22261 2 and TS 23122 17 53022 Broadcast system information NG-RAN nodes or Trusted non-3GPP access networks which provide access to SNPNs broadcast the following information - One or multiple PLMN IDs - List of NIDs per PLMN ID identifying the non-public networks NG-RAN provides access to and NOTE 1 It is assumed that an NG-RAN node supports broadcasting a total of twelve NIDs Further details are defined in TS 38331 28 NOTE2 The presence of a list of NIDs for a PLMN ID indicates that the related PLMN ID and NIDs identify SNPNs - Optionally - A human-readable network name per SNPN NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1271",
    "document_id": "23501-i80",
    "chunk_id": 1271,
    "text": "The human-readable network name per SNPN is only used for manual SNPN selection If the SNPN supports Localized Service the human-readable network name of the SNPN can be information related to the Localized Service The mechanism how human-readable network name is provided ie whether it is broadcasted or unicasted to the UE is specified in TS 38331 28 - Information as described in TS 38300 27 TS 38331 28 and in TS 38304 50 to prevent UEs not supporting SNPNs from accessing the cell eg if the cell only provides access to non-public networks - An indication per SNPN of whether access using credentials from a Credentials Holder is supported -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1272",
    "document_id": "23501-i80",
    "chunk_id": 1272,
    "text": "List of supported Group IDs for Network Selection GINs per SNPN and - An indication per SNPN of whether the SNPN allows registration attempts from UEs that are not explicitly configured to select the SNPN ie UEs that do not have any PLMN ID and NID nor GIN broadcast by the SNPN in the Credentials Holder controlled prioritized lists of preferred SNPNsGINs NOTE 4 Further details including number of supported GINs per SNPN are defined in TS 38331 28 53023 UE configuration and subscription aspects An SNPN-enabled UE is configured with the following information for each subscribed SNPN - PLMN ID and NID of the subscribed SNPN - Subscription identifier SUPI and credentials for the subscribed SNPN - Optionally an N3IWF FQDN and the MCC of the country where the configured N3IWF is located - Optionally if the UE supports access to an SNPN using credentials from a Credentials Holder - User controlled prioritized list of preferred SNPNs - Credentials Holder controlled prioritized list of preferred SNPNs - Credentials Holder controlled prioritized list of GINs - Optionally if the UE supports access to an SNPN using credentials from a Credentials Holder and access to an SNPN providing access for Localized Services - User controlled prioritized list of preferred SNPNs - Credentials Holder controlled prioritized list of preferred SNPNs for accessing Localized Services each entry of the list includes - an SNPN identifier - validity information and - optionally location assistance information - Credentials Holder controlled prioritized list of GINs for accessing Localized Services each entry of the list includes - a GIN - validity information and - optionally location assistance information - Protection scheme for concealing the SUPI as defined in TS 33501 29 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1273",
    "document_id": "23501-i80",
    "chunk_id": 1273,
    "text": "Additionally the UE can be configured with indication to use anonymous SUCI as defined in TS 24501 47 Validity information consists of - Time validity information ie time periods defined by start and end times when access to the SNPN for accessing Localized Services is allowed and - optionally location validity information containing one or more location information as defined in TS 24501 47 NOTE 2 Usage of the location validity information is further explained in TS 23122 17 Location assistance information consisting of - Geolocation information andor - Tracking Area information of serving networks ie lists of TACs per PLMN ID or per PLMN ID and NID The UE may use the location assistance information to determine where to search for the SNPNs in the Credentials Holder controlled prioritized list of SNPNs and GINs for accessing Localized Services ie the location assistance information is not used for any area restriction enforcement For an SNPN-enabled UE with SNPN subscription the Credentials Holder controlled prioritized lists of preferred SNPNs and GINs or Credentials Holder controlled prioritized lists of preferred SNPNs and GINs for accessing Localized Services may be updated by the Credentials Holder using the Steering of Roaming SoR procedure as defined in Annex C of TS 23122 17 Updating Credentials Holder controlled prioritized lists of preferred SNPNs and GINs or Credentials Holder controlled prioritized lists of preferred SNPNs and GINs for accessing Localized Services via the Steering of Roaming SoR procedure is not applicable for Credentials Holder with AAA Server A subscription of an SNPN is either - identified by a SUPI containing a network-specific identifier that takes the form of a Network Access Identifier NAI using the NAI RFC 7542 20 based user identification as defined in clause 2872 of TS 23003 19",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1274",
    "document_id": "23501-i80",
    "chunk_id": 1274,
    "text": "The realm part of the NAI may include the NID of the SNPN or - identified by a SUPI containing an IMSI NOTE 3 As to route network signalling to AUSF and UDM instances serving the SNPN-enabled UE the UE can be configured with Routing Indicator locally or updated with Routing Indicator using the UE Parameters Update via UDM Control Plane procedure defined in clause 420 of TS 23502 3 When the SNPN credential is stored in the USIM the Routing Indicator is provisioned in the USIM when the SNPN credential is stored in the ME the Routing Indicator is provisioned in the ME",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1275",
    "document_id": "23501-i80",
    "chunk_id": 1275,
    "text": "In the case of access to an SNPN using credentials owned by a Credentials Holder as specified in clause 530292 and clause 530293 the SUPI shall also contain identification for the Credentials Holder ie the realm in the case of Network Specific Identifier based SUPI or the MCC and MNC in the case of an IMSI based SUPI In the case of access to an SNPN using credentials owned by a Credentials Holder using AAA-S as specified in clause 530292 only Network Specific Identifier based SUPI is supported NOTE 4 When Credentials Holder is an SNPN and the MCC and MNC of the SNPN is not unique eg MCC 999 is used and MNC is not coordinated amongst the SNPNs then IMSI based SUPI is not supported as the MCC and MNC need not be globally unique always instead USIM credentials are supported using Network Specific Identifier based SUPI NOTE 5 Network Specific Identifier are not supported for the case the Credentials Holder is provided by a PLMN NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1276",
    "document_id": "23501-i80",
    "chunk_id": 1276,
    "text": "It is assumed that normally the SNPN and the Credentials Holder use different PLMN ID If the SNPN and CHs where CH can be another SNPN or a PLMN share PLMN ID and IMSI based SUPI is used then the Routing Indicator can be used for AUSFUDM discovery and selection as long as the Routing Indicator values are coordinated among the involved SNPN and CHs When the PLMN ID is not shared between SNPNs and CHs where CH can be another SNPN or a PLMN and IMSI based SUPI is used then PLMN ID is sufficient to be used for AUSFUDM discovery selection unless the CHs deploys multiple AUSFUDM in which case also the Routing Indicator can be used as long as the Routing Indicator values are coordinated within the CH An SNPN-enabled UE that supports access to an SNPN using credentials from a Credentials Holder and that is equipped with a PLMN subscription may additionally be configured with the following information for SNPN selection and registration using the PLMN subscription in SNPN access mode - User controlled prioritized list of preferred SNPNs - Credentials Holder controlled prioritized list of preferred SNPNs - Credentials Holder controlled prioritized list of preferred GINs - Optionally if the UE supports access to an SNPN providing access for Localized Services - Credentials Holder controlled prioritized list of preferred SNPNs for accessing Localized Services each entry of the list includes - an SNPN identifier - validity information and - optionally location assistance information - Credentials Holder controlled prioritized list of preferred GINs for accessing Localized Services each entry of the list includes - a GIN - validity information and - optionally location assistance information Validity information consists of - Time validity information ie time periods defined by start and end times when access to the SNPN for accessing Localized Services is allowed and - optionally location validity information containing one or more location information as defined in TS 24501 47 NOTE 7 Usage of the location validity information is further explained in TS 23122 17 Location assistance information consisting of - Geolocation information andor - Tracking Area information of serving networks ie lists of TACs per PLMN ID or per PLMN ID and NID The UE may use the location assistance information to determine where to search for the SNPNs in the Credentials Holder controlled prioritized list of SNPNs and GINs for accessing Localized Services ie the location assistance information is not used for any area restriction enforcement For an SNPN-enabled UE with PLMN subscription the Credentials Holder controlled prioritized lists of preferred SNPNs and GINs or the Credentials Holder controlled prioritized lists of preferred SNPNs and GINs for accessing Localized Services may be updated by the Credentials Holder using the Steering of Roaming SoR procedure as defined in Annex C of TS 23122 17 When the Credentials Holder updates a UE with the Credentials Holder controlled prioritized lists of preferred SNPNs and GINs andor the Credentials Holder controlled prioritized lists of preferred SNPNs and GINs for accessing Localized Services the UE may perform SNPN selection again eg to potentially select a higher prioritized SNPN or to potentially select an SNPN that provides access for Localized Services 53024 Network selection in SNPN access mode 530241 General An SNPN-enabled UE supports the SNPN access mode When the UE is set to operate in SNPN access mode the UE selects and registers with SNPNs over Uu as described in clause 53024 Network selection in SNPN access mode for access to SNPN services via Untrusted non-3GPP access Trusted non-3GPP access and Wireline access is specified in clause 530212 clause 530213 and clause 530214 respectively Access network selection in SNPN access mode for 5G NSWO is specified in clause 6312b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1277",
    "document_id": "23501-i80",
    "chunk_id": 1277,
    "text": "Emergency services are supported in SNPN access mode over Uu as defined in clause 51641 Support for Emergency in SNPN access mode via Untrusted non-3GPP access is specified in clause 530212 If a UE is not set to operate in SNPN access mode even if it is SNPN-enabled the UE does not select and register with SNPNs A UE not set to operate in SNPN access mode performs PLMN selection procedures as defined in clause 44 of TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1278",
    "document_id": "23501-i80",
    "chunk_id": 1278,
    "text": "For a UE capable of simultaneously connecting to an SNPN and a PLMN the setting for operation in SNPN access mode is applied to each of the UuYtNWu interfaces independently Clause D4 provides more details An SNPN-enabled UE that supports access to an SNPN using credentials from a Credentials Holder and that is equipped with a PLMN subscription needs to first enter SNPN access mode to be able to select SNPNs Once the UE has entered SNPN access mode SNPN selection is performed as described in clause 53024 Once an SNPN has been selected the UE attempts registration in the SNPN using the PLMN credentials NOTE 1 Details of activation and deactivation of SNPN access mode are up to UE implementation When a UE is set to operate in SNPN access mode the UE does not perform normal PLMN selection procedures as defined in clause 44 of TS 23122 17 UEs operating in SNPN access mode read the information described in clause 53022 from the broadcast system information and take them into account during network selection",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1279",
    "document_id": "23501-i80",
    "chunk_id": 1279,
    "text": "Furthermore if the UE supports access to an SNPN providing access for Localized Services and the end user enables to access the Localized Services the UE may select an SNPN providing access for Localized Services NOTE 2 Details of how the user enablesdisables access to Localized Services are up to UE implementation 530242 Automatic network selection NOTE 1 If the UE has multiple subscriptions SNPN andor PLMN it is assumed that the subscription to use for automatic selection is determined by implementation specific means prior to network selection If the UE supports accessing an SNPN providing access for Localized Services and the end user enables to access Localized Services for automatic network selection the UE shall select and attempts registration on available SNPN in the following order a if the UE supports access to an SNPN using Credentials from a Credentials Holder then the UE continues by selecting and attempting registration on available and allowable SNPNs which broadcasts the indication that access using credentials from a Credentials Holder is supported in the following order i the SNPN with the validity information the UE was last registered with if the validity information is met or the SNPNs equivalent SNPNs if available and the validity information of the SNPN that the UE was last registered with is met NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1280",
    "document_id": "23501-i80",
    "chunk_id": 1280,
    "text": "The equivalent SNPNs are assumed to provide access to the same Localized Services as the SNPN the UE was last registered with ii SNPNs in the Credentials Holder controlled prioritized list of preferred SNPNs for accessing Localized Services in priority order if the validity information is met iii SNPNs which additionally broadcast a GIN contained in the Credentials Holder controlled prioritized list of preferred GINs for accessing Localized Services in priority order if validity information is met b the SNPN without validity information the UE was last registered with if available or the equivalent SNPN if available c the subscribed SNPN which is identified by the PLMN ID and NID for which the UE has SUPI and credentials d the available and allowable SNPNs which broadcast the indication that access using credentials from a Credentials Holder is supported in the following order i SNPNs in the user controlled prioritized list of preferred SNPNs in priority order ii SNPNs in the Credentials Holder controlled prioritized list of preferred SNPNs in priority order iii SNPNs which additionally broadcast a GIN contained in the Credentials Holder controlled prioritized list of preferred GINs in priority order iv- SNPNs which additionally broadcast an indication that the SNPN allows registration attempts from UEs that are not explicitly configured to select the SNPN ie the broadcasted NID or GIN is not present in the Credentials Holder controlled prioritized lists of preferred SNPNsGINs nor in the Credentials Holder controlled prioritized lists of preferred SNPNsGINs for accessing Localized Services in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1281",
    "document_id": "23501-i80",
    "chunk_id": 1281,
    "text": "If the location validity information is not available and the time validity information is available the validity conditions are met when the time validity conditions are met If both the location validity information and the time validity information are available the validity conditions are met when both the time validity conditions and the location validity conditions are met If the UE supports accessing an SNPN providing access for Localized Services and the end user enables to access Localized Services the UE shall periodically attempt reselection and registration on a higher priority SNPN 1 based on the order of the above sub-bullets i to iii of bullet a bullet c sub-bullets i to iii of bullet d if the UE is not registered to the sub-bullet i of bullet a or 2 based on the order of the above sub-bullets ii to iii of bullet a bullet c sub-bullets i to iii of bullet d if the UE is registered to the sub-bullet i of bullet a if any of the below conditions is met - if there are one or more SNPNs with validity information which is met and the UE is not registered to an SNPN which has highest priority among the one or more SNPNs or - if there is no SNPN with validity information which is met and there are one or more GINs with the validity information which is met and the UE is not registered to an SNPN broadcasting a GIN which has highest priority among the one or more GINs or - if there is no SNPN with validity information which is met and there is no GIN with validity information which is met and the UE is not registered to the subscribed SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1282",
    "document_id": "23501-i80",
    "chunk_id": 1282,
    "text": "Otherwise the UE does not trigger periodic reselection and does not attempt registration on a higher priority SNPN NOTE 3 Details of network selection eg validity information handling periodicity determination specified in TS 23122 17 If the selected SNPN is an SNPN providing access for Localized Services and the validity condition for the selected SNPN changes from met to not met the UE may attempt selection and registration on an SNPN based on the above bullets a to d If the selected SNPN is not an SNPN providing access for Localized Services and a validity condition for an entry in Credentials Holder controlled prioritized list of preferred SNPNsGINs for accessing Localized Services changes from not met to met the UE may attempt selection and registration on an SNPN based on the above bullets a to d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1283",
    "document_id": "23501-i80",
    "chunk_id": 1283,
    "text": "If the UE does not support to access an SNPN providing access for Localized Services or the end user does not enable to access the Localized Services for automatic network selection the UE shall select and attempts registration on available and allowable SNPNs in the following order - the SNPN without validity information the UE was last registered with if available or the equivalent SNPN if available - the subscribed SNPN which is identified by the PLMN ID and NID for which the UE has SUPI and credentials - If the UEs supports access to an SNPN using credentials from a Credentials Holder then the UE continues by selecting and attempting registration on available and allowable SNPNs which broadcast the indication that access using credentials from a Credentials Holder is supported in the following order - SNPNs in the user controlled prioritized list of preferred SNPNs in priority order - SNPNs in the Credentials Holder controlled prioritized list of preferred SNPNs in priority order - SNPNs which additionally broadcast a GIN contained in the Credentials Holder controlled prioritized list of preferred GINs in priority order NOTE 4 If multiple SNPNs are available that broadcast the same GIN the order in which the UE selects and attempts a registration with those SNPNs is implementation specific - SNPNs which additionally broadcast an indication that the SNPN allows registration attempts from UEs that are not explicitly configured to select the SNPN ie the broadcasted NID or GIN is not present in the Credentials Holder controlled prioritized lists of preferred SNPNsGINs in the UE NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1284",
    "document_id": "23501-i80",
    "chunk_id": 1284,
    "text": "If multiple SNPNs are available that broadcast the indication that the SNPN allows registration attempts from UEs that are not explicitly configured to select the SNPN the order in which the UE selects and attempts a registration with those SNPNs is implementation specific When a UE performs Registration or Service Request to an SNPN the UE shall indicate the PLMN ID and NID as broadcast by the selected SNPN to NG-RAN NG-RAN shall inform the AMF of the selected PLMN ID and NID 530243 Manual network selection For manual network selection UEs operating in SNPN access mode provide to the user the list of SNPNs each is identified by a PLMN ID and NID and related human-readable names if available of the available SNPNs the UE has respective SUPI and credentials for If the UEs supports access to an SNPN using credentials from a Credentials Holder the UE also presents available SNPNs which broadcast the access using credentials from a Credentials Holder is supported indication and the human-readable names related to the SNPNs if available NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1285",
    "document_id": "23501-i80",
    "chunk_id": 1285,
    "text": "The details of manual SNPN selection are defined in TS 23122 17 When a UE performs Initial Registration to an SNPN the UE shall indicate the selected PLMN ID and NID as broadcast by the selected SNPN to NG-RAN NG-RAN shall inform the AMF of the selected PLMN ID and NID 53025 Network access control If a UE performs the registration or service request procedure in an SNPN identified by a PLMN ID and a self-assigned NID and there is no subscription for the UE then the AMF shall reject the UE with an appropriate cause code to temporarily prevent the UE from automatically selecting and registering with the same SNPN If a UE performs the registration or service request procedure in an SNPN identified by a PLMN ID and a coordinated assigned NID and there is no subscription for the UE then the AMF shall reject the UE with an appropriate cause code to permanently prevent the UE from automatically selecting and registering with the same SNPN NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1286",
    "document_id": "23501-i80",
    "chunk_id": 1286,
    "text": "The details of rejection and cause codes is defined in TS 24501 47 If a UE performs the registration in an SNPN using credentials from a Credentials Holder ie the CH is the PLMNSNPN that owns the UE subscription and controls the access and the Credentials Holder does not authorize the UE to access that specific SNPN due to access authorization based on subscription data or invalid time for accessing an SNPN that provides access to Localized Services then the UDM in the Credentials Holder can reject the UE which results in AMF rejecting the registration request from the UE with an appropriate cause code to prevent the UE from automatically selecting and registering with the same SNPN using credentials from the Credentials Holder as described in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1287",
    "document_id": "23501-i80",
    "chunk_id": 1287,
    "text": "In order to prevent access to SNPNs for authorized UEs in the case of network congestionoverload Unified Access Control information is configured per SNPN ie as part of the subscription information that the UE has for a given SNPN and provided to the UE as described in TS 24501 47 53026 Cell re-selection in SNPN access mode UEs operating in SNPN access mode only select cells and networks broadcasting both PLMN ID and NID of the selected SNPN or its equivalent SNPN NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1288",
    "document_id": "23501-i80",
    "chunk_id": 1288,
    "text": "Further details on the NR idle and inactive mode procedures for SNPN cell selection is defined in TS 38331 28 and in TS 38304 50 53027 Access to PLMN services via stand-alone non-public networks To access PLMN services a UE in SNPN access mode that has successfully registered with an SNPN may perform another registration via the SNPN User Plane with a PLMN using the credentials of that PLMN following the same architectural principles as specified in clause 428 including the optional support for PDU Session continuity between PLMN and SNPN using the Handover of a PDU Session procedures in clauses 4921 and 4922 of TS 23502 3 and the SNPN taking the role of Untrusted non-3GPP access Annex D clause D3 provides additional details NOTE QoS differentiation in the SNPN can be provided on per-IPsec Child Security Association basis by using the UE or network requested PDU Session Modification procedure described in clause 4332 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1289",
    "document_id": "23501-i80",
    "chunk_id": 1289,
    "text": "In the PLMN N3IWF determines the IPsec child SAs as defined in clause 412 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1290",
    "document_id": "23501-i80",
    "chunk_id": 1290,
    "text": "The N3IWF is preconfigured by PLMN to allocate different IPsec child SAs for QoS Flows with different QoS profiles To support QoS differentiation in the SNPN with network-initiated QoS the mapping rules between the SNPN and the PLMN are assumed to be governed by an SLA including 1 mapping between the DSCP markings for the IPsec child SAs on NWu and the corresponding QoS which is the QoS requirement of the PLMN and is expected to be provided by the SNPN and 2 N3IWF IP addresses in the PLMN The non-alteration of the DSCP field on NWu is also assumed to be governed by an SLA and by transport-level arrangements that are outside of 3GPP scope The packet detection filters in the SNPN can be based on the N3IWF IP address and the DSCP markings on NWu To support QoS differentiation in the SNPN with UE-requested QoS the UE can request for an IPsec SA the same 5QI from the SNPN as the 5QI provided by the PLMN It is assumed that UE-requested QoS is used only when the 5QIs used by the PLMN are from the range of standardized 5QIs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1291",
    "document_id": "23501-i80",
    "chunk_id": 1291,
    "text": "The packet filters in the requested QoS rule can be based on the N3IWF IP address and the SPI associated with the IPsec SA Refer to clause D7 for details on how to support QoS differentiation When the UE accesses the PLMN over NWu via a SNPN the AMF in the serving PLMN shall send an indication toward the UE during the Registration procedure to indicate whether an IMS voice over PS session is supported or not 53028 Access to stand-alone non-public network services via PLMN To access SNPN services a UE that has successfully registered with a PLMN over 3GPP access may perform another registration via the PLMN User Plane with an SNPN using the credentials of that SNPN following the same architectural principles as specified in clause 428 including the optional support for PDU Session continuity between PLMN and SNPN using the Handover of a PDU Session procedures in clauses 4921 and 4922 of TS 23502 3 and the PLMN taking the role of Untrusted non-3GPP access of the SNPN ie using the procedures for Untrusted non-3GPP access in clause 4122 of TS 23502 3 Annex D clause D3 provides additional details The case where UE that has successfully registered with a PLMN over non-3GPP access to access SNPN services is not specified in this Release NOTE QoS differentiation in the PLMN can be provided on per-IPsec Child Security Association basis by using the UE or network requested PDU Session Modification procedure described in clause 4332 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1292",
    "document_id": "23501-i80",
    "chunk_id": 1292,
    "text": "In the SNPN N3IWF determines the IPsec child SAs as defined in clause 412 of TS 23502 3 The N3IWF is preconfigured by SNPN to allocate different IPsec child SAs for QoS Flows with different QoS profiles To support QoS differentiation in the PLMN with network-initiated QoS the mapping rules between the PLMN and the SNPN are assumed to be governed by an SLA including 1 mapping between the DSCP markings for the IPsec child SAs on NWu and the corresponding QoS which is the QoS requirement of the SNPN and is expected to be provided by the PLMN and 2 N3IWF IP addresses in the SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1293",
    "document_id": "23501-i80",
    "chunk_id": 1293,
    "text": "The non-alteration of the DSCP field on NWu is also assumed to be governed by an SLA and by transport-level arrangements that are outside of 3GPP scope The packet detection filters in the PLMN can be based on the N3IWF IP address and the DSCP markings on NWu To support QoS differentiation in the PLMN with UE-requested QoS the UE can request for an IPsec SA the same 5QI from the PLMN as the 5QI provided by the SNPN It is assumed that UE-requested QoS is used only when the 5QIs used by the SNPN are from the range of standardized 5QIs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1294",
    "document_id": "23501-i80",
    "chunk_id": 1294,
    "text": "The packet filters in the requested QoS rule can be based on the N3IWF IP address and the SPI associated with the IPsec SA Refer to clause D7 for details on how to support QoS differentiation When the UE accesses the SNPN over NWu via a PLMN the AMF in the SNPN shall send an indication toward the UE during the Registration procedure to indicate whether an IMS voice over PS session is supported or not 53029 SNPN connectivity for UEs with credentials owned by Credentials Holder 530291 General SNPNs may support UE access using credentials owned by a Credentials Holder separate from the SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1295",
    "document_id": "23501-i80",
    "chunk_id": 1295,
    "text": "In this case the Session Management procedures ie PDU Sessions terminate in an SMF in the SNPN When an SNPN supports UE access using credentials assigned by a Credentials Holder separate from the SNPN it is assumed that is supported homogeneously within the whole SNPN Credentials Holder using AAA Server for primary authentication and authorization is described in clause 530292 and Credentials Holder using AUSF and UDM for primary authentication and authorization is described in clause 530293 530292 Credentials Holder using AAA Server for primary authentication and authorization The AUSF and the UDM in SNPN may support primary authentication and authorization of UEs using credentials from a AAA Server in a Credentials Holder CH - Only NSI based SUPI is supported and the SUPI is used to identify the UE during primary authentication and authorization towards the AAA Server SUPI privacy is achieved according to methods in clause I5 of TS 33501 29 - The AMF discovers and selects the AUSF as described in clause 634 using the Home Network Identifier realm part and Routing Indicator present in the SUCI provided by a UE configured as described in clause 53023 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1296",
    "document_id": "23501-i80",
    "chunk_id": 1296,
    "text": "The AMF selects the UDM in the same SNPN based on local configuration eg using the realm part of the SUCI or using the NRF procedure defined in clause 4174a of TS 23502 3 - If the UDM decides that the primary authentication is performed by AAA Server in CH based on the UEs SUPI and subscription data The Home Network Identifier is derived by UDM from the SUCI received from AUSF If the SUCI was generated using a privacy protection scheme that requires de-concealment UDM de-conceal the SUCI as defined in TS 33501 29 The UDM then instructs the AUSF that primary authentication by a AAA Server in a CH is required the AUSF shall discover and select the NSSAAF and then forward EAP messages to the NSSAAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1297",
    "document_id": "23501-i80",
    "chunk_id": 1297,
    "text": "The NSSAAF selects AAA Server based on the domain name corresponds to the realm part of the SUPI relays EAP messages between AUSF and AAA Server or AAA proxy and performs related protocol conversion The AAA Server acts as the EAP Server for the purpose of primary authentication NOTE 1 The UDM in SNPN based on SLA between Credentials Holder and SNPN is pre-configured with information indicating whether the UE needs primary authentication from AAA Server NOTE 2 It is assumed that the SNPN is configured on per Home Network Identifier basis to determine whether to perform primary authentication with AUSFUDM or AAA server - The AMF and SMF shall retrieve the UE subscription data from UDM using SUPI Figure 530292-1 depicts the 5G System architecture for SNPN with Credentials Holder using AAA Server for primary authentication and authorization NOTE 3 The SNPN in Figure 530292-1 can be the subscribed SNPN for the UE ie NG-RAN broadcasts SNPN ID of the subscribed SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1298",
    "document_id": "23501-i80",
    "chunk_id": 1298,
    "text": "As a deployment option the SNPN in Figure 530292-1 can also be another SNPN than the subscribed SNPN for the UE ie none of the SNPN IDs broadcast by NG-RAN matches the SNPN ID corresponding to the subscribed SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1299",
    "document_id": "23501-i80",
    "chunk_id": 1299,
    "text": "In both cases the AUSF UDM and NSSAAF are configured to support the HNI of the UEs SUPISUCI SUPI privacy settings when using privacy protection scheme other than the null-scheme to generate the SUCI as defined in TS 33501 29 subscription data of the UE and authentication settings to allow UE authentication with AAA-S in CH Figure 530292-1 5G System architecture with access to SNPN using credentials from Credentials Holder using AAA Server NOTE 4 The NSSAAF deployed in the SNPN can support primary authentication in the SNPN using credentials from Credentials Holder using a AAA Server as depicted andor the NSSAAF can support Network Slice-Specific Authentication and Authorization with a Network Slice-Specific AAA Server not depicted 530293 Credentials Holder using AUSF and UDM for primary authentication and authorization An SNPN may support primary authentication and authorization of UEs that use credentials from a Credentials Holder using AUSF and UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1300",
    "document_id": "23501-i80",
    "chunk_id": 1300,
    "text": "The Credentials Holder may be an SNPN or a PLMN The Credentials Holder UDM provides to SNPN the subscription data NOTE 1 A list of functionalities not supported in SNPN is provided in clause 53020 Optionally an SNPN may support network slicing including Network Slice-Specific Authentication and Authorization Network Slice Access Control and subscription-based restrictions to simultaneous registration of network slices for UEs that use credentials from a Credentials Holder using AUSF and UDM The SNPN retrieves NSSAA and NSSRG information from the UDM of the Credentials Holder Figure 530293-1 depicts the 5G System architecture for SNPN with Credentials Holder using AUSF and UDM for primary authentication and authorization and network slicing NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1301",
    "document_id": "23501-i80",
    "chunk_id": 1301,
    "text": "The architecture for SNPN and Credentials Holder using AUSF and UDM is depicted as a non-roaming reference architecture as the UE is not considered to be roaming even though some of the roaming architecture reference points are also used eg for AMF and SMF in SNPN to register with and retrieve subscription data from UDM of the Credentials Holder Figure 530293-1 5G System architecture with access to SNPN using credentials from Credentials Holder using AUSF and UDM 530210 Onboarding of UEs for SNPNs 5302101 General Onboarding of UEs for SNPNs allows the UE to access an Onboarding Network ONN for the purpose of provisioning the UE with SNPN credentials for primary authentication and other information to enable access to a desired SNPN ie re-select and re-register with SNPN To provision SNPN credentials in a UE that is configured with Default UE credentials see clause 53021024 the UE selects an SNPN as ONN and establishes a secure connection with that SNPN referred to as Onboarding SNPN ON-SNPN see more details in clause 5302102 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1302",
    "document_id": "23501-i80",
    "chunk_id": 1302,
    "text": "If the UE is already provisioned with a set of SNPN credentials or credentials owned by a Credentials Holder and needs to be provisioned with an additional set of SNPN credentials the UE can access an SNPN using the network selection in SNPN access mode as described in clause 53024 normal registration ie not registration for onboarding and normal PDU Session ie not a restricted PDU Session used for onboarding and then leverage the SNPNs User Plane connection to get access to a PVS The PVS address can be provided in the same way as when the Onboarding Network is a PLMN To provision SNPN credentials in a UE that is equipped with a USIM configured with PLMN credentials the UE selects a PLMN as ONN and establishes a secure connection with that PLMN see more details in clause 5302103 After the secure connection is established the UE is provisioned with SNPN credentials and possibly other data to enable discovery re-selection and re-registration for a desired SNPN see more details in clause 5302104 ON-SNPN and SO-SNPN can be roles taken by either an SNPN or different SNPNs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1303",
    "document_id": "23501-i80",
    "chunk_id": 1303,
    "text": "It is possible for the same network to be in both roles with respect to a specific UE 5302102 Onboarding Network is an SNPN 53021021 General A UE configured with Default UE credentials may register with an ON-SNPN for the provisioning of SO-SNPN credentials 53021022 Architecture Figures 53021022-1 53021022-2 and 53021022-3 depict the architecture for Onboarding of UEs in an ON-SNPN Figure 53021022-1 Architecture for UE Onboarding in ON-SNPN when the DCS includes an AUSF and a UDM Figure 53021022-2 Architecture for UE Onboarding in ON-SNPN when the DCS includes a AAA Server used for primary authentication Figure 53021022-3 Architecture for UE Onboarding in ON-SNPN when the DCS is not involved during primary authentication NOTE 1 AUSF in the ON-SNPN interfaces with the DCS via NSSAAF as shown in Figure 53021022-2 owned by an entity that is internal or external to the ON-SNPN NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1304",
    "document_id": "23501-i80",
    "chunk_id": 1304,
    "text": "The functionality with respect to exchange information between PVS and SO-SNPN to provision SNPN credentials and other data from the SO-SNPN in the UE is out of 3GPP scope NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1305",
    "document_id": "23501-i80",
    "chunk_id": 1305,
    "text": "The dotted lines in Figure 53021022-1 Figure 53021022-2 and Figure 53021022-3 indicate that whether domains eg DCS domain PVS domain and SO-SNPN are separated depends on the deployment scenario NOTE 4 See TS 33501 29 for the functionality beyond AUSF and other interfaces required for security NOTE 5 When secondary authentication is used in the context of the UE onboarding architecture in Figure 53021022-3 the same S-NSSAIDNN or different S-NSSAIDNNs can be used for the onboarding PDU Sessions of different UEs even though the DN-AAA servers that authenticate the UEs can reside in different administrative domains When the DCS is involved during mutual primary authentication during the Onboarding procedure as in Figure 5301022-1 and Figure 5301022-2 the following applies - When the DCS includes an AUSF and a UDM functionality then the AMF selects AUSF in the DCS domain The ON-SNPN and DCS domain are connected via N32 and SEPP which are not shown in the Figure 53021022-1 - When the DCS includes a AAA Server functionality only NSI based SUPI is supported and the AMF selects AUSF in the ON-SNPN Based on local configuration eg using the realm part of the Onboarding SUCI the AUSF skips the UDM selection and directly performs primary authentication towards DCS with AAA Server functionality using Default UE credentials for primary authentication The AUSF uses an NSSAAF and the NSSAAF may use a AAA-P which is not shown in the figure 53021022-2 to relay EAP messages towards the DCS including a AAA Server The NSSAAF selects AAA Server based on the domain name corresponding to the realm part of the SUPI NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1306",
    "document_id": "23501-i80",
    "chunk_id": 1306,
    "text": "The AMF in ON-SNPN uses the Home Network Identifier of the Onboarding SUCI to select the DCS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1307",
    "document_id": "23501-i80",
    "chunk_id": 1307,
    "text": "It is assumed that the ON-SNPN is configured on per Home Network Identifier basis to determine whether to perform primary authentication with AUSFUDM or AAA server - Upon establishment of the PDU Session used for User Plane Remote Provisioning the ON-SNPN may trigger secondary authentication procedure as described in clause 4323 of TS 23502 3 with a DN-AAA using Default UE credentials for secondary authentication as described in clause I924 of TS 33501 29 When the DCS is not involved during primary authentication as in Figure 5301022-3 the following applies - The AMF selects a local AUSF as described in clause 53021026 and performs primary authentication towards the local AUSF using Default UE credentials for primary authentication as described in TS 33501 29 - Upon establishment of the PDU Session used for User Plane Remote Provisioning the ON-SNPN may trigger secondary authentication procedure as described in clause 4323 of TS 23502 3 with the DCS or with a DN-AAA server using Default UE credentials for secondary authentication as described in clause I924 of TS 33501 29 When secondary authentication is used the SMF identifies the DCS or the DN-AAA server as defined in clause 4323 of TS 23502 3 NOTE 6 If the secondary authentication fails the SMF rejects the PDU Session used for User Plane Remote Provisioning Based on local policy the AMF can deregister the UE as described in clause 53021027 NOTE 7",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1308",
    "document_id": "23501-i80",
    "chunk_id": 1308,
    "text": "The DCS and PVS can be owned by an administrative entity that can be different from either the ON-SNPN or SO-SNPN The ownership of DCS and PVS is outside the scope of 3GPP 53021023 Broadcast system information When the SNPN supports Onboarding of UEs for SNPNs ie the SNPN can be used as ON-SNPN the NG-RAN node or the Trusted non-3GPP access network providing access to SNPN additionally broadcasts the following information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1309",
    "document_id": "23501-i80",
    "chunk_id": 1309,
    "text": "An onboarding enabled indication that indicates whether onboarding is currently enabled for the SNPN For access to SNPN via NG-RAN the onboarding enabled indication is broadcasted per cell eg to allow start of the onboarding procedure only in parts of the SNPN NOTE Onboarding enabled indication per cell does not affect mobility management functions ie once the UE selects the ON-SNPN as described in clause 53021025 and successfully registers within ON-SNPN as described in clause 53021026 the UE can move to a cell of the ON-SNPN not indicating onboarding support and continue with the remote provisioning as described in clause 5302104 53021024 UE Configuration Aspects",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1310",
    "document_id": "23501-i80",
    "chunk_id": 1310,
    "text": "A UE enabled to support UE Onboarding shall be pre-configured with Default UE credentials and the UE may be pre-configured with ON-SNPN selection information The Default UE credentials consist of credentials for primary authentication and optionally credentials for secondary authentication as described in clause I9 of TS 33501 29 NOTE 1 The content of the ON-SNPN network selection information depends on UE implementation and can include SNPN network identifiers andor GINs The UE uses the ON-SNPN selection information for selection of ON-SNPN see clause 53021025 The UE Configuration Data for UP Remote Provisioning is described in the clause 53021042 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1311",
    "document_id": "23501-i80",
    "chunk_id": 1311,
    "text": "It is assumed that the UE is not pre-configured with a S-NSSAI and DNN for the purpose of UE onboarding in the ON-SNPN NOTE 3 The Default UE credentials for primary authentication are used to derive a SUPI When the UE derives the SUPI from the Default UE credentials for primary authentication the UE performs specific onboarding procedure as described in clauses 53021025 53021026 and 53021027 53021025 Network selection This clause applies only when the UE is in SNPN access mode When the UE wants to perform UE onboarding via an SNPN the UE shall perform ON-SNPN selection as described below An ON-SNPN is an SNPN providing onboarding access and enabling remote provisioning for a UE registered for onboarding as specified in clause 42224 of TS 23502 3 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1312",
    "document_id": "23501-i80",
    "chunk_id": 1312,
    "text": "The trigger for the UE to initiate the UE Onboarding procedure is UE implementation dependent eg the trigger can be a power-on event in the UE or an input by the user For automatic or manual selection the UE may select and attempt to register to an ON-SNPN which broadcast the Onboarding enabled indication described in clause 53021023 and matches the pre-configured ON-SNPN selection information such as SNPN network identifier andor GINs if available described in clause 53021024 according to the UE implementation-specific logic If the registration fails the UE may select and attempt to register to a different ON-SNPN as defined in clause 49313 or clause 49314 of TS 23122 17 53021026 Registration for UE onboarding When the user or UE has selected an ON-SNPN according to clause 53021025 the UE establishes an RRC connection towards the NG-RAN node of the ON-SNPN The UE provides an indication in RRC Connection Establishment that the RRC connection is for onboarding as defined in TS 38331 28",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1313",
    "document_id": "23501-i80",
    "chunk_id": 1313,
    "text": "This indication allows the NG-RAN node to select an appropriate AMF that supports the UE onboarding procedures The UE indicates the ON-SNPN as the selected network and the NG-RAN node shall indicate the selected PLMN ID and NID of the ON-SNPN to the AMF NOTE 1 As the configuration information in the UE does not include any S-NSSAI and DNN used for onboarding the UE does not include S-NSSAI and DNN in RRC when it registers for UE onboarding purposes to the ONN The UE shall initiate the NAS registration procedure by sending a NAS Registration Request message with the following characteristics - The UE shall set the 5GS Registration Type to the value SNPN Onboarding indicating that the registration request is for onboarding - The UE shall provide a SUCI derived from a SUPI as specified in TS 23003 19 and TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1314",
    "document_id": "23501-i80",
    "chunk_id": 1314,
    "text": "The SUPI shall uniquely identify the UE and shall be derived from the Default UE credentials for primary authentication The SUPI used for onboarding may contain an IMSI or a network-specific identifier The ON-SNPN may determine the corresponding DCS identity or addressdomain based on the SUCI ie based on the Home Network Identifier of the SUCI The UE does not include a Requested NSSAI in NAS signalling when it registers for UE onboarding purposes to the ON-SNPN The AMF supporting UE onboarding is configured with AMF Onboarding Configuration Data that includes eg - S-NSSAI and DNN to be used for onboarding or a configured SMF for the S-NSSAI and DNN used for onboarding - Information to use a local AUSFs within the ON-SNPN for onboarding of UEs with a SUCI for a DCS with AAA Server or for onboarding of UEs in the case where the DCS is not involved during primary authentication NOTE 2 The S-NSSAI used for onboarding is assumed to be configured in both the AMF ie in the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1315",
    "document_id": "23501-i80",
    "chunk_id": 1315,
    "text": "Onboarding Configuration Data and the NG-RAN nodes for the corresponding Tracking Areas where onboarding is enabled When the AMF receives a NAS Registration Request with a 5GS Registration Type set to SNPN Onboarding the AMF - starts an authentication procedure towards the AUSF the authentication procedure is specified in TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1316",
    "document_id": "23501-i80",
    "chunk_id": 1316,
    "text": "The AMF may be provided with PVS IP addresses or PVS FQDNs from the DCS during authentication procedure The AMF selects an appropriate AUSF as described in clause 634 based on the Home Network Identifier of the SUCI used during onboarding or based on local configuration in the AMF - applies the AMF Onboarding Configuration Data eg used to restrict UE network usage to only onboarding for User Plane Remote Provisioning of UE as described in clause 53021043 - stores in the UE context in AMF an indication that the UE is registered for SNPN onboarding - shall handle the list of equivalent SNPNs as described in TS 24501 47 Upon successful authentication from AUSF the AMF informs the UE about the result of the registration If the UE is not successfully authenticated the AMF shall reject the registration procedure for onboarding and the UE may select a different ON-SNPN to attempt to register NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1317",
    "document_id": "23501-i80",
    "chunk_id": 1317,
    "text": "The AMF does not interact with the UDM of the ON-SNPN or DCS ie for registration or subscription management purposes when it receives a NAS Registration Request with a 5GS Registration Type set to SNPN Onboarding see clause 42224 of TS 23502 3 53021027 Deregistration from the ON-SNPN for onboarding registered UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1318",
    "document_id": "23501-i80",
    "chunk_id": 1318,
    "text": "Once remote provisioning of SO-SNPN credentials is completed the UE should initiate deregistration from the ON-SNPN Based on ON-SNPN policies the AMF may start an implementation specific timer once the UE has registered to the ON-SNPN for the purpose of onboarding Expiry of this timer triggers the AMF to deregister the onboarding registered UE from the ON-SNPN The AMF may also deregister the UE when it determines that the PDU Session used for User Plane Remote Provisioning has been released by the SMF When AMF re-allocation occurs for a UE registered for SNPN onboarding during mobility registration update procedure as described in TS 23502 3 in clause 42224 or during N2 based handover as described in TS 23502 3 clause 4913 the new AMF supporting SNPN Onboarding should be selected as described in clause 635 If the new AMF receives in UE context the indication that the UE is registered for SNPN onboarding the new AMF may start an implementation specific timer for when to deregister the UE when the new AMF completes the Registration procedure ie sends Registration Accept to the UE or completes the N2 based handover procedure NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1319",
    "document_id": "23501-i80",
    "chunk_id": 1319,
    "text": "This specific timer is used to prevent onboarding registered UEs from staying at the ON-SNPN indefinitely 5302103 Onboarding Network is a PLMN 53021031 General A UE configured with PLMN credentials in USIM for primary authentication may register with a PLMN for the provisioning of SO-SNPN credentials 53021032 Network selection and Registration This clause applies only when the UE is not in SNPN access mode When the UE is using PLMN credentials for accessing a PLMN as the Onboarding Network ONN then regular network selection as per TS 23122 17 and regular initial registration procedures apply as per TS 23502 3 After successfully registering to the ON-PLMN the UE is provisioned with the SO-SNPN credentials via User Plane as in clause 53021044 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1320",
    "document_id": "23501-i80",
    "chunk_id": 1320,
    "text": "When Onboarding network is a PLMN and the UEs subscription only allows for Remote Provisioning then based on PLMN policies the AMF can start an implementation specific timer once the UE has registered to the PLMN Expiry of this timer triggers the AMF to deregister the UE from the PLMN This specific timer is used to prevent registered UEs that are only allowed for Remote Provisioning from staying at the PLMN indefinitely 5302104 Remote Provisioning of UEs in Onboarding Network 53021041 General Remote Provisioning of UEs that registered with an Onboarding Network enables provisioning the UE with SNPN credentials for primary authentication and other information to enable access to the desired SNPN Onboarding Services are provided using a PDU Session for DNN and S-NSSAI used for onboarding allowing remote provisioning of UEs via User Plane The PDU Session may be restricted only to be used for Remote Provisioning of the UE 53021042 Onboarding configuration for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1321",
    "document_id": "23501-i80",
    "chunk_id": 1321,
    "text": "In order to enable UP Remote Provisioning of SNPN credentials for a UE UE Configuration Data for User Plane Remote Provisioning are either pre-configured on the UE or provided by the ONN UE Configuration Data for User Plane Remote Provisioning provided by the ONN take precedence over corresponding configuration data stored in the UE UE Configuration Data for User Plane Remote Provisioning consist of PVS IP addresses andor PVS FQDNs If the UE does not have any PVS IP address or PVS FQDN after the establishment of the PDU Session used for User Plane Remote Provisioning the UE may construct an FQDN for PVS discovery as defined in TS 23003 19 The UE Configuration Data for User Plane Remote Provisioning may be stored in the ME The UE Configuration Data for User Plane Remote",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1322",
    "document_id": "23501-i80",
    "chunk_id": 1322,
    "text": "Provisioning ie PVS IP addresses or PVS FQDNs or both may be - locally configured in the SMF of ONN andor - provided by the DCS to the AMF of ON-SNPN as part of the authentication procedure as specified in TS 33501 29 and sent by the AMF in the Nsmf_PDUSession_CreateSMContext Request message to the SMF If the SNPN acting as ON-SNPN is not capable to provide access to Localized Services the PVS IP addresses andor PVS FQDNs provided by the DCS take precedence over the locally configured PVS IP addresses andor PVS FQDNs in the ON-SNPN If the SNPN acting as ON-SNPN is capable to provides access to Localized Services the SMF should include both DCS provided and the locally configured PVS IP addresses andor PVS FQDNs in the UE Configuration Data for User Plane Remote Provisioning",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1323",
    "document_id": "23501-i80",
    "chunk_id": 1323,
    "text": "If the PCF is used for User Plane Remote Provisioning the SMF provides the UE Configuration Data to the PCF as described in clause 53021043 The UE Configuration Data for User Plane Remote Provisioning may be provided to the UE during the establishment of the PDU Session used for User Plane Remote Provisioning as part of Protocol Configuration Options PCO in the PDU Session Establishment Response NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1324",
    "document_id": "23501-i80",
    "chunk_id": 1324,
    "text": "If there are multiple PVS IP addresses andor PVS FQDNs in the UE how the UE selects PVS from this information is up to UE implementation 53021043 User Plane Remote Provisioning of UEs when Onboarding Network is an ON-SNPN The AMF selects an SMF used for User Plane Remote Provisioning using the SMF discovery and selection functionality as described in clause 632 The S-NSSAI and DNN of the AMF Onboarding Configuration Data may be used to discover and select an SMF for User Plane Remote Provisioning Alternatively for SMF selection the AMF Onboarding Configuration Data may contain a configured SMF for the S-NSSAI and DNN used for onboarding The AMF provides Onboarding Indication to SMF via Nsmf_PDUSession_CreateSMContext request message when a PDU Session used for User Plane Remote Provisioning is established During PDU Session establishment for remote provisioning the AMF may provide the PVS IP addresses andor PVS FQDNs to the SMF When a UPF is selected for User Plane Remote Provisioning the UPF selection function described in clause 633 for normal services is applied considering the S-NSSAI and DNN used for onboarding The SMF or the PCF may store S-NSSAI and DNN information used for onboarding Onboarding Configuration Data available to PCF for details see TS 23503 45 andor SMF may include PVS FQDNs andor PVS IP addresses The SMF and the PCF may use Onboarding Indication and DNN and S-NSSAI used for onboarding to access the Onboarding Configuration Data NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1325",
    "document_id": "23501-i80",
    "chunk_id": 1325,
    "text": "The SMF is aware about the PVS IP addresses andor PVS FQDNs in one of the following ways either received from the AMF or retrieved locally from the Onboarding Configuration Data When the UE registered for Onboarding ie 5GS Registration Type is set to the value SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1326",
    "document_id": "23501-i80",
    "chunk_id": 1326,
    "text": "Onboarding successfully completes the User Plane Remote Provisioning of SNPN credentials via the Onboarding Network then the UE should deregister from the Onboarding Network Initial QoS parameters used for User Plane Remote Provisioning are configured in the SMF when dynamic PCC is not used Dynamic PCC may be used for a PDU Session used for User Plane Remote Provisioning as described in TS 23503 45 If a PCF is used and the AMF provided an Onboarding Indication the SMF provides Onboarding Indication to the PCF when requesting an SM Policy Association The SMF may provide the UE Configuration Data ie PVS IP addresses andor PVS FQDNs to the PCF when requesting an SM Policy Association The QoS Flows of a restricted PDU Session which is associated with the S-NSSAIDNN used for Onboarding shall be dedicated to Onboarding Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1327",
    "document_id": "23501-i80",
    "chunk_id": 1327,
    "text": "The SMF may configure in the UPF PDRs and FARs including PVS and DNS server IP addresses to block any traffic that is not from or to PVS and DNS server addresses If the UE is registered for Onboarding ie 5GS Registration Type is set to the value SNPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1328",
    "document_id": "23501-i80",
    "chunk_id": 1328,
    "text": "Onboarding the network should apply S-NSSAI and DNN in the Onboarding Configuration Data for the PDU Session Establishment request from the UE 53021044 User Plane Remote Provisioning of UEs when Onboarding Network is a PLMN Subscription data of such a UE shall contain the DNN and S-NSSAI used for onboarding The AMF selects an SMF used for User Plane Remote Provisioning using the SMF discovery and selection functionality as described in clause 632 considering the DNN and S-NSSAI used for onboarding provided by the UE or the default DNN and S-NSSAI provided by UDM The UPF selection function described in clause 633 is applied considering the DNN and S-NSSAI used for onboarding The SMF may be configured with one or more PVS FQDNs andor PVS IP addresses per DNN and S-NSSAI used for onboarding When the UE requests a PDU Session used for User Plane Remote Provisioning by using DNN and S-NSSAI used for onboarding the SMF sends the PVS FQDNs andor PVS IP addresses associated to the DNN and S-NSSAI of the PDU Session to the UE as part of Protocol Configuration Options PCO in the PDU Session Establishment Response if the following conditions are met - the UE subscription data contains the DNN and S-NSSAI used for onboarding and - the SMF has obtained the PVS FQDNs andor PVS IP addresses associated to the DNN and S-NSSAI of the PDU Session from local configuration and - the UE has requested PVS information via PCO in PDU Session Establishment Request NOTE 1 Local PCC or dynamic PCC can be used as described for PLMNs in TS 23503 45 and based on operator policy PDRs and FARs can be configured to restrict traffic other than provisioning traffic between PVSDNS servers and UEs NOTE 2 If the UE receives multiple PVS IP addresses andor PVS FQDNs how the UE uses this information is up to UE implementation 530211 UE Mobility support for SNPN If the UE moves its 3GPP access between SNPN and PLMN the network selection is performed as specified in TS 23122 17 and UE performs initial registration as specified in clause 42222 of TS 23502 3 NOTE 1 When the UE moves its 3GPP access between SNPN and PLMN it is up to UE implementation to activatedeactivate SNPN access mode If the UE moves its 3GPP access between SNPNs the network selection is performed as specified in TS 23122 17 then the UE performs initial or mobility registration as specified in clause 42222 of TS 23502 3 NOTE 2 When the UE moves its 3GPP access between SNPNs it is up to UE implementation whether and when to establish again PDU Sessions using existing mechanism If the UE and network supports equivalent SNPNs the AMF may provide list of equivalent SNPNs to the UE and NG-RAN The UE may move its 3GPP access to the SNPN in the list of equivalent SNPNs without performing network selection A UE supporting equivalent SNPNs gets a new registered SNPN ID during the Registration procedure if serving SNPN is changed 530212 Access to SNPN services via Untrusted non-3GPP access Access to SNPN services via Untrusted non-3GPP access network follows the specification in the previous 5302 clauses with the differences as specified in this clause N3IWF selection is supported as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1329",
    "document_id": "23501-i80",
    "chunk_id": 1329,
    "text": "When UE registers to SNPN with credentials owned by the SNPN UE uses the same N3IWF selection procedure as specified for access to stand-alone non-public network services via PLMN in clause 6362a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1330",
    "document_id": "23501-i80",
    "chunk_id": 1330,
    "text": "Emergency services are supported as follows - UE initiates N3IWF selection for emergency services when the UE detects a user request for emergency session and determines that Untrusted non-3GPP access is to be used for the emergency access The UE in SNPN access mode the following - If the UE determines that it is located in the same country as the configured N3IWF of the subscribed SNPN the UE uses the configured N3IWF FQDN for N3IWF selection - Otherwise the UE performs a DNS query using the Visited Country Emergency SNPN FQDN as specified in clause 2832263 of TS 23003 19 to determine which SNPNs in the visited country support emergency services in untrusted non-3GPP access via N3IWF and - If the DNS response contains one or more records the UE selects an SNPN that supports emergency services in untrusted non-3GPP access via N3IWF based on UE implementation specific methods Each record in the DNS response shall contain the identity of an SNPN ie SNPN ID in the visited country supporting emergency services in untrusted non-3GPP access via N3IWF NOTE 1 Self-assigned NIDs are not supported since a DNS cannot be properly configured for multiple SNPNs using the same self-assigned NID ie in collision scenarios - Once the UE has selected an SNPN the UE selects an N3IWF for Emergency for the selected SNPN as specified in TS 23003 19 When an N3IWF has been selected the UE initiates an Emergency Registration If the Emergency Registration fails the UE shall select another SNPN supporting emergency services in untrusted non-3GPP access If the DNS response of the Visited Country Emergency SNPN FQDN does not contain any record or if the DNS response contains one or more records but the UE fails to select an SNPN that supports emergency services in untrusted non-3GPP access or if the Emergency Registration procedure has failed for all SNPNs supporting emergency services in untrusted non-3GPP access the UE deactivates the SNPN access mode over NWu and attempts emergency services via PLMN untrusted non-3GPP access by following the N3IWF selection procedure as defined in clause 63642 NOTE 2 If the UE determines that it is located in a different country as the configured N3IWF of the subscribed SNPN the UE can deactivate the SNPN access mode over NWu and attempts emergency services via PLMN untrusted non-3GPP access by following the N3IWF selection procedure defined in clause 63642 without performing a DNS query using the Visited Country Emergency SNPN FQDN UE onboarding is supported as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1331",
    "document_id": "23501-i80",
    "chunk_id": 1331,
    "text": "When UE registers to SNPN over Untrusted non-3GPP access for UE Onboarding if the UE determines that it is located in the country where the configured N3IWF for onboarding is located the UE may select the N3IWF in the SNPN which supports UE Onboarding by using the configured N3IWF FQDN used for Onboarding - If the UE determines that it is located in a country different from the country where the configured N3IWF for onboarding is located called the visited country then in order to determine which SNPNs in the visited country support Untrusted non-3GPP access for UE Onboarding via N3IWF performs a DNS query using the Visited Country FQDN for SNPN N3IWF supporting Onboarding as specified in clause 2832262 of TS 23003 19 and - If no DNS response is received the UE shall stop the N3IWF selection - If the DNS response contains one or more records the UE selects an SNPN that supports Untrusted non-3GPP access for UE Onboarding via N3IWF Each record in the DNS response shall contain the identity of an SNPN in the visited country supporting Untrusted non-3GPP access for UE Onboarding via N3IWF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1332",
    "document_id": "23501-i80",
    "chunk_id": 1332,
    "text": "In this case - The UE shall select an SNPN based on its own implementation means If the UE cannot select any N3IWF included in the DNS response then the UE shall stop the N3IWF selection - If the DNS response contains no records then the UE determines that the visited country does not mandate the selection of an N3IWF that supports Untrusted non-3GPP access for UE Onboarding via N3IWF in this country In this case the UE uses the configured N3IWF for onboarding - If the UE has selected an SNPN for onboarding the UE constructs the Operator Identifier based Onboarding FQDN for SNPN N3IWF as specified in clause 2832272 of TS 23003 19 based on the SNPN ID of the selected SNPN and performs a DNS query -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1333",
    "document_id": "23501-i80",
    "chunk_id": 1333,
    "text": "The DNS response contains the identifier of the N3IWF supporting the onboarding in the SNPN identified by the SNPN ID - If the PVS is reachable from the local Untrusted non-3GPP access network eg via the Internet using the local IP connectivity UE may connect directly ie without being connected to an N3WIF with a PVS to obtain the SNPN credentials -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1334",
    "document_id": "23501-i80",
    "chunk_id": 1334,
    "text": "As part of UE registration via Untrusted non-3GPP access in Figure 41222-1 step 5 of TS 23502 3 the UE provides an onboarding indication inside the AN-Parameters 530213 Access to SNPN services via Trusted non-3GPP access Access to SNPN services via Trusted non-3GPP access network follows the specification in the previous subclauses of clause 5302 with the differences as specified in this clause To access SNPN services via a Trusted non-3GPP access network the UE follows the procedure for accessing a PLMN via a Trusted non-3GPP access network defined in clause 63122 with the following clarifications and additions - A non-3GPP access network may advertise eg with ANQP not only the PLMNs with which 5G connectivity is supported as specified in clause 63122 but also the SNPNs with which 5G connectivity is supported and the related parameters and indications defined in clause 53022 ie human-readable network names GINs indication whether access using credentials from a Credentials Holder is supported indication whether SNPN allows registration attempts from UEs that are not explicitly configured to select the SNPN etc -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1335",
    "document_id": "23501-i80",
    "chunk_id": 1335,
    "text": "The UE initiates the access network selection procedure specified in clause 63122 and constructs a list of available SNPNs This list contains the SNPNs advertised by all discovered non-3GPP access networks - The UE selects an SNPN that is included in the list of available SNPNs following the procedure in clause 53024 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1336",
    "document_id": "23501-i80",
    "chunk_id": 1336,
    "text": "The UE selects a non-3GPP access network that supports 5G connectivity to the selected SNPN and initiates the registration procedure via Trusted non-3GPP access specified in clause 412a22 of TS 23502 3 in order to register with the selected SNPN via the selected non-3GPP access network During the EAP authentication procedure the NAI provided by the UE indicates that 5G connectivity to a specific SNPN is required eg NAI usernamenai5gcnidNIDmncMNCmccMCC3gppnetworkorg NOTE In the case of SNPN ID with self-assigned NID if the UE when trying to register with an SNPN ID via TNAN X is rejected by the AMF with a cause code that temporarily prevents the UE from registering with this SNPN ID the UE does temporarily not attempt to register with the same SNPN ID even if the same SNPN ID is advertised via another TNAN - If there are multiple non-3GPP access networks that support 5G connectivity to the selected SNPN then the UE places these non-3GPP access networks in a prioritized list and selects the highest priority non-3GPP access network from this list To determine the priority of a non-3GPP access network the UE shall apply the WLANSP rules if provided and the procedure specified in clause 6613 of TS 23503 45 UE procedure for selecting a WLAN access based on WLANSP rules If the UE is not provided with WLANSP rules the UE determines the priority of a non-3GPP access network by using implementation means UE onboarding via Trusted non-3GPP access is supported as follows - The non-3GPP access network advertises eg via ANQP an Onboarding enabled indication as specified in clause 53021023 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1337",
    "document_id": "23501-i80",
    "chunk_id": 1337,
    "text": "The UE selects an SNPN advertising the Onboarding enabled indication following the network selection procedure specified in clause 53021025 - As part of UE registration via Trusted non-3GPP access in Figure 412a22-1 step 5 of TS 23502 3 the UE provides an onboarding indication inside the AN-Parameters 530214 Access to SNPN services via wireline access network Access to SNPN services via a wireline access network is specified in TS 23316 84 530215 Access to SNPN services for N5CW devices Devices that do not support 5GC NAS signalling over WLAN access referred to as Non-5G-Capable over WLAN devices or N5CW devices for short may access 5GC in an SNPN via a trusted WLAN access network that supports a TWIF function To access SNPN services the N5CW device performs the following procedure - A WLAN access network may advertise eg with ANQP not only the PLMNs with which 5G connectivity-without-NAS is supported as specified in clause 6312a1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1338",
    "document_id": "23501-i80",
    "chunk_id": 1338,
    "text": "but also the SNPNs with which 5G connectivity-without-NAS is supported as well as the related parameters and indications defined in clause 53022 ie human-readable network names GINs indication whether access using credentials from a Credentials Holder is supported indication whether SNPN allows registration attempts from UEs that are not explicitly configured to select the SNPN - The N5CW device initiates the access network selection procedure by sending an ANQP query to each discovered WLAN access network and constructs a list of available SNPNs with which 5G connectivity-without-NAS is supported This list contains the SNPNs with which 5G connectivity-without-NAS is supported as advertised by all the discovered WLAN access networks - The N5CW device selects an SNPN that is included in the list of available SNPNs with which 5G connectivity-without-NAS is supported following the procedure in clause 53024 - The N5CW device selects a WLAN access network eg an SSID that supports 5G connectivity-without-NAS to the selected SNPN and initiates the Initial Registration and PDU Session Establishment procedure specified in clause 412b2 of TS 23502 3 If there are multiple WLAN access networks that support 5G connectivity-without-NAS to the selected SNPN then the N5CW device selects the highest priority WLAN access network from this list To determine the priority of a WLAN access network the N5CW device shall apply the WLANSP rules if provided and the procedure specified in clause 6613 of TS 23503 45 UE procedure for selecting a WLAN access based on WLANSP rules If the N5CW device is not provided with WLANSP rules the N5CW device determines the priority of a WLAN access network by using implementation means NOTE How the N5CW device selects credentials to use for SNPN access is implementation specific 5303 Public Network Integrated NPN 53031 General Public Network Integrated NPNs are NPNs made available via PLMNs eg by means of dedicated DNNs or by one or more Network Slice instances allocated for the NPN The existing network slicing functionalities apply as described in clause 515 When a PNI-NPN is made available via a PLMN then the UE shall have a subscription for the PLMN in order to access PNI-NPN NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1339",
    "document_id": "23501-i80",
    "chunk_id": 1339,
    "text": "Annex D provides additional consideration to consider when supporting Non-Public Network as a Network Slice of a PLMN As network slicing does not enable the possibility to prevent UEs from trying to access the network in areas where the UE is not allowed to use the Network Slice allocated for the NPN Closed Access Groups may optionally be used to apply access control A Closed Access Group identifies a group of subscribers who are permitted to access one or more CAG cells associated to the CAG CAG is used for the PNI-NPNs to prevent UEs which are not allowed to access the NPN via the associated cells from automatically selecting and accessing the associated CAG cells NOTE 2 CAG is used for access control eg authorization at cell selection and configured in the subscription as part of the Mobility Restrictions ie independent from any S-NSSAI CAG is not used as input to AMF selection nor Network Slice selection If NPN isolation is desired operator can better support NPN isolation by deploying network slicing for PNI-NPN configuring dedicated S-NSSAIs for the given NPN as specified in Annex D clause D2 and restricting NPNs UE subscriptions to these dedicated S-NSSAIs The UE and PNI-NPN may support remote provisioning of credentials for NSSAA or credentials for secondary authenticationauthorization to the UE as specified in clause 539 NOTE 3 After successful provisioning of the credentials to the UE specific service subscription data eg to enable the use of PNI-NPN can be activated in the UE Subscription data in the UDRUDM This can result in a change of the UE Subscription Data to include new S-NSSAI DNN or CAG information which can trigger update of the UE configurations eg described in clause 515522 NOTE 4 The UE always has subscription to the HPLMN providing the PNI-NPN and has a USIM that contains primary authentication credentials Support for Proximity based Services ProSe as defined in TS 23304 128 in conjunction with CAG is not specified in this Release of the specification 53032 Identifiers",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1340",
    "document_id": "23501-i80",
    "chunk_id": 1340,
    "text": "The following is required for identification - A CAG is identified by a CAG Identifier which is unique within the scope of a PLMN ID - A CAG cell broadcasts one or multiple CAG Identifiers per PLMN NOTE 1 It is assumed that a cell supports broadcasting a total of twelve CAG Identifiers Further details are defined in TS 38331 28 - A CAG cell may in addition broadcast a human-readable network name per CAG Identifier NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1341",
    "document_id": "23501-i80",
    "chunk_id": 1341,
    "text": "The human-readable network name per CAG Identifier is only used for presentation to user when user requests a manual CAG selection 53033 UE configuration subscription aspects and storage To use CAG the UE that supports CAG as indicated as part of the UE 5GMM Core Network Capability may be pre-configured or reconfigured with the following CAG information included in the subscription as part of the Mobility Restrictions - an Allowed CAG list ie a list of CAG Identifiers the UE is allowed to access and - each entry of the Allowed CAG list may be associated with time validity information containing one or more time periods and - optionally a CAG-only indication whether the UE is only allowed to access 5GS via CAG cells see TS 38304 50 for how the UE identifies whether a cell is a CAG cell The HPLMN may configure or re-configure a UE with the above CAG information using the UE Configuration Update procedure for access and mobility management related parameters described in clause 4242 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1342",
    "document_id": "23501-i80",
    "chunk_id": 1342,
    "text": "The above CAG information is provided by the HPLMN on a per PLMN basis In a PLMN the UE shall only consider the CAG information provided for this PLMN The entries of the Allowed CAG list with time validity information are provided to the UE only if the UE indicates support of CAG with validity information NOTE 1 If the UE supports CAG but not CAG with validity information and there are entries of the Allowed CAG list that are associated with time validity information in the subscription data the CAG Identifier of the corresponding entry in subscription data can be provided to the UE without time validity information when the validity condition is evaluated as true and removed when the evaluation changes to false It is up to AMF local policy whether to provide such CAG Identifier to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1343",
    "document_id": "23501-i80",
    "chunk_id": 1343,
    "text": "In case the AMF does not support CAG with validity information eg in the case of roaming the UDM provides CAG information to the AMF without entries including time validity information When the subscribed CAG information changes UDM sets a CAG information Subscription Change Indication and sends it to the AMF The AMF shall provide the UE with the CAG information when the UDM indicates that the CAG information within the Access and Mobility Subscription data has been changed When AMF receives the indication from the UDM that the CAG information within the Access and Mobility Subscription has changed the AMF uses the CAG information received from the UDM to update the UE Once the AMF updates the UE and obtains an acknowledgment from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1344",
    "document_id": "23501-i80",
    "chunk_id": 1344,
    "text": "the AMF informs the UDM that the update was successful and the UDM clears the CAG information Subscription Change Indication flag The AMF may update the UE using either the UE Configuration Update procedure after registration procedure is completed or by including the new CAG information in the Registration Accept or in the Registration Reject or in the Deregistration Request or in the Service Reject When the UE is roaming and the Serving PLMN provides CAG information the UE shall update only the CAG information provided for the Serving PLMN while the stored CAG information for other PLMNs are not updated When the UE is not roaming and the HPLMN provides CAG information the UE shall update the CAG information stored in the UE with the received CAG information for all the PLMNs The UE shall store the latest available CAG information for every PLMN for which it is provided and keep it stored when the UE is de-registered or switched off as described in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1345",
    "document_id": "23501-i80",
    "chunk_id": 1345,
    "text": "The CAG information is only applicable with 5GS NOTE 2 CAG information has no implication on whether and how the UE accesses 5GS over non-3GPP access 53034 Network and cell re-selection and access control The following is assumed for network and cell selection and access control - The CAG cell shall broadcast information such that only UEs supporting CAG are accessing the cell see TS 38300 27 TS 38304 50 NOTE 1 The above also implies that cells are either CAG cells or normal PLMN cells For network sharing scenario between SNPN PNI-NPN and PLMNs please see clause 518 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1346",
    "document_id": "23501-i80",
    "chunk_id": 1346,
    "text": "In order to prevent access to NPNs for authorized UEs in the case of network congestionoverload existing mechanisms defined for Control Plane load control congestion and overload control in clause 519 can be used as well as the access control and barring functionality described in clause 525 or Unified Access Control using the access categories as defined in TS 24501 47 can be used - For aspects of automatic and manual network selection in relation to CAG see TS 23122 17 - For aspects related to cell re-selection see TS 38304 50 - If the UE is accessing a CAG cell and the corresponding entry of the Allowed CAG list configured on the UE is associated with time validity information the UE may trigger cell reselection andor network selection procedure if the evaluation of the time validity information changes - The Mobility Restrictions shall be able to restrict the UEs mobility according to the Allowed CAG list if configured in the subscription and include an indication whether the UE is only allowed to access 5GS via CAG cells if configured in the subscription as described in clause 53033 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1347",
    "document_id": "23501-i80",
    "chunk_id": 1347,
    "text": "The AMF shall update the Allowed CAG list in the Mobility Restrictions towards NG-RAN if the evaluation of the time validity information of an entry in the Allowed CAG list changes between true and false unless the AMF releases the NAS signalling connection to the UE based on operators policy if the evaluation of the validity condition changes from true to false - During transition from CM-IDLE to CM-CONNECTED and during Registration after connected mode mobility from E-UTRAN to NG-RAN as described in clause 411122 of TS 23502 3 - The AMF shall verify whether UE access is allowed by Mobility Restrictions NOTE 2 It is assumed that the AMF is made aware of the supported CAG Identifiers of the CAG cell by the NG-RAN - If the UE is accessing the 5GS via a CAG cell and if at least one of the CAG Identifiers received from the NG-RAN is part of the UEs Allowed CAG list for entries with time validity information if any the evaluation of the condition is true then the AMF accepts the NAS request - If the UE is accessing the 5GS via a CAG cell and if none of the CAG Identifiers received from the NG-RAN are part of the UEs Allowed CAG list for entries with time validity information if any the evaluation of the condition is true then the AMF rejects the NAS request and the AMF should include CAG information in the NAS reject message The AMF shall then release the NAS signalling connection for the UE by triggering the AN release procedure and - If the UE is accessing the 5GS via a non-CAG cell and the UEs subscription contains an indication that the UE is only allowed to access CAG cells then the AMF rejects the NAS request and the AMF should include CAG information in the NAS reject message The AMF shall then release the NAS signalling connection for the UE by triggering the AN release procedure -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1348",
    "document_id": "23501-i80",
    "chunk_id": 1348,
    "text": "During transition from RRC_INACTIVE to RRC_CONNECTED state - When the UE initiates the RRC Resume procedure for RRC_INACTIVE to RRC_CONNECTED state transition in a CAG cell NG-RAN shall reject the RRC Resume request from the UE if none of the CAG Identifiers supported by the CAG cell are part of the UEs Allowed CAG list according to the Mobility Restrictions received from the AMF or if no Allowed CAG list has been received from the AMF - When the UE initiates the RRC Resume procedure for RRC_INACTIVE to RRC_CONNECTED state transition in a non-CAG cell NG-RAN shall reject the UEs Resume request if the UE is only allowed to access CAG cells according to the Mobility Restrictions received from the AMF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1349",
    "document_id": "23501-i80",
    "chunk_id": 1349,
    "text": "During connected mode mobility procedures within NG-RAN ie handover procedures as described in clause 491 of TS 23502 3 - Source NG-RAN shall not handover the UE to a target NG-RAN node if the target is a CAG cell and none of the CAG Identifiers supported by the CAG cell are part of the UEs Allowed CAG list in the Mobility Restriction List or if no Allowed CAG list has been received from the AMF - Source NG-RAN shall not handover the UE to a non-CAG cell if the UE is only allowed to access CAG cells based on the Mobility Restriction List -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1350",
    "document_id": "23501-i80",
    "chunk_id": 1350,
    "text": "If the target cell is a CAG cell target NG-RAN shall reject the N2 based handover procedure if none of the CAG Identifiers supported by the CAG cell are part of the UEs Allowed CAG list in the Mobility Restriction List or if no Allowed CAG list has been received from the AMF - If the target cell is a non-CAG cell target NG-RAN shall reject the N2 based handover procedure if the UE is only allowed to access CAG cells based on the Mobility Restriction List - Update of Mobility Restrictions - When the AMF receives the Nudm_SDM_Notification from the UDM and the AMF determines that the Allowed CAG list or the indication whether the UE is only allowed to access CAG cells have changed - The AMF shall update the Mobility Restrictions in the UE and NG-RAN accordingly under the conditions as described in clause 4242 of TS 23502 3 NOTE 3 When the UE is accessing the network for emergency services the conditions for AMF in clause 51643 apply 53035 Support of emergency services in CAG cells Emergency Services are supported in CAG cells for UEs supporting CAG whether normally registered or emergency registered as described in clause 5164 and in clause 4134 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1351",
    "document_id": "23501-i80",
    "chunk_id": 1351,
    "text": "A UE may camp on an acceptable CAG cell in limited service state as specified in TS 23122 17 and TS 38304 50 based on operator policy defined in TS 38300 27 NOTE Support for Emergency services requires each cell with a Cell Identity associated with PLMNs or PNI-NPNs to only be connected to AMFs that supports emergency services The UE shall select a PLMN of a CAG cell or non-CAG cell as described in TS 23122 17 and TS 23167 18 when initiating emergency services from limited service state During handover to a CAG cell if the UE is not authorized to access the target CAG cell as described in clause 53034 and has emergency services the target NG-RAN node only accepts the emergency PDU Session and the target AMF releases the non-emergency PDU Sessions that were not accepted by the NG-RAN node Upon completion of handover the UE behave as emergency registered 531 Support for Cellular IoT 5311 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1352",
    "document_id": "23501-i80",
    "chunk_id": 1352,
    "text": "This clause provides an overview about 5GS optimisations and functionality for support of Cellular Internet-of-Things Cellular IoT or CIoT according to service requirements described in TS 22261 2 Cellular IoT is in earlier 3GPP releases also referred to as Machine Type Communication MTC see clause 4317 of TS 23401 26 The specific functionality is described in the affected procedures and features of this specification in TS 23502 3 TS 23503 45 and other specifications In this Release Control Plane CIoT 5GS Optimisations clause 5314 and User Plane CIoT 5GS Optimisations clause 53118 are only supported over E-UTRA and these CIoT 5GS optimisations are not supported over Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1353",
    "document_id": "23501-i80",
    "chunk_id": 1353,
    "text": "RAT type accesses CIoT functionality is provided by the visited and home networks when the networks are configured to support CIoT It applies to both the non-roaming case and the roaming case and some functionality may be dependent upon the existence of appropriate roaming agreements between the operators Some of the CIoT functions are controlled by subscriber data Other CIoT functions are based on indicators sent by the UE to the network CIoT functionality is performed by UEs that are configured to support different options as described in clause 5312 Though motivated by scenarios and use cases defined in TS 22261 2 the functions added to support CIoT have general applicability and are in no way constrained to any specific scenario use case or UE types except where explicitly stated In the context of CIoT the term AF denotes an SCSAS as defined TS 23682 36 5312 Preferred and Supported Network Behaviour At registration a UE includes its 5G Preferred Network Behaviour indicating the network behaviour the UE can support and what it would prefer to use NOTE If the UE supports S1-mode then the UE will indicate the supported EPS Network Behaviour Information in the S1 UE network capability IE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1354",
    "document_id": "23501-i80",
    "chunk_id": 1354,
    "text": "The 5G Preferred Network Behaviour signalled by the UE includes the following information in the 5GMM Capability IE - Whether Control Plane CIoT 5GS Optimisation is supported - Whether User Plane CIoT 5GS Optimisation is supported - Whether N3 data transfer is supported - Whether header compression for Control Plane CIoT 5GS Optimisation is supported And the following 5G Preferred Network Behaviour in other IEs - Whether Control Plane CIoT 5GS Optimisation or User Plane CIoT 5GS Optimisation is preferred If N3 data transfer is supported is indicated by the UE the UE supports data transfer that is not subject to CIoT 5GS Optimisations If the UE indicates support of User Plane CIoT 5GS Optimisation then it shall also indicate support of N3 data transfer The AMF indicates the network behaviour the network accepts in the 5G Supported Network Behaviour information This indication is per Registered Area The AMF may indicate one or more of the following -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1355",
    "document_id": "23501-i80",
    "chunk_id": 1355,
    "text": "Whether Control Plane CIoT 5GS Optimisation is supported - Whether User Plane CIoT 5GS Optimisation is supported - Whether N3 data transfer is supported - Whether header compression for Control Plane CIoT 5GS Optimisation is supported If the AMF indicates support of User Plane CIoT 5GS Optimisation then it shall also indicate support of N3 data transfer If the UE and AMF indicate support for User Plane CIoT 5GS Optimisation the AMF indicates support of User Plane CIoT 5GS Optimisation support for the UE to NG-RAN For NB-IoT UEs that only support Control Plane CIoT 5GS Optimisation the AMF shall include support for Control Plane CIoT 5GS Optimisation in the Registration Accept message A UE that supports the NB-IoT shall always indicate support for Control Plane CIoT 5GS Optimisation A UE that supports WB-E-UTRA shall always indicate support for N3 data transfer The 5G Preferred Network Behaviour indication from the UE may be used to influence policy decisions that can cause rerouting of the Registration Request from an AMF to another AMF 5313 Selection steering and redirection between EPS and 5GS The UE selects the core network type EPC or 5GC based on the broadcast indications for both EPC and 5GC and the UEs EPC and 5GC Preferred Network Behaviour Networks that support NB-IoT shall broadcast an indication whether N3 data transfer is supported or not in system information When the UE performs the registration procedure it includes its Preferred Network Behaviour for 5G and EPC in the Registration Request message and the AMF replies with the 5G Supported Network Behaviour in the Registration Accept message If the UE supports any of the CIoT 5GS Optimisations included in 5GC Preferred Network Behaviour then when the UE performs an Attach or TAU procedure and the UE includes its EPC Preferred Network Behaviour then the UE shall also include its 5GC Preferred Network Behaviour In networks that support CIoT features in both EPC and 5GC the operator may steer UEs from a specific CN type due to operator policy eg due to roaming agreements Preferred and Supported Network Behaviour load redistribution etc Operator policies in EPC and 5GC are assumed to avoid steering UEs back and forth between EPC and 5GC To redirect a UE from 5GC to EPC when the UE sends a Registration Request or Service Request the AMF sends a Registration Reject or Service Reject with an EMM cause value indicating that the UE should not use 5GC The UE disables N1 mode and re-enables S1 mode if it was disabled The UE then performs either an Attach or TAU in EPC as described in clause 5172 To redirect a UE from EPC to 5GC when the UE requests an Attach or TAU procedure or Service Reject the MME sends a reject message with an EMM cause indicating the UE should not use EPC The UE disables S1 mode and re-enables N1 mode if it was disabled The UE then registers with 5GC as described in clause 5172 When determining whether to redirect the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1356",
    "document_id": "23501-i80",
    "chunk_id": 1356,
    "text": "the AMFMME takes into account the UE support of S1N1 mode respectively and the UEs Preferred Network Behaviour and the Supported Network Behaviour of the network the UE is being redirected towards When determining to redirect the UE in 5GMM-CONNECTED mode to EPC the AMF shall initiate the UE Configuration Update procedure to indicate registration requested and release of the N1 NAS signalling connection not requested then the AMF redirects the UE to EPC by rejecting the subsequent Registration Request see TS 24501 47 If after redirection the UE cannot find a cell supporting connectivity the UE may re-enable the disabled N1S1 mode and then perform Registration Attach or TAU 5314 Control Plane CIoT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1357",
    "document_id": "23501-i80",
    "chunk_id": 1357,
    "text": "5GS Optimisation 53141 General The Control Plane CIoT 5GS Optimisation is used to exchange user data between the UE and the SMF as payload of a NAS message in both uplink and downlink directions avoiding the establishment of a user plane connection for the PDU Session The UE and the AMF perform integrity protection and ciphering for the user data by using NAS PDU integrity protection and ciphering For IP and Ethernet data the UE and the SMF may negotiate and perform header compression NOTE In the context of Control Plane CIoT 5GS Optimisation established or activated user plane resourcesconnection refers to radio user plane resourcesconnection ie Data Radio Bearer and N3 tunnel UE and AMF negotiate support and use of Control Plane CIoT 5GS Optimisation as defined in clause 5312 When the Control Plane CIoT 5GS Optimisation feature is used and the PDU Session Type is unstructured the SMF selects either NEF or UPF based on information in the UEs subscription If UE and network have negotiated support and use of Control Plane CIoT 5GS Optimisation then the following paragraphs of this clause apply During the PDU Session Establishment procedure the AMF indicates to the SMF that Control Plane CIoT 5GS Optimisation is available for data transmission During the PDU Session Establishment procedure the AMF also determines based on Preferred and Supported Network Behaviour see clause 5312 subscription data other already established PDU Sessions and local policy whether a new PDU Session shall only use the Control Plane CIoT 5GS Optimisation ie that a user-plane connection shall never be established for the new PDU Session If a PDU Session shall only use Control Plane CIoT 5GS Optimisation the AMF provides a Control Plane Only Indicator to the SMF during the PDU Session Establishment",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1358",
    "document_id": "23501-i80",
    "chunk_id": 1358,
    "text": "The SMF provides the Control Plane Only Indicator in the Session Management Request to the UE A UE and SMF receiving the Control Plane Only Indicator for a PDU Session shall always use the Control Plane CIoT 5GS Optimisation for this PDU Session The following rules apply for the use of the Control Plane Only Indicator during PDU Session Establishment - If N3 data transfer was not successfully negotiated all PDU Sessions shall include Control Plane Only Indicator - If N3 data transfer was successfully negotiated then - For a new PDU Session for a DNNS-NSSAI for which the subscription data for SMF Selection includes an Invoke NEF indication ie for a PDU Session which will be anchored in NEF the AMF shall always include the Control Plane Only Indicator -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1359",
    "document_id": "23501-i80",
    "chunk_id": 1359,
    "text": "For a new PDU Session for a DNNS-NSSAI for which the subscription data for SMF Selection does not include an Invoke NEF indication ie for a PDU Session which will be anchored in UPF and that supports interworking with EPS based on the subscription data defined in TS 23502 3 - for the first PDU Session the AMF determines based on local policy whether to include the Control Plane Only Indicator or not - if the AMF previously included a Control Plane Only Indicator for PDU Sessions that support interworking with EPS based on the subscription data defined in TS 23502 3 and that are anchored in UPF the AMF shall include it also for the new PDU Session - if the AMF previously did not include a Control Plane Only Indicator for any of the PDU Sessions that support interworking with EPS based on the subscription data defined in TS 23502 3 and that are anchored in UPF the AMF shall not include it for the new PDU Session -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1360",
    "document_id": "23501-i80",
    "chunk_id": 1360,
    "text": "For a new PDU Session for a DNNS-NSSAI for which the subscription data for SMF Selection does not include an Invoke NEF indication ie for a PDU Session which will be anchored in UPF and that does not support interworking with EPS based on the subscription data defined in TS 23502 3 AMF determines individually per PDU Session whether to include the Control Plane Only Indicator or not As described in clause 53142 if UE and AMF successfully negotiate N3 data transfer in addition to Control Plane CIoT 5GS Optimisation the UE or SMF may request to establish N3 data transfer for one or more PDU Sessions for which Control Plane Only Indicator was not received In CM-CONNECTED the UE and the network use N3 delivery for PDU Sessions for which user plane resources are established and uses NAS for data transmission for PDU Sessions for which user plane resources are not established If the AMF determines that Control Plane Only indication associated with PDU Session is not applicable any longer due to eg change of Preferred and Supported Network Behaviour subscription data and local policy the AMF should request the SMF to release the PDU Session as specified in clause 4342 or clause 4343 of TS 23502 3 Early Data Transmission may be initiated by the UE for mobile originated Control Plane CIoT 5GS Optimisation when the RAT Type is E-UTRA The QoS model as defined in clause 57 is not supported for PDU Sessions using Control Plane CIoT 5GS Optimisation as user plane resources are not established for those PDU Sessions 53142 Establishment of N3 data transfer during Data Transport in Control Plane CIoT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1361",
    "document_id": "23501-i80",
    "chunk_id": 1361,
    "text": "5GS Optimisation If UE and AMF have successfully negotiated N3 data transfer in addition to Control Plane CIoT 5GS Optimisation based on the Preferred and Supported Network Behaviour as defined in clause 5312 then the SMF may decide to establish N3 data transfer for any PDU session for which Control Plane Only Indicator was not included based on local SMF decision eg based on the amount of data transferred in UL or DL using Control Plane CIoT 5GS Optimisation In that case the SMF initiates the SMF-triggered N3 data transfer establishment procedure as described in clause 42102 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1362",
    "document_id": "23501-i80",
    "chunk_id": 1362,
    "text": "If UE and AMF successfully negotiate N3 data transfer in addition to Control Plane CIoT 5GS Optimisation based on the Preferred and Supported Network Behaviour as defined in clause 5312 then the UE may decide to establish N3 data transfer for any PDU session for which Control Plane Only Indicator was not included based on local decision eg based on the amount of data to be transferred In that case the UE performs the UE triggered N3 data transfer establishment procedure as described in clause 42101 of TS 23502 3 53143 Control Plane Relocation Indication procedure For intra-NB-IoT mobility when UE and AMF are using Control Plane CIoT 5GS Optimisation the CP Relocation Indication procedures may be used The purpose of the CP Relocation Indication procedure is to request the AMF to authenticate the UEs re-establishment request see TS 33501 29 and initiate the establishment of the UEs N2 connection after the UE has initiated an RRC Re-Establishment procedure in a new NG-RAN node see TS 38300 27 The RRC Re-Establishment procedure uses the Truncated 5G-S-TMSI as the UE identifier The NG-RAN is configured with the sizes of the components of the Truncated 5G-S-TMSI and it is configured with how to recreate the AMF Set ID the AMF Pointer and 5G-TMSI from the equivalent truncated parameters see TS 23003 19",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1363",
    "document_id": "23501-i80",
    "chunk_id": 1363,
    "text": "The AMF configures the UE with the Truncated 5G-S-TMSI Configuration that provides the sizes of the components of the Truncated 5G-S-TMSI as described in TS 24501 47 during the Registration The configuration of these parameters are specific to each PLMN NOTE Network sharing default configuration of the sizes of the truncated components is described in TS 23003 19 5315 Non-IP Data Delivery NIDD Functions for NIDD may be used to handle Mobile Originated MO and Mobile Terminated MT communication for unstructured data also referred to as Non-IP Such delivery to the AF is accomplished by one of the following two mechanisms - Delivery using the NIDD API - Delivery using UPF via a Point-to-Point PtP N6 tunnel NIDD is handled using an Unstructured PDU session to the NEF The UE may obtain an Unstructured PDU session to the NEF during the PDU Session Establishment procedure Whether or not the NIDD API shall be invoked for a PDU session is determined by the presence of a NEF Identity for NIDD for the DNNS-NSSAI combination in the subscription If the subscription includes a NEF Identity for NIDD corresponding with the DNN and S-NSSAI information then the SMF selects that NEF and uses the NIDD API for that PDU session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1364",
    "document_id": "23501-i80",
    "chunk_id": 1364,
    "text": "The NEF exposes the NIDD APIs described in TS 23502 3 on the N33Nnef reference point The NEF uses the provisioned policies to map an AF Identifier and UE Identity to a DNNS-NSSAI combination if the Reliable Data Service RDS is not enabled If RDS is enabled the NEF determines the association based on RDS port numbers and the provisioned policies that may be used to map AF Identifier and User identity to a DNN The NEF also supports distribution of Mobile Terminated messages to a group of UEs based on the NIDD API If an External Group Identifier is included in the MT NIDD request the NEF uses the UDM to resolve the External Group Identifier to a list of SUPIs and sends the message to each UE in the group with an established PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1365",
    "document_id": "23501-i80",
    "chunk_id": 1365,
    "text": "The Protocol Configuration Options PCO may be used to transfer NIDD parameters to and from the UE eg maximum packet size The PCO is sent in the 5GSM signalling between UE and SMF NIDD parameters are sent to and from the NEF via the N29 interface 5316 Reliable Data Service The Reliable Data Service RDS may be used between the UE and NEF or UPF when using a PDU Session of PDU Type Unstructured The service provides a mechanism for the NEF or UPF to determine if the data was successfully delivered to the UE and for the UE to determine if the data was successfully delivered to the NEF or UPF When a requested acknowledgement is not received the Reliable Data Service retransmits the packet The service is enabled or disabled based on DNN and NSSAI Configuration per SLA When the service is enabled a protocol is used between the end-points of the unstructured PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1366",
    "document_id": "23501-i80",
    "chunk_id": 1366,
    "text": "The protocol uses a packet header to identify if the packet requires no acknowledgement requires an acknowledgement or is an acknowledgment and to allow detection and elimination of duplicate PDUs at the receiving endpoint RDS supports both single and multiple applications within the UE Port Numbers in the header are used to identify the application on the originator and to identify the application on the receiver The UE NEF and the UPF may support reservation of the source and destination port numbers for their use and subsequent release of the reserved port numbers Reliable Data Service protocol as defined in TS 24250 80 also enables applications to query their peer entities to determine which port numbers are reserved and which are available for use at any given time The header is configured based on Reliable Data Service Configuration information which is obtained in the NIDD configuration MT NIDD and MO NIDD procedures with the AF as specified in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1367",
    "document_id": "23501-i80",
    "chunk_id": 1367,
    "text": "During NIDD Configuration the AF may indicate which serialization formats it supports for mobile originated and mobile terminated traffic in the Reliable Data Server Configuration When port numbers are reserved by the UE the serialization format that will be used by the application may be indicated to the NEF When port numbers are reserved by the NEF the serialization format that will be used by the application may be indicated to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1368",
    "document_id": "23501-i80",
    "chunk_id": 1368,
    "text": "If the receiver does not support the indicated serialization format it rejects the port number reservation request and the sender may re-attempt to reserve the port number with a different serialization format If during NIDD Configuration the AF indicated that it supports multiple serialization formats the NEF determines the serialization format that it will indicate to the UE based on local policies and previous negotiations with the UE eg the NEF may indicate the same serialization format that was indicated by the UE or avoid indicating a serialization format that was previously rejected by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1369",
    "document_id": "23501-i80",
    "chunk_id": 1369,
    "text": "When serialization formats are configured for reserved port numbers the NEF stores the serialization formats as part of the Reliable Data Service Configuration and provides the updated Reliable Data Service Configuration to the AF NOTE Whether the UE Application or AF supports a given serialization format is outside the scope of 3GPP specifications The UE indicates its capability of supporting RDS in the Protocol Configuration Options PCO and the SMF negotiates RDS support with the NEF or UPF If the NEF or UPF supports and accepts RDS then the SMF indicates to the UE in the PCO that the RDS shall be used if enabled in the DNN and NSSAI configuration In order to prevent situations where an RDS instance needs to interface to both the user and control plane RDS may only be used with PDU Sessions for which the Control Plane CIoT 5GS Optimisation indication is set or with PDU sessions using the Control Plane CIoT 5GS Optimisation when the AMF does not move the PDU session to the user plane Reliable Data Service protocol is defined in TS 24250 80 5317 Power Saving Enhancements 53171 General To enable UE power saving and to enhance MT reachability while using MICO mode eg for CIoT the following features are specified in the following clauses - Extended Discontinuous Reception DRX for CM-IDLE and CM-CONNECTED with RRC_INACTIVE - MICO mode with Extended Connected Time - MICO mode with Active Time - MICO mode and Periodic Registration Timer Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1370",
    "document_id": "23501-i80",
    "chunk_id": 1370,
    "text": "If a UE requests via NAS to enable both MICO mode with Active Time and extended idle mode DRX eg based on local configuration Expected UE Behaviour if available UE requested Active Time value UE subscription information and network policies etc the AMF may decide to enable MICO mode with or without Active Time extended idle mode DRX or both The functions and procedures to enable a UE using power saving functions to receive MBS service are defined in TS 23247 129 53172 Extended Discontinuous Reception DRX for CM-IDLE and CM-CONNECTED with RRC-INACTIVE 531721 Overview The UE and the network may negotiate over non-access stratum signalling the use of extended idle mode DRX for reducing its power consumption while being available for mobile terminating data andor network originated procedures within a certain delay dependent on the DRX cycle value Extended DRX in CM-IDLE is supported for E-UTRA and NR connected to 5GC Extended DRX in CM-CONNECTED with RRC_INACTIVE mode is supported for WB-E-UTRA LTE-M and NR connected to 5GC RRC_INACTIVE is not supported by NB-IoT connected to 5GC The negotiation of the eDRX parameters for NR WB-E-UTRA and LTE-M is supported over any RAT Applications that want to use extended idle mode DRX need to consider specific handling of mobile terminating services or data transfers and in particular they need to consider the delay tolerance of mobile terminated data A network side application may send mobile terminated data an SMS or a device trigger and needs to be aware that extended idle mode DRX may be in place A UE should request for extended idle mode DRX only when all expected mobile terminating communication is tolerant to delay NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1371",
    "document_id": "23501-i80",
    "chunk_id": 1371,
    "text": "The extended idle mode DRX cycle length requested by UE takes into account requirements of applications running on the UE Subscription based determination of eDRX cycle length can be used in those rare scenarios when applications on UE cannot be modified to request appropriate extended idle mode DRX cycle length The network accepting extended DRX while providing an extended idle mode DRX cycle length value longer than the one requested by the UE can adversely impact reachability requirements of applications running on the UE UE and NW negotiate the use of extended idle mode DRX as follows If the UE decides to request for extended idle mode DRX the UE includes an extended idle mode DRX parameters information element in the Registration Request message The UE may also include the UE specific DRX parameters information element for regular idle mode DRX according to clause 545",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1372",
    "document_id": "23501-i80",
    "chunk_id": 1372,
    "text": "The extended DRX parameters information element includes the extended idle mode DRX cycle length The AMF decides whether to accept or reject the UE request for enabling extended idle mode DRX If the AMF accepts the extended idle mode DRX the AMF based on operator policies and if available the extended idle mode DRX cycle length value in the subscription data from the UDM may also provide different values of the extended idle mode DRX parameters than what was requested by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1373",
    "document_id": "23501-i80",
    "chunk_id": 1373,
    "text": "The AMF taking into account the RAT specific Subscribed Paging Time Window the UEs current RAT and local policy also assigns a Paging Time Window length to be used and provides this value to the UE during Registration Update procedures together with the extended idle mode DRX cycle length in the extended DRX parameter information element If the AMF accepts the use of extended idle mode DRX the UE shall apply extended idle mode DRX based on the received extended idle mode DRX length the UEs current RAT NR NB-IoT WB-E-UTRA or LTE-M and RAT specific Paging Time Window length If the UE does not receive the extended DRX parameters information element in the relevant accept message because the AMF rejected its request or because the request was received by AMF not supporting extended idle mode DRX the UE shall apply its regular discontinuous reception as defined in clause 545 For NR Paging Time Window applies for extended DRX lengths greater than 1024s as defined in TS 38304 50",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1374",
    "document_id": "23501-i80",
    "chunk_id": 1374,
    "text": "For WB-E-UTRA Paging Time Window applies for extended DRX lengths of 1024s and greater as defined in TS 36304 52 When the UE is accessing NR if the AMF provides an extended idle mode DRX cycle length value of 1024s and the registration area of the UE contains only NR cells the AMF does not include a Paging Time Window If the AMF provides an extended idle mode DRX cycle length value of 1024s and the registration area of the UE contains E-UTRA cells and NR cells if the UE supports both E-UTRA and NR the AMF includes a Paging Time Window For WB-E-UTRA and LTE-M the eNB broadcasts an indicator for support of extended idle mode DRX in 5GC in addition to the existing indicator for support of extended idle mode DRX in EPC as defined in TS 36331 51 For NR the gNB broadcasts an indicator for support of extended idle mode DRX as defined in TS 38331 28",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1375",
    "document_id": "23501-i80",
    "chunk_id": 1375,
    "text": "This indicator is used by the UE in CM-IDLE state NOTE 2 A broadcast indicator for support of extended idle mode DRX is not needed for NB-IoT as it is always supported in NB-IoT The specific negotiation procedure handling is described in TS 23502 3 NOTE 3 If the Periodic Registration Update timer assigned to the UE is not longer than the extended idle mode DRX cycle the power savings are not maximised For RAT types that support extended DRX for CM-CONNECTED with RRC_INACTIVE state the AMF passes the UEs accepted idle mode eDRX values to NG-RAN If the UE supports eDRX in RRC_INACTIVE based on its UE radio capabilities NG-RAN configures the UE with an eDRX cycle in RRC_INACTIVE as specified in TS 38300 27 up to the value for the UEs idle mode eDRX cycle as provided by the AMF in RRC Inactive Assistance Information as defined in clause 53325",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1376",
    "document_id": "23501-i80",
    "chunk_id": 1376,
    "text": "If an eDRX cycle is applied in RRC_INACTIVE the RAN can buffer DL packets up to the duration of the eDRX cycle chosen by NG-RAN if the eDRX cycle does not last more than 1024 seconds If the CN based MT communication handling support indication is received in RRC Inactive Assistance Information the NG-RAN may select an eDRX cycle that lasts more than 1024s In this case based on implementation the NG-RAN may send an indication in N2 message that the UE is transitioning to RRC_INACTIVE state and the NG-RAN determined eDRX values ie the eDRX cycle length and the Paging Time Window length for RRC_INACTIVE to the AMF The CN takes the indication in the N2 message into account then handles mobile terminated MT communication as specified in clause 531724 and it can apply high latency communication as specified in clause 5318",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1377",
    "document_id": "23501-i80",
    "chunk_id": 1377,
    "text": "The AMF replies to NG-RAN that the indication in the N2 message has been taken into account and the MT signalling or data may be buffered by the Core Network based on high latency communication",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1378",
    "document_id": "23501-i80",
    "chunk_id": 1378,
    "text": "If and when the NG-RAN chooses to send the indication is up to NG-RAN implementation If the NG-RAN delays sending the indication and it receives a DL NAS message for the UE the NG-RAN proceeds as described in clause 4811a of TS 23502 3 NOTE 4 If the indication that the UE is transitioning to RRC_INACTIVE state is not sent or sent after UE has entered RRC_INACTIVE state by the NG-RAN then until CN receives it the CN cannot apply the high latency communication functionality other NFs will not be aware of the UE reachability certain high latency communication related services provided to the AF via NEF would not be available NAS message delivery might fail and downlink data in RAN might be lost NOTE 5 The CN based MT communication handling support indication in RRC Inactive Assistance Information is provided when all entities eg AMF SMF and UPF involved in the CN support corresponding functionalities including the support providing buffered downlink data size based on deployment and configuration When the UE has PDU Session associated with emergency services the UE and AMF follow regular discontinuous reception as defined in clause 545 and shall not use the extended idle mode DRX Extended idle mode DRX parameters may be negotiated while the UE has PDU Session associated with emergency services When the PDU Session associated with emergency services is released the UE and AMF shall reuse the negotiated extended idle mode DRX parameters in the last Registration Update procedure The UE shall include the extended DRX parameters information element in each Registration Request message if it still wants to use extended idle mode DRX At AMF to AMF AMF to MME and MME to AMF mobility the extended idle mode DRX parameters are not sent from the old CN node to the new CN node as part of the MM context information 531722 Paging for extended idle mode DRX in E-UTRA and NR connected to 5GC 5317220 General For WB-E-UTRA and LTE-M connected to 5GC the extended idle mode DRX value range will consist of values starting from 512s ie 512s 1024s 2048s etc up to a maximum of 262144s almost 44 min For NB-IoT the extended idle mode DRX value range will start from 2048s ie 2048s 4096s 8192 etc up to a maximum of 1048576s almost 3 hours see TS 36304 52",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1379",
    "document_id": "23501-i80",
    "chunk_id": 1379,
    "text": "For NR the extended idle mode DRX value range will consist of values starting from 256s ie 256s 512s 1024s 2048s etc up to a maximum of 1048576s almost 3 hours see TS 38304 50 The extended idle mode DRX cycle length is negotiated via NAS signalling The AMF includes the extended idle mode DRX cycle length for NR WB-E-UTRA LTE-M or NB-IoT in paging message to assist the NG-RAN node in paging the UE For NR Paging Time Window applies for extended DRX lengths longer than 1024s as defined in TS 38304 50 For WB-E-UTRA LTE-M and NB-IoT Paging Time Window applies for extended DRX lengths of 1024s and longer as defined in TS 36304 52",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1380",
    "document_id": "23501-i80",
    "chunk_id": 1380,
    "text": "The network follows the regular paging strategy as defined in clause 545 when the extended idle mode DRX cycle length is 512s or less for WB-E-UTRA LTE-M and NB-IoT or 1024s or less for NR Clauses 5317221 5317222 and 5317223 apply when the extended idle mode DRX cycle length is 1024s or longer for WB-E-UTRA LTE-M and NB-IoT or longer than 1024s for NR 5317221 Hyper SFN Paging Hyperframe and Paging Time Window length A Hyper-SFN H-SFN frame structure is defined on top of the SFN used for regular idle mode DRX Each H-SFN value corresponds to a cycle of the legacy SFN of 1024 radio frames ie 1024s When extended idle mode DRX is enabled for a UE the UE is reachable for paging in specific Paging Hyperframes PH which is a specific set of H-SFN values The PH computation is a formula that is function of the extended idle mode DRX cycle and a UE specific identifier as described in TS 36304 52 and TS 38304 50",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1381",
    "document_id": "23501-i80",
    "chunk_id": 1381,
    "text": "This value can be computed at all UEs and AMFs without need for signalling The AMF includes the extended idle mode DRX cycle length and the PTW length in paging message to assist the NG-RAN nodes in paging the UE The AMF also assigns a Paging Time Window length and provides this value to the UE during Registration Update procedures together with the extended idle mode DRX cycle length The UE first paging occasion is within the Paging Hyperframe as described in TS 36304 52 and TS 38304 50 The UE is assumed reachable for paging within the Paging Time Window The start and end of the Paging Time Window is described in TS 36304 52 and TS 38304 50 After the Paging Time Window length the AMF considers the UE unreachable for paging until the next Paging Hyperfame 5317222 Loose Hyper SFN synchronization NOTE This clause applies when the extended DRX cycle length is 1024s or longer for WB-E-UTRA LTE-M and NB-IoT and longer than 1024s for NR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1382",
    "document_id": "23501-i80",
    "chunk_id": 1382,
    "text": "In order for the UE to be paged at roughly similar time the H-SFN of all NG-RAN nodes and AMFs should be loosely synchronized Each NG-RAN node and AMF synchronizes internally the H-SFN counter so that the start of H-SFN0 coincides with the same a preconfigured time epoch If NG-RAN nodes and AMFs use different epochs eg due to the use of different time references the GPS time should be set as the baseline and the NG-RAN nodes and AMFs synchronize the H-SFN counter based on the GPS epoch considering the time offset between GPS epoch and other time-reference epoch a preconfigured time It is assumed that NG-RAN nodes and AMFs are able to use the same H-SFN value with accuracy in the order of legacy DRX cycle lengths eg 1 to 2 seconds There is no need for synchronization at SFN level There is no signalling between network nodes required to achieve this level of loose H-SFN synchronization 5317223 AMF paging and paging retransmission strategy NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1383",
    "document_id": "23501-i80",
    "chunk_id": 1383,
    "text": "This clause applies when the extended DRX cycle length is 1024s or longer for WB-E-UTRA LTE-M and NB-IoT and longer than 1024s for NR When the AMF receives trigger for paging and the UE is reachable for paging the AMF sends the paging request If the UE is not reachable for paging then the AMF pages the UE just before the next paging occasion The AMF determines the Paging Time Window length and a paging retransmission strategy and executes the retransmission scheme For extended DRX length of 1024s in the paging request message the AMF sends the Paging Time Window to the ng-eNB but does not send the Paging Time Window to the gNB 531723 Paging for a UE registered in a tracking area with heterogeneous support of extended idle mode DRX When the UE is registered in a registration area with heterogeneous support of extended idle mode DRX eg comprising WB-E-UTRA and NR cells and has negotiated eDRX the AMF shall for any paging procedure perform at least one paging attempt during a PTW NOTE Heterogeneous support of extended idle mode DRX in tracking areas assigned by AMF in a TAI list can result in significant battery life reduction in the UE as compared to homogeneous support by NG-RAN nodes of extended idle mode DRX 531724 Paging for extended DRX for RRC_INACTIVE in NR connected to 5GC For NR the NG-RAN may request the CN to handle mobile terminated MT communication for the UE configured with eDRX for RRC_INACTIVE state by means of the Connection Inactive procedure with CN based MT communication handling Procedure see clause 4811a of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1384",
    "document_id": "23501-i80",
    "chunk_id": 1384,
    "text": "This allows the CN to apply high latency communication functions as specified in clause 5318 The NG-RAN provides the determined eDRX values ie the eDRX cycle length and the Paging Time Window length for RRC_INACTIVE to AMF ie 1024s Based on the request from NG-RAN the AMF responds to NG-RAN and informs other NFs eg SMF and UPF involved in downlink data or signalling handling and trigger the data buffering as specified in clause 4811a of TS 23502 3 Based on local policy andor an indication from the AMF eg the RAT type of REDCAP or the CN based MT handling indication the SMF may trigger the UPF to provide the DL data size in case of DL data arrival when data buffering is executed in the UPF When MT data or signalling arrives for a UE in RRC_INACTIVE state the other NFs communicate with the AMF for delivery of MT data or signalling The AMF calculates the UE reachability based on the eDRX values for RRC_INACTIVE state provided by NG-RAN and triggers NG-RAN paging via an N2 RAN Paging Request message if the UE is considered reachable as specified in clause 4822b of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1385",
    "document_id": "23501-i80",
    "chunk_id": 1385,
    "text": "Otherwise the AMF stores the information received in the NF request and replies to the requesting NF to apply high latency communication functions as specified in clause 5318 based on eDRX values for RRC_INACTIVE eg an Estimated Maximum Wait Time is calculated based on eDRX values for RRC_INACTIVE When the AMF determines that the UE has become reachable for paging the AMF uses the stored information to send an N2 RAN Paging Request message If UPFSMF provides the downlink data size information the AMF provides the information to NG-RAN as described in clause 4822b of TS 23502 3 When the UE resumes the RRC connection as specified in TS 38300 27 eg including mobile originated small data transmission procedure if the NG-RAN had sent the indication for the CN to handle mobile terminated MT communication NG-RAN proceeds as specified in clause 4822 of TS 23502 3 which indicates to the AMF that the UE is now reachable for downlink data andor signalling The AMF then informs other NFs that the UE is now reachable using the high latency communication functions as specified in clause 5318 and MT data and signalling can be delivered to the UE 53173 MICO mode with Extended Connected Time When a UE using MICO mode initiates MO signalling or MO data and the AMF is aware of pending or expected MT traffic the AMF may keep the UE in CM-CONNECTED state and the RAN may keep the UE in RRC_CONNECTED state for an Extended Connected Time period in order to ensure the downlink data andor signalling is delivered to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1386",
    "document_id": "23501-i80",
    "chunk_id": 1386,
    "text": "The Extended Connected Time is determined by the AMF and is based on local configuration andor the Maximum Response Time if provided by the UDM The AMF maintains the N2 connection for at least the Extended Connected Time and provides the Extended Connected Time value to the RAN The Extended Connected Time value indicates the minimum time the RAN should keep the UE in RRC_CONNECTED state regardless of inactivity The Extended Connected Time value is provided to the RAN together with the - NAS Registration Accept message or - NAS Service Accept message At inter-RAN node handovers if some signalling or data are still pending the target AMF may send the Extended Connected Time value to the target RAN node 53174 MICO mode with Active Time During a Registration procedure the UE may optionally request an Active Time value from the AMF as part of MICO Mode negotiation In response if the AMF receives an Active Time value from the UE and determines that the MICO mode is allowed for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1387",
    "document_id": "23501-i80",
    "chunk_id": 1387,
    "text": "the AMF may assign an Active Time value for the UE eg based on local configuration Expected UE Behaviour if available UE requested Active Time value UE subscription information and network policies and indicates it to the UE during Registration procedure When an Active Time value is assigned to the UE the AMF shall consider the UE reachable for paging after the transition from CM-CONNECTED to CM-IDLE for the duration of the Active Time Together with the Active Time value the UE may request a periodic registration time value as specified in clause 531745 When the AMF indicates MICO mode with an Active Time to a UE the registration area may be constrained by paging area size To avoid paging in the entire PLMN when the AMF allocates the Active Time the AMF should not allocate all PLMN registration area to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1388",
    "document_id": "23501-i80",
    "chunk_id": 1388,
    "text": "The UE and AMF shall set a timer corresponding to the Active Time value negotiated during the most recent Registration procedure The UE and AMF shall start the timer upon entering CM-IDLE state from CM-CONNECTED When the timer expires ie reaches the Active Time the UE enters MICO mode and the AMF can deduce that the UE has entered MICO mode and is not available for paging If the UE enters CM-CONNECTED state before the timer expires the UE and AMF shall stop and reset the timer If no Active Time value was negotiated during the most recent Registration procedure the UE shall not start the timer and it shall instead enter MICO mode directly upon entering CM-IDLE state Active Time is not transferred between AMF and MME 53175 MICO mode and Periodic Registration Timer Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1389",
    "document_id": "23501-i80",
    "chunk_id": 1389,
    "text": "If the Expected UE Behaviour indicates the absence of DL communication the AMF may allow MICO mode for the UE and allocate a large periodic registration timer value based on eg Network Configuration parameters to the UE so that the UE can maximise power saving between Periodic Registration Updates If the Expected UE Behaviour indicates scheduled DL communication the AMF should allow MICO mode for the UE and allocate a periodic registration timer value such that the UE performs Periodic Registration Update to renegotiate MICO mode before or at the scheduled DL communication time if the AMF decides to allow MICO mode for the UE When UE requests the MICO mode with active time the UE may also request a periodic registration timer value suitable for the latencyresponsiveness of the DL communication service known to UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1390",
    "document_id": "23501-i80",
    "chunk_id": 1390,
    "text": "If the UE wants to change the periodic registration timer value eg when the conditions are changed in the UE the UE consequently requests the value it wants in the registration procedure The AMF takes the UE requested periodic registration time value into consideration when providing the periodic registration timer to UE during Registration procedure as specified in clause 42222 of TS 23502 3 If the UE supports Strictly Periodic Registration Timer Indication",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1391",
    "document_id": "23501-i80",
    "chunk_id": 1391,
    "text": "the UE indicates its capability of supporting Strictly Periodic Registration Timer Indication in the Registration Request message If the UE indicates its support of Strictly Periodic Registration Timer Indication in the Registration Request message the AMF may provide a Strictly Periodic Registration Timer Indication to the UE together with the periodic registration timer value eg based on Expected UE Behaviour If the indication is provided by the AMF the UE and the AMF shall start the periodic registration timer after completion of the Registration procedure The UE and the AMF shall neither stop nor restart the periodic registration timer when the UE enters CM-CONNECTED and shall keep it running while in CM-CONNECTED state and after returning to CM-IDLE state",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1392",
    "document_id": "23501-i80",
    "chunk_id": 1392,
    "text": "If and only when the timer expires and the UE is in CM-IDLE the UE shall perform a Periodic Registration Update If the timer expires and the UE is in CM-CONNECTED state the AMF and the UE restart the periodic registration timer while still applying Strictly Periodic Registration Timer Indication The AMF may use the UE Configuration Update procedure to trigger the UE to perform Registration procedure in which the periodic registration timer value and Strictly Periodic Registration Timer Indication can be renegotiated When the UE and the AMF locally disable MICO mode eg when an emergency service is initiated the UE and the AMF shall not apply Strictly Periodic Registration Timer Indication",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1393",
    "document_id": "23501-i80",
    "chunk_id": 1393,
    "text": "If the periodic registration timer is renegotiated during a Registration procedure eg triggered by UE Configuration Update and if the periodic registration timer is running then the periodic registration timer is stopped and restarted using the renegotiated value even when the Strictly Periodic Registration Timer Indication was provided to the UE 5318 High latency communication Functions for High latency communication may be used to handle mobile terminated MT communication with UEs being unreachable while using power saving functions as specified in clause 5317 or due to discontinuous coverage as described in clause 5413 High latency refers to the initial response time before normal exchange of packets is established That is the time it takes before a UE has woken up from its power saving state and responded to an initial downlink packet or signal When a NR RedCap UE requests to use the power saving functions as specified in clause 5317 then the AMF may based on local policy reroute the Registration Request to another AMF that supports High latency communication as specified in clause 635 High latency communication is supported by extended buffering of downlink data in the UPF SMF or NEF when a UE is using power saving functions in CM-IDLE state or in RRC_INACTIVE state or when the UE is using a satellite access with discontinuous coverage and the UE is not reachable For UPF anchored PDU sessions the SMF configures during AN release or when NG-RAN indicates via the AMF the UE is in extended DRX for RRC_INACTIVE the UPF with user data Forwarding Action Rule and user data Buffering Action Rule according to TS 29244 65",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1394",
    "document_id": "23501-i80",
    "chunk_id": 1394,
    "text": "The rules include instructions whether UPF buffering applies or the user data shall be forwarded to the SMF for buffering in the SMF For NEF anchored PDU sessions only extended buffering in the NEF is supported in this release of the specification During the Network Triggered Service Request procedure or Mobile Terminated Data Transport procedures when using Control Plane CIoT 5GS Optimisation the AMF provides an Estimated Maximum Wait Time to the SMF if the SMF indicates the support of extended buffering The SMF determines the Extended Buffering Time based on the received Estimated Maximum Wait Time or local configuration The handling is eg specified in the Network Triggered Service Request procedure clauses 4233 426 4242 and 4255 of TS 23502 3 High latency communication is also supported through notification procedures The following procedures are available based on different monitoring events - UE Reachability - Availability after DDN failure - Downlink Data Delivery Status An AF may request a one-time UE Reachability notification when it wants to send data to a UE which is using a power saving function see event subscription procedure in clause 41532 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1395",
    "document_id": "23501-i80",
    "chunk_id": 1395,
    "text": "The SCSASAF then waits with sending the data until it gets a notification that the UE is reachable see notification procedures in TS 23502 3 An AF may request repeated Availability after DDN failure notifications where each UE reachability notification is triggered by a preceding DDN failure ie the AF sends a downlink packet to request a UE reachability notification when the UE becomes reachable That downlink packet is discarded by the UPF or SMF or NEF see notification procedures in TS 23502 3 An AF may request repeated Downlink Data Delivery Status notifications when it wants indications that DL data has been buffered or when buffered DL data has been delivered to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1396",
    "document_id": "23501-i80",
    "chunk_id": 1396,
    "text": "If MICO mode or extended idle mode DRX is enabled Idle Status Indication allows the AF to determine when the UE transitions into idle mode When requesting to be informed of either UE Reachability or Availability after DDN failure notification the AF may also request Idle Status Indication If the UDM and the AMF support Idle Status Indication then when the UE for which MICO mode or extended idle mode DRX is enabled transitions into idle mode the AMF includes in the notification towards the NEF the time at which the UE transitioned into idle mode the active time and the periodic registration update timer granted to the UE by the AMF the eDRX cycle length and the Suggested number of downlink packets if a value was provided to the SMF An AF may provide parameters related to High latency communication for different methods to UDM via NEF as part of provisioning capability as specified in clause 520",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1397",
    "document_id": "23501-i80",
    "chunk_id": 1397,
    "text": "The UDM can further deliver the parameters to other NFs eg AMF or SMF as specified in clause 4156 of TS 23502 3 If the AMF is aware that some signalling or data is pending in the network for an UE that is known as being unreachable for a long duration eg for UEs having extended idle mode DRX extended DRX for RRC_INACTIVE or MICO enabled the AMF maintains the N2 connection for at least the Extended Connected Time and provides the Extended Connected Time value in a NG-AP message to the RAN The Extended Connected Time value indicates the minimum time the RAN should keep the UE in RRC_CONNECTED state regardless of inactivity At inter-RAN node handovers if some signalling or data are still pending the target AMF may send the Extended Connected Time value to the target RAN node 5319 Support for Monitoring Events The Monitoring Events feature is intended for monitoring of specific events in the 3GPP system and reporting such Monitoring Events via the NEF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1398",
    "document_id": "23501-i80",
    "chunk_id": 1398,
    "text": "The feature allows NFs in 5GS to be configured to detect specific events and report the events to the requested party Clause 520 further discusses the Monitoring capabilities of the NEF For CIoT the list of supported monitoring events is specified in Table 41531-1 of TS 23502 3 Support for Monitoring Events can be offered via AMF UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1399",
    "document_id": "23501-i80",
    "chunk_id": 1399,
    "text": "NSACF and SMF and can be reported via the NEF as specified in clause 4153 of TS 23502 3 53110 NB-IoT UE Radio Capability Handling NB-IoT Radio Capabilities are handled in the network independently from other RATs Radio Capabilities see clause 5441 53111 Inter-RAT idle mode mobility to and from NB-IoT Tracking Areas are configured so that they do not contain both NB-IoT and other RATs cells so when the UE is changing RAT type to or from NB-IoT while remaining registered with 5GC the UE will perform the Mobility Registration Update procedure see clause 5323 When the UE is changing RAT type to or from NB-IoT and moving between 5GC and EPC during the Registration Attach or TAU procedure the RAT type change is determined The specification in this clause does not apply to RAT type corresponding to Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1400",
    "document_id": "23501-i80",
    "chunk_id": 1400,
    "text": "Access type PDU session handling is controlled by PDU Session continuity at inter RAT mobility in the UEs subscription data which indicates per DNNS-NSSAI whether to - maintain the PDU session - disconnect the PDU session with a reactivation request - disconnect the PDU session without reactivation request or - leave it up to local VPLMN policy when the UE moves between a broadband RAT eg NR or WB-E-UTRA and a narrowband RAT NB-IoT During PDU session establishment the SMF retrieves the PDU Session continuity at inter RAT mobility subscription information if available from the UDM Local SMF configuration is used if PDU Session continuity at inter RAT mobility is not available for a PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1401",
    "document_id": "23501-i80",
    "chunk_id": 1401,
    "text": "The AMF informs the SMF at an inter-RAT idle mobility event eg to or from NB-IoT connected to 5GC about the RAT type change in the Nsmf_PDUSession_UpdateSMContext message during the Registration procedure Based on this H-SMF handles the PDU session according to PDU session continuity at inter RAT mobility information subscription data or based on local policy NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1402",
    "document_id": "23501-i80",
    "chunk_id": 1402,
    "text": "The PDU Session continuity at inter RAT mobility and PDN continuity at inter-RAT mobility subscription should be the same so that the PDU sessionsPDN connections are handled the same by both CN types During inter-RAT idle mode mobility to NB-IoT if a PDU session has more than one QoS rule the SMF shall initiate a PDU session modification procedure as described in TS 23502 3 to remove any non-default QoS rule and maintain only the default QoS rule 53112 Restriction of use of Enhanced Coverage Support of UEs in E-UTRA Enhanced Coverage is specified in TS 36300 30 The usage of Enhanced Coverage requires use of extensive resources eg radio and signalling resources Specific subscribers can be restricted to use the Enhanced Coverage feature through Enhanced Coverage Restricted information that is stored in the UDM as part of subscription data and specifies per PLMN whether the Enhanced Coverage functionality is restricted or not for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1403",
    "document_id": "23501-i80",
    "chunk_id": 1403,
    "text": "For eMTC the Enhanced Coverage Restricted information indicates whether CE mode B is restricted for the UE or both CE mode A and CE mode B are restricted for the UE or both CE mode A and CE mode B are not restricted for the UE For NB-IoT the NB-IoT Enhanced Coverage Restricted information indicates whether the Enhanced Coverage is restricted or not for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1404",
    "document_id": "23501-i80",
    "chunk_id": 1404,
    "text": "The AMF receives Enhanced Coverage Restricted information from the UDM during the Registration procedure If the UE includes the support for restriction of use of Enhanced Coverage in the Registration Request message the AMF based on local configuration UE Usage setting UE subscription information and network policies or any combination of them determines whether Enhanced Coverage is restricted for the UE and stores updated Enhanced Coverage Restriction information in the UE context in the AMF If the UE usage setting indicated that UE is voice centric then the AMF shall set CE mode B restricted for the UE in Enhanced Coverage Restriction information The AMF sends Enhanced Coverage Restricted information to the UE in the Registration Accept message The UE shall use the value of Enhanced Coverage Restricted information to determine if enhanced coverage feature is restricted or not The AMF provides an Enhanced Coverage Restricted information to the RAN via N2 signalling whenever the UE context is established in the RAN eg during N2 Paging procedure Service Request procedure Initial Registration and Periodic Registration procedure For roaming UEs if the UDM doesnt provide any Enhanced Coverage Restricted information or the provided Enhanced Coverage Restricted information is in conflict with the roaming agreement the AMF uses default Enhanced Coverage Restricted information locally configured in the VPLMN based on the roaming agreement with the subscribers HPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1405",
    "document_id": "23501-i80",
    "chunk_id": 1405,
    "text": "The UE indicates its capability of support for restriction of use of Enhanced Coverage to the AMF in the Registration procedure for the RAT it is camping on A UE that supports Enhanced Coverage shall also support restriction of the Enhanced Coverage",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1406",
    "document_id": "23501-i80",
    "chunk_id": 1406,
    "text": "The UE shall assume that restriction for use of Enhanced Coverage indicated by Enhanced Coverage Restricted information is the same in the equivalent PLMNs NB-IoT cells also broadcast the support of restriction of use of Enhanced Coverage as defined in TS 36331 51 If the UE supports CE mode B and use of CE mode B is not restricted according to the Enhanced Coverage Restriction information in the UE context in the AMF then the AMF shall use the extended NAS-MM timer setting for the UE as specified in TS 24501 47 and shall send the extended NAS-SM timer indication during PDU session establishment to the SMF If the UE supports CE mode B and use of CE mode B changes from restricted to unrestricted or vice versa in the Enhanced Coverage Restriction information in the UE context in the AMF eg due to a subscription change then - The AMF determines when to enforce the change of restriction of use of Enhanced Coverage - When the UE is in CM-CONNECTED mode the AMF can use the UE Configuration Update procedure as specified in step 3a of clause 4242 of TS 23502 3 to trigger a mobility registration update procedure in CM-CONNECTED mode for the AMF to inform the change of restriction of Enhanced Coverage towards the UE - If the UE has already established PDU sessions then the AMF shall trigger a PDU session modification to the SMFs serving the UEs PDU sessions to update the use of the extended NAS-SM timer setting as described in step 1f of clause 4332 of TS 23502 3 when the AMF determines that NAS-SM timer shall be updated due to the change of Enhanced Coverage Restriction - The UE and network applies the new Enhanced Coverage Restriction information after mobility registration procedure is completed Based on the extended NAS-SM timer indication the SMF shall use the extended NAS-SM timer setting for the UE as specified in TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1407",
    "document_id": "23501-i80",
    "chunk_id": 1407,
    "text": "The support for Enhanced Coverage Restriction Control via NEF enables AF to query status of Enhanced Coverage Restriction or enabledisable Enhanced Coverage Restriction per individual UEs The procedure for Enhanced Coverage Restriction Control via NEF is described in clause 427 of TS 23502 3 53113 Paging for Enhanced Coverage Support of UEs in E-UTRA Enhanced Coverage is specified in TS 36300 30 Whenever N2 is released and Paging Assistance Data for CE capable UE is available for the UE the NG-RAN sends it to the AMF as described in clause 426 of TS 23502 3 The AMF stores the received Paging Assistance Data for CE capable UE and then the AMF includes it in every subsequent Paging message for all NG-RAN nodes selected by the AMF for paging If Enhanced Coverage is restricted for the UE as described in clause 53112 the AMF sends the Enhanced Coverage Restriction parameter as defined in TS 38413 34 NOTE Only the NG-RAN node which cell ID is included in the Paging Assistance Data considers the assistance data 53114 Support of rate control of user data 531141 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1408",
    "document_id": "23501-i80",
    "chunk_id": 1408,
    "text": "The rate of user data sent to and from a UE eg a UE using CIoT 5GS Optimisations can be controlled in two different ways - Serving PLMN Rate Control - Small Data Rate Control Serving PLMN Rate Control is intended to allow the Serving PLMN to protect its AMF and the Signalling Radio Bearers in the NG-RAN from the load generated by NAS Data PDUs Small Data Rate Control is intended to allow HPLMN operators to offer customer services such as maximum of Y messages per day NOTE Existing Session-AMBR mechanisms are not suitable for such a service since for radio efficiency and UE battery life reasons an AMBR of eg 100kbits is desirable and such an AMBR translates to a potentially large daily data volume The SMF in the Serving PLMN may send the Small Data rate control parameter for an emergency PDU session 531142 Serving PLMN Rate Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1409",
    "document_id": "23501-i80",
    "chunk_id": 1409,
    "text": "The Serving PLMN Rate Control value is configured in the V-SMF NOTE 1 Homogeneous support of Serving PLMN Rate Control in a network is assumed At PDU Session establishment and PDU Session modification the V-SMF may inform the UE and UPFNEF of any per PDU Session local Serving PLMN Rate Control that the Serving PLMN intends to enforce for NAS Data PDUs The V-SMF shall only indicate a Serving PLMN Rate Control command to the UPF if the PDU Session is using N4 and is set to Control Plane only The V-SMF shall only indicate a Serving PLMN Rate Control command to the NEF if that PDN connection is using NEF Serving PLMN rate control is operator configurable and expressed as X NAS Data PDUs per deci hour where X is an integer that shall not be less than 10 There are separate limits for uplink and downlink NAS Data PDUs - The UE shall limit the rate at which it generates uplink NAS Data PDUs to comply with the Serving PLMN policy In the UE the indicated rate control applies only on the PDU Session where it was received and therefore the UE shall limit the rate of its uplink NAS Data PDUs to comply with the rate that is indicated for the PDU Session The indicated rate is valid until the PDU Session is released -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1410",
    "document_id": "23501-i80",
    "chunk_id": 1410,
    "text": "The UPFNEF shall limit the rate at which it generates downlink Data PDUs In the UPFNEF the indicated rate control applies only on the PDU Session where it was received and therefore the UPFNEF shall limit the rate of its downlink Data PDUs to comply with the rate that is indicated for the PDU Session - The V-SMF may enforce these limits per PDU Session by discarding or delaying packets that exceed these limits The Serving PLMN Rate does not include SMS using NAS Transport PDUs The V-SMF starts the Serving PLMN Rate Control when the first NAS Data PDU is received NOTE 2 If the UEUPFNEF start the Serving PLMN rate control at a different time than the V-SMF PDUs sent within the limit enforced at the UEUPFNEF can still exceed the limit enforced by the V-SMF NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1411",
    "document_id": "23501-i80",
    "chunk_id": 1411,
    "text": "It is assumed that the Serving PLMN Rate is sufficiently high to not interfere with the Small Data Rate Control as the Small Data Rate Control if used is assumed to allow fewer messages NAS PDUs related to exception reports are not subject to the Serving PLMN Rate Control 531143 Small Data Rate Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1412",
    "document_id": "23501-i80",
    "chunk_id": 1412,
    "text": "The H-SMF may consider eg based on operator policy subscription DNN S-NSSAI RAT type etc to determine whether to apply Small Data Rate Control or not The H-SMF can send a Small Data Uplink Rate Control command to the UE using the PCO information element The H-SMF informs the UPF or NEF of any Small Data Rate Control that shall be enforced The Small Data Rate Control applies to data PDUs sent on that PDU Session by either Data Radio Bearers or Signalling Radio Bearers NAS Data PDUs The rate control information is separate for uplink and downlink and in the form of - an integer number of packets per time unit and - an integer number of additional allowed exception report packets per time unit once the rate control limit has been reached The UE shall comply with this uplink rate control instruction If the UE exceeds the uplink number of packets per time unit the UE may still send uplink exception reports if allowed and the number of additional allowed exception reports per time unit has not been exceeded The UE shall consider this rate control instruction as valid until it receives a new one from H-SMF When a PDU Session is first established the H-SMF may provide the configured Small Data Rate Control parameters to the UE and UPF or NEF When the PDU Session is released the Small Data Rate Control Status including the number of packets still allowed in the given time unit the number of additional exception reports still allowed in the given time unit and the termination time of the current Small Data Rate Control validity period may be stored in the AMF so that it can be retrieved for a subsequent re-establishment of a new PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1413",
    "document_id": "23501-i80",
    "chunk_id": 1413,
    "text": "At subsequent establishment of a new PDU Session the H-SMF may receive the previously stored Small Data Rate Control Status and if the validity period has not expired it provides the parameters to the UE in the PCO and to the UPFNEF as the initially applied parameters in addition to the configured Small Data Rate Control parameters If the initially applied parameters are provided the UE and UPF or NEF shall apply them and shall use the SMF provided configured Small Data Rate Control parameters once the initially applied Small Data Rate Control validity period expires NOTE 1 Storage of Small Data Rate Control Status information for very long time intervals can be implementation specific For the UPF and NEF Small Data Rate Control is based on a maximum allowed rate per direction If H-SMF provided the number of additional allowed exception report packets per time unit then the maximum allowed rate is equal to the number of packets per time unit plus the number of additional allowed exception report packets per time unit otherwise the maximum allowed rate is equal to the number of packets per time unit The UPF or NEF may enforce the uplink rate by discarding or delaying packets that exceed the maximum allowed rate The UPF or NEF shall enforce the downlink rate by discarding or delaying packets that exceed the downlink part of the maximum allowed rate NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1414",
    "document_id": "23501-i80",
    "chunk_id": 1414,
    "text": "It is assumed that the Serving PLMN Rate is sufficiently high to not interfere with the Small Data Rate Control as the Small Data Rate Control if used is assumed to allow fewer messages NAS PDUs related to exception reports are not subject to the Serving PLMN Rate Control For NB-IoT the AMF maintains an MO Exception Data Counter which is incremented when the RRC establishment cause MO exception data is received from NG-RAN The AMF reports whether the UE accessed using MO exception data RRC establishment cause to all H-SMFs which have PDU Sessions that are subject to Small Data Rate Control and if the UE is accessing using MO exception data then the MO Exception Data Counter is also provided by the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1415",
    "document_id": "23501-i80",
    "chunk_id": 1415,
    "text": "The SMF indicates each use of the RRC establishment cause MO Exception Data by including the related counter on the charging information NOTE 3 Since Exception Data PDUs and normal priority PDUs cannot be distinguished within an RRC connection the AMF is only counting the number of RRC Connection establishments with MO Exception data priority If the UE moves to EPC then the UE and the PGW-UUPF store the current Small Data Rate Control Status for all PDU Sessions that are not released If the UE moves back to 5GC the stored Small Data Rate Control Status is restored and continues to apply to PDU Sessions that are moved from EPC to 5GC taking into account remaining validity period of the stored Small Data Rate Control Status When the UE moves to EPC the Small Data Rate Control Status for all PDU Sessions may also be stored in the AMF if the PDU Session is released while the UE is connected to EPC and re-established when the UE moves to 5GC The time to store the Small Data Rate Control Status information is implementation specific 53115 Control Plane Data Transfer Congestion Control NAS level congestion control may be applied in general for all NAS messages To enable congestion control for control plane data transfer a Control Plane data back-off timer is used see clause 51976 53116 Service Gap Control Service Gap Control is an optional feature intended for CIoT UEs to control the frequency at which these UEs can access the network That is to ensure a minimum time gap between consecutive Mobile Originated data communications initiated by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1416",
    "document_id": "23501-i80",
    "chunk_id": 1416,
    "text": "This helps reducing peak load situations when there are a large number of these UEs in an operator network Service Gap Control is intended to be used for small data allowance plans for MTCCIoT UEs where the applications are tolerant to service latency NOTE 1 Time critical applications such as regulatory prioritized services like Emergency services can suffer from the latency caused by the Service Gap Control feature Therefore Service Gap Control feature is not recommended for subscriptions with such applications and services Service Gap Time is a subscription parameter used to set the Service Gap timer and is enforced in the UE and in the AMF on a per UE level ie the same Service Gap Timer applies for all PDU Sessions that the UE has The UE indicates its capability of support for Service Gap Control in the Registration Request message to the AMF The AMF passes the Service Gap Time to the UE in the Registration Accept message for a UE that has indicated its support of the Service Gap Control The Service Gap Control shall be applied in a UE when a Service Gap Time is stored in the UE context and applied in the AMF when the Service Gap Time is stored in the UE Context in the AMF Service Gap Control requires the UE to stay in CM-IDLE mode for at least the whole duration of the Service Gap timer before triggering Mobile Originated user data transmission except for procedures that are exempted see TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1417",
    "document_id": "23501-i80",
    "chunk_id": 1417,
    "text": "The Service Gap timer shall be started each time a UE moves from CM-CONNECTED to CM-IDLE unless the connection request was initiated by the paging of a Mobile Terminated event or after a Mobility or Periodic Registration procedure without Follow-on Request indication and without Uplink data status which shall not trigger a new or extended Service Gap interval When a Service Gap timer expires the UE is allowed to send a connection request again If the UE does so the Service Gap timer will be restarted at the next CM-CONNECTED to CM-IDLE transition The Service Gap control is applied in CM-IDLE state only and does not impact UE Mobile Originated user data transmission or Mobile Originated signalling in CM-CONNECTED state The Service Gap timer is not stopped upon CM-IDLE state to CM-CONNECTED state transition The UE shall not initiate connection requests for MO user plane data MO control plane data or MO SMS when a Service Gap timer is running The UE shall not initiate PDU Session Establishment Requests when a Service Gap timer is running unless it is for Emergency services which are allowed CM-CONNECTED with RRC_INACTIVE is not used for UEs that have a Service Gap Time configured NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1418",
    "document_id": "23501-i80",
    "chunk_id": 1418,
    "text": "As a consequence of allowing Initial Registration Request procedure the UE with a running Service Gap timer does not initiate further MO signalling except for Mobility Registration procedure until the UE receives MT signalling or after the UE has moved to CM-IDLE state and the Service Gap Timer is not running NOTE 3 Implementations need to make sure that latest and up-to-date data are always sent when a Service Gap timer expires The AMF may enforce the Service Gap timer by rejecting connection requests for MO user plane data MO control plane data or MO SMS when a Service Gap timer is running The AMF may enforce the Service Gap timer by not allowing MO signalling after Initial Registration requests when a Service Gap timer is running except for Mobility Registration procedure Periodic Registration procedure or access to the network for regulatory prioritized services like Emergency services which are allowed When rejecting the connection requests and the SM signalling after Initial Registration Requests while the Service Gap timer is running the AMF may include a Mobility Management back-off timer corresponding to the time left of the current Service Gap timer For UEs that do not support Service Gap Control eg pre-release-16 UEs Service Gap Control may be enforced using General NAS level congestion control as defined in clause 51972 NOTE 4 After MT signalling in CM-CONNECTED state the AMF does not further restrict MO signalling when a Service Gap timer is running as this case is considered equal to a connectivity request in response to paging When the AMF starts the Service Gap timer the AMF should invoke the Service Gap timer with a value that is slightly shorter than the Service Gap Time value provided to the UE based on the subscription information received from the UDM NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1419",
    "document_id": "23501-i80",
    "chunk_id": 1419,
    "text": "This ensures that the AMF does not reject any UE requests just before the Service Gap timer expires eg because of slightly unsynchronized timers between UE and AMF A UE which transitions from a MICO mode or eDRX power saving state shall apply Service Gap Control when it wakes up if the Service Gap timer is still running Additional aspects of Service Gap Control - Service Gap Control applies in all PLMNs - When the Service Gap timer is running and the UE receives paging the UE shall respond as normal - Service Gap Control does not apply to exception reporting for NB-IoT - Access to the network for regulatory prioritized services like Emergency services are allowed when a Service Gap timer is running - Service Gap Control shall be effective also for UEs performing de-registration and re-registration unless access to the network for regulatory prioritized services like Emergency services is required - If the Service Gap timer is running the Service Gap is applied at PLMN selection as follows a Re-registration to the registered PLMN The remaining Service Gap timer value survives b Registration to a different PLMN The remaining Service Gap timer value survives c USIM swap",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1420",
    "document_id": "23501-i80",
    "chunk_id": 1420,
    "text": "The Service Gap timer is no longer running and the Service Gap feature does not apply unless re-instantiated by the serving PLMN - Multiple uplink packets and downlink packets are allowed during one RRC connection for UE operating within its Rate Control limits The following procedures are impacted by Service Gap Control - Registration Procedure see clause 4222 of TS 23502 3 - UE Triggered Service Request see clause 4232 of TS 23502 3 NOTE 6 Since UE triggered Service Request is prevented by Service Gap timer this implicitly prevents the UE from initiating UPF anchored Mobile Originated Data Transport in Control Plane CIoT 5GS Optimisation see clause 4241 of TS 23502 3 NEF Anchored Mobile Originated Data Transport see clause 4254 of TS 23502 3 and MO SMS over NAS in CM-IDLE see clause 41333 of TS 23502 3 53117 Inter-UE QoS for NB-IoT To allow NG-RAN to prioritise resource allocation between different UEs accessing via NB-IoT when some of the UEs are using Control Plane CIoT 5GS Optimisation NG-RAN may based on configuration retrieve from the AMF the subscribed NB-IoT UE Priority for any UE accessing via NB-IoT by using the UEs 5G-S-TMSI as the identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1421",
    "document_id": "23501-i80",
    "chunk_id": 1421,
    "text": "In order to reduce signalling load on the AMF NG-RAN may be configured to request the NB-IoT UE Priority from the AMF eg only when the NG-RANs NB-IoT load exceeds certain thresholds or when the NG-RAN needs to cache the QoS profile 53118 User Plane CIoT 5GS Optimisation User Plane CIoT 5GS Optimisation enables transfer of user plane data from CM-IDLE without the need for using the Service Request procedure to establish Access Stratum AS context in NG-RAN and UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1422",
    "document_id": "23501-i80",
    "chunk_id": 1422,
    "text": "If the following preconditions are met - UE and AMF negotiated support User Plane CIoT 5GS Optimisation see clause 5312 over NAS - the UE has indicated support of User Plane CIoT 5GS Optimisation in the UE radio capabilities as defined in TS 36331 51 - AMF has indicated User Plane CIoT 5GS Optimisation support for the UE to NG-RAN - the UE has established at least one PDU session with active UP connection ie AS context is established in NG-RAN and the UE then the RRC connection can be suspended by means of the Connection Suspend Procedure see clause 4812 of TS 23502 3 Based on a trigger from the NAS layer when a UE is in CM-IDLE with Suspend the UE should attempt the Connection Resume in CM-IDLE with Suspend procedure clause 4823 of TS 23502 3 If the Connection Resume in CM-IDLE with Suspend procedure fails the UE initiates the pending NAS procedure To maintain support for User Plane CIoT 5GS Optimisation for UE mobility across different NG-RAN nodes the AS Context should be transferred between the NG-RAN nodes see TS 38300 27 and TS 38423 99",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1423",
    "document_id": "23501-i80",
    "chunk_id": 1423,
    "text": "For MT data or signalling when the UE is in CM-IDLE with Suspend Network Triggered Service Request procedure clause 4233 of TS 23502 3 applies By using the Connection Suspend Procedure - the UE at transition into CM-IDLE stores the AS information - NG-RAN stores the AS information the NGAP UE association and the PDU session context for that UE - AMF stores the NGAP UE association and other information necessary to later resume the UE interacts with the SMFs to deactivate the user plane resources for the UEs PDU Sessions and enters CM-IDLE NG-RAN may decide based on implementation to delete the stored UE context and NGAP association",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1424",
    "document_id": "23501-i80",
    "chunk_id": 1424,
    "text": "In that case the RAN shall initiate the AN Release procedure as described in clause 426 of TS 23502 3 NG-RAN does not initiate any RRC procedure to notify the UE of the UE context release By using the Connection Resume in CM-IDLE with Suspend procedure - the UE resumes the connection from CM-IDLE with the network using the AS information stored during the Connection Suspend procedure - NG-RAN notifies the AMF that the connection with the UE has been resumed - AMF enters CM-CONNECTED and interacts with the SMF to activate the user plane resources for the UEs PDU Sessions Early Data Transmission may be initiated by the UE for mobile originated User Plane CIoT 5GS Optimisation during Connection Resume If the AMF establishes an NGAP UE association with a new NG-RAN node different from the stored NGAP UE association eg the UE initiates service request or registration procedure from a different NG-RAN node the AMF initiates UE N2 release command towards the old NG-RAN node NG-RAN maintains the N3 tunnel endpoint information while a UE is in CM-IDLE with Suspend UPF is instructed to remove DL N3 Tunnel Info of AN during Connection Suspend procedure while UPF keeps UL N3 Tunnel Info ie UPF accepts and forwards UL data If a UE sends MO data with resume procedure the NG-RAN can send the MO data to the UPF which is addressed by the N3 tunnel endpoint information In the case of change of serving NG-RAN node due to UE mobility if NG-RAN determines that it is not able to connect to the UPF which is addressed by the N3 tunnel endpoint information NG-RAN performs Path Switch procedure before sending the MO data received from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1425",
    "document_id": "23501-i80",
    "chunk_id": 1425,
    "text": "Early Data Transmission may be initiated by the UE for mobile originated User Plane CIoT 5GS Optimisation when the RAT Type is E-UTRA 53119 QoS model for NB-IoT 5GC QoS model described in clause 57 applies to NB-IoT with the following requirements - The default QoS rule shall be the only QoS rule of a PDU Session for a UE connected to 5GC via NB-IoT There is only one QoS Flow corresponding to the default QoS rule per PDU session - Reflective QoS is not supported over NB-IoT - For NB-IoT there is a 11 mapping between the QoS Flow corresponding to the default QoS of a PDU session and a Data Radio Bearer when user plane resources are active for that PDU session - A maximum of two Data Radio Bearers are supported over NB-IoT Therefore at most two PDU sessions can have active user plane resources at the same time - The capability of multiple UP resource support for NB-IoT UEs is indicated in the UE 5GMM Core Network Capability see TS 24501 47",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1426",
    "document_id": "23501-i80",
    "chunk_id": 1426,
    "text": "During PDU Session Establishment or UP resource activation the AMF checks if the UE can support the establishment of user plane resources See clause 4232 and clause 43221 of TS 23502 3 53120 Category M UEs differentiation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1427",
    "document_id": "23501-i80",
    "chunk_id": 1427,
    "text": "This functionality is used by the network to identify traffic tofrom Category M UEs eg for charging differentiation A Category M UE using E-UTRA shall provide a Category M indication to the NG-RAN during RRC Connection Establishment procedure as defined in TS 36331 51 When the UE has provided a Category M indication to the NG-RAN during RRC Connection Establishment the NG-RAN shall provide an LTE-M Indication to the AMF in the Initial UE Message see clause 42221 of TS 23502 3 and TS 38413 34 When the AMF receives an LTE-M Indication from NG-RAN in an Initial UE Message or from an MME during EPS to 5GS handover the AMF shall store the LTE-M Indication in the UE context consider that the RAT type is LTE-M and signal it accordingly to the SMSF during registration procedure for SMS over NAS to the SMF during PDU Session Establishment or PDU Session Modification procedure The PCF can also receive the RAT Type as LTE-M when applicable from the AMF using the PCRT on Access Type change specified in clause 6125 of TS 23503 45 during AM Policy Association Establishment or AM Policy Association Modification procedure and from the SMF using the PCRT on Access Type change specified in clause 6135 of TS 23503 45 during SM Policy Association Establishment or SM Policy Association Modification procedure The NFs generating CDRs shall include the LTE-M RAT type in their CDRs Upon AMF change or inter-system mobility from 5GS to EPS the source AMF shall provide the LTE-M Indication to the target AMF or MME as part of the UE context During EPS to 5GS Mobility Registration Procedure the AMF shall disregard any LTE-M Indication received from the MME in the UE context see TS 23401 26 and take into account the LTE-M Indication received from NG-RAN as specified above 532 Support for ATSSS 5321 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1428",
    "document_id": "23501-i80",
    "chunk_id": 1428,
    "text": "The ATSSS feature is an optional feature that may be supported by the UE and the 5GC network The ATSSS feature enables a multi-access PDU Connectivity Service which can exchange PDUs between the UE and a data network by simultaneously using one 3GPP access network and one non-3GPP access network and two independent N3N9 tunnels between the PSA and RANAN The multi-access PDU Connectivity Service is realized by establishing a Multi-Access PDU MA PDU Session ie a PDU Session that may have user-plane resources on two access networks This assumes both 3GPP access and non-3GPP access are allowed for the S-NSSAI of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1429",
    "document_id": "23501-i80",
    "chunk_id": 1429,
    "text": "The UE may request a MA PDU Session when the UE is registered via both 3GPP and non-3GPP accesses or when the UE is registered via one access only After the establishment of a MA PDU Session and when there are user-plane resources on both access networks the UE applies network-provided policy ie ATSSS rules and considers local conditions such as network interface availability signal loss conditions user preferences etc for deciding how to distribute the uplink traffic across the two access networks Similarly the UPF anchor of the MA PDU Session applies network-provided policy ie N4 rules and feedback information received from the UE via the user-plane such as access network Unavailability or Availability for deciding how to distribute the downlink traffic across the two N3N9 tunnels and the two access networks When there are user-plane resources on only one access network the UE applies the ATSSS rules and considers local conditions for triggering the establishment or activation of the user plane resources over another access The type of a MA PDU Session may be one of the following types defined in clause 561 IPv4 IPv6 IPv4v6 and Ethernet In this release of the specification the Unstructured type is not supported The clause 532621 the clause 532622 and the clause 532631 below define what Steering Functionalities can be used for each supported type of a MA PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1430",
    "document_id": "23501-i80",
    "chunk_id": 1430,
    "text": "The handling of 3GPP PS Data Off feature for MA PDU Session is specified in clause 524 The ATSSS feature can be supported over any type of access network including untrusted and trusted non-3GPP access networks see clauses 428 and 55 wireline 5G access networks see clause 428 etc as long as a MA PDU Session can be established over this type of access network In this Release of the specification a MA PDU Session using IPv6 multi-homing see clause 5643 or UL Classifier see clause 5642 is not specified In this Release of the specification support for ATSSS assumes SMF Service Areas covering the whole PLMN or that a MA PDU Session is released over both accesses when the UE moves out of the SMF Service Area A MA PDU Session does not support LADN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1431",
    "document_id": "23501-i80",
    "chunk_id": 1431,
    "text": "If the AMF receives a request to establish a MA PDU Session for a LADN DNN the AMF shall reject the request If the AMF receives a request to establish a PDU Session for a LADN DNN with MA PDU Network-Upgrade Allowed indication the AMF shall not forward MA PDU Network-Upgrade",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1432",
    "document_id": "23501-i80",
    "chunk_id": 1432,
    "text": "Allowed indication to the SMF If the UE due to mobility moves from being served by a source AMF supporting ATSSS to a target AMF not supporting ATSSS the MA PDU Session is released as described in TS 23502 3 NOTE 1 Deployment of ATSSS that is homogeneous per PLMN or network slice enables consistent behaviour In the case of non-homogenous support of ATSSS in a PLMNslice ie some NFs in a PLMNslice may not support ATSSS MA PDU Sessions can be released due to UE mobility A Multi-Access PDU Session may for the 3GPP access andor non-3GPP access use user-plane resources of an associated PDN Connection in EPC eg one 3GPP access path via EPC and one non-3GPP access path via 5GC or one 3GPP access path via 5GC and one non-3GPP access path via ePDGEPC Such use of ATSSS with EPS interworking may apply to Ethernet and IP-based PDU Session and PDN Connection types NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1433",
    "document_id": "23501-i80",
    "chunk_id": 1433,
    "text": "Co-existence with NBIFOM is not defined It is assumed that NBIFOM and the multi-access connectivity described in this clause are not deployed in the same network NOTE 3 To the MME and SGW this is a regular PDN Connection and the support for ATSSS is transparent to MME and SGW For a MA PDU Session established for the Ethernet PDU Session type if the UE has not indicated support for Ethernet PDN connection type or if the network does not support Ethernet PDN connection type when the 3GPP access use user-plane resources of an associated PDN Connection the following takes place - The SMFPGW-C considers that the Multi-Access PDU Session is still using the Ethernet PDU Session PDN Connection type but in a restricted mode where EPS signalling can only refer to non-IP PDN Connection type - MAR rules in the UPF are still used for distributing DL traffic between 3GPP access and non-3GPP access -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1434",
    "document_id": "23501-i80",
    "chunk_id": 1434,
    "text": "For traffic on 3GPP access the SMF may update N4 rules and QoS rulesEPS bearer contexts on the UE to take into account that no QoS differentiation is possible over 3GPP access Support of Multi-Access PDU Sessions using one leg associated with PDN Connection in EPC and one leg associated with PDU Session in 5GC is further defined in TS 23502 3 The following clauses specify the functionality that enables ATSSS 5322 Multi Access PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1435",
    "document_id": "23501-i80",
    "chunk_id": 1435,
    "text": "A Multi-Access PDU MA PDU Session is managed by using the session management functionality specified in clause 56 with the following additions and modifications - When the UE wants to request a new MA PDU Session - If the UE is registered to the same PLMN over 3GPP and non-3GPP accesses then the UE shall send a PDU Session Establishment Request over any of the two accesses The UE also provides Request Type as MA PDU Request in the UL NAS Transport message The AMF informs the SMF that the UE is registered over both accesses and this triggers the establishment of user-plane resources on both accesses and two N3N9 tunnels between PSA and the RANAN - If the UE is registered to different PLMNs over 3GPP and non-3GPP accesses then the UE shall send a PDU Session Establishment Request over one access The UE also provides Request Type as MA PDU Request in the UL NAS Transport message After this PDU Session is established with one N3N9 tunnel between the PSA and RAN established the UE shall send another PDU Session Establishment Request over the other access The UE also provides the same PDU Session ID and Request Type as MA PDU Request in the UL NAS Transport message Two N3N9 tunnels and User-plane resources on both accesses are established - If the UE is registered over one access only then the UE shall send a PDU Session Establishment Request over this access The UE also provides Request Type as MA PDU Request in the UL NAS Transport message One N3N9 tunnel between the PSA and RAN and User-plane resources on this access only are established After the UE is registered over the second access the UE shall establish user-plane resources on the second access -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1436",
    "document_id": "23501-i80",
    "chunk_id": 1436,
    "text": "In the PDU Session Establishment Request that is sent to request a new MA PDU Session the UE shall provide also its ATSSS capabilities which indicate the steering functionalities and the steering modes supported in the UE These functionalities are defined in clause 5326 - If the UE indicates it is capable of supporting - the ATSSS-LL functionality with any steering mode as specified in clause 53261 and the network accepts to activate this functionality then the network may provide to UE Measurement Assistance Information see details in clause 5325 and shall provide to UE one or more ATSSS rules NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1437",
    "document_id": "23501-i80",
    "chunk_id": 1437,
    "text": "As specified in Table 5328-1 and in Table 5858-1 the ATSSS-LL functionality cannot be used together with the Redundant steering mode When the UE indicates it is capable of supporting the ATSSS-LL functionality with any steering mode it is implied that the UE can support the ATSSS-LL functionality with any steering mode except the Redundant steering mode - If the UE indicates it is capable of supporting - the MPTCP functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 or - the MPTCP functionality with any steering mode and the ATSSS-LL functionality with any steering mode as specified in clause 53261 and the network accepts to activate these functionalities then the network provides MPTCP proxy information to UE and allocates to UE a one IP addressprefix for the MA PDU session as defined in clause 5822 and b two additional IP addressesprefixes called MPTCP link-specific multipath addresses Further details are provided in clause 532621",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1438",
    "document_id": "23501-i80",
    "chunk_id": 1438,
    "text": "In addition the network may provide to UE Measurement Assistance Information and shall provide to UE one or more ATSSS rules If the UE supports the ATSSS-LL functionality with only the Active-Standby steering mode the network shall provide to UE an ATSSS rule for non-MPTCP traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1439",
    "document_id": "23501-i80",
    "chunk_id": 1439,
    "text": "The ATSSS rule for non-MPTCP traffic shall use the ATSSS-LL functionality and the Active-Standby Steering Mode to indicate how the non-MPTCP traffic shall be transferred across the 3GPP access and the non-3GPP access in the uplink direction - If the UE indicates it is capable of supporting - the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 or - the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with any steering mode as specified in clause 53261 and the network accepts to activate these functionalities then the network provides MPQUIC proxy information to UE and allocates to UE a one IP addressprefix for the MA PDU session as defined in clause 5822 and b two additional IP addressesprefixes called MPQUIC link-specific multipath addresses Further details are provided in clause 532622",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1440",
    "document_id": "23501-i80",
    "chunk_id": 1440,
    "text": "In addition the network may provide to UE Measurement Assistance Information and shall provide to UE one or more ATSSS rules If the UE supports the ATSSS-LL functionality with only the Active-Standby steering mode the network shall provide to UE an ATSSS rule for non-MPQUIC traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1441",
    "document_id": "23501-i80",
    "chunk_id": 1441,
    "text": "The ATSSS rule for non-MPQUIC traffic shall use the ATSSS-LL functionality and the Active-Standby Steering Mode to indicate how the non-MPQUIC traffic shall be transferred across the 3GPP access and the non-3GPP access in the uplink direction - If the UE indicates it is capable of supporting - the MPTCP functionality with any steering mode and the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 or - the MPTCP functionality with any steering mode and the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with any steering mode as specified in clause 53261 and the network accepts to activate these functionalities then the network provides MPTCP proxy information and MPQUIC proxy information to UE and allocates to UE a one IP addressprefix for the MA PDU session as defined in clause 5822 b two additional IP addressesprefixes called MPTCP link-specific multipath addresses and c two additional IP addressesprefixes called MPQUIC link-specific multipath addresses Further details are provided in clause 532621 and in clause 532622",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1442",
    "document_id": "23501-i80",
    "chunk_id": 1442,
    "text": "In addition the network may provide to UE Measurement Assistance Information and shall provide to UE one or more ATSSS rules If the UE supports the ATSSS-LL functionality with only the Active-Standby steering mode the network shall provide to UE an ATSSS rule for non-MPTCP and non-MPQUIC traffic ie the traffic for which neither the MPTCP nor the MPQUIC functionalities are applied The ATSSS rule for non-MPTCP and non-MPQUIC traffic shall use the ATSSS-LL functionality and the Active-Standby Steering Mode to indicate how the non-MPTCP and non-MPQUIC traffic shall be transferred across the 3GPP access and the non-3GPP access in the uplink direction NOTE 2 The MPTCP link-specific multipath addresses and the MPQUIC link-specific multipath addresses can be the same - If the UE requests an S-NSSAI this S-NSSAI should be allowed on both accesses Otherwise the MA PDU Session shall not be established -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1443",
    "document_id": "23501-i80",
    "chunk_id": 1443,
    "text": "The SMF determines the ATSSS capabilities supported for the MA PDU Session based on the ATSSS capabilities provided by the UE and per DNN configuration on SMF as follows a If the UE includes in its ATSSS capabilities MPTCP functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode as specified in clause 53261 then i If the DNN configuration allows MPTCP and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL including RTT measurement without using PMF protocol the MA PDU Session is capable of 1 MPTCP and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL in the downlink and 2 MPTCP and ATSSS-LL with Active-Standby mode in the uplink NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1444",
    "document_id": "23501-i80",
    "chunk_id": 1444,
    "text": "In this case it is assumed that ATSSS-LL with Smallest Delay steering mode is selected for the downlink only when the UPF can measure RTT without using the PMF protocol eg by using other means not defined by 3GPP such as using the RTT measurements of MPTCP ii If the DNN configuration allows MPTCP and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL but not RTT measurement without using PMF protocol the MA PDU Session is capable of 1 MPTCP in the downlink 2 ATSSS-LL with any steering mode except Smallest Delay steering mode ie any Steering Mode allowed for ATSSS-LL except Smallest Delay steering mode in the downlink and 3 MPTCP and ATSSS-LL with Active-Standby mode in the uplink iii If the DNN configuration allows MPTCP with any steering mode and ATSSS-LL with only Active-Standby steering mode the MA PDU Session is capable of MPTCP and ATSSS-LL with Active-Standby mode in the uplink and in the downlink b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1445",
    "document_id": "23501-i80",
    "chunk_id": 1445,
    "text": "If the UE includes in its ATSSS capabilities MPQUIC functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode as specified in clause 53261 then i If the DNN configuration allows MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL including RTT measurement without using PMF protocol the MA PDU Session is capable of 1 MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL in the downlink and 2 MPQUIC and ATSSS-LL with Active-Standby mode in the uplink NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1446",
    "document_id": "23501-i80",
    "chunk_id": 1446,
    "text": "In this case it is assumed that ATSSS-LL with Smallest Delay steering mode is selected for the downlink only when the UPF can measure RTT without using the PMF protocol eg by using other means not defined by 3GPP such as using the RTT measurements of MPQUIC ii If the DNN configuration allows MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL but not RTT measurement without using PMF protocol the MA PDU Session is capable of 1 MPQUIC in the downlink 2 ATSSS-LL with any steering mode except Smallest Delay steering mode ie any Steering Mode allowed for ATSSS-LL except Smallest Delay steering mode in the downlink and 3 MPQUIC and ATSSS-LL with Active-Standby mode in the uplink iii If the DNN configuration allows MPQUIC with any steering mode and ATSSS-LL with only Active-Standby steering mode the MA PDU Session is capable of MPQUIC and ATSSS-LL with Active-Standby mode in the uplink and in the downlink c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1447",
    "document_id": "23501-i80",
    "chunk_id": 1447,
    "text": "If the UE includes in its ATSSS capabilities MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode as specified in clause 53261 and the DNN configuration allows MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL the MA PDU Session is capable of MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL in the uplink and in the downlink d If the UE includes in its ATSSS capabilities ATSSS-LL functionality with any steering mode as specified in clause 53261 and the DNN configuration allows ATSSS-LL with any steering mode allowed for ATSSS-LL the MA PDU Session is capable of ATSSS-LL with any steering mode allowed for ATSSS-LL in the uplink and in the downlink e",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1448",
    "document_id": "23501-i80",
    "chunk_id": 1448,
    "text": "If the UE includes in its ATSSS capabilities MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode as specified in clause 53261 and the DNN configuration allows MPTCP and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL the MA PDU Session is capable of MPTCP and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL in the uplink and in the downlink f If the UE includes in its ATSSS capabilities MPTCP functionality with any steering mode and the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with any steering mode as specified in clause 53261 and the DNN configuration allows MPTCP MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL the MA PDU Session is capable of MPTCP MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL in the uplink and in the downlink g",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1449",
    "document_id": "23501-i80",
    "chunk_id": 1449,
    "text": "If the UE includes in its ATSSS capabilities MPTCP functionality with any steering mode and the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 then i If the DNN configuration allows MPTCP MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL including RTT measurement without using PMF protocol the MA PDU Session is capable of 1 MPTCP MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL in the downlink and 2 MPTCP MPQUIC and ATSSS-LL with Active-Standby mode in the uplink NOTE 5 In this case it is assumed that ATSSS-LL with Smallest Delay steering mode is selected for the downlink only when the UPF can measure RTT without using the PMF protocol eg by using other means not defined by 3GPP such as using the RTT measurements of MPTCP or MPQUIC ii",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1450",
    "document_id": "23501-i80",
    "chunk_id": 1450,
    "text": "If the DNN configuration allows MPTCP MPQUIC and ATSSS-LL with any steering mode ie any Steering Mode allowed for ATSSS-LL but not RTT measurement without using PMF protocol the MA PDU Session is capable of 1 MPTCP and MPQUIC in the downlink 2 ATSSS-LL with any steering mode except Smallest Delay steering mode ie any Steering Mode allowed for ATSSS-LL except Smallest Delay steering mode in the downlink and 3 MPTCP MPQUIC and ATSSS-LL with Active-Standby mode in the uplink iii If the DNN configuration allows MPTCP and MPQUIC with any steering mode and ATSSS-LL with only Active-Standby steering mode the MA PDU Session is capable of MPTCP and MPQUIC and ATSSS-LL with Active-Standby mode in the uplink and in the downlink The SMF provides the ATSSS capabilities of the MA PDU Session to the PCF during PDU Session Establishment - The PCC rules provided by PCF include MA PDU Session Control information see TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1451",
    "document_id": "23501-i80",
    "chunk_id": 1451,
    "text": "They are used by SMF to derive ATSSS rules for the UE and N4 rules for the UPF When dynamic PCC is not used for the MA PDU Session the SMF shall provide ATSSS rules and N4 rules based on local configuration eg based on DNN or S-NSSAI - The UE receives ATSSS rules from SMF which indicate how the uplink traffic should be routed across 3GPP access and non-3GPP access Similarly the UPF receives N4 rules from SMF which indicate how the downlink traffic should be routed across 3GPP access and non-3GPP access - When the SMF receives a PDU Session Establishment Request and a MA PDU Request indication and determines that UP security protection see clause 5103 is required for the PDU Session the SMF shall only confirm the establishment of the MA PDU session if the 3GPP access network can enforce the required UP security protection The SMF needs not confirm whether the non-3GPP access can enforce the required UP security protection -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1452",
    "document_id": "23501-i80",
    "chunk_id": 1452,
    "text": "The UE indicates during MA PDU Session Establishment to the AMF whether it supports non-3GPP access path switching ie whether the UE can transfer the non-3GPP access path of the MA PDU Session from a source non-3GPP access N3IWFTNGF to a target non-3GPP access a different N3IWFTNGF If the UE has indicated support for non-3GPP access path switching and the AMF supports non-3GPP access path switching the AMF selects an SMF that supports non-3GPP access path switching if such an SMF is available If the AMF supports to maintain two N2 connections for non-3GPP access during the Registration procedure and the selected SMF supports non-3GPP path switching the AMF indicates whether the UE supports non-3GPP path switching to the SMF The SMF indicates support for non-3GPP path switching to the UE in the PDU Session Establishment Accept message NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1453",
    "document_id": "23501-i80",
    "chunk_id": 1453,
    "text": "If the AMF selects an SMF not supporting non-3GPP access path switching the non-3GPP access path switching can still be performed with the AMF triggering release of the old user plane resources before new user plane resources are established -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1454",
    "document_id": "23501-i80",
    "chunk_id": 1454,
    "text": "After the MA PDU Session establishment - At any given time the MA PDU session may have user-plane resources on both 3GPP and non-3GPP accesses or on one access only or may have no user-plane resources on any access - The AMF SMF PCF and UPF maintain their MA PDU Session contexts even when the UE deregisters from one access but remains registered on the other access - When the UE deregisters from one access but remains registered on the other access the AMF informs the SMF to release the resource of this access type in the UPF for the MA PDU Session Subsequently the SMF notifies the UPF that the access type has become unavailable and the N3N9 tunnel for the access type are released - If the UE wants to add user-plane resources on one access of the MA PDU Session eg based on access network performance measurement andor ATSSS rules then the UE shall send a PDU Session Establishment Request over this access containing PDU Session ID of the MA PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1455",
    "document_id": "23501-i80",
    "chunk_id": 1455,
    "text": "The UE also provides Request Type as MA PDU Request and the same PDU Session ID in the UL NAS Transport message If there is no N3N9 tunnel for this access the N3N9 tunnel for this access is established - If the UE wants to re-activate user-plane resources on one access of the MA PDU Session eg based on access network performance measurement andor ATSSS rules then the UE shall initiate the UE Triggered Service Request procedure over this access - If the network wants to re-activate the user-plane resources over 3GPP access or non-3GPP access of the MA PDU Session the network shall initiate the Network Triggered Service Request procedure as specified in clause 4227 of TS 23502 3 - If the UE wants to move the non-3GPP user-plane resources of the MA PDU Session from a source non-3GPP access eg source N3IWF or TNGF to a target non-3GPP access eg target N3IWF or TNGF the UE initiates a Mobility Registration Update via the target non-3GPP access as described in TS 23502 3 clause 42295 This procedure may also be used to move the non-3GPP user-plane resources of single access PDU Sessions NOTE 7 The UE can request activation of single access PDU Sessions over the target non-3GPP access while performing Mobility Registration Update procedure according to the existing procedure - The SMF may add remove or update one or more individual ATSSS rules of the UE by sending new or updated ATSSS rules with the corresponding Rule IDs to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1456",
    "document_id": "23501-i80",
    "chunk_id": 1456,
    "text": "A MA PDU Session may be established either a when it is explicitly requested by an ATSSS-capable UE or b when an ATSSS-capable UE requests a single-access PDU Session but the network decides to establish a MA PDU Session instead This is an optional scenario specified in clause 4223 of TS 23502 3 which may occur when the UE requests a single-access PDU Session but no policy eg no URSP rule and no local restrictions in the UE mandate a single access for the PDU Session A MA PDU Session may be established during a PDU Session modification procedure when the UE moves from EPS to 5GS as specified in clause 42263 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1457",
    "document_id": "23501-i80",
    "chunk_id": 1457,
    "text": "The AMF indicates as part of the Registration procedure whether ATSSS is supported or not When ATSSS is not supported the UE shall not - request establishment of a MA PDU Session as described in clause 4222 of TS 23502 3 or - request addition of User Plane resources for an existing MA PDU Session as described in clause 4227 of TS 23502 3 or - request establishment of a PDU Session with MA PDU Network-Upgrade Allowed indication as described in clause 4223 of TS 23502 3 or - request PDU Session Modification with Request Type of MA PDU request or with MA PDU Network-Upgrade Allowed indication after moving from EPC to 5GC as described in clause 42263 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1458",
    "document_id": "23501-i80",
    "chunk_id": 1458,
    "text": "The AMF indicates as part of the Registration procedure whether it supports non-3GPP access path switching When the AMF does not indicate support of non-3GPP access path switching the UE shall not perform the Mobility Registration Update procedure for non-3GPP access path switching ie to switch traffic from a source non-3GPP access to a target non-3GPP access The SMF indicates as part of the PDU Session Establishment procedure whether it supports non-3GPP access path switching If the UE has one or more PDU sessions and at least one serving SMF for the PDU Sessions supports non-3GPP access path switching the UE may include Non-3GPP path switching while using old AN resources indication when the UE performs the Mobility Registration Update procedure for non-3GPP access path switching If the UE is registered to different PLMNs over 3GPP and non-3GPP accesses the UE shall use the capability received over non-3GPP access to determine whether to perform the Mobility Registration Update procedure for non-3GPP path switching and whether to include Non-3GPP access path switching while using old AN resources indication NOTE 8 If the AMF receives Non-3GPP path switching while using old AN resources indication from Mobility Registration Update procedure and the serving SMFs for PDU Sessions is not supporting non-3GPP access path switching the non-3GPP access path switching can still be performed with the AMF triggering for each PDU Session the release of the old user plane resources before new user plane resources are established An ATSSS-capable UE may decide to request a MA PDU Session based on the provisioned URSP rules In particular the UE should request a MA PDU Session when the UE applies a URSP rule which triggers the UE to establish a new PDU Session and the Access Type Preference component of the URSP rule indicates Multi-Access see TS 23503 45 5323 Policy for ATSSS Control",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1459",
    "document_id": "23501-i80",
    "chunk_id": 1459,
    "text": "If dynamic PCC is to be used for the MA PDU Session the PCF may take ATSSS policy decisions and create PCC rules that contain MA PDU Session Control information as specified in TS 23503 45 which determines how the uplink and the downlink traffic of the MA PDU Session should be distributed across the 3GPP and non-3GPP accesses If dynamic PCC is not deployed local policy in SMF is used The SMF receives the PCC rules with MA PDU Session Control information and maps these rules into a ATSSS rules which are sent to the UE and b N4 rules which are sent to the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1460",
    "document_id": "23501-i80",
    "chunk_id": 1460,
    "text": "The ATSSS rules are provided as a prioritized list of rules see clause 5328 which are applied by the UE to enforce the ATSSS policy in the uplink direction and the N4 Rules are applied by the UPF to enforce the ATSSS policy in the downlink direction The ATSSS rules are sent to UE with a NAS message when the MA PDU Session is created or updated by the SMF eg after receiving updatednew PCC rules from the PCF Similarly the N4 rules are sent to UPF when the MA PDU Session is created or updated by the SMF The details of the policy control related to ATSSS are specified in TS 23503 45 5324 QoS Support The 5G QoS model for the Single-Access PDU Session is also applied to the MA PDU Session ie the QoS Flow is the finest granularity of QoS differentiation in the MA PDU Session One difference compared to the Single-Access PDU Session is that in a MA PDU Session there can be separate user-plane tunnels between the AN and the PSA each one associated with a different access However the QoS Flow is not associated with specific access ie it is access agnostic so the same QoS is supported when the traffic is distributed over 3GPP and non-3GPP accesses The SMF shall provide the same QFI in 3GPP and non-3GPP accesses so that the same QoS is supported in both accesses A QoS Flow of the MA PDU Session may be either Non-GBR or GBR depending on its QoS profile For a Non-GBR QoS Flow the SMF provides a QoS profile to both 5G-ANs during MA PDU Session Establishment or MA PDU Session Modification procedure -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1461",
    "document_id": "23501-i80",
    "chunk_id": 1461,
    "text": "During MA PDU Session Establishment procedure the QoS profile to both ANs if the UE is registered over both accesses - During MA PDU Session Modification procedure the QoS profile is provided to the 5G-ANs over which the user plane resources are activated For a GBR QoS Flow the SMF shall provide a QoS profile to 5G-ANs as follows - If the PCC rule allows a GBR QoS Flow in a single access the SMF provides the QoS profile for the GBR QoS Flow to the access network allowed by the PCC rule - If the PCC rule allows a GBR QoS Flow in both accesses and the Steering Mode is different from Redundant the SMF decides to which access network to provide the QoS profile for the GBR QoS Flow based on its local policy eg the access where the traffic is ongoing according to the Multi Access Routing rule - If the PCC rule allows a GBR QoS Flow in both accesses and the Steering Mode is Redundant the SMF provides the QoS profile for the GBR QoS Flow to both access networks Whenever the SMF recognizes that resources are not allocated in one access network the SMF shall notify the PCF about the resource allocation failure and indicate the respective Access Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1462",
    "document_id": "23501-i80",
    "chunk_id": 1462,
    "text": "Whenever the SMF recognizes that resources are not allocated in both access networks the SMF shall release the resources for the GBR QoS Flow and report to the PCF about the removal of the PCC rule NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1463",
    "document_id": "23501-i80",
    "chunk_id": 1463,
    "text": "The SMF knows about the allocation of resources in an access network from the interaction with the access network during GBR QoS Flow establishmentmodification as well as during the release of resources by the access network For a GBR QoS Flow traffic splitting is not supported If the UPF determines that it cannot send GBR traffic over the current ongoing access eg based on the N4 rules and access availability and unavailability report from the UE as described in clause 53253 the UPF shall send an Access Availability report to the SMF Based on the Access Availability report and if the Steering Mode is different from Redundant the SMF decides whether to move GBR QoS Flows to the other access when one access is not available - if the PCC rule allows the GBR QoS Flows only on this access the SMF shall release the resources for the GBR QoS Flow and report to the PCF about the removal of the PCC rule - if the corresponding PCC rule allows the GBR QoS Flow on both accesses and the other access is not available the SMF shall release the resources for the GBR QoS Flow and report to the PCF about the removal of the PCC rule - if the PCC rule allows the GBR QoS Flow on both accesses and the other access is available the SMF shall try to move the GBR QoS Flow to the other access The SMF may trigger a PDU session modification procedure to provide the QoS profile to the other access and release the resources for the GBR QoS Flow in the current access - if Notification Control parameter is not included in the PCC rule for the GBR QoS Flow and the other access does not accept the QoS profile the SMF shall release the resources for the GBR QoS Flow and report to the PCF about the removal of the PCC rule - if the Notification Control parameter is included in the PCC rule the SMF shall notify the PCF that GFBR can no longer be guaranteed After the other access accepts the QoS profile the SMF shall notify the PCF that GFBR can again be guaranteed If the other access does not accept the QoS profile the SMF shall delete the GBR QoS Flow and report to the PCF about the removal of the PCC rule NOTE 2 The ATSSS rule for GBR QoS Flow only allows the UE to steer traffic over a single access so that the network knows in which access the UE sends GBR traffic If the network wants to move GBR QoS Flow to the other access the network needs to update ATSSS rule of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1464",
    "document_id": "23501-i80",
    "chunk_id": 1464,
    "text": "Based on the Access Availability report and if the Steering Mode is Redundant the SMF behaves as follows - if both accesses are not available the SMF shall release the resources for the GBR QoS Flow and report to the PCF about the removal of the PCC rule NOTE 3 The UPF can detect that both accesses are not available based on implementation specific means - when one of the accesses becomes unavailable while the other access is still available the SMF shall neither release the resources for the GBR QoS Flow nor notify the PCF that GFBR can no longer be guaranteed if the Notification Control parameter is included in the PCC rule NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1465",
    "document_id": "23501-i80",
    "chunk_id": 1465,
    "text": "The access network will typically release the resources for a GBR QoS Flow if there is no traffic transferred for a certain amount of time and this will then trigger the SMF notification to PCF described above When the MA PDU Session is established or when the MA PDU Session is modified the SMF may provide QoS rules to the UE via one access which are applied by the UE as specified in clause 5714 The QoS rules provided by SMF via one access are commonly used for both 3GPP access and non-3GPP access so the QoS classification is independent of ATSSS rules The derived QoS rule generated by Reflective QoS is applied independently of the access on which the RQI was received When the MPTCP functionality andor the MPQUIC functionality is used in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1466",
    "document_id": "23501-i80",
    "chunk_id": 1466,
    "text": "the UE shall use the IP addressprefix of the MA PDU Session and the final destination address to generate the derived QoS rule When the MPTCP functionality andor MPQUIC functionality is enabled for the MA PDU Session - any QoS rules or PDRs that apply to the MA PDU Session IP addressprefix and port also apply a to the MPTCP link-specific multipath addressesprefixes and ports used by the UE to establish MPTCP subflows over 3GPP and non-3GPP accesses and b to the MPQUIC link-specific multipath addresses and ports used by the UE to transmit UDP flows over 3GPP and non-3GPP accesses and - any QoS rules or PDRs that apply to the IP addressprefix and port of the final destination server in DN also apply a to the IP address and port of the MPTCP proxy for corresponding MPTCP subflows that are terminated at the proxy and b to the IP address and port of the MPQUIC proxy for corresponding UDP flows that are terminated at the proxy NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1467",
    "document_id": "23501-i80",
    "chunk_id": 1467,
    "text": "How these associations are made is left up to the UE and UPF implementations 5325 Access Network Performance Measurements 53251 General principles When an MA PDU Session is established the network may provide the UE with Measurement Assistance Information This information assists the UE in determining which measurements shall be performed over both accesses as well as whether measurement reports need to be sent to the network Measurement Assistance Information shall include the addressing information of a Performance Measurement Function PMF in the UPF the UE can send PMF protocol messages to - For a PDU Session of IP type Measurement Assistance Information contains one IP address for the PMF one UDP port associated with 3GPP access and another UDP port associated with non-3GPP access PMF messages sent by UE to one of these UDP ports shall be transmitted to UPF via the QoS Flow associated with the default QoS rule -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1468",
    "document_id": "23501-i80",
    "chunk_id": 1468,
    "text": "For a PDU Session of Ethernet type Measurement Assistance Information contains one MAC address associated with 3GPP access and another MAC address associated with non-3GPP access PMF messages sent by UE to one of these MAC addresses shall be transmitted to UPF via the QoS Flow associated with the default QoS rule NOTE 1 To protect the PMF in the UPF eg to block DDOS to the PMF the IP addresses of the PMF are only accessible from the UE IP address via the N3N9 interface NOTE 2 After the MA PDU Session is released the same UE IP addressprefix is not allocated to another UE for MA PDU Session in a short time If the SMF determines that access performance measurements per QoS Flow shall be applied for the MA PDU Session then the Measurement Assistance Information shall also include a list of QoS Flows on which access performance measurements may be performed For each QoS Flow in this list the following information is included - The QFI of the associated QoS Flow -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1469",
    "document_id": "23501-i80",
    "chunk_id": 1469,
    "text": "For a PDU Session of IP type one UDP port associated with 3GPP access and another UDP port associated with non-3GPP access PMF messages sent by UE to one of these UDP ports shall be transmitted to UPF via the associated QoS Flow - For a PDU Session of Ethernet type one MAC address associated with 3GPP access and another MAC address associated with non-3GPP access PMF messages sent by UE to one of these MAC addresses shall be transmitted to UPF via the associated QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1470",
    "document_id": "23501-i80",
    "chunk_id": 1470,
    "text": "The QoS rules and the N4 rules provided by SMF to UE and to UPF respectively shall include information eg packet filters containing the UDP port or the MAC address associated with a QoS Flow which enables the UE and UPF to route a PMF message to a specific QoS Flow The UE and the UPF may need to perform access performance measurements in order to estimate the Round-Trip Time RTT andor the Packet Loss Rate PLR that an SDF is expected to experience when transmitted on a certain access type Based on these measurements and the provisioned ATSSS rules in the UE and MAR rules in the UPF the UE and the UPF decide how to distribute the traffic of an SDF across the two accesses If the UE and the UPF decide to initiate access performance measurements to estimate the RTT andor the PLR for an SDF the access performance measurements shall be performed either a using the QoS Flow associated with the default QoS rule or b using the target QoS Flow which is the QoS Flow that the SDF traffic is transmitted on When the access performance measurements are using the target QoS Flow it is termed that access performance measurements per QoS Flow are applied for the MA PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1471",
    "document_id": "23501-i80",
    "chunk_id": 1471,
    "text": "The UE shall indicate in its ATSSS capabilities that it supports access performance measurements per QoS Flow Based on this UE capability and other information such as local policy the SMF determines whether access performance measurements per QoS Flow shall be applied for the MA PDU Session or not If the SMF determines that access performance measurements per QoS Flow shall be applied for the MA PDU Session then - The SMF determines a list of QoS Flows over which access performance measurements may be performed and provides this list to the UE within the Measurement Assistance Information and to the UPF - The UE and the UPF may initiate access performance measurements on one or more of the QoS Flows included in this list The UE and the UPF shall be able to receive and respond to PMF messages sent on any QoS Flow included in this list -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1472",
    "document_id": "23501-i80",
    "chunk_id": 1472,
    "text": "The SMF may update the list of QoS Flows over which access performance measurements may be performed during the lifetime of a MA PDU Session eg when a new PCC rule that could benefit from PMF access performance measurements is bound to a QoS Flow NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1473",
    "document_id": "23501-i80",
    "chunk_id": 1473,
    "text": "The SMF can eg add a QoS Flow into the list when at least one PCC Rule is bound to that QoS Flow that is using one of the Steering Modes where performance measurements via PMF are applicable such as Lowest Delay Steering Mode or a Steering Mode where threshold values have been provided The UE shall perform access performance measurements per QoS Flow only when this is explicitly indicated in the Measurement Assistance Information ie only when the UE receives the list of QoS Flows over which access performance measurements may be performed Otherwise the UE shall perform access performance measurements based on the QoS Flow associated with the default QoS rule The UPF shall perform access performance measurements per QoS Flow only when this is explicitly indicated by SMF ie only when the UPF receives the list of QoS Flows over which access performance measurements may be performed Otherwise the UPF shall perform access performance measurements based on the QoS Flow associated with the default QoS rule In this case the UPF learns what QoS Flow to use as described in TS 29244 65",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1474",
    "document_id": "23501-i80",
    "chunk_id": 1474,
    "text": "The UE and the UPF may decide not to initiate access performance measurements using PMF over a certain target QoS Flow when they already have access performance measurements for another target QoS Flow which they determine can be reused NOTE 4 How the UE and UPF determine that the performance measurements using a certain target QoS Flow apply to another target QoS Flow is based on implementation eg AN resource to QoS Flow mapping in the UE or getting similar access measurements results with other QoS Flow When access performance measurements for an SDF are performed based on the target QoS Flow the UE needs to be able to determine the QoS Flow a downlink packet arrives on In order to enable this the SMF shall include downlink Packet Filter information in the QoS rule provided to UE matching this SDF unless Reflective QoS is used for the SDF NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1475",
    "document_id": "23501-i80",
    "chunk_id": 1475,
    "text": "For example if a QoS Flow requires to activate Reflective QoS the SMF does not need to provide downlink QoS Flow information for the QoS Flow to minimize usage of packet filters When a data packet is received over a QoS Flow the UE can decide whether to check the downlink QoS Flow information based on the existence of SDAP header for the QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1476",
    "document_id": "23501-i80",
    "chunk_id": 1476,
    "text": "The addressing information of the PMF in the UPF is retrieved by the SMF from the UPF during N4 session establishment If the UPF receives from the SMF during N4 session establishment or modification procedure a list of QoS Flows over which access performance measurements may be performed the UPF allocates different UDP ports per QoS Flow per access for IP PDU sessions or allocates different MAC addresses per QoS Flow per access for Ethernet PDU sessions For IP PDU sessions the UPF sends the PMF IP addressing information and the UDP ports with the QFI of the associated QoS Flow to the SMF For Ethernet PDU sessions the UPF sends the MAC addresses with the QFI of the associated QoS Flow to the SMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1477",
    "document_id": "23501-i80",
    "chunk_id": 1477,
    "text": "The following PMF protocol messages can be exchanged between the UE and the UPF - Messages to allow for Round Trip Time RTT measurements ie when the Smallest Delay steering mode is used or when either Priority-based Load-Balancing or Redundant steering mode is used with RTT threshold value being applied - Messages to allow for Packet Loss Rate PLR measurements ie when steering mode is used either Priority-based Load-Balancing or Redundant steering mode is used with PLR threshold value being applied - Messages for reporting Access availabilityunavailability by the UE to the UPF - Messages for sending UE-assistance data to UPF Such messages may be sent from the UE to UPF only when the UE receives the UE-assistance indicator in an ATSSS rule as specified in clause 5328",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1478",
    "document_id": "23501-i80",
    "chunk_id": 1478,
    "text": "Further details are provided in clause 53255 - Messages for sending Suspend Traffic Duplication and Resume Traffic Duplication from UPF to UE to suspend or resume traffic duplication as defined in clause 53256 Since steering modes can be different in up-link and down-link the UE needs to be able to handle PMF protocol messages for RTT and PLR measurements received from UPF even if it is not using one of the steering modes associated with the RTT and PLR measurements and vice versa The PMF protocol is specified in TS 24193 109 The PMF protocol messages used for access availabilityunavailability reports shall be sent on the QoS Flow associated with the default QoS rule The PMF protocol messages used for access performance measurements shall be sent either on the QoS Flow associated with the default QoS rule or on the target QoS Flow as specified above The QoS Flow associated with the default QoS rule for MA PDU Session is Non-GBR QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1479",
    "document_id": "23501-i80",
    "chunk_id": 1479,
    "text": "The UE shall not apply the ATSSS rules and the UPF shall not apply the MAR rules for the PMF protocol messages When the UE requests a MA PDU session and indicates it is capable to support - the MPTCP functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 or - the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 or - the MPTCP functionality with any steering mode and the MPQUIC functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 the network may send Measurement Assistance Information for the UE to send Access availabilityunavailability reports to the UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1480",
    "document_id": "23501-i80",
    "chunk_id": 1480,
    "text": "In this case the UE and UPF shall not perform RTT and PLR measurements using PMF as the UE and UPF can use measurements available at the MPTCP layer andor at the MPQUIC layer 53251a Address of PMF messages As described in clause 53252 53252a and 53253 a UE and UPF may exchange PMF messages to measure access performance and report access availabilityunavailability When the UE and UPF exchanges PMF message source and destination address of the PMF messages shall be assigned as follows 1 In the case of a MA PDU Session of IP type - If access performance measurements are performed only over the QoS Flow associated with the default QoS rule the PMF in the UE sends PMF messages to the PMF in the UPF over UDPIP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1481",
    "document_id": "23501-i80",
    "chunk_id": 1481,
    "text": "The destination IP address is the IP address contained in the Measurement Assistance Information and the destination UDP port is one of the two UDP ports contained in the Measurement Assistance Information One UDP port is used for sending PMF messages to UPF over 3GPP access and the other UDP port is used for sending PMF messages to UPF over non-3GPP access The source IP address is the IP address assigned to UE for the MA PDU Session and the source UDP port is a UDP port that is dynamically allocated by the UE for PMF communication This source UDP port in the UE remains the same for the entire lifetime of the MA PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1482",
    "document_id": "23501-i80",
    "chunk_id": 1482,
    "text": "If access performance measurements per QoS Flow is performed the Measurement Assistance Information contains UDP ports one for each QoS Flow and access combination When the UE sends PMF message over a QoS Flow of an access the UE shall set the destination UDP port as the UDP port for the QoS Flow and the access in Measurement Assistance information - If access performance measurements are performed only over the QoS Flow associated with the default QoS rule the PMF in the UPF sends PMF messages to the PMF in the UE over UDPIP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1483",
    "document_id": "23501-i80",
    "chunk_id": 1483,
    "text": "The source IP address is the same IP address as the one provided in the Measurement Assistance Information and the source UDP port is one of the two UDP ports as provided in the Measurement Assistance Information One UDP port is used for sending PMF messages to UE over 3GPP access and the other UDP port is used for sending PMF messages to UE over the non-3GPP access The destination IPv4 address is the IPv4 address assigned to UE for the MA PDU Session if any and the destination IPv6 address is an IPv6 address selected by the UE from the IPv6 prefix assigned for the MA PDU Session if any The destination UDP port is the dynamically allocated UDP port in the UE which is contained in all PMF messages received from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1484",
    "document_id": "23501-i80",
    "chunk_id": 1484,
    "text": "If access performance measurements per QoS Flow is performed when the UPF sends PMF message over a QoS Flow of an access the UPF shall set the source UDP port with the UDP port for the QoS Flow and the access as the one for the QoS Flow and the access provided in Measurement Assistance information - If the UE receives Measurement Assistance Information the UE shall inform the network via the user plane about the UEs dynamically allocated UDP port and the IPv6 address if IPv6 is used for PMF messages so that it is possible for the UPF to know the UEs IPv6 address if applicable and dynamically allocated UDP port as soon as the MA PDU Session has been established NOTE 1 Regardless of whether access performance measurements per QoS Flow is applied or not the UE only allocates a single UDP port for PMF messages 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1485",
    "document_id": "23501-i80",
    "chunk_id": 1485,
    "text": "In the case of a MA PDU Session of Ethernet type - The PMF in the UE sends PMF messages to the PMF in the UPF over Ethernet The Ethertype is the Ethertype contained in the Measurement Assistance Information If access performance measurements are performed only over the QoS Flow associated with the default QoS rule the destination MAC address is one of the two MAC addresses contained in the Measurement Assistance Information One MAC address is used for sending PMF messages to UPF over 3GPP access and the other MAC address is used for sending PMF messages to UPF over non-3GPP access The source MAC address is a MAC address of the UE which remains the same for the entire lifetime of the MA PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1486",
    "document_id": "23501-i80",
    "chunk_id": 1486,
    "text": "If access performance measurements per QoS Flow is performed Measurement Assistance Information contains MAC addresses for each QoS Flow and each access When the UE sends PMF message over a QoS Flow of an access the UE shall set the destination MAC address as the MAC address for the QoS Flow and the access in Measurement Assistance information - The PMF in the UPF sends PMF messages to the PMF in the UE over Ethernet The Ethertype is the same Ethertype as the one provided in the Measurement Assistance Information If access performance measurements are performed only over the QoS Flow associated with the default QoS rule the source MAC address is one of the two MAC addresses as provided in the Measurement Assistance Information One MAC address is used for sending PMF messages to UE over 3GPP access and the other MAC address is used for sending PMF messages to UE over non-3GPP access The destination MAC address is the MAC address of the UE which is contained in all PMF messages received from the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1487",
    "document_id": "23501-i80",
    "chunk_id": 1487,
    "text": "If access performance measurements per QoS Flow is performed when the UPF sends PMF message over a QoS Flow of an access the UPF shall set the source MAC address with the MAC address for the QoS Flow and the access as the one for the QoS Flow and the access provided in Measurement Assistance information - If the UE receives Measurement Assistance Information the UE shall inform the network via the user plane about the UEs MAC address so that it is possible for the UPF to know the UEs MAC address as soon as the MA PDU Session has been established NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1488",
    "document_id": "23501-i80",
    "chunk_id": 1488,
    "text": "Regardless of whether access performance measurements per QoS Flow is applied or not the UE only use a single MAC address 53252 Round Trip Time Measurements RTT measurements can be conducted by the UE and UPF independently There is no measurement reporting from one side to the other RTT measurements are defined to support the Smallest Delay Priority-based Load Balancing or Redundant steering mode ie when RTT threshold value is applied The estimation of the RTT by the UE and by the UPF is based on the following mechanism 1 The PMF in the UE sends over the user plane PMF-Echo Request messages to the PMF in the UPF and the PMF in the UPF responds to each one with a PMF-Echo Response message Similarly the PMF in the UPF sends over the user plane PMF-Echo Request messages to the PMF in the UE and the PMF in the UE responds to each one with a PMF-Echo Response message 2 When the UP connection of the MA PDU session is deactivated on an access no PMF-Echo Request messages are sent on this access The PMF in the UPF shall not send PMF-Echo Request on this access if the UP connection is not available or after it receives notification from the H-SMF to stop sending the PMF-Echo Request on this access 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1489",
    "document_id": "23501-i80",
    "chunk_id": 1489,
    "text": "The UE and the UPF derive an estimation of the average RTT over an access type and QoS Flow by averaging the RTT measurements obtained over this access type and QoS Flow 53252a Packet Loss Rate Measurements The UE and the UPF may decide to estimate the Packet Loss Rate PLR for an SDF over both accesses For example the UE may take this decision when an ATSSS rule in the UE requires the traffic of an SDF to be steered in accordance with a PLR-based threshold condition eg PLR 2 The UE and the UPF calculate the PLR for an SDF by exchanging PMF-PLR Report messages as specified below A PMF-PLR Report message is sent over 3GPP access or over non-3GPP access using either the QoS Flow associated with the default QoS rule or a target QoS Flow as specified in clause 53251",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1490",
    "document_id": "23501-i80",
    "chunk_id": 1490,
    "text": "The calculation of the PLR by the UE and by the UPF is based on the following mechanism It is assumed that the PLR should be calculated for a target QoS Flow however the same mechanism applies when the PLR should be calculated for the QoS Flow associated with the default QoS rule - The UE requests from UPF to start counting the number of received UL packets by sending a PMF-PLR Count Request message over the target QoS Flow The UPF starts counting of the received UL packets over the target QoS Flow and over the access network which the PMF-PLR Count Request message was received from The UE starts counting the transmitted UL packets over the target QoS Flow and access network when it sends a PMF-PLR Count Request message to UPF - The UE stops the counting and requests from UPF to report the number of counted UL packets by sending a PMF-PLR Report Request message over the target QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1491",
    "document_id": "23501-i80",
    "chunk_id": 1491,
    "text": "The UPF stops the counting and sends a PMF-PLR Report Response message over the QoS Flow including the number of UL packets counted since it received the last PMF-PLR Count Request message NOTE 1 A PMF-PLR Report Request message can also indicate to UPF to start counting packets if the UE wants to measure the Packet Loss Rate again - The UE calculates the UL packet loss ratio based on the local counting result of the number of transmitted UL packets and reported number of received UL packets in the UPF - The UPF applies the same procedure for calculating the DL PLR ie it sends to UE a PMF-PLR Count Request message on a target QoS Flow to request from UE to start counting the number of DL packets received on this target QoS Flow As defined in clause 53251 the UE determines which DL packets are received on the target QoS Flow by checking the QFI included in the header of DL packets eg in the SDAP header If no QFI is included in the header of a DL packet the UE determines the QFI for this DL packet by applying the Packet Filters for downlink in the QoS Rules received from SMF - When the UP connection of the MA PDU session is deactivated on an access no PMF-PLR messages are sent on this access The PMF in the UPF shall not send PMF-PLR message on this access if the UP connection is not available or after it receives notification from the H-SMF to stop sending the PMF-PLR message on this access - The UE and the UPF derive an estimation of the average PLR per QoS Flow over an access type by averaging the PLR measurements obtained over this access NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1492",
    "document_id": "23501-i80",
    "chunk_id": 1492,
    "text": "The details of the packet loss measurements including error cases and mechanisms for improving the measurement accuracy are considered in the Stage 3 specifications 53253 Access AvailabilityUnavailability Report",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1493",
    "document_id": "23501-i80",
    "chunk_id": 1493,
    "text": "If required by the network in the Measurement Assistance Information the UE shall provide access availabilityunavailability reports to the network How the UE detects the unavailability and the availability of an access is based on implementation The CM state of a UE is not a factor when determining whether the 3GPP access is available When the UE detects the unavailabilityavailability of an access it shall - build a PMF-Access Report containing the access type and an indication of availabilityunavailability of this access - send the PMF-Access Report to the UPF via the user plane The UPF shall acknowledge the PMF-Access Report received from the UE 53254 Protocol stack for user plane measurements and measurement reports Figure 53254-1 UEUPF measurements related protocol stack for 3GPP access and for an MA PDU Session with type IP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1494",
    "document_id": "23501-i80",
    "chunk_id": 1494,
    "text": "In the case of an MA PDU Session with type Ethernet the protocol stack over 3GPP access is that same as the one in the above figure but the PMF protocol operates on top of Ethernet instead of UDPIP Figure 53254-2 UEUPF measurements related protocol stack for Untrusted non-3GPP access and for an MA PDU Session with type IP In the case of an MA PDU Session with type Ethernet the protocol stack over Untrusted non-3GPP access is the same as the one in the above figure but the PMF protocol operates on top of Ethernet instead of UDPIP Figure 53254-3 UEUPF measurements related protocol stack for Trusted non-3GPP access and for an MA PDU Session with type IP In the case of an MA PDU Session with type Ethernet the protocol stack over Trusted non-3GPP access is the same as the one in the above figure but the PMF protocol operates on top of Ethernet instead of UDPIP 53255 UE Assistance Operation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1495",
    "document_id": "23501-i80",
    "chunk_id": 1495,
    "text": "When UE-assistance operation is authorized by the PCF in the PCC Rule the SMF provides an indication for UE-assistance in the ATSSS Rule to the UE as described in clause 5328 and in the MAR to the UPF as described in clause 5858 If the UE receives the UE-assistance indicator in an ATSSS rule as specified in clause 5328 and the UE decides to apply a different UL traffic distribution for an SDF than the default UL traffic distribution indicated in the Steering Mode component of the ATSSS rule eg because the UE is running out of battery then the following applies - The UE may apply any split percentages for the UL traffic distribution of an SDF based on implementation specific criteria -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1496",
    "document_id": "23501-i80",
    "chunk_id": 1496,
    "text": "The UE may send a PMF-UAD UE Assistance Data message to UPF that contains the split percentages that may be used by UPF for all DL traffic that the UE-assistance operation applies The UPF acknowledges the reception of the PMF-UAD message by sending a PMF-UAD complete message to the UE NOTE If the UE has multiple ATSSS rules that allow UE-assistance operation and the UE decides to use different UL split percentages for their respective SDFs then the split percentages included in the PMF-UAD message are selected by the UE based on implementation specific criteria -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1497",
    "document_id": "23501-i80",
    "chunk_id": 1497,
    "text": "The UPF may apply the information in a received PMF-UAD message to align the DL traffic distribution for traffic that is allowed to use UE-assistance operation ie traffic where the MAR contains a Steering Mode Indicator set to UE-assistance operation - If the UE decides to terminate the UE assistance operation the UE may send a PMF-UAT UE Assistance Termination message to the UPF indicating that the UE assistance operation is terminated and the UE performs the UL traffic distribution according to the split percentages in the ATSSS rule received from the network If the UPF receives the PMF-UAT message the UPF acknowledges the reception by sending a PMF-UAT complete message and performs DL traffic distribution by applying the split percentages included in the MAR 53256 Suspend and Resume Traffic Duplication As part of the Redundant Steering Mode a UPF can decide to suspend traffic duplication for a UE by sending PMF- Suspend Duplication Request message to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1498",
    "document_id": "23501-i80",
    "chunk_id": 1498,
    "text": "How the UPF determines to suspend traffic duplication is implementation specific NOTE 1 The Suspension of traffic duplication can be caused by eg the locally detected UPF congestion In that way the UPF can stop receiving duplicated traffic via 3GPP and non-3GPP access network simultaneously",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1499",
    "document_id": "23501-i80",
    "chunk_id": 1499,
    "text": "The UPF may indicate in the PMF-Suspend Duplication Request message the type of traffic ie GBR or non-GBR for which traffic duplication is being suspended The PMF-Suspend Duplication Request message is sent over the user plane of any available access network of the MA PDU Session Once the UE receives the PMF-Suspend Duplication Request message from the UPF the UE shall stop duplicating the type of traffic for which traffic duplication is suspended If the UPF does not provide the type of traffic GBR or non-GBR in the PMF-Suspend Duplication Request message traffic duplication is suspended for all traffic for which traffic duplication is being performed Once UPF suspended traffic duplication and if no Primary Access is configured both the UE and the UPF decide based on their own implementation which access network to use for sending UL and DL traffic If the Primary Access is configured both the UE and the UPF use the Primary Access for sending UL and DL traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1500",
    "document_id": "23501-i80",
    "chunk_id": 1500,
    "text": "The UPF may decide to resume traffic duplication for a UE by sending the PMF-Resume Duplication Request message How the UPF determines to resume traffic duplication is implementation specific NOTE 2 Traffic duplication can be resumed eg when the UPF has detected that local congestion has diminished Once the UE receives the PMF-Resume Duplication Request message from the UPF the UE may restart to duplicate the type of traffic for which traffic duplication is resumed based on the provided Redundant steering mode policies and UE implementation 5326 Support of Steering Functionalities 53261 General The functionality in an ATSSS-capable UE that can steer switch and split the MA PDU Session traffic across 3GPP access and non-3GPP access is called a steering functionality An ATSSS-capable UE may support one or more of the following types of steering functionalities - High-layer steering functionalities which operate above the IP layer -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1501",
    "document_id": "23501-i80",
    "chunk_id": 1501,
    "text": "In this release of the specification two high-layer steering functionalities are specified - The first applies the MPTCP protocol IETF RFC 8684 81 and is called MPTCP functionality see clause 532621 This steering functionality can be applied to steer switch and split the TCP traffic flows identified in the ATSSSN4 rules The MPTCP functionality in the UE may communicate with an associated MPTCP Proxy functionality in the UPF by using the MPTCP protocol over the 3GPP andor the non-3GPP user plane - The second applies the QUIC protocol RFC 9000 166 RFC 9001 167 RFC 9002 168 and its multipath extensions draft-ietf-quic-multipath 174 and it is called MPQUIC functionality see clause 532622",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1502",
    "document_id": "23501-i80",
    "chunk_id": 1502,
    "text": "This steering functionality can be applied to steer switch and split the UDP traffic flows identified in the ATSSSN4 rules The MPQUIC functionality in the UE may communicate with an associated MPQUIC Proxy functionality in the UPF by using the QUIC protocol and its multipath extensions over the 3GPP andor the non-3GPP user plane - Low-layer steering functionalities which operate below the IP layer - One type of low-layer steering functionality defined in the present document is called ATSSS Low-Layer functionality or ATSSS-LL functionality see clause 532631",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1503",
    "document_id": "23501-i80",
    "chunk_id": 1503,
    "text": "This steering functionality can be applied to steer switch and split all types of traffic including TCP traffic UDP traffic Ethernet traffic etc ATSSS-LL functionality is mandatory for MA PDU Session of type Ethernet In the network there shall be in the data path of the MA PDU session one UPF supporting ATSSS-LL NOTE Filters used in ATSSS rules related with a MA PDU Session of type Ethernet can refer to IP level parameters such as IP addresses and TCPUDP ports The UE indicates to the network its supported steering functionalities and steering modes by including in the UE ATSSS Capability one of the following 1 ATSSS-LL functionality with any steering mode In this case the UE indicates that it is capable to steer switch and split all traffic of the MA PDU Session by using the ATSSS-LL functionality with any steering mode allowed for ATSSS-LL as specified in clause 5328 2 MPTCP functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode In this case the UE indicates that a it is capable to steer switch and split the MPTCP traffic of the MA PDU Session by using the MPTCP functionality with any steering mode specified in clause 5328 and b it is capable to steer and switch all other traffic ie the non-MPTCP traffic of the MA PDU Session by using the ATSSS-LL functionality with the Active-Standby steering mode specified in clause 5328 3 MPTCP functionality with any steering mode and ATSSS-LL functionality with any steering mode In this case the UE indicates that a it is capable to steer switch and split the MPTCP traffic of the MA PDU Session by using the MPTCP functionality with any steering mode specified in clause 5328 and b it is capable to steer switch and split all other traffic ie the non-MPTCP traffic of the MA PDU Session by using the ATSSS-LL functionality with any steering mode as specified in clause 5328 4 MPQUIC functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode In this case the UE indicates that a it is capable to steer switch and split the MPQUIC traffic of the MA PDU Session by using the MPQUIC functionality with any steering mode specified in clause 5328 and b it is capable to steer and switch all other traffic ie the non-MPQUIC traffic of the MA PDU Session by using the ATSSS-LL functionality with the Active-Standby steering mode specified in clause 5328 5 MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode In this case the UE indicates that a it is capable to steer switch and split the MPQUIC traffic of the MA PDU Session by using the MPQUIC functionality with any steering mode specified in clause 5328 and b it is capable to steer switch and split all other traffic ie the non-MPQUIC traffic of the MA PDU Session by using the ATSSS-LL functionality with any steering mode that can be used with ATSSS-LL as specified in clause 5328 6 MPTCP functionality with any steering mode MPQUIC functionality with any steering mode and ATSSS-LL functionality with only Active-Standby steering mode In this case the UE indicates that a it is capable to steer switch and split the MPTCP traffic of the MA PDU Session by using the MPTCP functionality with any steering mode specified in clause 5328",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1504",
    "document_id": "23501-i80",
    "chunk_id": 1504,
    "text": "b it is capable to steer switch and split the MPQUIC traffic of the MA PDU Session by using the MPQUIC functionality with any steering mode specified in clause 5328 and c it is capable to steer and switch all other traffic ie the non-MPTCP traffic and the non-MPQUIC traffic of the MA PDU Session by using the ATSSS-LL functionality with the Active-Standby steering mode specified in clause 5328 7 MPTCP functionality with any steering mode MPQUIC functionality with any steering mode and ATSSS-LL functionality with any steering mode In this case the UE indicates that a it is capable to steer switch and split the MPTCP traffic of the MA PDU Session by using the MPTCP functionality with any steering mode specified in clause 5328",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1505",
    "document_id": "23501-i80",
    "chunk_id": 1505,
    "text": "b it is capable to steer switch and split the MPQUIC traffic of the MA PDU Session by using the MPQUIC functionality with any steering mode specified in clause 5328 and c it is capable to steer switch and split all other traffic ie the non-MPTCP traffic and the non-MPQUIC traffic of the MA PDU Session by using the ATSSS-LL functionality with any steering mode that can be used with ATSSS-LL as specified in clause 5328 The above steering functionalities are schematically illustrated in the Figure 53261-1 which shows an example model for an ATSSS-capable UE supporting the MPTCP functionality the MPQUIC functionality and the ATSSS-LL functionality The MPTCP flows and the MPQUIC flows in this figure represent the traffic of the applications for which MPTCP can be applied and for which MPQUIC can be applied respectively",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1506",
    "document_id": "23501-i80",
    "chunk_id": 1506,
    "text": "The five different IP addresses illustrated in the UE are further described in clause 532621 and in clause 532622 When the MPTCP functionality and the MPQUIC functionality are both applied the addresses IP1 IP2 used for MPTCP may be the same as the addresses IP4 IP5 used for MPQUIC The Low-Layer in this figure contains functionality that operates below the IP layer eg different network interfaces in the UE while the High-Layer contains functionality that operates above the IP layer Figure 53261-1 Steering functionalities in an example UE model Within the same MA PDU Session in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1507",
    "document_id": "23501-i80",
    "chunk_id": 1507,
    "text": "it is possible to steer the MPTCP flows by using the MPTCP functionality to steer the MPQUIC flows by using the MPQUIC functionality and simultaneously to steer all other flows by using the ATSSS-LL functionality For the same packet flow only one steering functionality shall be used All steering functionalities in the UE shall take ATSSS decisions ie decide how to steer switch and split the traffic by using the same set of ATSSS rules Similarly all ATSSS decisions in the UPF shall be taken by applying the same set of N4 rules which support ATSSS The ATSSS rules and the N4 rules supporting ATSSS are provisioned in the UE and in the UPF respectively when the MA PDU Session is established If the UE supports multiple steering functionalities eg both the MPTCP functionality and the ATSSS-LL functionality both the MPQUIC functionality and the ATSSS-LL functionality or the MPTCP functionality the MPQUIC functionality and the ATSSS-LL functionality it shall use the provisioned ATSSS rules see TS 23503 45 to decide which steering functionality to apply for a specific packet flow 53262 High-Layer Steering Functionalities 532621 MPTCP Functionality As mentioned in clause 53261 the MPTCP functionality in the UE applies the MPTCP protocol IETF RFC 8684 81 and the provisioned ATSSS rules for performing access traffic steering switching and splitting The MPTCP functionality in the UE may communicate with the MPTCP Proxy functionality in the UPF using the user plane of the 3GPP access or the non-3GPP access or both The MPTCP functionality may be enabled in the UE when the UE provides an MPTCP capability during PDU Session Establishment procedure The network shall not enable the MPTCP functionality when the type of the MA PDU Session is Ethernet If the UE indicates it is capable of supporting the MPTCP functionality as described in clause 5322 and the network agrees to enable the MPTCP functionality for the MA PDU Session then i An associated MPTCP Proxy functionality is enabled in the UPF for the MA PDU Session by MPTCP functionality indication received in the Multi-Access Rules MAR ii",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1508",
    "document_id": "23501-i80",
    "chunk_id": 1508,
    "text": "The network allocates to UE one IP addressprefix for the MA PDU Session and two additional IP addressesprefixes called MPTCP link-specific multipath addressesprefixes one associated with 3GPP access and another associated with the non-3GPP access In the UE these two IP addressesprefixes are used only by the MPTCP functionality Each MPTCP link-specific multipath addressprefix assigned to UE may not be routable via N6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1509",
    "document_id": "23501-i80",
    "chunk_id": 1509,
    "text": "The MPTCP functionality in the UE and the MPTCP Proxy functionality in the UPF shall use the MPTCP link-specific multipath addressesprefixes for subflows over non-3GPP access and over 3GPP access and MPTCP Proxy functionality shall use the IP addressprefix of the MA PDU session for the communication with the final destination In Figure 53261-1 the IP3 corresponds to the IP address of the MA PDU Session and the IP1 and IP2 correspond to the MPTCP link-specific multipath IP addresses The following UE IP address management applies - The MA PDU IP addressprefix shall be provided to the UE via mechanisms defined in clause 5822 - The MPTCP link-specific multipath IP addressesprefixes shall be allocated by the UPF and shall be provided to the UE via SM NAS signalling NOTE 1 After the MA PDU Session is released the same UE IP addressesprefixes are not allocated to another UE for MA PDU Session in a short time NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1510",
    "document_id": "23501-i80",
    "chunk_id": 1510,
    "text": "The act of the UPF performing translation on traffic associated with the MPTCP link-specific multipath addresses tofrom the MA PDU session IP address can lead to TCP port collision and exhaustion The port collision can potentially occur because the UE also uses the MA PDU session IP address for non-MPTCP traffic and this causes the port namespace of such address to be owned simultaneously by the UE and UPF In addition the port exhaustion can potentially occur when the UE creates a large number of flows because multiple IP addresses used by the UE are mapped to a single MA PDU session IP address on the UPF The UPF needs to consider these problems based on the UPF implementation and avoid them by for example using additional N6-routable IP addresses for traffic associated to the link-specific multipath addressesprefixes How this is done is left to the implementation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1511",
    "document_id": "23501-i80",
    "chunk_id": 1511,
    "text": "iii The network shall send MPTCP proxy information to UE ie the IP address a port number and the type of the MPTCP proxy The following type of MPTCP proxy shall be supported in this release - Type 1 Transport Converter as defined in IETF RFC 8803 82 The MPTCP proxy information is retrieved by the SMF from the UPF during N4 session establishment The UE shall support the client extensions specified in IETF RFC 8803 82 iv The network may indicate to UE the list of applications for which the MPTCP functionality should be applied This is achieved by using the Steering Functionality component of an ATSSS rule see clause 5328 NOTE 3 To protect the MPTCP proxy function eg to block DDOS to the MPTCP proxy function the IP addresses of the MPTCP Proxy Function are only accessible from the two MPTCP link-specific multipath IP addresses of the UE via the N3N9 interface v",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1512",
    "document_id": "23501-i80",
    "chunk_id": 1512,
    "text": "When the UE indicates it is capable of supporting the MPTCP functionality with any steering mode and the ATSSS-LL functionality with only the Active-Standby steering mode as specified in clause 53261 and these functionalities are enabled for the MA PDU Session then the UE shall route via the MA PDU Session the TCP traffic of applications for which the MPTCP functionality should be applied ie the MPTCP traffic as defined in bullet iv The UE may route all other traffic ie the non-MPTCP traffic via the MA PDU Session but this type of traffic shall be routed on one of 3GPP access or non-3GPP access based on the received ATSSS rule for non-MPTCP traffic see clause 5322 The UPF shall route all other traffic ie non-MPTCP traffic based on the N4 rules provided by the SMF This may include N4 rules for ATSSS-LL using any steering mode as instructed by the N4 rules 532622 MPQUIC Functionality",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1513",
    "document_id": "23501-i80",
    "chunk_id": 1513,
    "text": "The MPQUIC functionality enables steering switching and splitting of UDP traffic between the UE and UPF in accordance with the ATSSS policy created by the network The operation of the MPQUIC functionality is based on RFC 9298 170 proxying UDP in HTTP which specifies how UDP traffic can be transferred between a client UE and a proxy UPF using the RFC 9114 171 HTTP3 protocol The HTTP3 protocol operates on top of the QUIC protocol RFC 9000 166 RFC 9001 167 RFC 9002 168 which supports simultaneous communication over multiple paths as defined in draft-ietf-quic-multipath 174 The MPQUIC functionality in the UE communicates with the MPQUIC Proxy functionality in the UPF see Figure 4210-1 using the user plane of the 3GPP access or the non-3GPP access or both The MPQUIC functionality may be enabled for an MA PDU Session with type IPv4 IPv6 or IPv4v6 when both the UE and the network support this functionality",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1514",
    "document_id": "23501-i80",
    "chunk_id": 1514,
    "text": "The MPQUIC functionality shall not be enabled when the type of the MA PDU Session is Ethernet The MPQUIC functionality is composed of three components 1 QoS flow selection Steering mode selection This component in the UE initiates the establishment of one or more multipath QUIC connections after the establishment of the MA PDU Session and for each uplink UDP flow it selects a QoS flow based on the QoS rules a steering mode and a transport mode based on the ATSSS rules This component in the UPF selects for each downlink UDP flow a QoS flow based on the N4 rules a steering mode and a transport mode based on the N4 rules The supported transport modes are defined below In the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1515",
    "document_id": "23501-i80",
    "chunk_id": 1515,
    "text": "this component is only used in the uplink direction while in the UPF this component is only used in the downlink direction 2 HTTP3 layer Supports the HTTP3 protocol defined in RFC 9114 171 and the extensions defined in - RFC 9298 170 for supporting UDP proxying over HTTP - RFC 9297 172 for supporting HTTP datagrams and - RFC 9220 173 for supporting Extended CONNECT The HTTP3 layer selects a multipath QUIC connection to be used for each UDP flow and allocates a new QUIC stream on this connection that is associated with the UDP flow It also configures this QUIC stream to apply a specific steering mode In the UE the HTTP3 layer implements an HTTP3 client while in the UPF it implements an HTTP3 proxy 3 QUIC layer Supports the QUIC protocol as defined in the applicable IETF specifications RFC 9000 166 RFC 9001 167 RFC 9002 168 and the extensions defined in - RFC 9221 169 for supporting unreliable datagram transport with QUIC and - draft-ietf-quic-multipath 174 for supporting QUIC connections using multiple paths simultaneously When the MPQUIC functionality is applied the protocol stack of the user plane is depicted in figure below Figure 532622-1 UP protocol stack when the MPQUIC functionality is applied If the UE indicates that it is capable of supporting the MPQUIC functionality as described in clause 5322 and the network agrees to enable the MPQUIC functionality for the MA PDU Session then i An associated MPQUIC Proxy functionality is enabled in the UPF for the MA PDU Session ii",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1516",
    "document_id": "23501-i80",
    "chunk_id": 1516,
    "text": "The network allocates to UE one IP addressprefix for the MA PDU Session and two additional IP addressesprefixes called MPQUIC link-specific multipath addressesprefixes one associated with 3GPP access and another associated with the non-3GPP access In the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1517",
    "document_id": "23501-i80",
    "chunk_id": 1517,
    "text": "these two IP addressesprefixes are used only by the MPQUIC functionality Each MPQUIC link-specific multipath addressprefix assigned to UE may not be routable via N6 The MPQUIC functionality in the UE and the MPQUIC Proxy functionality in the UPF shall use the MPQUIC link-specific multipath addressesprefixes for transmitting UDP flows over non-3GPP access and over 3GPP access The MPQUIC Proxy functionality shall use the IP addressprefix of the MA PDU session for the communication with the final destination In Figure 53261-1 the IP3 corresponds to the IP address of the MA PDU Session and the IP4 and IP5 correspond to the MPQUIC link-specific multipath addresses The following UE IP address management applies - The MA PDU IP addressprefix shall be provided to the UE via mechanisms defined in clause 5822 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1518",
    "document_id": "23501-i80",
    "chunk_id": 1518,
    "text": "The MPQUIC link-specific multipath IP addressesprefixes shall be allocated by the UPF and shall be provided to the UE via SM NAS signalling NOTE 1 After the MA PDU Session is released the same UE IP addressesprefixes are not allocated to another UE for MA PDU Session in a short time iii The network shall send MPQUIC proxy information to UE ie one IP address of UPF one UDP port number and the proxy type eg connect-udp This information is used by the UE for establishing multipath QUIC connections with the UPF which implements the MPQUIC Proxy functionality iv After the MA PDU Session is established the UE determines the number of multipath QUIC connections to be established with the UPF The UE determines to establish at least as many multipath QUIC connections as the number of QoS flows of the MA PDU Session ie one multipath QUIC connection per QoS flow Each multipath QUIC connection carries the UDP traffic mapped to a single QoS flow Security aspects are defined in TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1519",
    "document_id": "23501-i80",
    "chunk_id": 1519,
    "text": "For the downlink traffic to which the MPQUIC functionality is to be applied the QoS rules provided to UE include downlink QoS information and the UE applies the downlink QoS information to establish multipath QUIC connections for the QoS flows used for the downlink traffic only v During a QUIC connection establishment the UE and UPF negotiate QUIC transport parameters and indicate a support of QUIC Datagram frames and b support of multipath They indicate support of QUIC Datagram frames by providing the max_datagram_frame_size transport parameter with a non-zero value see RFC 9221 169 and they indicate support of multipath by providing the enable_multipath transport parameter see draft-ietf-quic-multipath 174",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1520",
    "document_id": "23501-i80",
    "chunk_id": 1520,
    "text": "In addition during a QUIC connection establishment the QoS flow associated with this connection is determined The UE sends all traffic of a QUIC connection over the QoS flow associated with this QUIC connection This enables the UPF to determine the QoS flow associated with a QUIC connection and to select a QUIC connection for sending the downlink traffic of a QoS flow vi After a QUIC connection establishment the HTTP3 client in the UE and the HTTP3 proxy in the UPF negotiate HTTP settings and indicate support of HTTP Datagrams see RFC 9297 172 and support of Extended CONNECT see RFC 9220 173 To use MPQUIC proxying for a UDP traffic flow the UE then sends a HTTP3 CONNECT request see RFC 9298 170 to the HTTP3 proxy in the UPF vii The network may indicate to UE the list of applications for which the MPQUIC functionality should be applied This is achieved by using the Steering Functionality component of an ATSSS rule see clause 5328 5326221 Supported Transport Modes",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1521",
    "document_id": "23501-i80",
    "chunk_id": 1521,
    "text": "The MPQUIC functionality supports the following transport modes for transmitting a UDP flow between UE and UPF The PCF selects which of these transport modes shall be applied for a UDP flow SDF The selected transport mode is provided to UE and UPF within the ATSSS rules and N4MAR rules respectively - Datagram mode 2 This transport mode is the mode defined in RFC 9298 170 It encapsulates UDP packets within QUIC Datagram frames and provides unreliable transport with no sequence numbering and no packet reordering deduplication - Datagram mode 1 This transport mode is an extension of the mode defined in RFC 9298 170",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1522",
    "document_id": "23501-i80",
    "chunk_id": 1522,
    "text": "It encapsulates UDP packets within QUIC Datagram frames and provides unreliable transport but with sequence numbering and with packet reordering deduplication It can be applied for any UDP flow The details of the datagram mode 1 are defined in TS 24193 109 - Stream mode This transport mode is readily supported by the QUIC protocol It encapsulates UDP packets within QUIC Stream frames and provides reliable transport with sequence numbering and with packet reordering deduplication It can be applied for UDP flows where it is known that the application does not perform retransmissions NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1523",
    "document_id": "23501-i80",
    "chunk_id": 1523,
    "text": "The Stream mode provides strict reliability and in-order delivery with re-transmissions and therefore can lead to melt down phenomena when reliable traffic eg QUIC is carried or counteracts application decisions when UDP is selected to avoid reliability andor in-order delivery Therefore it can be avoided for applications which perform their own reliability mechanisms NOTE 2 When a steering mode is supported by ATSSS-LL for a UDP flow eg Active-Standby the MPQUIC steering functionality can be selected if additional features which are not supported by the ATSSS-LL steering functionality and PMF are required for the traffic steeringswitchingsplitting of the UDP flow 53263 Low-Layer Steering Functionalities 532631 ATSSS-LL Functionality The ATSSS-LL functionality in the UE does not apply a specific protocol It is a data switching function which decides how to steer switch and split the uplink traffic across 3GPP and non-3GPP accesses based on the provisioned ATSSS rules and local conditions eg signal loss conditions The ATSSS-LL functionality in the UE may be applied to steer switch and split all types of traffic including TCP traffic UDP traffic Ethernet traffic etc The ATSSS-LL functionality does not support the Redundant Steering Mode The ATSSS-LL functionality may be enabled in the UE when the UE provides an ATSSS-LL capability during the PDU Session Establishment procedure The ATSSS-LL functionality is mandatory in the UE for MA PDU Session of type Ethernet",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1524",
    "document_id": "23501-i80",
    "chunk_id": 1524,
    "text": "In addition - When the UE neither supports the MPTCP functionality nor the MPQUIC functionality the ATSSS-LL functionality is mandatory in the UE for an MA PDU Session of type IP - When the UE supports the MPTCP functionality and does not support the MPQUIC functionality the ATSSS-LL functionality with Active-Standby Steering Mode is mandatory in the UE for an MA PDU Session of type IP to support non-MPTCP traffic - When the UE supports the MPQUIC functionality and does not support the MPTCP functionality the ATSSS-LL functionality with Active-Standby Steering Mode is mandatory in the UE for an MA PDU Session of type IP to support non-MPQUIC traffic - When the UE supports both the MPTCP functionality and the MPQUIC functionality the ATSSS-LL functionality with Active-Standby Steering Mode is mandatory in the UE for an MA PDU Session of type IP to support non-MPTCP and non-MPQUIC traffic The network shall also support the ATSSS-LL functionality as defined for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1525",
    "document_id": "23501-i80",
    "chunk_id": 1525,
    "text": "The ATSSS-LL functionality in the UPF is enabled for a MA PDU Session by ATSSS-LL functionality indication received in the Multi-Access Rules MAR 5327 Interworking with EPS 53271 General Multi-access connectivity using ATSSS established via EPC only is not supported Interworking for MA PDU Session if allowed by the network is based on the interworking functionality specified in clause 5172 with the differences and clarifications described in the following clauses A PDN Connection in EPS may be modified into a MA PDU Session when transferred to 5GS if the UE and the SMFPGW-C support the ATSSS feature 53272 Interworking with N26 Interface Interworking with N26 interface is based on clause 51722 with the following differences and clarifications - When the UE is registered to the same PLMN over 3GPP and non-3GPP accesses and the UE request a new MA PDU Session via non-3GPP access the AMF also includes the indication of interworking with N26 to SMF - The SMF does not request EBI allocation when MA PDU Session is established only over non-3GPP access If MA PDU Session is released over 3GPP access the allocated EBIs for the MA PDU Session is revoked by the SMF as described in clause 411143 of TS 23502 3 - The SMF does not request EBI allocation for GBR QoS Flow if the GBR QoS Flow is only allowed over non-3GPP access - If the UE and the network support MA PDU Sessions with 3GPP access connected to EPC the MA PDU Session may be simultaneously associated with user-plane resources on 3GPP access network connected to EPC and with non-3GPP access network connected to 5GC This case is further described in clause 5321 and in clause 42223 of TS 23502 3 - If the UE or the network does not support MA PDU Session with 3GPP access connected to EPC the MA PDU Session is handled as follows -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1526",
    "document_id": "23501-i80",
    "chunk_id": 1526,
    "text": "When UE moves from 5GS to EPS for both idle mode and connected mode mobility if the MA PDU Session is moved to EPS as a PDN connection the SMF triggers PDU Session Release procedure to release the MA PDU Session over Non-3GPP access in 5GS UE and SMF remove ATSSS related contexts eg ATSSS rules Measurement Assistance Information - When UE moves from 5GS to EPS for both idle mode and connected mode mobility if the MA PDU Session is not moved to EPS as a PDN connection the 3GPP access of this MA PDU session becomes unavailable and the AMF notifies the SMF In turn the SMF may decide to move the traffic to Non-3GPP access of the MA PDU session if it is available When UE moves back from EPS to 5GS after the UE is registered over the 3GPP the UE may add user-plane resources over the 3GPP access to the MA PDU session by triggering PDU Session Establishment procedure as specified in clause 5322 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1527",
    "document_id": "23501-i80",
    "chunk_id": 1527,
    "text": "After UE moves from EPS to 5GS for both idle mode and connected mode mobility if the UE requires MA PDU session or if no policy in the UE eg no URSP rule and no local restrictions mandate a single access for the PDU Session UE triggers the PDU Session Modification procedure as described in clause 42263 of TS 23502 3 to provide the ATSSS Capability to SMFPGW-C The SMFPGW-C may determine whether to modify this PDU Session to a MA PDU Session in 5GS eg based on SMFPGW-C and UEs ATSSS Capability subscription data and local policy If dynamic PCC is to be used for the MA PDU Session the PCF decides whether the MA PDU session is allowed or not based on operator policy and subscription data If the MA PDU Session is allowed the SMF provides ATSSS rules and Measurement Assistance Information to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1528",
    "document_id": "23501-i80",
    "chunk_id": 1528,
    "text": "If the UE receives ATSSS rules and is not registered to non-3GPP access the UE establishes the second user-plane over non-3GPP access after the UE is registered to non-3GPP access If UE was registered to non-3GPP access in 5GS the UP resources over non-3GPP access are also established by the SMF using the PDU Session Modification procedure - If the MA PDU Session is established using one 3GPP access path via 5GC and one non-3GPP access path via ePDGEPC and the UE moves from NG-RAN5GC to E-UTRANEPC the SMFPGW-C may keep the MA PDU Session if MA PDU Sessions with 3GPP access and non-3GPP access user plane resources both connected to EPC is allowed based on operator policy - If the MA PDU Session is established using one 3GPP access path via 5GC and one non-3GPP access path via ePDGEPC and the UE moves from NG-RAN5GC to E-UTRANEPC the SMFPGW-C may release the user plane resources either over 3GPP access or non-3GPP access if MA PDU Sessions with 3GPP access and non-3GPP access user plane resources both connected to EPC is not allowed based on operator policy In this case while the UE is connected to EPC via both 3GPP access and non-3GPP access the UE shall not trigger PDN Connection establishment to add an additional EPC access leg to the MA PDU Session 53273 Interworking without N26 Interface Interworking without N26 interface is based on clause 51723 with the following differences and clarifications - After UE moves from 5GS to EPS UE may send a PDN Connectivity Request with handover indication to transfer the MA PDU Session to EPS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1529",
    "document_id": "23501-i80",
    "chunk_id": 1529,
    "text": "Then if the UE or the network does not support MA PDU Session with 3GPP access connected to EPC the SMFPGW-C triggers to release MA PDU in 5GS If UE does not transfer the MA PDU Session to EPS UE keeps the MA PDU Session in 5GS and UE may report to UPF that 3GPP access is unavailable all MA PDU Session traffic is transported over N3GPP access Later if UE returns to 5GS UE may report the 3GPP access availability to UPF If the UE and the network support MA PDU Session with 3GPP access connected to EPC the UE includes a handover indication and a MA PDU Request indication as well as the PDU Session ID in the PCO and the SMFPGW-C keeps the user-plane resources over non-3GPP access in 5GC as described in clause 422625 of TS 23502 3 - After UE moves from EPS to 5GS UE may trigger PDU Session Establishment procedure to transfer the PDN Connection to 5GS During the PDU Session Establishment procedure if the PDN Connection was not used as the 3GPP access leg of the MA PDU Session the UE may request to establish a MA PDU Session by including MA PDU Request or if no policy in the UE eg no URSP rule and no local restrictions mandate a single access for the PDU Session the UE may include the MA PDU Network-Upgrade Allowed indication 5328",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1530",
    "document_id": "23501-i80",
    "chunk_id": 1530,
    "text": "ATSSS Rules As specified in clause 5323 after the establishment of a MA PDU Session the UE receives a prioritized list of ATSSS rules from the SMF The structure of an ATSSS rule is specified in Table 5328-1 Table 5328-1 Structure of ATSSS Rule The UE evaluates the ATSSS rules in priority order Each ATSSS rule contains a Traffic Descriptor containing one or more components described in Table 5328-1 that determines when the rule is applicable An ATSSS rule is determined to be applicable when every component in the Traffic Descriptor matches the considered service data flow SDF Depending on the type of the MA PDU Session the Traffic Descriptor may contain the following components the details of the Traffic Descriptor generation are described in clause 5323 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1531",
    "document_id": "23501-i80",
    "chunk_id": 1531,
    "text": "For IPv4 or IPv6 or IPv4v6 type Application descriptors andor IP descriptors - For Ethernet type Application descriptors andor Non-IP descriptors One ATSSS rule with a match all Traffic Descriptor may be provided which matches all SDFs When provided it shall have the least Rule Precedence value so it shall be the last one evaluated by the UE NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1532",
    "document_id": "23501-i80",
    "chunk_id": 1532,
    "text": "The format of the match all Traffic descriptor of an ATSSS rule is defined in stage-3 Each ATSSS rule contains an Access Selection Descriptor that contains the following components - A Steering Mode which determines how the traffic of the matching SDF should be distributed across 3GPP and non-3GPP accesses The following Steering Modes are supported - Active-Standby It is used to steer a SDF on one access the Active access when this access is available and to switch the SDF to the available other access the Standby access when Active access becomes unavailable When the Active access becomes available again the SDF is switched back to this access If the Standby access is not defined then the SDF is only allowed on the Active access and cannot be transferred on another access - Smallest Delay It is used to steer a SDF to the access that is determined to have the smallest Round-Trip Time RTT As defined in clause 5325 measurements may be obtained by the UE and UPF to determine the RTT over 3GPP access and over non-3GPP access In addition if one access becomes unavailable all SDF traffic is switched to the other available access It can only be used for the Non-GBR SDF - Load-Balancing It is used to split a SDF across both accesses if both accesses are available It contains the percentage of the SDF traffic that should be sent over 3GPP access and over non-3GPP access Load-Balancing is only applicable to Non-GBR SDF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1533",
    "document_id": "23501-i80",
    "chunk_id": 1533,
    "text": "In addition if one access becomes unavailable all SDF traffic is switched to the other available access as if the percentage of the SDF traffic transported via the available access was 100 - Priority-based It is used to steer all the traffic of an SDF to the high priority access until this access is determined to be congested In this case the traffic of the SDF is sent also to the low priority access ie the SDF traffic is split over the two accesses In addition when the high priority access becomes unavailable all SDF traffic is switched to the low priority access How UE and UPF determine when a congestion occurs on an access is implementation dependent It can only be used for the Non-GBR SDF - Redundant without Threshold Values It is used to duplicate traffic of an SDF on both accesses if both accesses are available A Primary Access either 3GPP access or Non-3GPP access may be provided to the UE in the ATSSS rules and to the UPF in the N4 rules If a Primary Access is provided UE and UPF shall send all data packets of the SDF on the Primary Access and may duplicate data packets of the SDF on the other access How many and which data packets are duplicated by UE and UPF on the other access is based on implementation If the Primary Access is not provided to UE and UPF the UE and UPF shall send all data packets of the SDF on both accesses It can be used for GBR and Non-GBR SDF - A Steering Mode Indicator which indicates that the UE may change the default steering parameters provided in the Steering Mode component and may adjust the traffic steering based on its own decisions Only one of the following Steering Mode Indicators may be provided - Autonomous load-balance indicator This indicator may be provided only when the Steering Mode is Load-Balancing When provided the UE may ignore the percentages in the Steering Mode component ie the default percentages provided by the network and may autonomously determine its own percentages for traffic splitting in a way that maximizes the aggregated bandwidth in the uplink direction The UE is expected to determine its own percentages for traffic splitting by performing measurements across the two accesses The UPF may apply a similar behaviour when the autonomous load-balance indicator is included in an N4 rule - UE-assistance indicator This indicator may be provided only when the Steering Mode is Load-Balancing When provided by the network it indicates that a the UE may decide how to distribute the UL traffic of the matching SDF based on the UEs internal state eg when the UE is in the special internal state eg lower battery level and that b the UE may inform the UPF how it decided to distribute the UL traffic of the matching SDF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1534",
    "document_id": "23501-i80",
    "chunk_id": 1534,
    "text": "In the normal cases although with this indicator provided the UE shall distribute the UL traffic as indicated by the network NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1535",
    "document_id": "23501-i80",
    "chunk_id": 1535,
    "text": "Typically the UE-assistance indicator can be provided for SDFs for which the network has no strong steering requirements For example when the network has no strong steering requirements for the default traffic of an MA PDU Session the network can indicate i that this traffic must be steered with Load-Balancing steering mode using 50 - 50 split percentages and ii that the UE is allowed to use other split percentages such as 0 - 100 if this is needed by the UE to optimize its operation eg to minimize its battery consumption - Threshold Values One or more threshold values may be provided when the Steering Mode is Priority-based or when the Steering Mode is Load-Balancing with fixed split percentages ie without the Autonomous load-balance indicator or UE assistance indicator One threshold value may be provided when the Steering Mode is Redundant A threshold value may be either a value for RTT or a value for Packet Loss Rate",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1536",
    "document_id": "23501-i80",
    "chunk_id": 1536,
    "text": "The threshold values are applicable to both accesses and are applied by the UE and UPF as follows - Load-Balancing Steering Mode with fixed split percentages ie without the Autonomous load-balance indicator or UE assistance indicator When at least one measured parameter ie RTT or Packet Loss Rate on one access exceeds the provided threshold value the UE and UPF may stop sending traffic on this access or may continue sending traffic on this access but should reduce the traffic on this access by an implementation specific amount and shall send the amount of reduced traffic on the other access When all measured parameters ie RTT and Packet Loss Rate for both accesses do not exceed the provided threshold values the UE and UPF shall apply the fixed split percentages - Priority-based Steering Mode When one or more threshold values are provided for the Priority-based Steering Mode these threshold values should be considered by UE and UPF to determine when an access becomes congested For example when a measured parameter ie RTT or Packet Loss Rate on one access exceeds the provided threshold value the UE and UPF may consider this access as congested and send the traffic also to the low priority access - Redundant Steering Mode When the measured Packet Loss Rate exceeds the provided threshold value on both accesses the UE and UPF shall duplicate the traffic of the SDF on both accesses When the measured RTT exceeds the provided threshold value on both accesses the UE and UPF may duplicate the traffic of the SDF on both accesses based on implementation When the measured parameter ie either RTT or Packet Loss Rate exceeds the provided threshold value on one access only the UE and UPF shall send the traffic of the SDF only over the other access When the measured parameter ie either RTT or Packet Loss Rate does not exceed the provided threshold value on any access the UE and UPF shall send the traffic of the SDF only over the Primary Access The Primary Access either 3GPP access or Non-3GPP access may be provided to the UE in the ATSSS rules and to the UPF in the N4 rules If the Primary Access is not provided to the UE and UPF UE and UPF shall select a Primary Access based on their own implementation eg using the lowest RTT access or the lowest Packet Loss Rate access If measurement results on an access are not available for a parameter it is considered that the measured parameter for this access has not exceeded the provided threshold value If a threshold value is provided when the Steering Mode is Redundant the Steering Mode can only be used for Non-GBR SDF - A Steering Functionality which identifies whether the MPTCP functionality or the MPQUIC functionality or the ATSSS-LL functionality should be used to steer the traffic of the matching SDF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1537",
    "document_id": "23501-i80",
    "chunk_id": 1537,
    "text": "This is used when the UE supports multiple functionalities for ATSSS as specified in clause 5326 Support of Steering Functions - A Transport Mode which identifies the transport mode that should be applied by the MPQUIC functionality for the matching traffic The transport modes supported by the MPQUIC functionality are defined in clause 5326221 NOTE 3 There is no need to update the ATSSS rules when one access becomes unavailable or available As an example the following ATSSS rules could be provided to UE a Traffic Descriptor UDP DestAddr 1234 Steering Mode Active-Standby Active3GPP Standbynon-3GPP - This rule means steer UDP traffic with destination IP address 1234 to the active access 3GPP if available If the active access is not available use the standby access non-3GPP b Traffic Descriptor TCP DestPort 8080 Steering Mode",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1538",
    "document_id": "23501-i80",
    "chunk_id": 1538,
    "text": "Smallest Delay - This rule means steer TCP traffic with destination port 8080 to the access with the smallest delay The UE needs to measure the RTT over both accesses in order to determine which access has the smallest delay c Traffic Descriptor TCP traffic of Application-1 Steering Mode Load-Balancing 3GPP20 non-3GPP80 Steering Functionality MPTCP - This rule means send 20 of the TCP traffic of Application-1 to 3GPP access and 80 to non-3GPP access by using the MPTCP functionality d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1539",
    "document_id": "23501-i80",
    "chunk_id": 1539,
    "text": "Traffic Descriptor TCP traffic of Application-1 Steering Mode Load-Balancing 3GPP20 non-3GPP80 Threshold Value for Packet Loss Rate 1 Steering Functionality MPTCP - This rule means send 20 of the TCP traffic of Application-1 to 3GPP access and 80 to non-3GPP access as long as the Packet Loss Rate does not exceed 1 on both accesses by using the MPTCP functionality If the measured Packet Loss Rate of an access exceeds 1 then the TCP traffic of Application-1 may be reduced on this access and sent via the other access e Traffic Descriptor UDP traffic of Application-1 Steering Mode Load-Balancing 3GPP30 non-3GPP70 Steering Functionality MPQUIC Transport Mode Datagram mode 1 - This rule means send 30 of the UDP traffic of Application-1 to 3GPP access and 70 to non-3GPP access by using the MPQUIC functionality with the Datagram mode 1 f Traffic Descriptor comexampleapp0 TCP Steering Mode Redundant Steering Functionality MPTCP - This rule means traffic duplication is applied by the MPTCP steering functionality to the TCP traffic of application comexampleapp0 and 100 of the traffic is duplicated over both accesses g Traffic Descriptor comexampleapp1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1540",
    "document_id": "23501-i80",
    "chunk_id": 1540,
    "text": "TCP Steering Mode Redundant Primary Access3GPP Threshold Value for Packet Loss Rate 01 Steering Functionality MPTCP - This rule means traffic duplication is applied to the TCP traffic of application comexampleapp1 If the measured PLR exceeds 01 on both accesses all matched traffic is duplicated on both accesses If the measured PLR exceeds 01 on one access only either 3GPP or non-3GPP access all matched traffic is sent over the other access only If the measured PLR does not exceed 01 on any access all matched traffic is sent over 3GPP access only as this is the Primary Access h Traffic Descriptor comexampleapp2 TCP Steering Mode Redundant Threshold Value for Packet Loss Rate 01 Steering Functionality MPTCP - This rule means traffic duplication is applied to the TCP traffic of application comexampleapp2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1541",
    "document_id": "23501-i80",
    "chunk_id": 1541,
    "text": "If the measured PLR exceeds 01 on both accesses all matched traffic is duplicated and transmitted on both accesses If the measured PLR exceeds 01 on one access only either 3GPP or non-3GPP access all matched traffic is sent over the other access only If the measured PLR does not exceed 01 on any access the UE or UPF selects the access based on their own implementation eg the access with lower Packet Loss Rate to transmit all matched traffic 533 Support for Ultra Reliable Low Latency Communication 5331 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1542",
    "document_id": "23501-i80",
    "chunk_id": 1542,
    "text": "The following features described in 533 may be used to enhance 5GS to support Ultra Reliable Low Latency Communication URLLC - Redundant transmission for high reliability communication In this Release URLLC applies to 3GPP access only When a PDU Session is to serve URLLC QoS Flow the UE and SMF should establish the PDU Session as always-on PDU Session as described in clause 5613 NOTE 1 How the UE knows whether a PDU Session is to serve a URLLC QoS Flow when triggering PDU Session establishment is up to UE implementation NOTE 2 No additional functionality is specified for URLLC in order to support Home Routed roaming scenario in this Release 5332 Redundant transmission for high reliability communication 53321 Dual Connectivity based end to end Redundant User Plane Paths",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1543",
    "document_id": "23501-i80",
    "chunk_id": 1543,
    "text": "In order to support highly reliable URLLC services a UE may set up two redundant PDU Sessions over the 5G network such that the 5GS sets up the user plane paths of the two redundant PDU Sessions to be disjoint The users subscription indicates if user is allowed to have redundant PDU Sessions and this indication is provided to SMF from UDM NOTE 1 It is out of scope of 3GPP how to make use of the duplicate paths for redundant traffic delivery end-to-end It is possible to rely on upper layer protocols such as the IEEE 8021 TSN Time Sensitive Networking FRER Frame Replication and Elimination for Reliability 83 to manage the replication and elimination of redundant packetsframes over the duplicate paths which can span both the 3GPP segments and possibly fixed network segments as well NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1544",
    "document_id": "23501-i80",
    "chunk_id": 1544,
    "text": "The following redundant network deployment aspects are within the responsibility of the operator and are not subject to 3GPP standardization - RAN supports dual connectivity and there is sufficient RAN coverage for dual connectivity in the target area - UEs support dual connectivity - The core network UPF deployment is aligned with RAN deployment and supports redundant user plane paths - The underlying transport topology is aligned with the RAN and UPF deployment and supports redundant user plane paths - The physical network topology and geographical distribution of functions also supports the redundant user plane paths to the extent deemed necessary by the operator - The operation of the redundant user plane paths is made sufficiently independent to the extent deemed necessary by the operator eg independent power supplies Figure 53321-1 illustrates an example user plane resource configuration of dual PDU Sessions when redundancy is applied One PDU Session spans from the UE via Master RAN node to UPF1 acting as the PDU Session Anchor and the other PDU Session spans from the UE via Secondary RAN node to UPF2 acting as the PDU Session Anchor As described in TS 37340 31 NG-RAN may realize redundant user plane resources for the two PDU Sessions with two NG-RAN nodes ie Master RAN node and Secondary RAN node as shown in Figure 53321-1 or a single NG-RAN node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1545",
    "document_id": "23501-i80",
    "chunk_id": 1545,
    "text": "In both cases there is a single N1 interface towards AMF Based on these two PDU Sessions two independent user plane paths are set up UPF1 and UPF2 connect to the same Data Network DN even though the traffic via UPF1 and UPF2 may be routed via different user plane nodes within the DN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1546",
    "document_id": "23501-i80",
    "chunk_id": 1546,
    "text": "In order to establish two redundant PDU Sessions and associate the duplicated traffic coming from the same application to these PDU Sessions URSP as specified in TS 23503 45 may be used or alternatively the UE may perform this task independently from URSP When URSP is used to establish two redundant PDU Sessions duplicated traffic from the application associated to the redundant PDU Sessions is differentiated by two distinct traffic descriptors each in a distinct URSP rule These traffic descriptors need to have different DNNs IP descriptors or non-IP descriptors eg MAC address VLAN ID so that the two redundant PDU Sessions are matched to the Route Selection Descriptors of distinct URSP rules These Route Selection Descriptors of distinct URSP rules may include corresponding RSNs and PDU Session Pair IDs The Route Selection Descriptors share same PDU Session Pair ID if included to denote the two traffic are redundant with each other How does UE determines the PDU Session Pair ID andor RSN from the matched URSP rules is described in clause 662 of TS 23503 45 When the UE performs the establishment of two redundant PDU Sessions and the duplication of traffic independently from URSP the UE may establish two redundant PDU Sessions even when the application does not duplicate the traffic and the application does not provide two distinct traffic descriptors In this case the UE may set the RSN and PDU Session Pair ID in the PDU Session Establishment Request message based on UE implementation NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1547",
    "document_id": "23501-i80",
    "chunk_id": 1547,
    "text": "As an example the UE may use the implementation of FRER Frame Replication and Elimination for Reliability IEEE Std 8021CB-2017 83 in the UEs operating system If the operator decides to allow UE to use its own mechanisms to determine PDU Session Pair ID and RSN where such UE capability is known based on local PCF configuration based on eg deployment terminal implementation or policies per group of UEs then the PCF shall not include PDU Session Pair ID and RSN in URSP rule The redundant user plane set up applies to both IP and Ethernet PDU Sessions Figure 53321-1 Example scenario for end to end redundant User Plane paths using Dual Connectivity Support of redundant PDU Sessions include - UE initiates two redundant PDU Sessions and may provide PDU Session Pair ID optional and the RSN optional Different combinations of RSN DNN and S-NSSAI are used for each PDU Session within a given pair of redundant PDU Sessions Different combinations of PDU Session Pair ID DNN and S-NSSAI are used between the different pairs of redundant PDU Session - The UE may include a PDU Session Pair ID andor RSN in each of the PDU Session establishment Request when it establishes redundant PDU Sessions UE determines the PDU Session Pair ID andor RSN based on UE local mechanism or the matched URSP rules - The SMF determines whether the PDU Session is to be handled redundantly The determination is based on the presence of the PDU Session Pair ID andor RSN in the PDU Session Establishment Request or the determination is based on an indication that redundant PDU Session is required provided by PCF for the PDU Session if dynamic PCC applies for the PDU Session or the combination of the S-NSSAI DNN user subscription and local policy configuration in the SMF if dynamic PCC is not used for the PDU Session If the PDU session is to be handled redundantly and the PDU Session Pair ID was not included in the PDU Session Establishment request the SMF uses S-NSSAI DNN and local configuration to determine the PDU Session Pair ID If the PDU session is to be handled redundantly and RSN was not included in the PDU Session Establishment request the SMF uses S-NSSAI DNN to determine the RSN value The RSN differentiates the PDU Sessions that are handled redundantly and indicates redundant user plane requirements for the PDU Sessions in NG-RAN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1548",
    "document_id": "23501-i80",
    "chunk_id": 1548,
    "text": "The SMF shall provide the RSN and PDU Session Pair ID to the NG-RAN for a redundant PDU Session - Operator configuration of UPF selection ensures the appropriate UPF selection for disjoint paths - At establishment of the PDU Sessions or at transitions to CM-CONNECTED state the RSN parameter indicates to NG-RAN that redundant user plane resources shall be provided for the given PDU Sessions by means of dual connectivity The PDU Session Pair ID identifies the two redundant PDU Sessions that belong together The value of the RSN parameter and the PDU Session Pair ID indicates redundant user plane requirements for the PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1549",
    "document_id": "23501-i80",
    "chunk_id": 1549,
    "text": "This request for redundant handling is made by indicating the RSN to the NG-RAN node on a per PDU Session granularity PDU Sessions associated with different RSN values shall be realized by different redundant UP resources Based on the RSN the PDU Session Pair ID and RAN configuration the NG-RAN sets up dual connectivity as defined in TS 37340 31 so that the sessions have end to end redundant paths When there are multiple PDU Sessions with the RSN parameter set of different values of RSN and the same PDU Session Pair ID this indicates to NG-RAN that CN is requesting dual connectivity to be set up and the user plane shall be handled as indicated by the RSN parameter the PDU Session Pair ID and the associated RAN configuration If the RSN value and PDU Session Pair ID are provided to the NG-RAN NG-RAN shall consider the RSN value and PDU Session Pair ID when it associates the PDU Sessions with NG-RAN UP NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1550",
    "document_id": "23501-i80",
    "chunk_id": 1550,
    "text": "The decision to set up dual connectivity remains in NG-RAN as defined today NG-RAN takes into account the additional request for the dual connectivity setup provided by the CN - Using NG-RAN local configuration NG-RAN determines whether the request to establish RAN resources for a PDU Session is fulfilled or not considering user plane requirements indicated by the RSN parameter and the PDU Session Pair ID by means of dual connectivity If the request to establish RAN resources for PDU Session can be fulfilled by the RAN the PDU Session is established even if the user plane requirements indicated by RSN cannot be satisfied The decision for each PDU Session is taken independently ie rejection of a PDU Session request shall not release the previously established PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1551",
    "document_id": "23501-i80",
    "chunk_id": 1551,
    "text": "The RAN shall determine whether to notify the SMF if the RAN resources indicated by the RSN parameter and the PDU Session Pair ID can no longer be maintained and SMF can use that to determine if the PDU Session should be released - In the case of Ethernet PDU Sessions the SMF has the possibility to change the UPF acting as the PSA and select a new UPF based on the identity of the Secondary RAN node for the second PDU Session if the Secondary RAN node is modified or addedreleased using the Ethernet PDU Session Anchor Relocation procedure described in clause 4358 of TS 23502 3 - The SMFs charging record may reflect the RSN information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1552",
    "document_id": "23501-i80",
    "chunk_id": 1552,
    "text": "The RSN parameter and the PDU Session Pair ID if available is transferred from Source NG-RAN to Target NG-RAN in the case of handover 53322 Support of redundant transmission on N3N9 interfaces If the reliability of NG-RAN node UPF and CP NFs are high enough to fulfil the reliability requirement of URLLC services served by these NFs but the reliability of single N3 tunnel is considered not high enough eg due to the deployment environment of backhaul network the redundant transmission may be deployed between PSA UPF and NG-RAN via two independent N3 tunnels which are associated with a single PDU Session over different transport layer path to enhance the reliability SMF may make use of Redundant Transmission Experience analytics provided by NWDAF as described in clause 613 of TS 23288 86 to determine whether redundant transmission for the PDU session of the URLLC shall be performed or if activated shall be stopped To ensure the two N3 tunnels are transferred via disjointed transport layer paths the SMF or PSA UPF should provide different routing information in the tunnel information eg different IP addresses or different Network Instances and these routing information should be mapped to disjoint transport layer paths according to network deployment configuration The SMF indicates NG-RAN and PSA UPF that one of the two CNAN Tunnel Info is used as the redundancy tunnel of the PDU Session accordingly The redundant transmission using the two N3N9 tunnels are performed at QoS Flow granularity and are sharing the same QoS Flow ID During or after a URLLC QoS Flow establishment if the SMF decided that redundant transmission shall be performed based on authorized 5QI NG-RAN node capability operator configuration andor Redundant Transmission Experience analytics the SMF informs the PSA UPF and NG-RAN to perform redundant transmission via N4 interface and N2 information accordingly In this case NG-RAN should also provide different routing information in the tunnel information eg different IP addresses and these routing information should be mapped to disjoint transport layer paths according to network deployment configuration NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1553",
    "document_id": "23501-i80",
    "chunk_id": 1553,
    "text": "The NG-RAN node capability to support the redundant transmission on N3N9 can be configured in the SMF per network slice or per SMF service area If duplication transmission is performed on N3N9 interface for each downlink packet of the QoS Flow the PSA UPF received from DN the PSA UPF replicates the packet and assigns the same GTP-U sequence number to them for the redundant transmission The NG-RAN eliminates the duplicated packets based on the GTP-U sequence number and then forwards the PDU to the UE For each uplink packet of the QoS Flow the NG-RAN received from UE the NG-RAN replicates the packet and assigns the same GTP-U sequence number to them for redundant transmission These packets are transmitted to the PSA UPF via two N3 Tunnels separately The PSA UPF eliminates the duplicated packet based on the GTP-U sequence number accordingly NOTE 2 How to realize the sequence number for support of GTP-U duplication over N3N9 is up to stage 3 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1554",
    "document_id": "23501-i80",
    "chunk_id": 1554,
    "text": "For redundant transmission on N3N9 interfaces reordering is not required on the receiver side The PSA UPF and NG-RAN may transmit packets via one or both of the tunnels per QoS Flow based on SMF instruction NOTE 4 The AMF selects an SMF supporting redundant transmission based on the requested S-NSSAI andor DNN During UE mobility when the UE moves from NG-RAN supporting redundant transmission to NG-RAN not supporting redundant transmission the SMF may release the QoS Flow which are subject to redundant transmission Figure 53322-1 illustrates the case that the redundant transmission is performed only on N3 interface These packets are transmitted to the NG-RAN via two N3 Tunnels separately The RAN node and PSA UPF shall support the packet replication and elimination function as described above Figure 53322-1 Redundant transmission with two N3 tunnels between the PSA UPF and a single NG-RAN node",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1555",
    "document_id": "23501-i80",
    "chunk_id": 1555,
    "text": "Two Intermediate UPFs I-UPFs between the PSA UPF and the NG-RAN may be used to support the redundant transmission based on two N3 and N9 tunnels between a single NG-RAN node and the PSA UPF The NG-RAN node and PSA UPF shall support the packet replication and elimination function as described above Figure 53322-2 Two N3 and N9 tunnels between NG-RAN and PSA UPF for redundant transmission In figure 53322-2 there are two N3 and N9 tunnels between NG-RAN and PSA UPF for the URLLC QoS Flows of the same PDU Session for redundant transmission established during or after a URLLC QoS Flow establishment In the case of downlink traffic the PSA UPF duplicates the downlink packet of the QoS Flow from the DN and assigns the same GTP-U sequence number to them These duplicated packets are transmitted to I-UPF1 and I-UPF2 via N9 Tunnel 1 and N9 Tunnel 2 separately Each I-UPF forwards the packet with the same GTP-U sequence number which receives from the PSA UPF to NG-RAN via N3 Tunnel 1 and N3 Tunnel 2 respectively The NG-RAN eliminates the duplicated packet based on the GTP-U sequence number In the case of uplink traffic the NG-RAN duplicates the packet of the QoS Flow from the UE and assigns the same GTP-U sequence number to them These duplicated packets are transmitted to I-UPF1 and I-UPF2 via N3 Tunnel 1 and N3 Tunnel 2 separately Each I-UPF forwards the packet with the same GTP-U sequence number which receives from the NG-RAN to PSA UPF via N9 Tunnel 1 and N9 Tunnel 2 respectively The PSA UPF eliminates the duplicated packets based on the GTP-U sequence number The I-UPFs inserted on one leg of the redundant paths shall not behave in an UL CL or Branching Point role 53323 Support for redundant transmission at transport layer Redundant transmission can be supported within the 5G System without making any assumption on support for protocols such as IEEE FRER in the application layer DN only at the same time it can be supported without requiring redundant GTP-U tunnel over N3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1556",
    "document_id": "23501-i80",
    "chunk_id": 1556,
    "text": "The backhaul provides two disjoint transport paths between UPF and NG-RAN The redundancy functionality within NG-RAN and UPF make use of the independent paths at transport layer Support of redundant transmission at transport layer requires no 3GPP protocol impact Following are the required steps - UE establishes the PDU session for URLLC services Based on DNN S-NSSAI knowledge of supporting redundant transmission at transport layer and other factors as described in clause 633 SMF selects a UPF that supports redundant transmission at transport layer for the PDU session One N3 GTP-U tunnel is established between UPF and NG-RAN The knowledge of supporting redundant transmission at transport layer can be configured in the SMF or be configured in UPF and then obtained by the SMF via N4 capability negotiation during N4 Association setup procedure -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1557",
    "document_id": "23501-i80",
    "chunk_id": 1557,
    "text": "For DL data transmission UPF sends the DL packets on N3 GTP-U tunnel Redundant functionality in the UPF duplicates the DL data on the transport layer Redundant functionality in the NG-RAN eliminates the received duplicated DL data and sends to NG-RAN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1558",
    "document_id": "23501-i80",
    "chunk_id": 1558,
    "text": "For UL data transmission NG-RAN sends the received UL packets on N3 GTP-U tunnel the Redundant functionality in the NG-RAN performs the redundant handling on the backhaul transport layer The Redundant functionality in the UPF eliminates the received duplicated UL data and sends to UPF 5333 QoS Monitoring for packet delay 53331 General QoS Monitoring for packet delay can be applied based on 3rd party application request or PCF policy control or both eg to assist URLLC services The packet delay between UE and PSA UPF is a combination of the RAN part of ULDL packet delay as defined in TS 38314 120 and ULDL packet delay between NG-RAN and PSA UPF The NG-RAN is required to provide the QoS monitoring results on the RAN part of ULDL packet delay measurement The measurement of the ULDL packet delay between NG-RAN and PSA UPF can be performed on different levels of granularities ie per QoS Flow per UE level or per GTP-U path level subject to the operators configuration The PCF generates the authorized QoS Monitoring policy for a service data flow based on the QoS Monitoring request received from the AF as described in clause 61321 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1559",
    "document_id": "23501-i80",
    "chunk_id": 1559,
    "text": "The PCF includes the authorized QoS Monitoring policy in the PCC rule and provides it to the SMF When SMF receives the authorized QoS Monitoring policy for packet delay in a PCC rule from the PCF as described in clause 61321 of TS 23503 45 SMF configures the UPFs and NG-RAN to perform delay measurements according to the method selected per QoS Flow per UE QoS measurement as described in clause 53332 or per GTP-U Path measurement as described in clause 53333 The SMF configure the UPF to report the QoS monitoring results for the QoS Flow as described in clause 58218 with parameters determined by the SMF based on the authorized QoS Monitoring policy received from the PCF andor local configuration The UPF reporting behaviour for QoS Monitoring for packet delay of a QoS Flow is the same when per QoS Flow per UE level measurement described further in clause 53332 or when per GTP-U path level measurement described further in clause 53333 is used 53332 Per QoS Flow per UE QoS Measurement SMF may activate the end to end ULDL packet delay measurement between UE and PSA UPF for a QoS Flow during the PDU Session Establishment or Modification procedure The SMF sends a QoS Monitoring request to the PSA UPF via N4 and NG-RAN via N2 signalling to request the QoS monitoring between PSA UPF and NG-RAN The QoS Monitoring request may contain monitoring parameters determined by SMF based on the authorized QoS Monitoring policy received from the PCF andor local configuration The NG-RAN initiates the RAN part of ULDL packet delay measurement based on the QoS Monitoring request from SMF NG-RAN reports the RAN part of ULDL packet delay result to the PSA UPF in the UL data packet or dummy UL packet If the NG-RAN and PSA UPF are time synchronised the one way packet delay monitoring between NG-RAN and PSA UPF is supported If the NG-RAN and PSA UPF are not time synchronised it is assumed that the UL packet delay and the DL packet delay between NG-RAN and PSA UPF are the same For both time synchronised and not time synchronised between NG-RAN and PSA UPF the PSA UPF creates and sends the monitoring packets to the RAN in a measurement frequency decided by the PSA UPF taking the Reporting frequency for QoS Monitoring received from the SMF into account - The PSA UPF encapsulates in the GTP-U header with QFI QoS Monitoring Packet QMP indicator which indicates the packet is used for ULDL packet delay measurement and the local time T1 when the PSA UPF sends out the DL monitoring packets - The NG-RAN records the local time T1 received in the GTP-U header and the local time T2 at the reception of the DL monitoring packets - When receiving an UL packet from UE for that QFI or when the NG-RAN sends a dummy UL packet as monitoring response in case there is no UL service packet for UL packet delay monitoring the NG-RAN encapsulates QMP indicator the RAN part of ULDL packet delay result the time T1 received in the GTP-U header the local time T2 at the reception of the DL monitoring packet and the local time T3 when NG-RAN sends out this monitoring response packet to the UPF via N3 interface in the GTP-U header of the monitoring response packet NOTE 1 When the NG-RAN sends the dummy UL packet as monitoring response to PSA UPF depends on NG-RANs implementation - The PSA UPF records the local time T4 when receiving the monitoring response packets and calculates the round trip if not time synchronized or ULDL packet delay if time synchronized between NG-RAN and anchor PSA UPF based on the time information contained in the GTP-U header of the received monitoring response packet If the NG-RAN and PSA UPF are not time synchronised the PSA UPF calculates the ULDL packet delay between the NG-RAN and the PSA UPF based on the T2-T1T4-T32 If the NG-RAN and PSA UPF are time synchronised the PSA UPF calculates the UL packet delay and DL packet delay between the NG-RAN and the PSA UPF based on T4-T3 and T2-T1 respectively The PSA UPF calculates the ULDL packet delay between UE and PSA UPF based on the received RAN part of ULDL packet delay result and the calculated ULDL packet delay between RAN and PSA UPF NOTE 2 If the NG-RAN and PSA UPF are not time synchronised it can cause inaccurate result of ULDL packet delay - The PSA UPF reports the QoS Monitoring results as described in clause 58218 If the redundant transmission on N3N9 interfaces is activated the UPF and NG-RAN performs QoS monitoring for both UP paths The UPF reports the packet delays of the two UP paths independently to the SMF 53333 GTP-U Path Measurement",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1560",
    "document_id": "23501-i80",
    "chunk_id": 1560,
    "text": "The SMF can request to activate QoS monitoring for the GTP-U paths between all UPFs and the RAN based on locally configured policies Alternatively when a QoS monitoring policy is received in a PCC rule and the QoS monitoring is not yet active for the DSCP corresponding to the 5QI in the PCC rule the SMF activates QoS Monitoring for all UPFs currently in use for this PDU Session and the RAN In this case the SMF performs the QoS Flow Binding without taking the QoS Monitoring Policy within the PCC rule into account The SMF sends the QoS monitoring policy to each involved UPF and the RAN via N4 interface and via N2 interface respectively NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1561",
    "document_id": "23501-i80",
    "chunk_id": 1561,
    "text": "The PCC rule containing a QoS monitoring policy is just a trigger for the SMF to instruct the UPFs to initiate the GTP-U based QoS Monitoring A GTP-U sender performs an estimation of RTT to a GTP-U receiver on a GTP-U path by sending Echo messages and measuring time that elapses between the transmission of Request message and the reception of Response message A GTP-U sender computes an accumulated packet delay by adding RTT2 the processing time and if available an accumulated packet delay from an upstream GTP-U sender ie an immediately preceding GTP-U sender in user plane path thus the measured accumulated packet delay represents an estimated elapsed time since a user plane packet entered 3GPP domain It is expected that a GTP-U sender determines RTT periodically in order to detect changes in transport delays QoS monitoring is performed by a GTP-U end-point UP function that receives stores and executes the QoS monitoring policy as described below for a QoS Flow QoS monitoring is performed by comparing a measured accumulated packet delay with the stored parameters If the GTP-U end-point the PSA UPF in the case of accumulated packet delay reporting determines that the packet delay exceeds the value of a stored parameter then the node triggers QoS monitoring alert signalling to the relevant SMF or to the OAM function as further described in TS 29244 65 NOTE 2 Echo Request message and Echo Response message are sent outside GTP-U tunnels the messages are using TEID set to 0",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1562",
    "document_id": "23501-i80",
    "chunk_id": 1562,
    "text": "If underlying transport is using QoS differentiation eg IP DiffServ then it is up to the implementation to ensure that the Echo messages are classified correctly and receive similar treatment by the underlaying transport as GTP-U GTP-PDUs carrying QoS Flows user data When QoS Monitoring is used to measure the packet delay for a QoS Flow the following applies - Packet delay measurement is performed by using GTP-U Echo RequestResponse as defined in the TS 28552 108 in the corresponding user plane transport paths independent of the corresponding PDU Session and the 5QI for a given QoS Flow - RAN measures and provides the RAN part of ULDL packet delay towards UPF in the GTP-U header of the respective QoS Flow via N3 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1563",
    "document_id": "23501-i80",
    "chunk_id": 1563,
    "text": "The UPF calculates the ULDL packet delay by combining the received measurements of RAN part with the measurements of N3N9 interface N9 is applicable when I-UPF exists - The UPF reports the QoS Monitoring results as described in clause 58218 QoS Monitoring can also be used to measure the packet delay for transport paths to influence the mapping of QoS Flows to appropriate network instances DSCP values as follows - SMF activates QoS monitoring for the GTP-U paths between all UPFs and all RAN nodes based on locally configured policies - UPF does measurement of network hop delay per transport resources that it will use towards a peer network node identified by an IP destination address the hop between these two nodes and port The network hop measured delay is computed by sending an Echo Request over such transport resource Ti and measuring RTT2 when Echo Response is received - UPF maps network instance DSCP into Transport Resource and measures delay per IP destination address and port",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1564",
    "document_id": "23501-i80",
    "chunk_id": 1564,
    "text": "Thus for each IP destination address the measured delay per network instance DSCP entry is determined - The UPF performing the QoS monitoring can provide the corresponding Network instance DSCP along with the measured accumulated packet delay for the corresponding transport path to the SMF The UPF reports the measurement results to the SMF based on some specific conditions eg first time periodic event triggered when thresholds for reporting towards SMF via N4 are reached - Based on this SMF can determine QoS Flow mapping to the appropriate Network instance DSCP considering 5QI QoS characteristics ARP for the given QoS Flow 534 Support of deployments topologies with specific SMF Service Areas 5341 General When the UE is outside of the SMF Service Area or current SMF cannot serve the target DNAI for the traffic routing for local access to the DN an I-SMF is inserted between the SMF and the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1565",
    "document_id": "23501-i80",
    "chunk_id": 1565,
    "text": "The I-SMF has a N11 interface with the AMF and a N16a interface with the SMF and is responsible of controlling the UPFs that the SMF cannot directly control The exchange of the SM context and forwarding of tunnel information if needed are done between two SMFs directly without involvement of AMF Depending on scenario a PDU Session in non-roaming case or local breakout is either served by a single SMF or served by an SMF and an I-SMF When a PDU Session is served by both an SMF and an I-SMF the SMF is the NF instance that has the interfaces towards the PCF and CHF In this Release of the specification deployments topologies with specific SMF Service Areas apply only for 3GPP access The SMF shall release or reject the PDU Session if the DNN of the PDU Session corresponds to a LADN and the I-SMF is inserted to the PDU Session NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1566",
    "document_id": "23501-i80",
    "chunk_id": 1566,
    "text": "This implies that operators need to plan the LADN deployment in such a way that the LADN Service area needs to be within the SMF Service Area but not across SMFs Service Areas NOTE 2 This is to cover the case where the UE is not in or moves out of SMF Service Area and an I-SMF is inserted to the PDU Session eg during PDU Session Establishment Service Request If the PDU Session is maintained with I-SMF the SMF is not be able to enforce the LADN Service control eg SMF is not notified in the case of Service Request Independent of whether deployments topologies with specific SMF Service Areas apply the SMF may trigger the PDU Session re-establishment to the same DN if the PDU Session is associated with the SSC mode 2 or SSC mode 3 NOTE 3 SSC mode 2 or SSC mode 3 can be used to optimize SMF location for a PDU Session andor depending on deployment ensure that the UE is always within the service area of the SMF controlling the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1567",
    "document_id": "23501-i80",
    "chunk_id": 1567,
    "text": "In this case when PDU Session continuity over the PLMN is not required procedures described in this clause are not needed In this Release how TSC as defined in clauses 527 and 528 is supported for PDU Sessions involving an I-SMF is not specified In this Release Redundant User Plane Paths as defined in clause 53322 is not supported for PDU Sessions involving an I-SMF Redundant PDU sessions support as defined in clause 53321 is supported for PDU Sessions involving an I-SMF when different S-NSSAIs are used for the redundant PDU sessions Redundant User Plane Paths as defined in clause 53323 is supported for PDU Sessions involving an I-SMF only if this PDU session is established for a S-NSSAI referring to network instances requiring redundant transmission at transport layer QoS monitoring as defined in clause 5333 is supported as long as SMF and not I-SMF initiates the QoS monitoring function Dynamic CN PDB provisioning as defined in clause 5734 is supported for PDU Sessions involving an I-SMF In this Release no dedicated functionality is specified for I-SMF and N16a in order to support NPN 5342 Architecture 53421 SBA architecture In non-roaming case the SBA architecture described in Figure 423-1 shall apply In local breakout scenarios the SBA architecture described in Figure 424-1 shall apply In Home Routed scenarios the SBA architecture described in Figure 424-3 shall apply 53422 Non-roaming architecture Figure 53422-1 depicts the non-roaming architecture with an I-SMF insertion to the PDU Session without UL-CLBP using reference point representation NOTE 1 N16a is the interface between SMF and I-SMF NOTE 2 N38 is the interface between I-SMFs Figure 53422-1 Non-roaming architecture with I-SMF insertion to the PDU Session in reference point representation with no UL-CLBP Figure 53422-2 depicts the non-roaming architecture for an I-SMF insertion to the PDU Session with UL-CLBP using reference point representation Figure 53422-2 Non-roaming architecture with I-SMF insertion to the PDU Session in reference point representation with UL-CLBP 53423 Roaming architecture Figure 53423-1 depicts 5G System roaming architecture in the case of local break out scenario where the SMF controlling the UPF connecting to NG-RAN is separated from the SMF controlling PDU Session anchor using the reference point representation Figure 53423-1 Roaming 5G System architecture with SMFI-SMF - local breakout scenario in reference point representation For the case of home routed scenario Figure 424-6 applies 5343 I-SMF selection V-SMF reselection The AMF is responsible of detecting when to add or to remove an I-SMF or a V-SMF for a PDU Session For this purpose the AMF gets from NRF information about the Service Area and supported DNAIs of SMFs During mobility events such as Hand-Over or AMF change if the service area of the SMF does not include the new UE location then the AMF selects and inserts an I-SMF which can serve the UE location and the S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1568",
    "document_id": "23501-i80",
    "chunk_id": 1568,
    "text": "Conversely if the AMF detects that an I-SMF is no more needed as the service area of the SMF includes the new UE location it removes the I-SMF and interfaces directly with the SMF of the PDU Session If the AMF detects that the SMF cannot serve the UE location eg due to mobility then the AMF selects a new I-SMF serving the UE location If the existing I-SMF or V-SMF cannot serve the UE location eg due to mobility and the service area of the SMF does not include the new UE location or the PDU Session is Home Routed then the AMF initiates an I-SMF or V-SMF change A V-SMF change may take place either at intra-PLMN or inter-PLMN mobility",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1569",
    "document_id": "23501-i80",
    "chunk_id": 1569,
    "text": "According to the PCC rules related with AF influence traffic mechanism regarding DNAIs the SMF determines the target DNAI which is applicable to the current UE location and which can be based on the common DNAI if applicable as described in TS 23548 130 If current I-SMF cannot serve the target DNAI or if the SMF can server the target DNAI and existing I-SMF is not needed the SMF may send the target DNAI information to the AMF for triggering I-SMF reselection or removal eg the AMF performs I-SMF reselection or removal based on the target DNAI and supported DNAIs of I-SMF If the SMF determines that target DNAI currently served by I-SMF should not be used for the PDU Session hence the existing I-SMF is not needed eg due to the updated PCC rules removes DNAIs that was provided in the previous PCC rules the SMF sends the target DNAI information without including target DNAI to AMF which may trigger the I-SMF removal At PDU Session Establishment in non-roaming and roaming with LBO scenarios if the AMF or SCP cannot select an SMF with a Service Area supporting the current UE location for the selected DNN S-NSSAI and required SMF capabilities the AMF selects an SMF for the selected DNN S-NSSAI and required capabilities and in addition selects an I-SMF serving the UE location and the S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1570",
    "document_id": "23501-i80",
    "chunk_id": 1570,
    "text": "Compared to the SMF selection function defined in clause 632 the following parameters are not applicable for I-SMFV-SMF selection - Data Network Name DNN - Subscription information from UDM NOTE 1 All SMFs and I-SMF are assumed to be able to control the UPF mapping between EPC bearers and 5GC QoS Flows If HR-SBO roaming is allowed for a PDU Session the DNN is also considered for V-SMF selection If delegated SMF discovery is used at PDU Session establishment 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1571",
    "document_id": "23501-i80",
    "chunk_id": 1571,
    "text": "The AMF sends Nsmf_PDUSession_CreateSMContext Request to SCP and includes the parameters as defined in clause 632 eg the DNN required SMF capabilities UE location as discovery and selection parameters If the SCP successfully selects an SMF matching all discovery and selection parameters the SCP forwards the Nsmf_PDUSessionCreateSMContext Request to the selected SMF 2 If the SCP cannot select an SMF matching all discovery and selection parameters the SCP returns a dedicated error to AMF In this case the I-SMF also need be discovered 3 Upon reception of the error from the SCP that an SMF matching all discovery and selection parameters cannot be found the AMF performs the discovery and selection of the SMF from NRF thus not providing the UE location as a discovery parameter The AMF may indicate the maximum number of SMF instances to be returned from NRF ie SMF selection at NRF 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1572",
    "document_id": "23501-i80",
    "chunk_id": 1572,
    "text": "The AMF sends Nsmf_PDUSession_CreateSMContext Request to SCP which includes the endpoint eg URI of the selected SMF and the discovery and selection parameters as defined in clause 632 except the DNN and the required SMF capabilities ie parameter for I-SMF selection The SCP performs discovery and selection of the I-SMF and forwards the Nsmf_PDUSession_CreateSMContext Request to the selected I-SMF 5 The I-SMF sends the Nsmf_PDUSession_Create Request towards the SMF via the SCP the I-SMF uses the received endpoint eg URI of the selected SMF to construct the target destination to be addressed The SCP forwards the Nsmf_PDUSession_Create Request to the SMF 6 The SMF answers to the I-SMF that answers to the AMF in this answer the AMF receives the I-SMF ID 7 Upon reception of a response from I-SMF based on the received I-SMF ID the AMF may obtain the SMF Service Area of the I-SMF from NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1573",
    "document_id": "23501-i80",
    "chunk_id": 1573,
    "text": "The AMF uses the SMF Service Area of the I-SMF to determine the need for I-SMF relocation upon subsequent UE mobility If delegated I-SMF discovery is used once the PDU Session establishment has been established the procedure starts at step 4 above and is further detailed in the messages flows in clause 23 of TS 23502 3 If delegated V-SMF discovery is used for V-SMF reselection clause 632 applies but there is no need for discovery and selection of the H-SMF This is further detailed in the messages flows in clause 23 of TS 23502 3 5344 Usage of an UL Classifier for a PDU Session controlled by I-SMF This clause applies only in the case of non-roaming or LBO roaming as control of UL CLBP in VPLMN is not supported in HR case When I-SMF is involved for a PDU Session it is possible that the UL CL controlled by I-SMF is inserted into the data path of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1574",
    "document_id": "23501-i80",
    "chunk_id": 1574,
    "text": "The usage of an ULCL controlled by I-SMF in the data path of a PDU Session is depicted in Figure 5344-1 Figure 5344-1 User plane Architecture for the Uplink Classifier controlled by I-SMF The I-SMF determines whether UL CL will be inserted based on information received from SMF and the I-SMF selects the UPFs acting as UL CL andor PDU Session Anchor providing local access to the Data Network 5345 Usage of IPv6 multi-homing for a PDU Session controlled by I-SMF This clause applies only in the case of non-roaming or LBO roaming as control of UL CLBP in VPLMN is not supported in HR case When I-SMF is involved for a PDU Session it is possible that the BP controlled by I-SMF is inserted into the data path of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1575",
    "document_id": "23501-i80",
    "chunk_id": 1575,
    "text": "The usage of a BP controlled by I-SMF in the data path of a PDU Session is depicted in Figure 5345-1 Figure 5345-1 Multi-homed PDU Session Branching Point controlled by I-SMF The I-SMF determines whether BP will be inserted based on information received from SMF and the I-SMF selects the UPFs acting as BP andor PDU Session Anchor providing local access to the Data Network 5346 Interaction between I-SMF and SMF for the support of traffic offload by UPF controlled by the I-SMF 53461 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1576",
    "document_id": "23501-i80",
    "chunk_id": 1576,
    "text": "This clause applies only in the case of non-roaming or LBO roaming as control of UL CLBranching Point in VPLMN is not supported in HR case It applies for the architectures described in clauses 5344 and 5345 When the I-SMF is inserted into a PDU Session eg during PDU Session establishment or due to UE mobility the I-SMF may provide the DNAI list it supports to the SMF Based on the DNAI list information received from I-SMF the SMF may provide the DNAIs of interest for this PDU Session for local traffic steering to the I-SMF eg immediately or when a new or updated or removed PCC rules isare received The DNAIs of interest is derived from PCC rules The I-SMF is responsible for the insertion modification and removal of UPFs to ensure local traffic steering The SMF does not need to have access to local configuration or NRF output related with UPFs controlled by I-SMF Based on the DNAIs of interest for this PDU Session for local traffic steering and UE location the I-SMF determines which DNAIs are to be selected selects UPFs acting as UL CLBP andor PDU Session Anchor based on selected DNAI and insert these UPFs into the data path of the PDU Session When a UL CLBP has been inserted changed or removed the I-SMF indicates to the SMF that traffic offload have been inserted updated or removed for a DNAI providing also the IPv6 prefix that has been allocated if a new IPv6 prefix has been allocated for the PDU Session From now on the SMF and I-SMF interactions entail - Notifying the SMF with the new Prefix multi-Homing case the SMF is responsible of issuing Router Advertisement message The SMF constructs a link-local address as the source IP address The Router Advertisement message includes the IPv6 multi-homed routing rules provided to the UE to select the source IPv6 prefix among the prefixes related with the PDU Session according to RFC 4191 8",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1577",
    "document_id": "23501-i80",
    "chunk_id": 1577,
    "text": "The SMF sends the Router Advertisement message to the UE via the PSA UPF controlled by the SMF - N4 interactions related with traffic offloading The SMF provide N4 information to the I-SMF for how the traffic shall be detected enforced monitored in UPFs controlled by the I-SMF the SMF issues requests to the I-SMF containing N4 information to be used for creating updating removing PDR FAR QER URR etc The N4 information for local traffic offload provided by the SMF to the I-SMF are described in clause 53462 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1578",
    "document_id": "23501-i80",
    "chunk_id": 1578,
    "text": "Receiving N4 notifications related with traffic usage reporting the I-SMF forwards to the SMF N4 information corresponding to UPF notifications related with traffic usage reporting the SMF aggregates and constructs usage reports towards PCFCHF NOTE How the SMF decides what traffic steering and enforcement actions are enforced in UPFs controlled by I-SMF is left for implementation The I-SMF is responsible of the N4 interface towards the local UPFs including - the usage of AN Tunnel Info received from the 5G AN via the AMF in order to build PDR and FAR - requesting the allocation of the CN Tunnel Info between local UPFs if needed - to control UPF actions when the UP of the PDU Session becomes INACTIVE - provide Trace Requirements on the N4 interface towards the UPFs it is controlling using Trace Requirements received from AMF 53462 N4 information sent from SMF to I-SMF for local traffic offload The SMF generates N4 information for local traffic offload based on the available DNAIs indicated by the I-SMF PCC rules associated with these DNAIs and charging requirement This N4 information is sent from the SMF to the I-SMF after UL CLBranching Point insertionupdateremoval and the I-SMF uses this N4 information to derive rules installed in the UPFs controlled by the I-SMF The N4 information for local traffic offload corresponds to rules and parameters defined in clause 585 ie PDR FAR URR and QER It contains identifiers allowing the SMF to later modify or delete these rules N4 information for local traffic offload is generated by the SMF without knowledge of how many local UPFs are actually used by the I-SMF The SMF indicates whether a rule within N4 information is enforced in UL CL Branching Point or local PSA If the rule is applied to the local PSA the N4 information includes the associated DNAI The I-SMF generates suitable rules for the UPFs based on the N4 information received from SMF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1579",
    "document_id": "23501-i80",
    "chunk_id": 1579,
    "text": "The SMF is not aware of whether there is a single PSA or multiple PSA controlled by I-SMF The following parameters are managed by the I-SMF - The 5G AN Tunnel Info - CN tunnel info between local UPFs - Network instance if needed The N4 information exchanged between I-SMF and SMF are not associated with a N4 Session ID but are associated with an N16a association allowing the SMF to modify or delete the N4 information at a later stage The I-SMF generates an N4 Session ID and for each rule a Rule ID unless the ones received from the SMF can be used and maintains a mapping between the locally generated identifiers and the ones received from the SMF The I-SMF replaces those IDs in the PDRs QERs URRs and FARs received from the SMF When the I-SMF receives the N4 information the Network instance if needed included in the rules sent to the UPF is generated by I-SMF 5347 Event Management 53471 UEs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1580",
    "document_id": "23501-i80",
    "chunk_id": 1580,
    "text": "Mobility Event Management When an I-SMF is involved in a PDU Session the SMF and I-SMF independently subscribe to UE mobility event notification service provided by AMF The AMF treats the SMFs and I-SMFs subscription separately and notifies the event directly to the SMF or I-SMF If the SMF does not know the serving AMF address the SMF gets the serving AMF address from the UDM as described in clause 52324 TS 23502 3 and subscribes directly with the serving AMF In the case of AMF change eg Inter NG-RAN node N2 based handover the target AMF receives mobility event subscription information from the source AMF and updates the mobility event subscription information with the SMF and I-SMF independently ie target AMF allocates the Subscription Correlation ID for each event and notifies the respective SMFs and I-SMF as described in clause 5344 In the case of I-SMF change or I-SMF insertion eg at Inter NG-RAN node N2 based handover the subscription of mobility event from AMF is not transferred from the old I-SMF or SMF to the new I-SMF the new I-SMF triggers a new subscription event if the new I-SMF wants to receive the corresponding mobility event In the case of I-SMF removal the subscription of mobility event at the AMF is not transferred from the old I-SMF to the SMF the SMF triggers a new subscription event if the SMF wants to receive the corresponding mobility event The subscription from the old SMF entity old I-SMF SMF is removed via an explicitly request from this old SMF entity 53472 SMF event exposure service Consumers of SMF events do not need to be aware of the insertion removal change of an I-SMF as they always subscribe to the SMF of the PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1581",
    "document_id": "23501-i80",
    "chunk_id": 1581,
    "text": "Except for the events documented in the present clause the I-SMF does not need to support the events defined in clause 52831 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1582",
    "document_id": "23501-i80",
    "chunk_id": 1582,
    "text": "For Events First downlink packet per source of the downlink IP traffic buffered discarded transmitted and UPF event exposure for User DataUsage Measures and User DataUsage Trends when an I-SMF is involved in the PDU Session the SMF subscribes unsubscribes onto I-SMF for the PDU Session ID on behalf of the event consumer eg at I-SMF insertion or when a consumer subscribes or un subscribes while an I-SMF serves the PDU Session and the I-SMF or I-UPF directly notifies the event consumer At I-SMF change the related SMF event subscriptions are not transferred from source I-SMF to the target I-SMF The SMF may trigger new subscription event to the target I-SMF if the SMF wants to receive the corresponding SMF or UPF event or to continue the UPF event subscription for the final consumer At I-SMF change or removal the corresponding subscription is removed in the source I-SMF when it removes the context associated with the PDU Session Id 53473 AMF implicit subscription about events related with the PDU Session When creating an association with a SMF or I-SMF for a PDU Session the AMF implicitly subscribes to SMF I-SMF about events related with the PDU Session the AMF provides the relevant notification information to the SMF or the I-SMF respectively",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1583",
    "document_id": "23501-i80",
    "chunk_id": 1583,
    "text": "This implicit subscription is implicitly released when the corresponding association with the SMF I-SMF is removed eg as no more needed due to a I-SMF insertion change removal 5348 Support for Cellular IoT This clause defines the specific impacts of deployments topologies with specific SMF Service Areas on how 5GS supports Cellular IoT as defined in clause 531 For a PDU Session supporting Control Plane CIoT 5GS Optimisation as defined in clause 5314 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1584",
    "document_id": "23501-i80",
    "chunk_id": 1584,
    "text": "For a PDU Session towards a DNNS-NSSAI for which the SMF Selection Subscription data includes Invoke NEF Indication ie for a PDU Session which will be anchored in NEF the AMF never inserts an I-SMF When an I-SMF is inserted to serve a PDU Session the I-SMF supports the features that as specified in clause 531 apply to the V-SMF in the case of Home Routed NOTE This can require the SMF to subscribe onto I-SMF about RAT type change for a PDU Session as described in clause 423 of TS 23502 3 5349 Support of the Deployment Topologies with specific SMF Service Areas feature within and between PLMNs When Deployments Topologies with specific SMF Service Areas need to be used in a PLMN for a S-NSSAI all AMF serving this S-NSSAI are configured to support Deployments Topologies with specific SMF Service Areas NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1585",
    "document_id": "23501-i80",
    "chunk_id": 1585,
    "text": "The specifications do not support AMF selection related with Deployment Topologies with specific SMF Service Areas For HR roaming the AMF discovers at PDU Session establishment whether a H-SMF supports V-SMF change based on feature support indication received from the NRF possibly via the SCP When the V-PLMN requires Deployments Topologies with specific SMF Service Areas but no H-SMF can be selected that supports V-SMF change a H-SMF not supporting V-SMF change may be selected by the VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1586",
    "document_id": "23501-i80",
    "chunk_id": 1586,
    "text": "In that case and if a V-SMF serving the full VPLMN is available AMF should prefer to select such V-SMF In this release of the specifications when an AMF detects the need to change the V-SMF while the H-SMF does not support V-SMF change the AMF shall not trigger V-SMF change but shall trigger the release of the PDU Session NOTE 2 The AMF can determine whether the H-SMF supports V-SMF change based on NRF look up 53410 Support for 5G LAN-type service This clause defines how 5GS supports 5G LAN-type service as defined in clause 529 in the case of deployments topologies with specific SMF Service Areas",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1587",
    "document_id": "23501-i80",
    "chunk_id": 1587,
    "text": "The UE may be connected with the PSA via an I-UPF which is controlled by the I-SMF In this case traffic switching eg UPF local traffic switching is controlled by the SMF as described in clause 5294 without any specific knowledge or involvement of the I-SMF to support the 5G LAN-type service 535 Support for Integrated access and backhaul IAB 5351 IAB architecture and functional entities Integrated access and backhaul IAB enables wireless in-band and out-of-band relaying of NR Uu access traffic via NR Uu backhaul links In this Release of the specification NR satellite access is not applicable The serving PLMN may provide the mobility restriction for NR satellite access as specified in clause 5341",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1588",
    "document_id": "23501-i80",
    "chunk_id": 1588,
    "text": "The Uu backhaul links can exist between the IAB-node and - a gNB referred to as IAB-donor or - another IAB-node The part of the IAB node that supports the Uu interface towards the IAB-donor or another parent IAB-node and thus manages the backhaul connectivity with either PLMN or SNPN it is registered with is referred to as an IAB-UE In this Release of the specification the IAB-UE function does not apply to the NR RedCap UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1589",
    "document_id": "23501-i80",
    "chunk_id": 1589,
    "text": "At high level IAB has the following characteristics - IAB uses the CUDU architecture defined in TS 38401 42 and the IAB operation via F1 between IAB-donor and IAB-node is invisible to the 5GC - IAB performs relaying at layer-2 and therefore does not require a local UPF - IAB supports multi-hop backhauling - IAB supports dynamic topology update ie the IAB-node can change the parent node eg another IAB-node or the IAB-donor during operation for example in response to backhaul link failure or blockage Figure 5351-1 shows the IAB reference architecture with two backhaul hops when connected to 5GC Figure 5351-1 IAB architecture for 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1590",
    "document_id": "23501-i80",
    "chunk_id": 1590,
    "text": "The gNB-DU in the IAB-node is responsible for providing NR Uu access to UEs and child IAB-nodes The corresponding gNB-CU function resides on the IAB-donor gNB which controls IAB-node gNB-DU via the F1 interface IAB-node appears as a normal gNB to UEs and other IAB-nodes and allows them to connect to the 5GC The IAB-UE function behaves as a UE and reuses UE procedures to connect to - the gNB-DU on a parent IAB-node or IAB-donor for access and backhauling - the gNB-CU on the IAB-donor via RRC for control of the access and backhaul link - 5GC eg AMF via NAS - OAM system via a PDU session or PDN connection based on implementation NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1591",
    "document_id": "23501-i80",
    "chunk_id": 1591,
    "text": "The 5GC eg SMF may detect that a PDU session for the IAB-UE is for the OAM system access eg by checking the DNN andor configuration It is up to the operator configuration to choose whether to use 1 or multiple QoS Flows for OAM traffic and the appropriate QoS parameters eg using 5QI6 for software downloading and 5QI80 with signalled higher priority or a pre-configured 5QI for alarm or control traffic The IAB-UE can connect to 5GC over NR SA mode or connect to EPC EN-DC mode The UE served by the IAB-node can operate in the same or different modes than the IAB-node as defined in TS 38401 42 The operation mode with both UE and IAB-node connected to EPC is covered in TS 23401 26 Operation modes with UE and IAB-node connected to different core networks are described in clause 5356 5352 5G System enhancements to support IAB In IAB operation the IAB-UE interacts with the 5GC using procedures defined for UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1592",
    "document_id": "23501-i80",
    "chunk_id": 1592,
    "text": "The IAB-node gNB-DU only interacts with the IAB-donor-CU and follows the CUDU design defined in TS 38401 42",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1593",
    "document_id": "23501-i80",
    "chunk_id": 1593,
    "text": "For the IAB-UE operation the existing UE authentication methods as defined in TS 33501 29 applies Both USIM based methods and EAP based methods are allowed and NAI based SUPIs can be used The following aspects are enhanced to support the IAB operation in the Registration procedure as defined in clause 4222 of TS 23502 3 - The IAB-node provides an IAB-indication to the IAB-donor-CU when the RRC connection is established as defined in TS 38331 28 When the IAB-indication is received the IAB-donor-CU selects an AMF that supports IAB and includes the IAB-indication in the N2 INITIAL UE MESSAGE as defined in TS 38413 34 so that the AMF can perform IAB authorization - the UE Subscription data as defined in clause 523 of TS 23502 3 is enhanced to include the authorization information for the IAB operation - Authorization procedure during the UE Registration procedure is enhanced to perform verification of IAB subscription information - If the IAB operation is not authorized and IAB-UE is not allowed to be registered the AMF rejects the IAB-UEs registration or de-register the IAB-UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1594",
    "document_id": "23501-i80",
    "chunk_id": 1594,
    "text": "The AMF initiates UE Context setupmodification procedure by providing IAB authorized indication with the value set to not authorized to the NG-RAN if the IAB-UE is still allowed to be registered - If the IAB operation is authorized UE Context setupmodification procedure is enhanced to provide IAB authorized indication with the value set to authorized to NG-RAN After registered to the 5G system the IAB-node remains in CM-CONNECTED state if the IAB operation is authorized In the case of radio link failure the IAB-UE uses existing UE procedure to restore the connection with the network The IAB-UE uses Deregistration Procedure as defined in clause 4223 of TS 23502 3 to disconnect from the network In the case of controlled IAB-node release as specified in clause 8910 of TS 38401 42 including the case when authorization state of the IAB-node is changed from authorized to non-authorized after UE Context Modification message to NG-RAN with authorization indication as not authorized and after a certain period eg based on the expiration of a timer configured on the AMF the AMF may trigger the IAB-UE Deregistration 5353 Data handling and QoS support with IAB Control plane and user plane protocol stacks for IAB operation are defined in TS 38300 27 QoS management for IAB can remain transparent to the 5GC If NG-RAN cannot meet a QoS requirement for a QoS Flow to IAB-related resource constraints the NG-RAN can reject the request using procedures defined in TS 23502 3 The IAB-UE function can establish a PDU session or PDN connection eg for OAM purpose protocol stack not shown here In that case the IAB-UE obtains an IP addressprefix from the core network using normal UE procedures The IAB-UEs IP address is different from that of the IAB-nodes gNB DU IP address NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1595",
    "document_id": "23501-i80",
    "chunk_id": 1595,
    "text": "For OAM traffic based on their specific requirements operators can select QoS characteristics and reference them by pre-configured 5QIs or using signalled QoS characteristics within the operators network 5354 Mobility support with IAB For UEs all existing NR intra-RAT mobility and dual-connectivity procedures are supported when the UE is served by an IAB-node except for the cases of NR satellite access For a UE served by an IAB-node when the serving IAB-node changes its IAB-donor-CU due to mobility the mobility support is specified in clause 535A1 and clause 535A3 5355",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1596",
    "document_id": "23501-i80",
    "chunk_id": 1596,
    "text": "Charging support with IAB IAB-donor has all the information regarding the UE and the IAB-node and corresponding mapping of the bearers The PDU sessions for the UE and IAB-node are separate from IAB-node onwards to the core network Therefore the existing charging mechanism as defined in clause 512 can be used to support IAB 5356 IAB operation involving EPC When the IAB-donor gNB has connection to both EPC and 5GC based on PLMN configuration there are two possible operation modes - the IAB-node connects to a 5GC via the IAB-donor gNB while the UEs served by the IAB-node connect to EPC with Dual Connectivity as defined in TS 37340 31 In this operation mode the IAB-donor gNB has connection to an eNB and the 5GC is restricted for IAB-node access only and - the IAB-node connects to an EPC via the IAB-donor gNB with Dual Connectivity as defined in TS 37340 31 while the UEs served by the IAB-node connect to the 5GC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1597",
    "document_id": "23501-i80",
    "chunk_id": 1597,
    "text": "In this operation mode the EPC is restricted for IAB-node access only To support the above operation modes the IAB-UE shall be configured to select only a specific PLMN as defined in TS 23122 17 and whether it needs to connect to 5GC or EPC NOTE For a particular PLMN it is expected that only one of the modes would be deployed in a known region 535A Support for Mobile Base Station Relay MBSR 535A1 General The MBSR uses the IAB architecture as defined in clause 535 and operates as an IAB node with an IAB-UE and gNB-DU with mobility when integrated with the serving PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1598",
    "document_id": "23501-i80",
    "chunk_id": 1598,
    "text": "The architecture described in clause 535 applies unless specific handling is specified in clause 535A Additionally the following limitations apply to the MBSR - the MBSR has a single hop to the IAB-donor node - NR Uu is used for the radio link between a MBSR and served UEs and between MBSR and IAB-donor node Regulatory requirements eg emergency services priority services are supported when UEs access 5GS via a MBSR LCS framework as defined in TS 23273 87 is used for providing the location service to the served UEs with additional enhancements described in clause 535A5 Roaming of the MBSR is supported ie a MBSR can be integrated with a VPLMNs IAB-donor gNB node The corresponding enhancements to support MBSR roaming are described in clause 535A4 CAG mechanism as defined in clause 530 can be used for the control of UEs access to the MBSR Optional enhancements to the CAG mechanism for MBSR use are described in clause 535A7 For a MBSR node to operate as a MBSR it provides a mobile IAB-indication to the IAB-donor-CU when the RRC connection is established as defined in TS 38331 28 When the mobile IAB-indication is received the IAB-donor-CU selects an AMF that supports mobile IAB-node and includes the mobile IAB-indication in the N2 INITIAL UE MESSAGE as defined in TS 38413 34 so that the AMF can perform MBSR authorization as described in clause 535A4 If the MBSR node is not authorized eg due to the MBSR authorization indication from AMF it also provides the mobile IAB-indication when establishing new RRC connection so that the AMF supporting mobile IAB-node will be selected by the IAB-donor-CU to ensure that the operation related to MBSR authorization status change for a registered MBSR node can be performed as described in clause 535A4 If the MBSR receives MBSR authorized indication from AMF it provides the information about the authorization result to its IAB-DU component based on non-standardized interface as described in clause 535A4 As defined in TS 38331 28 when a MBSR includes the mobile IAB-indication when establishing the RRC connection it shall not include the IAB-indication as described in clause 5352 After the IAB-UE performs registration procedure in 5GS further mobility procedure can be performed to change the IAB-donor-DU the IAB-donor-CU as specified in TS 38401 42 The mobility support of UEs served by the MBSR is specified in clause 535A3 535A2 Configuration of the MBSR In order for an MBSR to operate as a mobile IAB node it receives configuration from the OAM system of the serving PLMN as specified in TS 38401 42 The MBSR IAB-UE establishes a secure and trusted connection to the OAM server only if it is authorized to operate as MBSR in the serving PLMN as defined in TS 38401 42",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1599",
    "document_id": "23501-i80",
    "chunk_id": 1599,
    "text": "In addition the MBSRIAB-UE is assumed to be configured with preferred PLMN lists and forbidden PLMNs by the HPLMN to perform PLMN selection as specified in TS 23122 17 When a PDU session is used for the MBSR to access the OAM server the MBSR IAB-UE establishes a dedicated PDU session for the OAM traffic The serving PLMN provides an Allowed NSSAI and establishes the PDU session for the OAM server access considering the S-NSSAI and DNN requested by MBSR andor the default values in subscription data",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1600",
    "document_id": "23501-i80",
    "chunk_id": 1600,
    "text": "The MBSR can be pre-configured with UE policy or provisioned using existing UE Policy mechanism as defined in TS 23503 45 including the OAM access PDU session parameters for the authorized PLMNs 535A3 Mobility support of UEs served by MBSR 535A31 UE mobility between a fixed cell and MBSR cell For UEs in RRC_IDLE and RRC_INACTIVE state when a MBSR goes out-of-service procedure for cell re-selection as specified in TS 38304 50 for RRC_IDLE and RRC_INACTIVE is used between MBSR cell and other cells If the MBSR goes out-of-service due to eg MBSR moves to an area where the MBSR is not allowed to provide the relay service the NG-RAN triggers the handover procedures to the neighbouring cells for UEs in RRC_CONNECTED state served by the MBSR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1601",
    "document_id": "23501-i80",
    "chunk_id": 1601,
    "text": "Any change of authorization state of the MBSR is also handled according to clause 535A4 The IAB-donor-CU triggers handover procedure when it is possible for the UEs accessing emergency service and being served by the MBSR if MBSR is about to become unavailable to provide the services 535A32 UE mobility between MBSR cells Similar to the behaviours described in clause 535A31 UEs and NG-RAN use existing procedures as specified in clause 823 of TS 38401 42 TS 23502 3 or TS 38304 50 to handle the mobility between MBSR cells 535A33 UE mobility when moving together with a MBSR cell For a UE served by a MBSR cell it may observe change of TAC andor cell IDs even if it is still connected to the same MBSR This can trigger mobility registrations as defined in TS 23502 3 if the new TAC is not in the TAI list in the RA 535A34 MBSR mobility The mobility of MBSR between different IAB-donor gNBs is described in clause 823 of TS 38401 42 If a MBSR operates without PDU sessions -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1602",
    "document_id": "23501-i80",
    "chunk_id": 1602,
    "text": "For N2 Handover the NG-RAN triggers the N2 handover procedure for a dummy PDU session and includes the related dummy PDU session information in the Handover Required message as specified in TS 38413 34 towards the AMF of the MBSR IAB-UE The AMF checks the UE context it stores for the MBSR IAB-UE and since it includes no PDU sessions the AMF shall not forward the PDU Session information it receives in the Handover Required message to any SMF The AMF shall then perform the handover procedures as specified in clause 4913 of TS 23502 3 without involving any SMF and it includes in the Handover Request message towards the target NG-RAN the PDU session information received in the Handover Required message with an indication to cause the target NG-RAN to ignore the received PDU session information No PDU Session Indication IE defined in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1603",
    "document_id": "23501-i80",
    "chunk_id": 1603,
    "text": "If the AMF is reallocated during the handover the target AMF checks whether the UE context for the MBSR IAB-UE it receives from the source AMF includes any PDU sessions related information and if none is detected it continues the handover without involving any SMF and it includes in the Handover Request message towards the target NG-RAN with an indication to cause the target NG-RAN to ignore the received PDU session information No PDU Session Indication IE defined in TS 38413 34 - For Xn Handover the NG-RAN triggers the Xn handover procedure for a dummy PDU session and includes the related dummy PDU session information in the Path Switch Request message as specified in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1604",
    "document_id": "23501-i80",
    "chunk_id": 1604,
    "text": "The AMF checks the UE context it stores for the MBSR IAB-UE and since it includes no PDU sessions the AMF shall then perform the handover procedures as specified in clause 4912 of TS 23502 3 without involving any SMF and it includes in the Path Switch Acknowledge towards the target NG-RAN dummy PDU session information The NG-RAN ignores the received PDU session information from the AMF as it has no PDU sessions in the RAN UE context 535A4 MBSR authorization For a MBSR the subscription information stored in the HPLMN indicates whether it is authorized to operate as MBSR and the corresponding location and time information as specified in TS 23502 3 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1605",
    "document_id": "23501-i80",
    "chunk_id": 1605,
    "text": "For non-roaming MBSRs the operator local policy can be taken into consideration for MBSR authorization eg based on the network status or a limit on the number of MBSRs operating in a certain area When the MBSR IAB-UE performs initial registration with the serving PLMN it indicates the request to operate as a MBSR as described in clause 535A1 The AMF authorizes the MBSR based on the subscription information and provides MBSR authorized indication to the MBSR node over NAS and NG-RAN over NGAP as described in the registration procedure in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1606",
    "document_id": "23501-i80",
    "chunk_id": 1606,
    "text": "The MBSR establishes the connection to OAM system using the configuration information for MBSR operation upon the reception of MBSR authorization indication authorized The MBSR provides the information about the authorization result authorized to its IAB gNB-DU component When the AMF formulates the registration area for an authorized MBSR the TAs included in the registration area are authorized for MBSR operation homogenously taking any MBSR Operation allowed information in subscription data and operator local policy into account NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1607",
    "document_id": "23501-i80",
    "chunk_id": 1607,
    "text": "The MBSR support can be deployed in certain Network Slices based on operator configuration and Network slicing functionalities eg the function specified in clause 51518 can be applied when suitable When MBSR roaming is supported a roaming agreement between VPLMN and HPLMN regarding MBSR operation is in place The AMF can make use of the subscription data for authorization of the MBSR in the V-PLMN MBSR IAB gNB-DU can use IAB-node integration procedure or inter-IAB-donor gNB mobility procedure to integrate into the serving PLMN to provide service NOTE 3 How the MBSR obtains the configuration information for MBSR operation is described in clause 535A2 If the MBSR operation is not authorized eg due to location or time limitation or due to lack of authorization altogether to operate as MBSR the AMF of the MBSR IAB-UE can indicate to the MBSR IAB-UE that it is not allowed to act as an MBSR ie the MBSR authorization indication not authorized as part of registration procedure The AMF may provide the indication in a Registration Accept if the PLMN allows the MBSR IAB-UE to be registered in the PLMN In this case the AMF includes the MBSR authorization indication not authorized to IAB-donor-gNB",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1608",
    "document_id": "23501-i80",
    "chunk_id": 1608,
    "text": "The MBSR provides the information about the authorization result not authorized to its IAB-DU component The AMF may reject the Registration if the PLMN does not allow the MBSR IAB-UE to be registered in the PLMN When the MBSR authorization state changes for a registered MBSR node either authorized or not authorized the AMF of the MBSR IAB-UE updates the MBSR IAB-UE and the NG-RAN accordingly Based on the operator configuration the AMF may use either Deregistration with re-registration required indication or the UE Configuration Update procedure to inform the MBSR regarding the updated authorization status - The Deregistration with re-registration required indication procedure is used when the AMF of the MBSR IAB-UE intends to keep the MBSR IAB-UE registered The AMF of the MBSR IAB-UE provides the new authorization indication to MBSR IAB-UE as described above when the MBSR performs initial Registration procedure after the deregistration - The Deregistration procedure without re-registration required indication is used if the PLMN does not allow the MBSR IAB-UE to remain registered in the PLMN - When UE Configuration Update procedure is used the AMF provides the new authorization indication to the MBSR IAB-UE in the UE Configuration Update Command",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1609",
    "document_id": "23501-i80",
    "chunk_id": 1609,
    "text": "The MBSR provides the information about the new authorization status to its IAB-DU component The AMF of the MBSR IAB-UE informs the NG-RAN ie the IAB-donor gNB of the new authorization status using UE Context Modification Initial Context Setup procedure or the DOWNLINK NAS TRANSPORT message with the following principles - If the authorization state changes from authorized to not authorized and AMF uses the UE Configuration Updated procedure to update the MBSR the AMF updates the NG-RAN with the new authorization indication not authorized by including this information in the DOWNLINK NAS TRANSPORT message The NG-RAN completes handover of the UEs served by the MBSR before releasing the F1 connection to the MBSR IAB-DU - If the authorization state changes from authorized to not authorized and the AMF uses the Deregistration procedure to update the MBSR the AMF sends the UE Context Modification message to NG-RAN with the authorization indication as not authorized Then if the AMF receives a NGAP UE CONTEXT RELEASE REQUEST message from the NG-RAN with a cause code indicating the NG-RAN node has completed the operation for a non-authorized MBSR including eg the handover of the UEs the MBSR was serving as defined in TS 38413 34 or after a certain period eg based on the expiration of a timer configured on the AMF the AMF executes the deregistration procedure with MBSR and releases the NAS signalling connection If the Network-initiated Deregistration procedure is triggered for MBSR IAB-UE that is registered with authorization to act as MBSR the AMF sends the UE Context Modification message to the NG-RAN ie the IAB-donor gNB and updates the NG-RAN with the authorization indication as not authorized Then if the AMF receives a NGAP UE CONTEXT RELEASE REQUEST message from the NG-RAN with a cause code indicating that the NG-RAN node has completed the operation for a non-authorized MBSR including eg the handover of the UEs the MBSR was serving as defined in TS 38413 34 or after a certain period eg based on the expiration of a timer configured on the AMF the AMF executes the deregistration procedure with MBSR and releases the NAS signalling connection NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1610",
    "document_id": "23501-i80",
    "chunk_id": 1610,
    "text": "The AMF delays the MBSR de-registration to allow the IAB-donor gNB to move all connected UEs via MBSR to other cells as specified in clause 8910 of TS 38401 42 If a PDU session is used to provide OAM access for MBSR when it is not authorized but remains registered the AMF of the MBSR IAB-UE may notify the SMF serving the PDU session for OM access to trigger the release of the PDU Session NOTE 5 The mechanism applies to both roaming and non-roaming MBSR operations 535A5 Location Service Support of UEs served by MBSR When a UE accesses 5GS via a MBSR it can use the location service as defined in TS 23273 87",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1611",
    "document_id": "23501-i80",
    "chunk_id": 1611,
    "text": "However in order to provide accurate estimation of the UE location LMF needs to take the location of the MBSR into account Enhancements to the LCS framework for MBSR support is described in clause 59 of TS 23273 87 535A6 Providing cell IDTAC of MBSR for services The TAC and cell ID broadcasted by the MBSR cells are configured and reconfigured eg upon mobility as specified in TS 38401 42 After the MBSR is authorized as defined in 535A4 when a UE is served by a cell of this MBSR the IAB-donor-CU may provide Additional ULI in addition to User Location Information in N2 messages The Additional ULI is the ULI of the IAB-UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1612",
    "document_id": "23501-i80",
    "chunk_id": 1612,
    "text": "The AMF may consider the Additional ULI when it determines UE location and manages the UE location related functions eg Mobility Restrictions When the AMF provides user location information to the LMF as specified in clause 59 of TS 23273 87 for a UE connected via MBSR the AMF may also send the Additional ULI received via N2 messages 535A7 Control of UE access to MBSR CAG Identifier is used to control the access of UE via MBSR ie mobile IAB-node and existing CAG mechanism defined in clause 5303 can be used for managing UEs access to MBSR with the following additional considerations - When the MBSR is allowed to operate as an IAB node for a PLMN the MBSR is configured either during the communication with the serving PLMN OAM or pre-configuration mechanism with a CAG identifier which is unique within the scope of this PLMN If the MBSR is pre-configured with the PLMN list in which the MBSR is allowed to operate as MBSR the corresponding CAG Identifier per PLMN is also configured in the MBSR NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1613",
    "document_id": "23501-i80",
    "chunk_id": 1613,
    "text": "The CAG for MBSR is supported as part of the PNI-NPN concept described in clause 5303 - NG-RAN and 5GC support the UE access control based on the CAG identifier associated with the MBSR cell and the allowed CAG identifiers for the UE that supports CAG functionality - For the UE that does not support CAG functionality NG-RAN and 5GC are allowed to use not only CAG mechanism but also the other existing mechanism eg forbidden Tracking Area to manage its access to MBSR - Time validity information may be provided together with the CAG Identifiers for the MBSRs that the UE can access The Allowed CAG list will be provided to UE and AMF for enforcement to make sure that UE not accessing the MBSR cell outside of the time duration For example if the time when a certain CAG is allowed for a UE is up the CAG for the UE is revoked from the network NOTE 2 Control of the MBSR access to the serving network is based on normal mobility restriction management based on subscription data form MBSR ie IAB-UE 536 RIM Information Transfer",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1614",
    "document_id": "23501-i80",
    "chunk_id": 1614,
    "text": "The purpose of RIM Information Transfer is to enable the transfer of RIM information between two RAN nodes via 5GC The RIM Information Transfer is specified in TS 38413 34 When the source AMF receives RIM information from source NG-RAN towards target NG-RAN the source AMF forwards the RIM information to the target AMF as described in TS 38413 34 and TS 29518 71 The AMF does not interpret the transferred RIM information 537 Support for high data rate low latency services eXtended Reality XR and interactive media services 5371 General This clause provides an overview of 5GS functionalities for support of XR services ARVR applications and interactive media services that require high data rate and low latency communication eg cloud gaming and tactilemulti-modal communication services according to service requirements documented in TS 22261 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1615",
    "document_id": "23501-i80",
    "chunk_id": 1615,
    "text": "The standardized 5QI characteristics for such interactive services are provided in Table 574-1 and TSCAI is used to describe the related traffic characteristics as defined in clause 5272 Further enhancements for these interactive media services are as follows - The 5GS may support QoS policy control for multi-modal traffic see clause 5372 - The 5GS may support network information exposure which can be based on ECN markings for L4S see clause 5373 or 5GS exposure API see clause 5374 - The 5GS may support PDU Set based QoS handling including PDU Set identification and marking see clause 5375 - The 5GS may ensure that the UL and DL packets together meet the requested round trip delay and also update the delay for UL and DL considering QoS monitoring results see clause 5376 - The 5GS may perform per-flow Packet Delay Variation PDV monitoring and policy control according to AF provided requirements see clause 5377 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1616",
    "document_id": "23501-i80",
    "chunk_id": 1616,
    "text": "The 5GC may provide traffic assistance information to the NG-RAN to enable Connected mode DRX power saving see clause 5378 5372 Policy control enhancements to support multi-modal services A multi-modal service is a communication service that consists of several data flows that relate to each other and that are subject to application coordination",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1617",
    "document_id": "23501-i80",
    "chunk_id": 1617,
    "text": "The data flows can transfer different types of data for example audio video positioning haptic data and may come from different sourceseg a single UE a single device or multiple devices connected to the single UE or multiple UEs For the single UE case it is expected that those data flows are closely related and require strong application coordination for the proper execution of the multi-modal application and therefore all those data flows are transmitted in a single PDU session The Nnef_AFsessionWithQoS service allows the AF to provide at the same time for each data flow that belongs to the multi-modal service a Multi-modal Service ID the service requirements and the QoS monitoring requirements - The Multi-modal Service ID is an explicit indication that data flows are related to a multi-modal service The PCF may use this information to derive the correct PCC rules and to apply appropriate QoS policies for the data flows that are part of a specific multi-modal application - The AF may provide QoS monitoring requirements for data flows associated to a multi-modal service to the PCF The PCF generates the authorized QoS Monitoring policy for each data flow NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1618",
    "document_id": "23501-i80",
    "chunk_id": 1618,
    "text": "In order to start the QoS monitoring for the data flows associated to a multi-modal service within a certain period of time the PCF needs to receive the QoS monitoring requirements for those data flows from AF within a single request or in case of multiple requests within a short period of time In addition to the features that are provided for the case that the data flows are associated with a single UE the following features are provided for the case where the data flows are associated with more than one UE - The same DNNS-NSSAI combination for the multi-modal service should be selected by each of the involved UEs The URSP Rule evaluation framework is used to ensure that the same DNNS-NSSAI is selected - The AF should use the same Multi-modal Service ID in the interactions with the PCFs for all the involved UEs that relate to a multi-modal service The PCF may take this information into account eg to apply a specific QoS policy when processing each AF request independently The data flows contribute to the service experience but are still valid stand-alone as they are transmitted over separate PDU Sessions tofrom the involved UEs - If multiple PCFs are involved the PCFs take policy decisions according to the input provided by the AF There is no support for policy coordination among the multiple PCFs in this Release of the specification Policy decisions are taken by each PCF separately on a per PDU Session basis 5373 Support of ECN marking for L4S to expose the congestion information 53731 General L4S Low Latency Low Loss and Scalable Throughput is described in IETF RFC 9330 159 IETF RFC 9331 160 and IETF RFC 9332 161",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1619",
    "document_id": "23501-i80",
    "chunk_id": 1619,
    "text": "It exposes congestion information by marking ECN bits in the IP header of the user IP packets between the UE and the application server to trigger application layer rate adaptation In 5G System ECN marking for L4S may be supported ECN marking for L4S is enabled on a per QoS Flow basis in the uplink andor downlink direction and may be used for GBR and non-GBR QoS Flows ECN marking for the L4S in the IP header is supported in either the NG-RAN see clause 53732 and TS 38300 27 or in the PSA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1620",
    "document_id": "23501-i80",
    "chunk_id": 1620,
    "text": "UPF see clause 53733 NOTE 1 Based on operators network configuration and policies SMF decides whether NG-RAN or PSA UPF based ECN marking for L4S is used In the case of ECN marking for L4S by PSA UPF the NG-RAN is instructed to perform congestion information monitoring and report to the PSA UPF the congestion information ie a percentage of packets that UPF uses for ECN marking for L4S of the QoS Flow on UL andor DL directions via GTP-U header extension to PSA UPF and accordingly the PSA UPF may mark the UL andor DL direction packets of the QoS Flow NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1621",
    "document_id": "23501-i80",
    "chunk_id": 1621,
    "text": "As for any QoS Flow QoS rules in the UE and PDRs in the PSA UPF control which packets are bound to the L4S enabled QoS flow The Packet Filter Set in the QoS rule or PDR can use packet filters in clause 5762 eg match packets with ECT1 or CE See RFC 9331 160 together with IP 5 tuple to steer traffic to an L4S enabled QoS Flow NOTE 3 A QoS Flow may be enabled with ECN marking for L4S requirement eg statically when a PDU session is established based on configuration in SMF or PCF or dynamically based on detection of the L4S traffic eg match packets with ECT1 or CE See RFC 9331 160 together with IP 5 tuple in the IP header whereby SMF or PCF triggers a setup of a QoS Flow enabled for L4S or by requests by an AF NOTE 4 To support this functionality the UE needs to support L4S feedback as described in IETF RFC 9330 159 which is not in the scope of 3GPP When serving PSA UPF or NG-RAN is changed eg due to inter-NG-RAN handover or PSA UPF relocation target NG-RAN and target PSA UPF if supported should continue to perform ECN marking for L4S for the QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1622",
    "document_id": "23501-i80",
    "chunk_id": 1622,
    "text": "However if not available ie ECN marking for L4S is not supported in both target NG-RAN and target PSA UPF AF should be notified that ECN marking for L4S can no longer be performed if ECN marking for L4S had been enabled for the QoS Flow based on AF request When ECN marking for L4S is supported again either in target NG-RAN or in target PSA UPF AF should be notified that ECN marking for L4S can be performed again if ECN marking for L4S had been enabled for the QoS Flow based on AF request 53732 Support of ECN marking for L4S in NG-RAN ECN marking for L4S may be supported in NG-RAN as specified in TS 38300 27 To enable ECN marking for L4S in NG-RAN dedicated QoS Flows are used for carrying L4S enabled IP traffic",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1623",
    "document_id": "23501-i80",
    "chunk_id": 1623,
    "text": "The SMF may be instructed based on either dynamic or predefined PCC rule to provide an indication for ECN marking for L4S to NG-RAN for a corresponding QoS Flows in UL andor DL directions In the absence of such PCC rule the use of ECN marking for L4S in NG-RAN on a QoS Flow is controlled by a coordinated configuration in NG-RAN and 5GC The criteria based on which NG-RAN decides to mark ECN bits for L4S is NG-RAN implementation specific In the case of inter NG-RAN UE mobility if the ECN marking for L4S has been enabled on source NG-RAN but the target NG-RAN does not support ECN marking for L4S then the SMF may if supported enable ECN marking for L4S in PSA UPF as defined in clause 53733 53733 Support of ECN marking for L4S in PSA UPF To enable ECN marking for L4S by a PSA UPF a QoS Flow level ECN marking for L4S indicator may be sent by SMF to PSA UPF over N4 SMF also indicates to NG-RAN to report the congestion information ie a percentage of packets that UPF uses for ECN marking for L4S of the QoS Flow on UL andor DL directions via GTP-U header extension to PSA UPF and accordingly the PSA UPF may mark the UL andor DL direction packets of the QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1624",
    "document_id": "23501-i80",
    "chunk_id": 1624,
    "text": "If there is no UL packet when report for DL andor UL needs to be provided NG-RAN may generate an UL Dummy GTP-U Packet for such a reporting The SMF may be instructed based on either dynamic or predefined PCC rule to provide an indication for ECN marking for L4S to PSA UPF for a corresponding QoS Flows in UL andor DL directions Upon successful activation of congestion information reporting for UL andor DL directions PSA UPF uses information sent by NG-RAN in GTP-U header extension see TS 38415 116 and TS 38300 27 to perform ECN bits marking for L4S for the corresponding direction NOTE How the congestion information is converted to ECN markings is UPF implementation specific The criteria based on which NG-RAN decides to provide the congestion information is up to NG-RAN implementation In the case of PSA UPF relocation if the ECN marking for L4S has been enabled on source PSA UPF SMF should select a target PSA UPF supporting ECN marking for L4S If the target PSA UPF does not support ECN marking for L4S then SMF may if supported switch to ECN marking for L4S in target NG-RAN by following clause 53732 In such case the target NG-RAN stops sending congestion information to the target PSA UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1625",
    "document_id": "23501-i80",
    "chunk_id": 1625,
    "text": "In the case of inter NG-RAN UE mobility if the congestion information reporting has been enabled on source NG-RAN while the target NG-RAN does not support congestion information reporting then the SMF shall inform PSA UPF to stop ECN marking for L4S If ECN marking for L4S is supported by the target NG-RAN the SMF may instruct the target NG-RAN to perform ECN marking for L4S in NG-RAN by following clause 53732 For a given QoS Flow if the target NG-RAN supports congestion information reporting the target NG-RAN shall report congestion information to UPF once it is available 5374 Network Exposure of 5GS information 5GS and XRmedia services cooperate to provide a better user experience using External Network Exposure Based on the AF request the 5GS can expose the following information based on the QoS Monitoring as defined in clause 5333 andor clause 545 - The UL andor DL congestion information monitoring see clause 5453 Based on the PCC rule from PCF the SMF requests the NG-RAN to report congestion information ie a percentage of congestion level for exposure via GTP-U header to PSA UPF This NG-RAN reported congestion information is sent to the PSA UPF in a common information element to support congestion information exposure and to support ECN marking for L4S in PSA UPF as described in clause 53733 In the case of congestion information exposure the PSA UPF interprets the RAN reported information as the percentage of congestion level for exposure and exposes the corresponding UL andor DL congestion information via Nupf_EventExposure service or via SMFPCFNEF as described in clause 58218 It can be applied to a Non-GBR or GBR QoS Flow",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1626",
    "document_id": "23501-i80",
    "chunk_id": 1626,
    "text": "In the case of ECN marking for L4S in PSA UPF the PSA UPF interprets the RAN reported information as percentage of packets that UPF uses for ECN marking for L4S as described in clause 53733 - The UL andor DL Data rate information see clause 5454 Based on the PCC rule from PCF the SMF requests the PSA UPF to measure and report the information They may be exposed to the AF directly by PSA UPF via Nupf_EventExposure service or via SMFPCFNEF as described in clause 58218 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1627",
    "document_id": "23501-i80",
    "chunk_id": 1627,
    "text": "The round trip delay for two service data flows considering the UL direction of a service data flow and the DL direction of another service data flow in the same PDU Session It is determined based on the QoS Monitoring for packet delay of individual QoS Flows as described in clause 5333 The PCF derives the separate QoS monitoring policies for each direction packet delay see clause 5333 based on AF request and local policy The PCF provides the two QoS Monitoring policies in the PCC rules for the service data flows The PSA UPF reports the delay information per QoS Flow to the SMF The SMF reports to PCF The PCF derives round trip delay information based on the two directions packet delay result for the service data flows and exposes the information to the AF directly or via NEF - The round trip delay for one service data flow If the service data flow is mapped to two QoS Flows ie the UL traffic and DL traffic of the service data flow are separated into two QoS flows respectively in the same PDU Session similarly to the round trip delay for two service data flows over two QoS flows the PCF triggers QoS Monitoring for each direction packet delay of individual QoS flows respectively and derives round trip delay based on the two direction QoS flows packet delay monitored result NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1628",
    "document_id": "23501-i80",
    "chunk_id": 1628,
    "text": "How PCF calculates the requested round trip delay for multiple QoS Flows from delays of individual QoS Flows is not specified in this specification The AF may provide the Alternative QoS parameter set requirements and Averaging Window to the NEFPCF for the GBR QoS Flow as specified in clause 41566 of TS 23502 3 5375 PDU Set based Handling 53751 General A PDU Set is comprised of one or more PDUs carrying an application layer payload such as a video frame or video slice The PDU Set based QoS handling by the NG-RAN is determined by PDU Set QoS Parameters in the QoS profile of the QoS Flow specified in clause 577 and PDU Set Information provided by the PSA UPF via N3N9 interface as described in clause 53752 The PDU Set based Handling can be applied for GBR and non-GBR QoS Flows",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1629",
    "document_id": "23501-i80",
    "chunk_id": 1629,
    "text": "The AF should provide PDU Set related assistance information for dynamic PCC control One or more of the following PDU Set related assistance information may be provided to the NEFPCF using the AF session with required QoS procedures in clauses 41566 and 41566a of TS 23502 3 - PDU Set QoS Parameters as described in clause 577 - Protocol Description Indicates the transport protocol used by the service data flow eg RTP SRTP and information eg the following - RTP 185 or SRTP 186 - RTP or SRTP with RTP Header Extensions including - RTP Header Extensions for PDU Set Marking as defined in TS 26522 179 - Other RTP Header Extensions as defined RFC 8285 189 - RTP or SRTP without RTP Header Extensions but together with RTP Payload Format eg H264 187 or H265 188 - RTP or SRTP with RTP Header Extensions for PDU Set Marking as defined in TS 26522 179 and together with RTP Payload Format eg H264 187 or H265 188 - RTP or SRTP with other RTP Header Extensions following RFC 8285 189 and together with RTP Payload Format eg H264 187 or H265",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1630",
    "document_id": "23501-i80",
    "chunk_id": 1630,
    "text": "188 NOTE 1 With the Protocol Description options combining SRTP together with RTP Payload Format the UPF can still obtain some of the PDU Set information from the RTP Header refer to Annex A of TS 26522 179 When RTP Header Extensions for PDU Set Marking as defined in TS 26522 179 or other RTP header extensions as defined in RFC 8285 189 is included the differentiation between different RTP Header Extension Types should be supported When RTP Payload Format is included the differentiation between different RTP Payload Formats should be supported NOTE 2 Multiplexing of different transport protocols and different media traffic for differentiated PDU Set based handling is not supported in the current Release The Protocol Description can be UL only DL only or UL and DL The Protocol Description for UL and DL traffic may be different AF provided PDU Set QoS Parameters and UL andor DL Protocol Description may be used in determining the PCC Rule by the PCF as defined in clause 613274 of TS 23503 45 and the DL Protocol Description may be used for identifying the PDU Set Information and PDU Set Information marking by the PSA UPF When the SMF receives the PCC rule the SMF performs binding of the PCC rule to one QoS Flow as described in clause 61324 of TS 23503 45 At least one of the following shall be included in the PCC rule to enable PDU Set based handling 1 a PSIHI andor 2 both PSDB and PSER Based on the PCC rule the SMF adds the PDU Set QoS Parameters to the QoS Profile of the QoS Flow as described in clause 6224 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1631",
    "document_id": "23501-i80",
    "chunk_id": 1631,
    "text": "Alternatively the SMF may be configured to support PDU Set based Handling without receiving PCC rules from a PCF For the downlink direction the PSA UPF identifies PDUs that belong to PDU Sets and marks them accordingly as described in clause 53752 If the PSA UPF receives a PDU that does not belong to a PDU Set based on Protocol Description for PDU Set identification then the PSA UPF still maps it to a PDU Set and determines the PDU Set Information as described in clause 53752 NOTE 3 If the PSA UPF receives a PDU that does not belong to a PDU Set then it is assumed that the UPF determines the PDU Set Importance value based on pre-configuration For the uplink direction the UE may identify PDU Sets and how this is done is left up to UE implementation The SMF may send the UL Protocol Description associated with the QoS rule to UE NOTE 4 Using the Protocol Description or not is left to UE implementation The use of Protocol Description does not impact QoS Flow Mapping in the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1632",
    "document_id": "23501-i80",
    "chunk_id": 1632,
    "text": "In this Release the PDU Set based handling is supported in 5GS for UE registered in 3GPP access for single access PDU Session with IP PDU Session Type 53752 PDU Set Information and Identification To support PDU Set based QoS handling the PSA UPF identifies PDUs that belong to a PDU Set and determines the below PDU Set Information and sends it to the NG-RAN in the GTP-U header The PDU Set information is used by the NG-RAN for PDU Set based QoS handling as described above The PDU Set Information comprises - PDU Set Sequence Number - Indication of End PDU of the PDU Set - PDU Sequence Number within a PDU Set - PDU Set Size in bytes - PDU Set Importance which identifies the relative importance of a PDU Set compared to other PDU Sets within a QoS Flow The NG-RAN may use the Priority Level see clause 5733 across QoS Flows and PDU Set Importance within a QoS Flow for PDU Set level packet discarding in presence of congestion NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1633",
    "document_id": "23501-i80",
    "chunk_id": 1633,
    "text": "In addition to considering the PDU Set Importance within a QoS Flow NG-RAN could also consider the relative PDU Set Importance across QoS Flows of the same Priority Level when determining which PDU Set needs to be discarded which is up to implementation and configuration of operator NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1634",
    "document_id": "23501-i80",
    "chunk_id": 1634,
    "text": "The PDU Set Information can be different for different PDU Sets within a QoS Flow If the NG-RAN has provided a PDU Set based handling support Indication indicating that PDU Set handling is supported and a Protocol Description together with 1 a PSIHI andor 2 PSDB and PSER is included in the PCC rule the SMF instructs PSA UPF to perform PDU Set marking and may provide the PSA UPF the DL Protocol Description used by the service data flow The DL Protocol Description may be received in the PCC rule based on information provided by the AF or by PCF local policies as described in clause 53751 PSA UPF can identify the PDU Set Information using the DL Protocol Description and the received transport protocol headers and payload or using implementation specific means The details of the RTPSRTP headers header extensions andor payloads used to identify PDU Set Information are defined in TS 26522 179",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1635",
    "document_id": "23501-i80",
    "chunk_id": 1635,
    "text": "For each DL PDU received on N6 for which PDU Set based QoS handling is indicated from the SMF the PSA UPF applies the rules for PDU Set identification and provides the available PDU Set Information to the RAN in the GTP-U header NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1636",
    "document_id": "23501-i80",
    "chunk_id": 1636,
    "text": "The PSA UPF is expected to assign a unique PDU Set Sequence Number in the GTP-U header to each PDU Set of the QoS Flow 53753 Non-homogenous support of PDU set based handling in NG-RAN The SMF by sending PDU Set QoS parameters to the NG-RAN as described in clause 5771 requests the NG-RAN to activate PDU Set QoS handling for a given QoS Flow and the NG-RAN provides the SMF with a PDU Set Based Handling Support Indication if the PDU Set based handling is supported Based on this indication SMF may activate the PDU Set identification and marking in the PSA UPF During mobility procedures that result in the change of NG-RAN the target NG-RAN provides to the SMF a PDU Set Based Handling Support Indication if it supports PDU Set based handling as specified in TS 38413 34 Based on the target NG-RAN indication the SMF may upon completion of the mobility procedure initiate the PDU Session modification procedure to provide PDU Set QoS parameters to NG-RAN and may configure the PSA UPF to activate the PDU Set identification and marking If the PDU Set Based Handling Support Indication is not received from the target NG-RAN and PDU Set identification and marking is active in the PSA UPF the SMF may deactivate it In the case where the PSA UPF identifies and marks PDUs with PDU Set information in GTP-U header it shall start doing so from a complete PDU Set 5376 ULDL policy control based on round-trip latency requirement For XR and other interactive media services that require very low Round-Trip RT latency Uplink-Downlink policy control may be supported to meet the RT latency requirement RT latency requirement is the upper bound for the sum of UL delay and DL delay of a single data flow or two different data flows between UE and N6 termination point at the UPF PCF may support Uplink-Downlink policy control based on RT latency requirement based on an RT latency indication from AF as defined in clause 613272 of TS 23503 45 during the AF session with the required QoS procedure as defined in clause 41566 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1637",
    "document_id": "23501-i80",
    "chunk_id": 1637,
    "text": "The AF can provide an RT latency indication with a single direction delay requirement between the UE and the PSA UPF expressed as the QoS Reference parameter or individual QoS parameters as defined in clause 61322 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1638",
    "document_id": "23501-i80",
    "chunk_id": 1638,
    "text": "The RT latency indication indicates the need to meet the RT latency requirement for data flow ie doubling of the single direction delay requirement between the UE and the PSA UPF expressed by the QoS Reference parameter or individual QoS parameter PCF determines the data flows UL PDB and DL PDB based on the RT latency requirement The UL PDB and DL PDB can be unequal but their sum shall not exceed the RT latency requirement The PCF shall generate two PCC rules one for UL QoS flow for UL traffic of the data flow and one for DL QoS flow for DL traffic of the data flow respectively PCF shall assign the 5QIs for each of these two PCC rules according to the derived UL PDB and DL PDB To support UL and DL delay tracking the QoS monitoring for UL packet delay and the DL packet delay as defined in clause 61321 of TS 23503 45 shall be triggered respectively to request tracking the UL packet delay of the QoS flow used in UL and DL packet delay of the QoS flow used in DL independently Based on the QoS monitoring results the PCF may readjust the UL PDB andor DL PDB under the consideration of the RT latency requirement to better fit the new situation The Uplink-Downlink policy control based on round-trip latency requirement for two unidirectional service data flows is described in clause 613272 of TS 23503 45 NOTE How the PCF derives the round-trip latency and takes policy decisions is up to the implementation 5377 5GS Packet Delay Variation monitoring and reporting 53771 General The 5GS Packet Delay Variation is the variation of packet delay measured between UE and PSA",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1639",
    "document_id": "23501-i80",
    "chunk_id": 1639,
    "text": "UPF The AF may send the requirement for Packet Delay Variation monitoring to 5GS together with the requirement for packet delay measurement as described in clause 61326 of TS 23503 45 Upon AF request for Packet Delay Variation monitoring together with packet delay monitoring the PCF triggers the QoS monitoring procedure and obtains the UL DL or RT QoS Monitoring result from the SMF After receiving the QoS Monitoring result the PCF derives the 5GS Packet Delay Variation based on the QoS Monitoring result and then reports to the AFNEF both packet delay measurements and Packet Delay Variation The details of the QoS Monitoring and QoS Monitoring for packet delay are described in clauses 545 and 5333 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1640",
    "document_id": "23501-i80",
    "chunk_id": 1640,
    "text": "The derivation of 5GS Packet Delay Variation by PCF based on QoS Monitoring is implementation dependent The Packet Delay Variation calculation method needs to be the same within the PLMN based on operator policy QoS Monitoring is used to obtain measurement of QoS parameters of individual QoS Flows PCF determines the measurements required based on input from AF and enables the measurements by generating an authorized QoS Monitoring Policy for the PCC Rule as specified in clause 61321 of TS 23503 45 5378 UE power saving management 53781 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1641",
    "document_id": "23501-i80",
    "chunk_id": 1641,
    "text": "The following traffic assistance information may be provided by the CN to NG-RAN in order to configure UE power saving management scheme for connected mode DRX - UL andor DL Periodicity - N6 Jitter Information associated with the DL Periodicity - Indication of End of Data Burst The UL andor DL Periodicity and N6 Jitter Information associated with the DL Periodicity are provided by the CN to NG RAN via TSCAI 53782 Periodicity and N6 Jitter Information associated with Periodicity In the procedures for setting up or updating an AF session with QoS the 5G System may be provided with ULDL Periodicity information for NG-RAN to configure UE power management for connected mode DRX The ULDL Periodicity information is provided by the AF to the PCF via NEF or directly to the PCF when the AF is trusted NOTE 1 AF can provide the updated periodicity and 5G system can provide the updated ULDL periodicity to NG-RAN If ULDL Periodicity information is available at the PCF the PCF sends the Periodicity information received from the AFNEF to the SMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1642",
    "document_id": "23501-i80",
    "chunk_id": 1642,
    "text": "In accordance with the operators local policies the PCF may include an indication for SMF to request the UPF to perform N6 Traffic Parameters measurement ie N6 Jitter Information associated with the DL Periodicity and if not provided by the AF ULDL periodicity within the PCC Rules Upon reception of a PCC rule with Periodicity information the SMF determines the TSCAI and forwards it to the NG-RAN If the PCC rule indicates to perform N6 Traffic Parameter measurements the SMF shall request the UPF to monitor and periodically or event-triggered report the N6 Traffic Parameters ie the N6 Jitter Information associated with the DL Periodicity and if not provided by the AF ULDL periodicity using the N4 Session Modification procedure see clause 58511",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1643",
    "document_id": "23501-i80",
    "chunk_id": 1643,
    "text": "If the measurement of N6 Jitter Information associated with the DL Periodicity is required and the DL Periodicity is available at the SMF the SMF also sends the DL Periodicity to the UPF The UPF reports the measured N6 Traffic Parameters to SMF via N4 interface NOTE 2 How the UPF derives the N6 jitter and periodicity ie when periodicity is not provided by the AF is implementation dependent At reception of measured N6 Traffic Parameters from the UPF in the N4 Session Level Report the SMF includes the N6 Jitter Information associated with the DL Periodicity together with the DL periodicity and the UL periodicity if not provided by the AF in the TSCAI and forwards it to the NG-RAN in an NGAP message see clause 5272 NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1644",
    "document_id": "23501-i80",
    "chunk_id": 1644,
    "text": "In order to prevent frequent updates from the UPF the UPF sends the N6 Jitter Measurement Report periodically or only when the N6 jitter is larger than a threshold The N6 Jitter Information associated with the DL Periodicity indicates the range of the positive or negative deviation of the arrival time of first arrived packet of a Data Burst compared to the ideal Data Burst start time which is determined based on the DL periodicity 53783 End of Data Burst Indication An indication of End of Data Burst may be provided to the NG-RAN by the PSA UPF eg to configure UE power management schemes like",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1645",
    "document_id": "23501-i80",
    "chunk_id": 1645,
    "text": "connected mode DRX Based on the End of Data Burst Marking Indication in a PCC rule andor on local operator policies SMF should request the PSA UPF to detect the last PDU of the data burst and mark the End of Data burst in the GTP-U header of the last PDU in downlink The SMF may provide the PSA UPF the End of Data Burst Marking Indication and Protocol Description used by the service data flow The Protocol Description may be received in the PCC rule based on information provided by the AF or by PCF local policies as described in clause 53751",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1646",
    "document_id": "23501-i80",
    "chunk_id": 1646,
    "text": "According to the request and information from the SMF the UPF identifies the last PDU of a Data burst in the DL traffic using the DL Protocol Description and the received transport protocol headers as defined in TS 26522 179 or using implementation specific means and provides an End of Data Burst indication to the NG-RAN in GTP-U header of the last PDU of the Data burst NOTE There can be some packets from the Data Burst received by NG-RAN after the PDU with End of Data Burst Indication if packets are received out of sequence 538 Support for Multi-USIM UE 5381 General A network and a Multi-USIM UE may support one or more of the following features for Multi-USIM UE operation - Connection Release as described in clause 5382 - Paging Cause Indication for Voice Service as described in clause 5383 - Reject Paging Request as described in clause 5384 - Paging Restriction as described in clause 5385 - Paging Timing Collision Control as described in clause 5386",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1647",
    "document_id": "23501-i80",
    "chunk_id": 1647,
    "text": "In the Registration procedure as specified in clause 42222 when a Multi-USIM UE has more than one USIM active supports and intends to use one or more Multi-USIM specific features it indicates to the AMF the corresponding Multi-USIM features are supported except for the Paging Timing Collision Control feature Based on the received indication of the supported Multi-USIM features from the UE the AMF shall indicate to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1648",
    "document_id": "23501-i80",
    "chunk_id": 1648,
    "text": "the support of the Multi-USIM features based on the Multi-USIM features supported by network and any preference policy by the network if available When a UE returns to having only one USIM active from a Multi-USIM UE that previously indicated to the network it supported Multi-USIM features the UE shall indicate all the Multi-USIM features are not supported to the network for that USIM The AMF shall only indicate the support of Paging Restriction feature together with the support of either Connection Release feature or Reject Paging Request feature The Multi-USIM UE includes the support of individual features for Connection Release Paging Cause Indication for Voice Service Reject Paging Request and Paging Restriction as specified in clause 544a NOTE The Paging Timing Collision Control feature being based on the Mobility Registration Update and it doesnt require capability exchange between the UE and network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1649",
    "document_id": "23501-i80",
    "chunk_id": 1649,
    "text": "The network shall not indicate support for any Multi-USIM feature to the UE as part of the Emergency Registration procedure A Multi-USIM UE shall use a separate PEI for each USIM when it registers with the network 5382 Connection Release A Multi-USIM UE may request the network to release the UE from RRC_CONNECTED state in 3GPP access for a USIM due to activity on another USIM in 3GPP access if both UE and network indicate the Connection Release feature is supported to each other In the case of NAS connection release procedure the UE indicates that it requests to be released from RRC_CONNECTED state by initiating either a Service Request procedure over 3GPP access or a Registration procedure over 3GPP access if case the UE needs to perform Registration Update at the same time with this network including the case where the Registration Request is sent due to mobility outside the Registration Area ie before detecting whether the network supports the feature in the new Tracking Area provided that the network has already indicated support for Connection Release feature in the current stored Registration Area by including a Release Request Indication If supported by the UE and network the UE may also provide only together with the Release Request Indication Paging Restriction Information as specified in clause 5385 which requests the network to restrict paging If the UE is performing an Emergency Registration then it shall not include a Release Request Indication For NR5G access an AS method for the UE to request the network to release the UE from RRC_CONNECTED state is specified in TS 38300 27 This mechanism does not allow the UE to indicate Paging Restrictions NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1650",
    "document_id": "23501-i80",
    "chunk_id": 1650,
    "text": "When both the access stratum and NAS based approaches for requesting the connection release are supported by the UE and the network it depends on the UE implementation which of the two to use for example based on the preferred end state RRC_INACTIVE or RRC_IDLE and whether Paging Restriction Information is to be provided NOTE 2 When there is no PLMN-wide support for the Connection Release feature it can occur that upon Mobility Registration Update with Release Request indication the UE is not released by the network The UE behaviour when it detects that the network does not support the feature in a new RA is outside the scope of this specification 5383",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1651",
    "document_id": "23501-i80",
    "chunk_id": 1651,
    "text": "Paging Cause Indication for Voice Service A Multi-USIM UE and the network may support Paging Cause Indication for Voice Service feature The network that supports Paging Cause Indication for Voice Service feature shall provide a Voice Service Indication for IMS voice service in the Paging message only if the UE indicates the Paging Cause Indication for Voice Service feature is supported to the network The network determines the IMS voice service based on the Paging Policy Indicator as specified in clause 5432 Upon reception of the Voice Service Indication in NGAP Paging Message from AMF the NG-RAN supporting Paging Cause Indication for Voice Service should include the Voice Service Indication in the Uu Paging message to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1652",
    "document_id": "23501-i80",
    "chunk_id": 1652,
    "text": "When the UE context in the AMF indicates Paging Cause Indication for Voice Service feature is supported in order to require NG RAN to deliver the Voice Service Indication in RAN paging for the UE in RRC_INACTIVE state the AMF provides an indication indicating the Paging Cause Indication for Voice Service feature is supported to the NG-RAN Upon reception of the indication the NG-RAN that supports the feature stores a Paging Cause Indication for Voice Service indication in its the UE context For a UE in RRC_INACTIVE the NG-RAN should provide the Voice Service Indication in the RAN Paging message only when there is Paging Cause Indication for Voice Service indication in the UE context and detects the downlink data which triggers the RAN Paging message is related to voice service based on the Paging Policy Indicator in the header of the received downlink data as specified in clause 5432 UE that supports the Paging Cause Indication for Voice Service feature is capable of differentiation between Paging from a network that does not support the Paging Cause Indication for Voice Service feature and Paging without the Voice Service Indication How the UE distinguishes the Paging from a RAN that does not support the Paging Cause Indication for Voice Service feature and Paging without the Voice Service Indication is defined in TS 38331 28 The UE determines whether the Paging Cause Indication for Voice Service feature is supported in the current Registration Area by 5GC based on the MUSIM capability exchange with the AMF see clause 5381",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1653",
    "document_id": "23501-i80",
    "chunk_id": 1653,
    "text": "The UE determines that the Paging Cause Indication for Voice Service feature is supported if it is supported by both the RAN as indicated in the received Uu Paging message and by 5GC as indicated in the MUSIM capability exchange with the AMF The UE uses the Paging Cause Indication for Voice Service as described in TS 24501 47 and TS 38331 28 5384 Reject Paging Request A Multi-USIM UE may set up a connection to respond to a page with a Reject Paging Indication to the network indicating that the UE does not accept the paging and requests to return to CM-IDLE state after sending this response if both UE and network indicate the Reject Paging Request feature is supported to each other Upon being paged by the network the Multi-USIM UE in CM-IDLE state attempts to send a Service Request message to the paging network including the Reject Paging Indication as the response to the paging unless it is unable to do so eg due to UE implementation constraints",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1654",
    "document_id": "23501-i80",
    "chunk_id": 1654,
    "text": "In addition to the Reject Paging Indication the UE may include Paging Restriction Information as specified in clause 5385 in the Service Request message if supported by UE and network NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1655",
    "document_id": "23501-i80",
    "chunk_id": 1655,
    "text": "A Multi-USIM UE in RRC_INACTIVE state can decide to not initiate the RRC connection resumption procedure eg when it decides not to respond to the paging message due to UE implementation constraints as specified in TS 24501 47 and TS 38331 28 5385 Paging Restriction A Multi-USIM UE and the network may support Paging Restriction A Multi-USIM UE if the AMF indicates that the network supports Paging Restriction feature may indicate Paging Restriction Information in the Service Request or Registration Request message including the case where the Registration Request is sent due to mobility outside the Registration Area ie before detecting whether the network supports the feature in the new Tracking Area provided that the network has already indicated support for Paging Restriction feature in the current stored Registration Area as specified in clauses 5382 and 5384 Based on operator policy the AMF may accept or reject the Paging Restriction Information requested by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1656",
    "document_id": "23501-i80",
    "chunk_id": 1656,
    "text": "If the AMF accepts the Paging Restriction Information from the UE the AMF stores the Paging Restriction Information from the UE in the UE context If the AMF rejects the Paging Restriction Information the AMF removes any stored Paging Restriction Information from the UE context and discards the UEs requested Paging Restriction Information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1657",
    "document_id": "23501-i80",
    "chunk_id": 1657,
    "text": "The AMF informs the UE about the acceptancerejection of the requested Paging Restriction Information in the Registration Accept or Service Accept message If the UE does not provide any Paging Restriction Information in the Service Request over 3GPP access or the Registration Request over 3GPP access the AMF removes any stored Paging Restriction Information from the UE context The Paging Restriction Information may indicate any of the following a all paging is restricted or b all paging is restricted except paging for voice service IMS voice or c all paging is restricted except for certain PDU Sessions or d all paging is restricted except paging for voice service IMS voice and certain PDU sessions NOTE 1 The UE expects not to be paged for any purpose in case a The UE expects to be paged only for voice service in case b The UE expects to be paged only for certain PDU Sessions in case c The UE expects to be paged for voice service and certain PDU sessions in case d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1658",
    "document_id": "23501-i80",
    "chunk_id": 1658,
    "text": "The AMF can page the UE for mobile terminated signalling based on local policy considering the stored Paging Restriction Information except for case a In this case to comply with the UE provided Paging Restriction Information the AMF can trigger AN release procedure as soon as possible after the mobile terminated signalling procedure is executed NOTE 2 In the case of roaming the Paging Restrictions for voice service implied by bullet b and d depends on the existence of an agreement with the HPLMN to support voice service via IMS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1659",
    "document_id": "23501-i80",
    "chunk_id": 1659,
    "text": "Hence the support of Paging Restrictions in bullets b and d takes the IMS voice service agreement into consideration NOTE 3 When there is no PLMN-wide support for the Paging Restriction feature it can occur that upon Mobility Registration Update with Paging Restriction Information the UE detects the network does not support the feature If so the UE assumes that no Paging Restriction Information is applied 5386 Paging Timing Collision Control To avoid possible paging occasion collision and to enhance the likelihood that paging is received successfully for different USIMs a Multi-USIM UE may need a new 5G-GUTI to modify the timing of the Paging Occasions POs for a USIM when the USIMs registration is not emergency registration When a Multi-USIM UE needs a 5G-GUTI assignment it performs a Mobility Registration Update without any specific indication ie it is using a normal Registration procedure This triggers the AMF to allocate a new 5G-GUTI and provide it to the Multi-USIM UE in the Registration Accept message NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1660",
    "document_id": "23501-i80",
    "chunk_id": 1660,
    "text": "It is recommended to avoid excessive signalling load from UE due to this procedure 539 Remote provisioning of credentials for NSSAA or secondary authenticationauthorization 5391 General The UEs subscribed network ie HPLMN or subscribed SNPN may provide functionalities to provision or update the credentials used for NSSAA or credentials used for secondary authenticationauthorization to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1661",
    "document_id": "23501-i80",
    "chunk_id": 1661,
    "text": "The provisioning procedure is supported via User Plane For User Plane Remote Provisioning the UE establishes a PDU Session that is used for remote provisioning eg by using DNNsS-NSSAIs which can access the PVS The AMF selects an SMF used for remote provisioning using the SMF discovery and selection functionality as described in clause 632 If the SMF is configured with the PVS addresses andor PVS FQDNs the SMF shall send the PVS addresses andor PVS FQDNs per DNNS-NSSAI to the UE via PCO during PDU Session Establishment procedure based on the UEs subscribed DNNsS-NSSAIs and the UEs request of PVS information from the network Alternatively the UE may be configured with an address of a PVS or the PVS may subscribe for UE Reachability Notification and may use the Application Triggering procedure as specified in TS 23502 3 to trigger the UE to initiate the setup of a connection for remote provisioning 5392 Configuration for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1662",
    "document_id": "23501-i80",
    "chunk_id": 1662,
    "text": "In order to enable UP Remote Provisioning of credentials for NSSAA or secondary authenticationauthorization UE Configuration Data for UP Remote Provisioning are either pre-configured on the UE or provided by the network to the UE UE Configuration Data for UP Remote Provisioning provided by the network take precedence over corresponding configuration data stored in the UE UE Configuration Data for UP Remote Provisioning consist of PVS IP addresses andor PVS FQDNs The PVS IP address or PVS FQDN may be associated with dedicated DNNs andor S-NSSAIs If the UE does not have any PVS IP address or PVS FQDN after the establishment of a PDU Session used for UP remote provisioning the UE may construct an FQDN for PVS discovery as defined in TS 23003 19 The UE Configuration Data for UP Remote Provisioning may be stored in the ME The UE Configuration Data for UP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1663",
    "document_id": "23501-i80",
    "chunk_id": 1663,
    "text": "Remote Provisioning ie PVS IP addresses or PVS FQDNs associated with dedicated DNNs andor S-NSSAIs may be locally configured in the SMF The UE Configuration Data for UP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1664",
    "document_id": "23501-i80",
    "chunk_id": 1664,
    "text": "Remote Provisioning if available shall be provided to the UE during the establishment of any PDU Session used for UP Remote Provisioning as part of Protocol Configuration Options PCO in the PDU Session Establishment Response if the UE has requested the PVS information via PCO in the PDU Session Establishment Request 540 Support of Disaster Roaming with Minimization of Service Interruption 5401 General Subject to operator policy and nationalregional regulations 5GS provides Disaster Roaming service for the UEs from PLMNs with Disaster Condition The UE shall attempt Disaster Roaming only if - there is no available PLMN which is allowable see TS 23122 17 - the UE is not in RM-REGISTERED and CM-CONNECTED state over non-3GPP access connected to 5GCN - the UE cannot get service over non-3GPP access through ePDG - the UE supports Disaster Roaming service - the UE has been configured by the HPLMN with an indication of whether Disaster roaming is enabled in the UE set to disaster roaming is enabled in the UE as specified in clause 5402 and - a PLMN without Disaster Condition is able to accept Disaster Inbound Roamers from the PLMN with Disaster Condition In this Release of the specification the Disaster Condition only applies to NG-RAN nodes which means the rest of the network functions except one or more NG-RAN nodes of the PLMN with Disaster Condition can be assumed to be operational 5402 UE configuration and provisioning for Disaster Roaming A UE supporting Disaster Roaming is configured with the following information - Optionally indication of whether disaster roaming is enabled in the UE - Optionally indication of applicability of lists of PLMNs to be used in disaster condition provided by a VPLMN - Optionally list of PLMNs to be used in Disaster Condition The Activation of Disaster Roaming is performed by the HPLMN by setting the indication of whether Disaster roaming is enabled in the UE to disaster roaming is enabled in the UE using the UE Parameters Update Procedure as defined in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1665",
    "document_id": "23501-i80",
    "chunk_id": 1665,
    "text": "The UE shall only perform disaster roaming if the HPLMN has configured the UE with the indication of whether disaster roaming is enabled in the UE and set the indication to disaster roaming is enabled in the UE The UE registered for Disaster Roaming service shall deregister from the PLMN providing Disaster Roaming service if the received indication of whether disaster roaming is enabled in the UE is set to disaster roaming is disabled in the UE The optional list of PLMNs to be used in Disaster Condition may be pre-configured in USIM or provided by the HPLMN during and after a successful registration procedure over 3GPP access or non-3GPP access via Registration Request procedure or UE Configuration Update procedure as defined in TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1666",
    "document_id": "23501-i80",
    "chunk_id": 1666,
    "text": "The list of PLMNs to be used in Disaster Condition may be configured over non-3GPP access before disaster condition has occurred While roaming ie not in HPLMN the Registered PLMN may provide the list of PLMNs to be used in Disaster Condition during and after a successful registration procedure to the UE via Registration Request procedure or UE Configuration Update procedure as specified in TS 23502 3 This list shall not alter any list provided by the HPLMN and shall only be used if the UE is configured by the HPLMN using the UE Parameters Update Procedure as defined in TS 23502 3 with the indication of applicability of lists of PLMNs to be used in disaster condition provided by a VPLMN set to True The details of the UE behaviour regarding the usage of this list are described in TS 23122 17 and TS 24501 47 If the UE is not configured with list of PLMNs to be used in Disaster Condition the UE follows the procedure described in TS 23122 17 to select PLMN to be used in Disaster Condition",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1667",
    "document_id": "23501-i80",
    "chunk_id": 1667,
    "text": "The HPLMN may use UE Parameters Update Procedure as defined in TS 23502 3 to update the Disaster Roaming information configuration in UE if the UDM has received MINT support indication as indicated in 5GMM capability from the AMF The UE indicates the support of MINT in 5GMM capability as specified in clause 544a during registration procedure as defined in TS 23502 3 5403 Disaster Condition Notification and Determination The NG-RAN in the PLMN that provides Disaster Roaming service broadcasts an indication of accessibility for Disaster Roaming service and optionally a list of one or more PLMNs with Disaster Condition for which Disaster Roaming service is offered by the available PLMN in the impacted area as described in TS 38304 50 and TS 38331 28 A UE determines the Disaster Condition based on the information broadcasted from the NG-RAN providing Disaster Roaming service and performs the network selection and the access control for the Disaster Roaming as described in TS 23122 17 and",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1668",
    "document_id": "23501-i80",
    "chunk_id": 1668,
    "text": "TS 24501 47 NOTE 1 How a PLMN is notified that another PLMN is a PLMN with Disaster Condition and how a PLMN is notified of the area where the associated Disaster Condition applies is managed by the government agencies or the authorities and is out of scope of 3GPP NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1669",
    "document_id": "23501-i80",
    "chunk_id": 1669,
    "text": "The broadcast for Disaster Roaming service from the NG-RAN occurs only during the Disaster Condition 5404 Registration for Disaster Roaming service For a UE to receive Disaster Roaming service from a PLMN providing Disaster Roaming service the UE sends a NAS Registration Request message with Registration Type value Disaster Roaming Initial Registration or Disaster Roaming Mobility Registration Update - When the AMF in the PLMN providing Disaster Roaming service receives a NAS Registration Request with Registration Type set to Disaster Roaming Initial Registration or Disaster Roaming Mobility Registration Update - the AMF controls if the UE is allowed to access Disaster Roaming service in the area with Disaster Condition as specified in clause 42222 of TS 23502 3 - the AMF may provide the Disaster Roaming service indication to AUSF and UDM as specified in clause 42222 of TS 23502 3 and TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1670",
    "document_id": "23501-i80",
    "chunk_id": 1670,
    "text": "The AMF may provide the Disaster Roaming service indication to SMF as specified in clause 432 of TS 23502 3 NOTE 1 The AUSF and the UDM are configured with Disaster Condition via OAM based on operator policy and the request by the government agencies Based on this local configuration andor the Disaster Roaming service indication the AUSF can execute authentication of the UE and the UDM can provides the subscription data for a Disaster Roaming service to the AMF andor the SMF To support the Disaster Roaming service the PLMN providing Disaster Roaming service is configured to support communication with the network entities in the HPLMN of the UE ie configurations related to roaming interfaces for communication between serving PLMN and HPLMN shall be deployed in the affected entities This communication between the PLMNs need only be enabled during the Disaster Condition The Disaster Roaming service is limited to the impacted geographic area with Disaster Condition The NG-RAN nodes and AMF in the PLMN providing Disaster Roaming service are configured with the area information ie a list of TAIs which can be formulated by the PLMN providing the Disaster Roaming service based on the geographic area with Disaster Condition in the other PLMNs The AMF in the PLMN providing Disaster Roaming service provides the mobility restriction list to the NG-RAN as specified in clause 53411 considering the area with Disaster Condition and also indicating that EPC is not an allowed core network NOTE 2 From the perspective of emergency services a UE is following procedures as described in clause 424 of TS 24501 47 when registered for Disaster Roaming service NOTE 3 When the UE is registered for Disaster Roaming service SMS over NAS can be supported with the procedures as described in clause 41331 of TS 23502 3 based on subscription data 5405 Handling when a Disaster Condition is no longer applicable When a UE detects a Disaster Condition is no longer applicable the UE performs PLMN selection as described in TS 23122 17 and TS 24501 47 and may return to the PLMN previously with Disaster Condition A PLMN providing Disaster Roaming - May trigger the Disaster",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1671",
    "document_id": "23501-i80",
    "chunk_id": 1671,
    "text": "Inbound Roaming UEs to return to the PLMN previously with Disaster Condition when the Disaster Inbound Roamers attempt to transit to 5GMM-CONNECTED mode - May trigger the Disaster Inbound Roaming UEs to return to the PLMN previously with Disaster Condition by triggering Deregistration procedure - May trigger the Disaster Inbound Roaming UEs to return to the PLMN previously with Disaster Condition by rejecting Registration Request message - May trigger the Disaster Inbound Roaming UEs to return to the PLMN previously with Disaster Condition by rejecting Service Request message - Shall organise the return of the Disaster Roaming UEs in a manner that does not cause overload eg of signalling in the PLMN that previously had the Disaster Condition - Stop broadcasting of providing Disaster Roaming service as specified in clause 5403 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1672",
    "document_id": "23501-i80",
    "chunk_id": 1672,
    "text": "May determine that the disaster condition has ended and the UE which is registered for disaster roaming services has an emergency PDU session the AMF initiates the UE configuration update procedure to indicate that the UE is registered for emergency services as described in TS 24501 47 - May determine that the disaster condition has ended and inform the UE by initiating the UE configuration update procedure indicating re-registration from UE is required as specified in clause 544 of TS 24501 47 if the UE is in CM-CONNECTED mode NOTE Whether and how long the PLMN waits before paging the Disaster Inbound Roamers upon being notified that a Disaster Condition no longer applies is up to operators policy The HPLMN ie the UDM may trigger the Disaster Inbound Roaming UEs to return to the PLMN previously with Disaster Condition by triggering Deregistration procedure 5406 Prevention of signalling overload related to Disaster Condition and Disaster Roaming service",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1673",
    "document_id": "23501-i80",
    "chunk_id": 1673,
    "text": "The load control congestion and overload control mechanism specified in clause 519 and access control and barring specified in clause 525 can be used to mitigate the load caused by UE requesting the Disaster Roaming service in the PLMN providing Disaster Roaming service and returning of UE to allowable PLMN when Disaster Condition is no longer applicable To prevent signalling overload in PLMN providing Disaster Roaming the HPLMN or registered PLMN - may provide the UE in a prioritized manner with the list of PLMNs described in clause 5402 for Disaster Roaming - may provide disaster roaming wait range information to control when the UE can initiate the registration for Disaster Roaming service upon arriving in the PLMN providing Disaster Roaming service as specified in TS 23122 17 and TS 24501 47 and - applies Access Identity 3 for Disaster Roaming service request as specified in TS 24501 47 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1674",
    "document_id": "23501-i80",
    "chunk_id": 1674,
    "text": "The mechanisms available at the AMF and the SMF for mitigation of overload and congestion are used for 5GSM congestion mitigation during the Disaster Roaming To prevent signalling overload by returning UEs in PLMN previously with Disaster Condition which is no long applicable the HPLMN or registered PLMN - may provide disaster return wait range information to control when the UE can initiate the registration upon returning to the PLMN previously with Disaster Condition as specified in TS 23122 17 and TS 24501 47 541 NR RedCap and NR eRedCap UEs differentiation This functionality is used by the network to identify traffic tofrom UEs accessing over NR RedCap or NR eRedCap eg for charging differentiation An NR RedCap UE or NR eRedCap UE using NR shall provide an NR RedCap indication or respectively an NR eRedCap indication to the NG-RAN during RRC Connection Establishment procedure as defined in TS 38300 27 When the UE has provided an NR RedCap indication indicating support of NR RedCap to the NG-RAN during RRC Connection Establishment the NG-RAN shall provide an NR RedCap Indication to the AMF in the Initial UE Message see clause 42221 of TS 23502 3 and TS 38413 34 When the UE has provided an NR eRedCap indication indicating support of NR eRedCap to the NG-RAN during RRC Connection Establishment the NG-RAN shall provide an NR eRedCap Indication to the AMF in the Initial UE Message see clause 42221 of TS 23502 3 and TS 38413 34 When the AMF receives an NR RedCap Indication or NR eRedCap Indication from NG-RAN in an Initial UE Message the AMF shall store the NR RedCap Indication or NR RedCap Indication in the UE context consider that the RAT type is NR RedCap or NR eRedCap and signal it accordingly to the SMSF during registration procedure for SMS over NAS to the SMF during PDU Session Establishment or PDU Session Modification procedure The PCF can also receive the NR RedCap or NR eRedCap RAT type when applicable from the AMF using the PCRT on Access Type change specified in clause 6125 of TS 23503 45 during AM Policy Association Establishment or AM Policy Association Modification procedure and from the SMF using the PCRT on Access Type change specified in clause 6135 of TS 23503 45 during SM Policy Association Establishment or SM Policy Association Modification procedure During handover from E-UTRA to NR the target NG-RAN ie gNB provides the NR RedCap indication or NR eRedCap indication to AMF in NGAP Path Switch Request message during Xn handover or NGAP Handover Request Acknowledge message during N2 handover including intra 5GS N2 handover and EPS to 5GS handover based on the UE capability information provided by the source RAN to the target RAN as specified in TS 38300 27 The NFs interacting with CHF shall include the NR RedCap or NR eRedCap as RAT type Upon AMF change the source AMF shall provide the NR RedCap Indication or NR eRedCap Indication to the target AMF If a UE supports either NR RedCap or NR eRedCap as specified in TS 38306 69 and the UE NG-RAN Radio Capability information changes following the procedure in clause 5441 when the UE performs RRC Connection Establishment procedure the UE shall report the NR RedCap indication or NR eRedCap indication that applies to the new Radio Capability 542 Support of Non-seamless WLAN offload Non-seamless WLAN offload is an optional capability of a UE supporting WLAN radio access The architecture to support authentication for Non-seamless WLAN offload in 5GS is defined in clause 4215 A UE supporting Non-seamless WLAN offload may while connected to WLAN access route specific data flows via the WLAN access without traversing the 5GC These UE data flows are identified using URSP configuration for Non-Seamless Offload or UE Local Configurations as defined in TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1675",
    "document_id": "23501-i80",
    "chunk_id": 1675,
    "text": "For these data flows the UE uses the local IP address allocated by the WLAN access network and no IP address preservation is provided between WLAN and NG-RAN For performing the Non-seamless WLAN offload the UE needs to acquire a local IP address from the WLAN access network and it is not required to connect to an N3IWF ePDG or TNGF If the WLAN access network is configured to require the 5GS based access authentication of the UE for connecting to the WLAN the UE performs the authentication procedure for Non-seamless WLAN offload in 5GS defined in clause 4215 and in Annex S of TS 33501 29 After successful authentication the UE is not considered to be entered in 5GS Registered state The UE can send and receive traffic not traversing the 5GC and which is not under the control of the 5GC A non-3GPP access network may be connected via SWa to multiple PLMNs for 5G NSWO In a roaming scenario the HPLMN may be reached by the UE via a WLAN access connected to more than one VPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1676",
    "document_id": "23501-i80",
    "chunk_id": 1676,
    "text": "Therefore a UE when roaming shall be able to indicate a specific selected VPLMN using decorated NAI for 5G NSWO as specified in clauses 28791 and 28792 of TS 23003 19 through which the NSWO request should be sent towards the HPLMN A non-3GPP access network may be connected to multiple SNPNs different from the Credentials Holder for 5G NSWO When using the credentials owned by CH the UE shall be able to indicate a specific selected SNPN eg using decorated NAI for 5G NSWO through which the NSWO request should be sent towards the CH in the following scenarios - The CH hosts AUSFUDM and the CH is reached by the UE via a WLAN access connected to a SNPN different from the CH as defined in Figure 4215-3a -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1677",
    "document_id": "23501-i80",
    "chunk_id": 1677,
    "text": "The CH hosts AAA server and the CH is reached by the UE via a WLAN access connected to the AAA proxy in specific SNPN as defined in Figure 4215-3b A UE connected to a WLAN access network using 5GS credentials as shown in Figure 4215-1 may also be connected to the 5GC for example to establish a PDU session For example the UE may connect to the 5GC either via another access type such as NG-RAN or via the same WLAN access network by performing the 5GS registration via Untrusted non-3GPP access procedure using N3IWF or interworking between ePDG connected to EPC and 5GS using ePDG defined in TS 23502 3 When a UE is connected to a WLAN access network eg using 5GS credentials and using an Untrusted non-3GPP access the UE can perform Non-Seamless Offload of some or all data traffic to this WLAN access network sending the traffic outside the IPSec tunnel encapsulation as defined in URSP rules with Non-Seamless Offload indication A UE may use the Registration procedure for Trusted non-3GPP access defined in clause 412a22 of TS 23502 3 and then determine to send some traffic to be subject to Non-seamless WLAN offload outside of the IPSec tunnel established with the TNGF NOTE A UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1678",
    "document_id": "23501-i80",
    "chunk_id": 1678,
    "text": "cannot first connect to a WLAN access network using 5GS credentials and without performing 5GS registration and then later on this WLAN access network perform 5GS registration using the Trusted non-3GPP access procedure without first having to release the WLAN and then to establish a new WLAN association per the Registration procedure for Trusted non-3GPP access as defined in clause 412a22 of TS 23502 3 When the UE decides to use 5G NSWO to connect to the WLAN access network using its 5GS credentials but without registration to 5GS the NAI format for 5G NSWO is used whose realm is different than the realm defined for usage of Trusted non-3GPP access to the 5GC defined in clauses 2876 and 2877 of TS 23003 19 The NAI format for 5G NSWO is defined in TS 23003 19 543 Support for 5G Satellite Backhaul 5431 General Satellite may be used as part of the backhaul between RAN and 5GC The 5G System supports to report of usage of satellite backhaul as described in clause 5432",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1679",
    "document_id": "23501-i80",
    "chunk_id": 1679,
    "text": "For some deployments UPF may be deployed on the satellite In these cases edge computing or local switch via UPF deployed on the satellite may be performed as described in clauses 5432 and 5433 Deployments with satellite backhaul and edge computing with UPF on the ground is supported as described in clause 513 ie without satellite backhaul specific requirements 5432 Edge Computing via UPF deployed on satellite This clause only applies to the case where Edge Computing is deployed with UPF and Edge Computing services on-board the satellite The UPF deployed on satellite can act as UL CLBPlocal PSA UPF or act as PSA UPF NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1680",
    "document_id": "23501-i80",
    "chunk_id": 1680,
    "text": "In this Release Edge Computing via UPF deployed on satellite only applies to GEO satellite backhaul To select the UPF deployed on satellite as PSA the following enhancements apply - If the UE is accessing gNB with satellite backhaul and AMF is aware of the satellite backhaul category the AMF sends the satellite backhaul category to the PCF If GEO satellite backhaul category is indicated the PCF may take it into account to generate or update the URSP rule as defined in clause 6122 of TS 23503 45 to including an appropriate Route Selection Descriptor for services deployed on GEO satellite which further enable PDU Session Establishment with PSA UPF on the satellite Based on GEO satellite ID provided by the AMF the SMF performs PSA UPF selection or UL CLBPlocal PSA selection and insertion during the PDU Session Establishment procedure as described in clause 432 of TS 23502 3 or PDU Session Modification procedure as described in clause 433 of TS 23502 3 to select the UPF deployed on the GEO satellite if available which includes - Based on configuration the AMF may determine the GEO Satellite ID serving the UE and send it to the SMF If GEO satellite ID changes eg due to UE handover to an gNB using different GEO satellite as part of backhaul the AMF may update the latest GEO Satellite ID to the SMF NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1681",
    "document_id": "23501-i80",
    "chunk_id": 1681,
    "text": "It is assumed that AMF determines the GEO Satellite ID based on local configuration eg based on Global RAN Node IDs associated with satellite backhaul - The SMF determines DNAI based on local configuration DNN or S-NSSAI or both and the GEO Satellite ID received from AMF NOTE 3 It is assumed that one or more DNAI values are assigned for each GEO Satellite ID by the operator SMF is locally configured with mapping relationship between DNAI and GEO Satellite ID - If the UE is allowed to access the services according to the EAS Deployment Information as described in clause 6234 of TS 23548 130 the SMF selects the PSA UPF or UL CLBPlocal PSA based on the DNAI corresponding to the GEO Satellite ID and other factors as described in clause 6232 of TS 23548 130 NOTE 4 EASDF may be deployed on satellite based on local configuration 5433 Local switch for UE-to-UE communications via UPF deployed on",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1682",
    "document_id": "23501-i80",
    "chunk_id": 1682,
    "text": "GEO satellite 54331 General The UE to UE traffic may be locally routed by UPFs deployed on satellite ie through local switch to the target UE without traversing back to the satellite gateway on the ground Local switching via UPFs deployed on satellite in this clause only applies on GEO satellite backhaul case and considers only DNNs and slices for 5G VN N19 tunnel may be established between two UPFs deployed on different satellites for traffic between UEs Also N6 may be used for carrying traffic between UPFs deployed on different satellites Only a single SMF is supported for local switching and N19 forwarding ie both UEs are served by the same SMF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1683",
    "document_id": "23501-i80",
    "chunk_id": 1683,
    "text": "The latency optimisation that can be gained by inter-satellite link between UPFs on different GEO satellites depends on the distance between the satellites that can be substantial depending on the number of deployed satellites Clause 54332 describes the case of PSA UPF deployed on satellite clause 54333 describes the case of UL CLBP and local PSA deployed on satellite PSA UPF is on the ground Selection of PSA UPF or UL CLBPlocal PSA on satellite is described in clause 633 and determination of DNAI to select the UPF deployed on the corresponding GEO satellite reuses the mechanism described in clause 5432",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1684",
    "document_id": "23501-i80",
    "chunk_id": 1684,
    "text": "A combination of DNNS-NSSAI is assigned by the operator for the communications between UEs where backhaul with UPF is deployed on GEO satellite the URSP is described in TS 23503 45 and its configuration to enable the selection PSA UPF on the GEO satellite reuses the mechanism described in clause 5432 54332 Local switch with PSA UPF deployed on satellite If SMF selects the UPF deployed on satellite as PSA of UEs PDU Session the SMF configures the UEs N4 session to forwarddetect packet tofrom the internal interface as specified for the configuration for the 5GVN group members N4 Session in clause 582131 Support for unicast traffic forwarding of a 5G VN SMF may reuse the mechanism described in clause 582131 to configure group-level N4 session rules for each N19 tunnel For establishing N19 tunnel between the PSA UPFs onboard the satellite the PSA UPFs are controlled by the same SMF - To process packets between UE and servers residing in DN SMF configures rules to route traffic via N6 as described in clause 582131",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1685",
    "document_id": "23501-i80",
    "chunk_id": 1685,
    "text": "The group-level N4 session is per DNN and S-NSSAI The SMF can create update or delete the group-level N4 Session ie add or delete N4 rules allocate or release the N19 tunnel resources based on operator deployment eg based on GEO satellites planned obsolescence or new GEO satellite setup N6 may be used for carrying traffic between PSA UPFs deployed on different satellites If N6 is used SMF configures corresponding N4 rules for processing traffic tofrom N6 54333 Local switching with UL CLBP and local PSA UPF deployed on satellite If the UEs using GEO satellite backhaul are served by the same SMF and the GEO satellites serving the UEs has UPF deployed the SMF may determine to activate local switching and N19 forwarding for the UEs based on 1 AF request including of UE identifiers which require communication between UEs as described in clause 5292 andor 2 Destination IP addresses reported by on-ground PSA UPF as current reporting mechanism in clause 5857 To enable the destination IP addresses reporting SMF configures the on-ground PSA UPF to detect UL packets with destination IP addresses which belong to the current UPF address pool If the SMF determines that the UEs ie corresponding to AF request in bullet 1 andor the Destination IP addresses reported in bullet 2 are under the same GEO satellite or multiple connectable GEO satellites based on GEO Satellite IDs reported by AMF and the UEs are allowed to access the DNAIs corresponding to the GEO satellite IDs for each UE communicating with target UEs in the communication group the SMF may select and insert the UPF deployed on GEO satellite according to the DNAI as UL CLBP and L-PSA and configures UL CLBP with the following rule - Route the data traffic received from the UE and destined to IP addresses of the target UEs to the L-PSA - Route other data traffic received from the UE to the PSA UPF of the UEs PDU Session NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1686",
    "document_id": "23501-i80",
    "chunk_id": 1686,
    "text": "The SMF determines the GEO satellites are connectable based on configuration The SMF configures the Local PSA with local forwarding rules to forward the data traffic to the target UEs directly If the selected L-PSAs are different for the UEs in the communication group N19 tunnel is established between the L-PSAs For establishing N19 tunnel between the UPFs onboard the satellite the UPFs are controlled by the same SMF If UEs are members of the same 5G VN group the SMF may configure the local data forwarding rules on L-PSAs using 5GVN user plane handing mechanism in clause 582131 Support for unicast traffic forwarding of a 5G VN NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1687",
    "document_id": "23501-i80",
    "chunk_id": 1687,
    "text": "The selected UPF deployed on satellite can be inserted as UL CLBPL-PSA reusing existing UL CLBP insertion procedures defined in TS 23502 3 or TS 23548 130 N6 may be used for carrying traffic between L-PSA UPFs deployed on different satellites If N6 is used SMF configures corresponding N4 rules for processing traffic tofrom N6 5434 Reporting of satellite backhaul to SMF If the AMF is aware that a satellite backhaul is used towards 5G AN the AMF may report this to SMF as part of the PDU Session establishment procedure as described in clause 432 of TS 23502 3 If AMF is aware that satellite backhaul category changes eg at handover the AMF reports the current Satellite backhaul category to SMF The SMF reports it to the PCF when the Satellite backhaul category change PCRT was armed as specified in TS 23503 45 or notifies it to other NFs if requested as described in clause 5283 of TS 23502 3 When the backhaul network changes from a type of satellite to terrestrial network the AMF reports that non-satellite backhaul network is used with the Satellite backhaul category Satellite backhaul category refers to the type of the satellite ie GEO MEO LEO or OTHERSAT DYNAMIC_GEO DYNAMIC_MEO",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1688",
    "document_id": "23501-i80",
    "chunk_id": 1688,
    "text": "DYNAMIC_LEO and DYNAMIC_OTHERSAT used in the backhaul as specified in clause 54339 of TS 29571 183 The dynamic satellite backhaul category ie DYNAMIC_GEO DYNAMIC_MEO DYNAMIC_LEO and DYNAMIC_OTHERSAT refers that ie capabilities latency andor bandwidth of the satellite backhaul change over time due to eg use of varying inter-satellite links as part of backhaul Only a single backhaul category can be indicated NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1689",
    "document_id": "23501-i80",
    "chunk_id": 1689,
    "text": "It is assumed that the AMF can determine the Satellite backhaul category for the notification to the SMF based on local configuration eg based on Global RAN Node IDs associated with satellite backhaul 5435 QoS monitoring when dynamic Satellite Backhaul is used If dynamic satellite backhaul is used QoS monitoring may be used to measure packet delay as specified in clause 5452 If the Satellite backhaul category received from SMF indicates dynamic satellite backhaul is used the PCF may based on PCF local policy or configuration request QoS monitoring for the packet delay between UE and PSA UPF as specified in clause 5452 The AF may trigger QoS monitoring by requesting QoS monitoring report from the PCF eg when the AF has received a dynamic satellite backhaul category NOTE PCF handling of satellite backhaul category indication and possible QoS monitoring is specified in TS 23503 45 544 Support of Personal IoT network service 5441 General Personal IoT Network PIN provides local connectivity between PINEs ie UEs andor non-3GPP devices PINEs communicate using PIN direct communication PIN indirect communication and the PIN-DN communication The management of the PIN direct communication is out of the scope of this specification For the PIN indirect communication and PIN-DN communication the data traffic and PIN management traffic pass via a PEGC With the support of the PEGC registered to 5G network the PINEs have access to the 5G network services and may communicate with other PINEs within the PIN or with the DN via 5G network A PEGC may support multiple PINs For each PIN a dedicated DNN S-NSSAI combination shall be configured PIN and PINEs are managed by specific PEMC with support of an AF if AF Application Server and PIN server as specified in TS 23542 181 is deployed A PIN includes at least one PEGC and at least one PEMC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1690",
    "document_id": "23501-i80",
    "chunk_id": 1690,
    "text": "The management of the PIN ie the management of PIN creation deletion and update and PINE including the management role distribution between PEMC and AF is out of the scope of this specification The PEGC is a UE with subscription data related to PIN within the 5GS ie dedicated DNN S-NSSAI combinations for PIN and shall register to 5G network as UE in order to support PIN indirect communication and PIN-DN communication via dedicated PDU session The UE acting as PEMC does not have subscription data related to PIN within the 5GS and behaves as normal UE if it is registered in 5GS An AF for PIN may be deployed to support the PIN service The AF for PIN may communicate with PINEs including PEMC and PEGC via application layer for management of the PIN which is transported as user plane data transparently to 5G network and the AF for PIN may communicate with the 5GC via NEF The PEMC can manage a PIN via PIN direction communication or PIN indirect communication with the other PINEs of the PIN or via PIN-DN communication with an AF for PIN which enables the exchange of information with 5GC The 5GC is enhanced to support the delivery of UE policy related to PIN service for PEGC as specified in clause 5442 and to support the PDU session management for PIN service as specified in clause 5443 See information in Annex P for the relation between PIN and 5GS The PINE PEMC and PEGC application layer functionalities are defined in TS 23542 181 and are transparent in 5G network The support of PIN by 5G-RG and FN-RG is not specified Redundant PDU session for URLLC is not supported in conjunction with PIN 5442 UE policy delivery for PIN For a PEGC registered in the 5G network the 5G network supports the provisioning of URSP rules that include a PIN ID as Traffic Descriptor URSP rules with a PIN ID in the Traffic Descriptor are sent to the PEGC based on the information provided from an AF for PIN as specified in TS 23502 3 and TS 23503 45 for policy delivery 5443 Session management enhancement for PIN service support 54431 PDU Session Establishment for PIN When a PDU Session associated with a PIN is established by PEGC an SMF is selected according to clause 43223 of TS 23502 3 based on DNN S-NSSAI combination The PEGC may use IP address allocation methods as specified in clause 582 eg IPv6 Prefix Delegation feature One PEGC may serve more than one PIN The PEGC may use a single or multiple PDU sessions to serve multiple PINs One PDU Session may be shared by more than one PIN served by the PEGC if differentiation or isolation for the traffics tofrom different PINs via the PEGC is not required in 5GS Otherwise different DNN S-NSSAI combinations shall be applied to distinguish the PINs by different PDU sessions of the PEGC One PIN can be served by only one PDU session in the PEGC If there are multiple PDU sessions for a PIN from different PEGCs connecting to the same UPF the same mechanism for local switching in the UPF as defined for 5G VN group communication as described in clause 58213 may be applied 54432 Session management related policy control For PIN indirect communication and PIN-DN communication via PEGC and 5G network with PDU session the 5G network supports the session policy control The policy control is based on session management procedures as specified in TS 23502 3 and TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1691",
    "document_id": "23501-i80",
    "chunk_id": 1691,
    "text": "An AF for PIN may provide QoS parameters for PIN traffic to 5GC as specified in clauses 41566 41566a and 415614 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1692",
    "document_id": "23501-i80",
    "chunk_id": 1692,
    "text": "An AF for PIN may influence traffic routing for PDU sessions for PIN-DN communication as specified in clause 567 and in clause 436 of TS 23502 3 54433 Non-3GPP QoS Assistance Information QoS experienced by a PINE connected behind a PEGC depends on the end-to-end path between the PINE and the DN ie depends on the QoS differentiation in both the 3GPP network and the non-3GPP network attached to the PEGC Non-3GPP QoS Assistance Information N3QAI enables the PEGC to perform QoS differentiation for PINEs in the non-3GPP network behind the PEGC During PDU session establishment and PDU session modification procedure if the SMF provides the PEGC with QoS flow descriptions the SMF may additionally signal N3QAI for each QoS flow to the PEGC based on the DNN S-NSSAI combination of the PDU Session Based on the N3QAI together with QoS rule information the PEGC may reserve resources in the non-3GPP network N3QAI consists of the following QoS information QoS characteristics GFBRMFBR Maximum Packet Loss Rate How to enforce QoS based on the N3QAI in the non-3GPP network is considered outside the scope of 3GPP 54434 Non-3GPP delay budget between PINE and PEGC For PIN indirect communication and PIN-DN communication of a PINE via a PEGC and 5G network non-3GPP delay is the delay between the PEGC and the PINE 5GC may need to be aware of the non-3GPP delay and compensate for this delay in 5GS",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1693",
    "document_id": "23501-i80",
    "chunk_id": 1693,
    "text": "The compensation is achieved by adjusting the dynamic CN PDB for the 3GPP network by the non-3GPP delay ie the network determined original PDB value is unchanged but it needs to cover non-3GPP delay besides the AN PDB and CN PDB If the PEGC supports providing of the non-3GPP delay budget for a specific QoS flow of the PIN traffic the PEGC may provide a non-3GPP delay budget to SMF by using the UE requested PDU Session Modification procedure Based on the DNN S-NSSAI combination of the PDU Session the SMF may according to operator policy and implementation consider the non-3GPP delay budget when signalling the dynamic CN PDB to NG-RAN The dynamic CN PDB signalled to the NG-RAN may be calculated as the sum of the value of dynamic CN PDB for the related GBR QoS flow and the requested non-3GPP delay budge If the dynamic CN PDB changes in the SMF eg when an I-UPF is inserted by the SMF based on the DNN S-NSSAI combination of the PDU Session the SMF may apply the non-3GPP delay budget again before signalling the dynamic CN PDB to NG-RAN The non-3GPP delay budget does not impact the QoS flow binding in SMF NOTE For deployments that support a PEGC to request a non-3GPP delay budget it is assumed that RAN is locally configured to give precedence to the CN PDB value received via N2 signalling as specified in clause 5734 It is assumed that the PEGC will limit the frequency of triggering the UE-initiated PDU Session Modification request to provide the non-3GPP delay budget to the network to avoid unnecessary signalling 5444 Identifiers for PIN A PIN is managed at the PIN application layer A unique PIN ID in a PLMN is designated to a PIN eg by PIN server as specified in TS 23542 181",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1694",
    "document_id": "23501-i80",
    "chunk_id": 1694,
    "text": "In 5GS the PIN ID is only used in the traffic descriptor of URSP rules for routing traffic of specific PIN towards a dedicated DNN S-NSSAI combination as specified in clause 662 of TS 23503 45 If a PIN contains more than one PEGCs the list of PEGCs may be grouped together following the 5G VN group management principles as specified in clause 5292 Then the PEGCs of a PIN can be identified by an External Group ID by an AF for PIN The AF for PIN may use the External Group ID to manage the list of PEGCs that are part of a PIN and for providing URSP guidance as specified in clause 5442 andor QoS requests applicable to all the PEGCs as specified in clause 5443 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1695",
    "document_id": "23501-i80",
    "chunk_id": 1695,
    "text": "The PEMCs can also be grouped together with the PEGCs using the 5G VN group management functionality for enabling the PEMCs to communicate with PEGCs via UPF local switch in order to manage the PIN 545 QoS Monitoring 5451 General QoS monitoring comprises of measurements of QoS monitoring parameters and reports of the measurement result for a QoS Flow and can be enabled based on 3rd party application requests andor operator policies configured in the PCF Event Reporting from PCF is specified in clause 61318 of TS 23503 45 and User Plane QoS Flow related QoS monitoring and reporting in clause 58218",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1696",
    "document_id": "23501-i80",
    "chunk_id": 1696,
    "text": "The AF may request measurements for one or more of the following QoS monitoring parameters which may trigger QoS monitoring for service data flows - UL packet delay DL packet delay round trip packet delay for a service data flow see clause 5452 - Congestion see clause 5453 - Data Rate see clause 5454 - Packet Delay Variation see clause 5377 - Round trip packet delay considering UL on a service data flow and DL of another service data flow see clause 5374",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1697",
    "document_id": "23501-i80",
    "chunk_id": 1697,
    "text": "The following AF requested QoS requirements may trigger QoS monitoring for service data flows - Round-trip latency requirement see clause 5376 The PCF may generate the authorized QoS Monitoring policy for a service data flow based on the QoS Monitoring request received from the AF as described in clause 61321 of TS 23503 45 or based on PCF local policy or configuration reasons such as PCF awareness of dynamic satellite backhaul connection The PCF includes the authorized QoS Monitoring policy in the PCC rule and provides it to the SMF The QoS monitoring parameters that can be measured by means of QoS monitoring are listed below The QoS monitoring policy in PCC rule described in clause 631 of TS 23503 45 may include the following - UL packet delay DL packet delay round trip packet delay see clause 5452 - Congestion see clause 5453 - Data Rate see clause 5454",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1698",
    "document_id": "23501-i80",
    "chunk_id": 1698,
    "text": "The SMF configures the UPF to perform QoS monitoring for the QoS Flow and to report the monitoring results as described in clause 58218 with parameters determined by the SMF based on the authorized QoS Monitoring policy received from the PCF or local configuration or both The SMF may also configure RAN to measure the QoS monitoring parameters by sending QoS monitoring request based on the authorized QoS Monitoring policy received from the PCF andor local configuration The QoS monitoring request to the NG RAN for different parameters is as defined in clause 5452 and 5453 The following clauses describe the QoS monitoring parameters which can be measured and any specific actions or constraints for their measurement NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1699",
    "document_id": "23501-i80",
    "chunk_id": 1699,
    "text": "The QoS monitoring parameter which can be measured are parameters which describe the QoS experienced in the 5GS by the application ie they are not restricted to the 5G QoS Parameters defined in clause 572 5452 Packet delay monitoring QoS Monitoring for packet delay allows for the measurement of UL packet delay DL packet delay or round trip packet delay between UE and PSA UPF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1700",
    "document_id": "23501-i80",
    "chunk_id": 1700,
    "text": "The details of the QoS Monitoring for packet delay are described in clause 5333 The PCF may calculate Packet Delay Variation clause 5377 and the round trip packet delay when UL and DL are on different QoS flows clause 5374 based on packet delay monitoring results of QoS flows 5453 Congestion information monitoring The NG-RAN may be required to provide the UL andor DL QoS Flow congestion information to UPF ie a percentage of congestion level for exposure The UPF may be required to monitor and expose the UL andor DL QoS Flow congestion information reported from the NG-RAN QoS monitoring request for congestion information provided by the SMF to the NG-RAN is to trigger the NG-RAN to measure and report UL andor DL QoS Flow congestion information to PSA UPF as defined in 5373 NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1701",
    "document_id": "23501-i80",
    "chunk_id": 1701,
    "text": "How the RAN measures and reports the congestion information is up to RAN implementation NOTE 2 It is assumed that the RAN reports whenever there is a change in the percentage of packets to be marked with ECN for L4S marking andor congestion information The granularity of change in percentage determination is up to RAN implementation For the reporting of the congestion information from PSA UPF the periodical reporting is not applied and only the Reporting frequency event triggered applies see clause 58218 The PSA UPF reports the received UL andor DL QoS Flow congestion information to the target NF as instructed by the QoS Monitoring request see clause 58218 from the SMF Only ECN marking for L4S in NG-RAN as described in clause 5373 or QoS monitoring of congestion information may be requested to NG-RAN for a QoS Flow QoS Monitoring of congestion information for exposure and ECN marking for L4S in NG-RAN or UPF are mutually exclusive therefore measurements of Congestion information on a QoS Flow are not exposed in QoS Monitoring reports if SMF enables ECN marking for L4S see clauses 5373 and 5374 5454 Data rate monitoring The QoS Monitoring for data rate allows the measurement of the UL andor DL data rate per QoS flow at the PSA UPF and it can be applied to a Non-GBR or GBR QoS flow The data rate is measured over a monitoring averaging window with a standardized value The SMF may configure the UPF to perform and report QoS monitoring for data rates as described in clause 58218",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1702",
    "document_id": "23501-i80",
    "chunk_id": 1702,
    "text": "According to the QoS Monitoring request for UL andor DL data rate from the SMF the UPF is required to initiate data rate measurement for a QoS Flow and to report the measured data rate as instructed 5455 Void 546 Assistance to AIML Operations in the Application Layer 5461 General This clause describes the list of 5GC enablers to support the following AIML operations in the Application layer over the 5G System - AIML operation splitting between AIML endpoints - AIML modeldata distribution and sharing - DistributedFederated Learning NOTE 1 Requirements on 5G System assistance to AIML operations in the Application layer are specified in clause 640 of TS 22261 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1703",
    "document_id": "23501-i80",
    "chunk_id": 1703,
    "text": "The AF may subscribe to NEF monitoring events as described in clause 415323 of TS 23502 3 in order to assist its application AIML operations For example the AF may subscribe to session inactivity time monitoring event in order to assist the AIML application server in scheduling available UEs to participate in the AIML operation eg Federated Learning In addition the AF may subscribe to NEF to be notified on the traffic volume exchanged between the UE and the AIML application server in order to assist the AF with the transfer of AIML data The AF that aims to provide an AIML operation may request assistance from the 5GC as described in clause 5462 The AF initially provides a list of target member UEs and at least one filtering criterion when subscribing to the NEF to be notified about a subset list of UEs ie list of candidate UEs that fulfil certain filtering criteria Details of the procedures are described in clause 41513 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1704",
    "document_id": "23501-i80",
    "chunk_id": 1704,
    "text": "This subset list of UEs may become the member UEs used in the AIML operation depending on the AFs final decision considering its internal logic Alternatively the AF may select the list of UEs for the AIML operation without NEF involvement as described in Annex I of TS 23502 3 in this case the AF determines a list of UEs without any assistance from the NEF and may use for example NWDAF analytics to assist with the AIML operation over 5G System The AF may request the network to provide a recommended time window for the AIML operation using the Planned Data Transfer with QoS PDTQ requirements and procedures as described in clause 6127 of TS 23503 45 and in clause 41615 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1705",
    "document_id": "23501-i80",
    "chunk_id": 1705,
    "text": "At the time or during the AIML operation the AF may request the serving NEF to provide QoS for a list of UEs Each UE is identified by its UE IP address The AF may subscribe to QoS Monitoring which may include also Consolidated Data Rate monitoring as described in clause 545 and in clause 415613 of TS 23502 3 for those AF requests for QoS that result in a successful resource allocation The AF provides QoS parameters that are derived from the performance requirements listed in clause 710 of TS 22261 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1706",
    "document_id": "23501-i80",
    "chunk_id": 1706,
    "text": "As a result of the AF subscription to NEF to provide the subset list of UEs that fulfil certain filtering criteria the AF may be notified about changes in the subset list of UEs and in such a case the AF may determine a updated list of UEs used in the AIML operation from the new subset list of UEs provided by NEF and the AF may request a new recommended time window for the AIML operation using the Planned Data Transfer with QoS PDTQ requirements as described in clause 6127 of TS 23503 45 and in clause 41615 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1707",
    "document_id": "23501-i80",
    "chunk_id": 1707,
    "text": "The AF may request the NEF to provide QoS for the updated list of UEs each identified by UE IP address that results in QoS resources previously allocated to some UEs to be released while QoS resources for other UEs to be allocated and QoS monitoring to be initiated The AF may also subscribe to or request Network Data Analytics as defined in TS 23288 86 such as End-to-end data volume transfer time analytics DN performance analytics Network performance analytics UE mobility analytics WLAN performance analytics etc in order to assist its AIML operations The AF hosting an AIML based application may provision the Expected UE Behaviour parameters captured in Table 41563-1 of TS 23502 3 andor the Application-Specific Expected UE Behaviour parameters captured in Table 41563f-1 of TS 23502 3 to the 5GC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1708",
    "document_id": "23501-i80",
    "chunk_id": 1708,
    "text": "The parameters may be provisioned with corresponding confidence andor accuracy levels and a threshold may also be provided to the UDM by the NF eg AMF or SMF subscribing to such externally provisioned parameters as described in clause 41562 of TS 23502 3 In addition the following principles apply when 5GS assists the AIML operation at the application layer - AF requesting 5GS assistance to AIML operations in the application layer shall be authorized by the 5GC using the existing mechanisms NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1709",
    "document_id": "23501-i80",
    "chunk_id": 1709,
    "text": "In this Release assistance to AIML operations in the application layer is not supported for roaming UEs NOTE 3 Policy and charging control as defined in TS 23503 45 can be used for traffic related to AIML operations as described in clause 6401 of TS 22261 2 Capabilities based on Flow Based Charging can be used together with an appropriate PCF configuration for charging differentiation between AIML traffic and other type of traffic from the same application As long as the AF can provide different filter information as described in TS 23503 45 for the AIML traffic and the other type of traffic from the same application in the procedures utilized for the resource request the PCF can assign different rating groups ie charging key or rating group service-ids based on an appropriate PCF configuration The UPF will then handle such traffic accordingly",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1710",
    "document_id": "23501-i80",
    "chunk_id": 1710,
    "text": "This enables charging of AIML traffic according to operators policies - Application AIML decisions and their internal operation logic reside at the AF and UE application client and is out of scope of 3GPP - Based on application logic it is the application decision whether to request assistance from 5GC eg for the purpose of selection of Member UEs that participate in certain AIML operation -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1711",
    "document_id": "23501-i80",
    "chunk_id": 1711,
    "text": "In this Release 5GS assistance to AIML operations in the application layer is conducted within a single slice 5462 Member UE selection assistance functionality for application operation 5G System may support Member UE selection assistance functionality to assist the AF to select member UEs that can be used in application operations such as AIML based applications eg Federated Learning as specified in clause 5461 according to the AFs inputs The Member UE selection assistance functionality shall be hosted by NEF and the features of the Member UE selection assistance functionality hosted by the NEF include see clause 41513 of TS 23502 3 for details of Member UE selection procedures - Receiving a request from the AF that shall include a list of target member UEs which may not necessarily be a part of the subsequent updated request optionally a time windows and one or more filtering criteria as specified in Table 415132-1 of TS 23502 3 eg UE current location UE historical location UE direction UE separation distance QoS requirements DNN preferred accessRAT type Desired end-to-end data volume transfer time performance or Service Experience - Referring to the filtering criteria provided by the AF and then interacting with 5GC NFs using existing services in order to have the corresponding data for all the UEs in the list of target member UE from relevant 5GC NFs eg PCF NWDAF AMF SMF to derive the lists of candidate UEs ie UEs among the list of target member UEs provided by the AF which fulfil the filtering criteria - Providing the AF with the Member UE selection assistance information including one or more lists of candidate UEs and optionally other additional information eg one or more recommended time windows for performing the application operation QoS of each target UE UEs location AccessRAT type or Service Experience NEF may also provide the number of UEs per each filtering criterion that do not fulfil the corresponding filtering criterion The Member UE selection assistance information provided by the NEF may be used by the AF to select member UEs used in application AIML operation",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1712",
    "document_id": "23501-i80",
    "chunk_id": 1712,
    "text": "See clause 52632 of TS 23502 3 for details of parameters NOTE The AF can decide whether to use the Member UE selection assistance functionality provided by NEF Without using the Member UE selection assistance functionality AF in either trusted or untrusted domain can select the Member UEs for eg participating in federating learning operation by collecting the corresponding data using network exposure information as described in clause 415 of TS 23502 3 eg UE location reporting from the AMF user plane information from the UPF and network data analytics from NWDAF 547 Support for Network Controlled Repeater NCR A Network-Controlled Repeater node referred to as NCR-node is an RF repeater that enables wireless amplifying-and-forwarding functionality in NG-RAN as defined in TS 38300 27 In NCR operation the NCR-MT as defined in TS 38300 27 interacts with the 5GC using procedures defined for UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1713",
    "document_id": "23501-i80",
    "chunk_id": 1713,
    "text": "The following aspects are enhanced to support the NCR operation - The UE Subscription data as defined in clause 523 of TS 23502 3 is enhanced to include the authorization information for the NCR operation - During the UE Registration procedure the AMF is enhanced to perform authorization of the NCR based on subscription information from UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1714",
    "document_id": "23501-i80",
    "chunk_id": 1714,
    "text": "The AMF uses Initial UE Context Setup procedure to provide NCR authorization status information to NG-RAN - If the authorization status of NCR-MT changes after initial registration the AMF uses the UE Context Modification procedure to NG-RAN to update the NG-RAN with the new authorization status 6 Network Functions 61 General Clause 6 provides the functional description of the Network Functions and network entities and the principles for Network Function and Network Function Service discovery and selection NG-RAN functions and entities are described in TS 38300 27 and TS 38401 42 Security functions and entities are described in TS 33501 29 and TS 33535 124 5G Media streaming functions are described in TS 26501 135 62 Network Function Functional description 621 AMF The Access and Mobility Management function AMF includes the following functionality Some or all of the AMF functionalities may be supported in a single instance of an AMF - Termination of RAN CP interface N2 - Termination of NAS N1 NAS ciphering and integrity protection - Registration management - Connection management - Reachability management - Mobility Management - Lawful intercept for AMF events and interface to LI System - Provide transport for SM messages between UE and SMF - Transparent proxy for routing SM messages - Access Authentication - Access Authorization - Provide transport for SMS messages between UE and SMSF - Security Anchor Functionality SEAF as specified in TS 33501 29 - Location Services management for regulatory services - Provide transport for Location Services messages between UE and LMF as well as between RAN and LMF - EPS Bearer ID allocation for interworking with EPS - UE mobility event notification - S-NSSAIs per TA mapping notification - Support for Control Plane CIoT 5GS Optimisation - Support for User Plane CIoT 5GS Optimisation - Support for restriction of use of Enhanced Coverage - Provisioning of external parameters Expected UE Behaviour parameters or Network Configuration parameters - Support for Network Slice-Specific Authentication and Authorization - Support for charging - Controlling the 5G access stratum-based time distribution based on UEs subscription data - Controlling the gNBs time synchronization status reporting and subscription NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1715",
    "document_id": "23501-i80",
    "chunk_id": 1715,
    "text": "Regardless of the number of Network functions there is only one NAS interface instance per access network between the UE and the CN terminated at one of the Network functions that implements at least NAS security and Mobility Management",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1716",
    "document_id": "23501-i80",
    "chunk_id": 1716,
    "text": "In addition to the functionalities of the AMF described above the AMF may include the following functionality to support non-3GPP access networks - Support of N2 interface with N3IWFTNGF Over this interface some information eg 3GPP Cell Identification and procedures eg Handover related defined over 3GPP access may not apply and non-3GPP access specific information may be applied that do not apply to 3GPP accesses - Support of NAS signalling with a UE over N3IWFTNGF Some procedures supported by NAS signalling over 3GPP access may be not applicable to untrusted non-3GPP eg Paging access - Support of authentication of UEs connected over N3IWFTNGF - Management of mobility authentication and separate security context states of a UE connected via a non-3GPP access or connected via a 3GPP access and a non-3GPP access simultaneously - Support as described in clause 5323 a co-ordinated RM management context valid over a 3GPP access and a Non 3GPP access - Support as described in clause 5334 dedicated CM management contexts for the UE for connectivity over non-3GPP access -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1717",
    "document_id": "23501-i80",
    "chunk_id": 1717,
    "text": "Determine whether the serving N3IWFTNGF is appropriate based on the slices supported by the N3IWFsTNGFs as specified in clause 636 and clause 6312 respectively NOTE 2 Not all of the functionalities are required to be supported in an instance of a Network Slice In addition to the functionalities of the AMF described above the AMF may include policy related functionalities as described in clause 628 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1718",
    "document_id": "23501-i80",
    "chunk_id": 1718,
    "text": "The AMF uses the N14 interface for AMF re-allocation and AMF to AMF information transfer This interface may be either intra-PLMN or inter-PLMN eg in the case of inter-PLMN mobility In addition to the functionality of the AMF described above the AMF may include the following functionality to support monitoring in roaming scenarios - Normalization of reports according to roaming agreements between VPLMN and HPLMN eg change the location granularity in a report from cell level to a level that is appropriate for the HPLMN and - Generation of chargingaccounting information for Monitoring Event Reports that are sent to the HPLMN In addition to the functionality of the AMF described above the AMF may provide support for Network Slice restriction and Network Slice instance restriction based on NWDAF analytics In addition to the functionalities of the AMF described above the AMF may provide support for the Disaster Roaming as described in clause 540",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1719",
    "document_id": "23501-i80",
    "chunk_id": 1719,
    "text": "In addition to the functionalities of the AMF described above the AMF may also include following functionalities to support Network Slice Admission Control - Support of NSAC for maximum number of UEs as defined in clauses 515111 and 515113 In addition to the functionality of the AMF described above the AMF may include the following functionality to support SNPNs - Support for Onboarding of UEs for SNPNs In addition to the functionalities of the AMF described above the AMF may also include following functionalities to support satellite backhaul - Support for reporting satellite backhaul category and its modification based on AMF local configuration to SMF as defined in clause 5434 In addition to the functionalities of the AMF described above the AMF may provide support for Network Slice instance change for PDU sessions as defined in clause 51553",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1720",
    "document_id": "23501-i80",
    "chunk_id": 1720,
    "text": "In addition to the functionalities of the AMF described above the AMF may also support functionalities for Partial Network Slice support in a Registration Area as described in clause 51517 In addition to the functionalities of the AMF described above the AMF may also include functionalities to support NS-AoS not matching deployed Tracking Areas as described in clause 51518 In addition to the functionalities of the AMF described above the AMF may also include functionalities to support Network Slice Replacement as described in clause 51519",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1721",
    "document_id": "23501-i80",
    "chunk_id": 1721,
    "text": "In addition to the functionalities of the AMF described above the AMF may also include functionalities to enforce the LADN Service Area per LADN DNN and S-NSSAI for a UE as described in clause 565a as well as to enforce the LADN Service Area per LADN DNN for a UE in clause 565 622 SMF The Session Management function SMF includes the following functionality Some or all of the SMF functionalities may be supported in a single instance of a SMF - Session Management eg Session Establishment modify and release including tunnel maintain between UPF and AN node - UE IP address allocation management including optional Authorization The UE IP address may be received from a UPF or from an external data network - DHCPv4 server and client and DHCPv6 server and client functions - Functionality to respond to Address Resolution Protocol ARP requests and or IPv6 Neighbour Solicitation requests based on local cache information for the Ethernet PDUs The SMF responds to the ARP and or the IPv6 Neighbour Solicitation Request by providing the MAC address corresponding to the IP address sent in the request - Selection and control of UP function including controlling the UPF to proxy ARP or IPv6 Neighbour Discovery or to forward all ARPIPv6 Neighbour Solicitation traffic to the SMF for Ethernet PDU Sessions - Configures traffic steering at UPF to route traffic to proper destination - 5G VN group management eg maintain the topology of the involved PSA UPFs establish and release the N19 tunnels between PSA UPFs configure traffic forwarding at UPF to apply local switching N6-based forwarding or N19-based forwarding manage traffic forwarding in the case that a SMF Set or multiple SMF Sets are serving a 5G VN - Termination of interfaces towards Policy control functions - Lawful intercept for SM events and interface to LI System - Support for charging - Control and coordination of charging data collection at UPF - Termination of SM parts of NAS messages - Downlink Data Notification - Initiator of AN specific SM information sent via AMF over N2 to AN - Determine SSC mode of a session - Support for Control Plane CIoT 5GS Optimisation - Support of header compression - Act as I-SMF in deployments where I-SMF can be inserted removed and relocated - Provisioning of external parameters Expected UE Behaviour parameters or Network Configuration parameters - Support P-CSCF discovery for IMS services - Act as V-SMF with following roaming functionalities - Handle local enforcement to apply QoS SLAs VPLMN - Charging VPLMN - Lawful intercept in VPLMN for SM events and interface to LI System - Support for interaction with external DN for transport of signalling for PDU Session authenticationauthorization by external DN - Instructs UPF and NG-RAN to perform redundant transmission on N3N9 interfaces - Generation of the TSC Assistance Information based on the TSC Assistance Container received from the PCF - Support for RAN feedback for BAT offset and adjusted periodicity as defined in clause 52725 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1722",
    "document_id": "23501-i80",
    "chunk_id": 1722,
    "text": "Not all of the functionalities are required to be supported in an instance of a Network Slice In addition to the functionalities of the SMF described above the SMF may include policy related functionalities as described in clause 622 of TS 23503 45",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1723",
    "document_id": "23501-i80",
    "chunk_id": 1723,
    "text": "In addition to the functionality of the SMF described above the SMF may include the following functionality to support monitoring in roaming scenarios - Normalization of reports according to roaming agreements between VPLMN and HPLMN and - Generation of charging information for Monitoring Event Reports that are sent to the HPLMN The SMF may also include following functionalities to support Edge Computing enhancements further defined in TS 23548 130 - Selection of EASDF obtain andor provision DNS security information of the EASDF and provision of its address to the UE as the DNS Server for the PDU session - Usage of EASDF services as defined in TS 23548 130 - For supporting the Application Layer Architecture defined in TS 23558 134 Provision and updates of ECS Address Configuration Information to the UE - For supporting the HR-SBO as defined in clause 67 of TS 23548 130 The SMF and SMF PGW-C may also include following functionalities to support Network Slice Admission Control - Support of NSAC for maximum number of PDU sessions as defined in clauses 515112 515113 and 515115 - Support of NSAC for maximum number of UEs as defined in clauses 515113 and 515115",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1724",
    "document_id": "23501-i80",
    "chunk_id": 1724,
    "text": "The SMF may also include following functionalities - Providing per-QoS flow Non-3GPP QoS assistance information to the UE eg PEGC and formulation of the CN PDB based on non-3GPP delay budget from UE eg PEGC as described in clause 54434 - Support of PDU Set based handling as described in clause 5375 In addition to the functionalities of the SMF described above the SMF may also include functionalities to support Network Slice Replacement as described in clause 51519",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1725",
    "document_id": "23501-i80",
    "chunk_id": 1725,
    "text": "The SMF may also include functionalities to support indirect UPF event exposure service subscription on behalf of the consumer NFs as described in clause 41545 of TS 23502 3 623 UPF The User plane function UPF includes the following functionality Some or all of the UPF functionalities may be supported in a single instance of a UPF - Anchor point for Intra-Inter-RAT mobility when applicable - Allocation of UE IP addressprefix if supported in response to SMF request - External PDU Session point of interconnect to Data Network - Packet routing forwarding eg support of Uplink classifier to route traffic flows to an instance of a data network support of Branching point to support multi-homed PDU Session support of traffic forwarding within a 5G VN group UPF local switching via N6 via N19 - Packet inspection eg Application detection based on service data flow template and the optional PFDs received from the SMF in addition - User Plane part of policy rule enforcement eg Gating Redirection Traffic steering - Lawful intercept UP collection - Traffic usage reporting - QoS handling for user plane eg ULDL rate enforcement Reflective QoS marking in DL - Uplink Traffic verification SDF to QoS Flow mapping - Transport level packet marking in the uplink and downlink - Downlink packet buffering and downlink data notification triggering - Sending and forwarding of one or more end marker to the source NG-RAN node - Functionality to respond to Address Resolution Protocol ARP requests and or IPv6 Neighbour Solicitation requests based on local cache information for the Ethernet PDUs The UPF responds to the ARP and or the IPv6 Neighbour Solicitation Request by providing the MAC address corresponding to the IP address sent in the request - Packet duplication in downlink direction and elimination in uplink direction in GTP-U layer - NW-TT functionality - High latency communication see clause 5318 - ATSSS Steering functionality to steer the MA PDU Session traffic refer to clause 5326 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1726",
    "document_id": "23501-i80",
    "chunk_id": 1726,
    "text": "Not all of the UPF functionalities are required to be supported in an instance of user plane function of a Network Slice - Inter PLMN UP Security IPUPS functionality specified in clause 58214 - Event exposure including exposure of network information ie the QoS monitoring information as specified in clause 58218 events as specified in clause 52262 of TS 23502 3 exposure of data collected for analytics as specified in clause 52262 of TS 23502 3 and exposure of the TSC management information as specified in clause 58514 - Exposure of the UE information eg UE IP address translation information as specified in clause 52263 of TS 23502 3 and clause 41510 of TS 23502 3 if Network address translation ie NAT functionality of the UE IP address is deployed within UPF - Support PDU Set Handling as defined in clause 5375 624 PCF The Policy Control Function PCF includes the following functionality - Supports unified policy framework to govern network behaviour - Provides policy rules to Control Plane functions to enforce them - Accesses subscription information relevant for policy decisions in a Unified Data Repository UDR - Support PDU Set Handling as defined in clause 5375 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1727",
    "document_id": "23501-i80",
    "chunk_id": 1727,
    "text": "The PCF accesses the UDR located in the same PLMN as the PCF The details of the PCF functionality are defined in clause 621 of TS 23503 45 625 NEF 6250 NEF functionality The Network Exposure Function NEF supports the following independent functionality - Exposure of capabilities and events NF capabilities and events may be securely exposed by NEF for eg 3rd party Application Functions Edge Computing as described in clause 513 NEF storesretrieves information as structured data using a standardized interface Nudr to the Unified Data Repository UDR - Secure provision of information from external application to 3GPP network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1728",
    "document_id": "23501-i80",
    "chunk_id": 1728,
    "text": "It provides a means for the Application Functions to securely provide information to 3GPP network eg Expected UE Behaviour 5G-VN group information time synchronization service information and PDU Set handling service specific information In that case the NEF may authenticate and authorize and assist in throttling the Application Functions - Translation of internal-external information It translates between information exchanged with the AF and information exchanged with the internal network function For example it translates between an AF-Service-Identifier and internal 5G Core information such as DNN S-NSSAI as described in clause 567",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1729",
    "document_id": "23501-i80",
    "chunk_id": 1729,
    "text": "In particular NEF handles masking of network and user sensitive information to external AFs according to the network policy - Redirecting the AF to a more suitable NEFL-NEF eg when serving an AF request for local information exposure and detecting there is a more appropriate NEF instance to serve the AFs request - The Network Exposure Function receives information from other network functions based on exposed capabilities of other network functions NEF stores the received information as structured data using a standardized interface to a Unified Data Repository UDR The stored information can be accessed and re-exposed by the NEF to other network functions and Application Functions and used for other purposes such as analytics -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1730",
    "document_id": "23501-i80",
    "chunk_id": 1730,
    "text": "A NEF may also support a PFD Function The PFD Function in the NEF may store and retrieve PFDs in the UDR and shall provide PFDs to the SMF on the request of SMF pull mode or on the request of PFD management from NEF push mode as described in TS 23503 45 - A NEF may also support a 5G-VN Group Management Function The 5G-VN Group Management Function in the NEF may store the 5G-VN group information in the UDR via UDM as described in TS 23502 3 - Support management of ECS Address Information - Support management of relationship between DNAI and EAS Address Information - Exposure of analytics NWDAF analytics may be securely exposed by NEF for external party as specified in TS 23288 86 - Retrieval of data from external party by NWDAF Data provided by the external party may be collected by NWDAF via NEF for analytics generation purpose NEF handles and forwards requests and notifications between NWDAF and AF as specified in TS 23288 86 - Support of Non-IP Data Delivery NEF provides a means for management of NIDD configuration and delivery of MOMT unstructured data by exposing the NIDD APIs as described in TS 23502 3 on the N33Nnef reference point See clause 5315",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1731",
    "document_id": "23501-i80",
    "chunk_id": 1731,
    "text": "- Charging data collection and support of charging interfaces - Support of Member UE selection assistance functionality - NEF may provide one or more lists of candidate UEs among the list of target member UEs provided by the AF and additional information to the AF based on the parameters contained in the request from the AF as described in clause 5462 NEF supports the translation of the member UE selection filtering criteria parameters received from the AF to the corresponding event or analytics filters that can be understood by the 5GC NFs for events or analytics related data collection NEF interacts with 5GC NFs using existing services in order to collect the corresponding data and then derive the lists of candidate UEs and other assistance information as described in clause 41513 of TS 23502 3 - Support of Multi-member AF session with required QoS for a set of UEs identified by a list of UE addresses - Details are specified in clause 415613 of TS 23502 3 - Support of UAS NF functionality Details are defined in TS 23256 136 - Support of EAS deployment functionality Details are defined in TS 23548 130 - Support of SBI-based MO SM transmit for",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1732",
    "document_id": "23501-i80",
    "chunk_id": 1732,
    "text": "MSISDN-less MO SMS Details are defined in TS 23540 142 - Support PDU Set Handling as defined in clause 5375 - Support management of common EAS and common DNAI Details are defined in TS 23548 130 A specific NEF instance may support one or more of the functionalities described above and consequently an individual NEF may support a subset of the APIs specified for capability exposure NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1733",
    "document_id": "23501-i80",
    "chunk_id": 1733,
    "text": "The NEF can access the UDR located in the same PLMN as the NEF The services provided by the NEF are specified in clause 728 For external exposure of services related to specific UEs the NEF resides in the HPLMN Depending on operator agreements the NEF in the HPLMN may have interfaces with NFs in the VPLMN When a UE is capable of switching between EPC and 5GC an SCEFNEF is used for service exposure See clause 5175 for a description of the SCEFNEF 6251 Support for CAPIF When an NEF is used for external exposure the CAPIF may be supported When CAPIF is supported an NEF that is used for external exposure supports the CAPIF API provider domain functions The CAPIF and associated API provider domain functions are specified in TS 23222 64 625a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1734",
    "document_id": "23501-i80",
    "chunk_id": 1734,
    "text": "Void 626 NRF 6261 General The Network Repository Function NRF supports the following functionality - Supports service discovery of NRF services and their endpoint addresses by the NRF bootstrapping service - Supports service discovery function Receive NF Discovery Request from NF instance or SCP and provides the information of the discovered NF instances be discovered to the NF instance or SCP - Supports P-CSCF discovery specialized case of AF discovery by SMF - Maintains the NF profile of available NF instances and their supported services - Maintains SCP profile of available SCP instances - Supports SCP discovery by SCP instances - Notifies about newly registeredupdated deregistered NF and SCP instances along with its potential NF services to the subscribed NF service consumer or SCP - Maintains the health status of NFs and SCP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1735",
    "document_id": "23501-i80",
    "chunk_id": 1735,
    "text": "In the context of Network Slicing based on network implementation multiple NRFs can be deployed at different levels see clause 5155 - PLMN level the NRF is configured with information for the whole PLMN - shared-slice level the NRF is configured with information belonging to a set of Network Slices - slice-specific level the NRF is configured with information belonging to an S-NSSAI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1736",
    "document_id": "23501-i80",
    "chunk_id": 1736,
    "text": "In the context of roaming multiple NRFs may be deployed in the different networks see clause 424 - the NRFs in the Visited PLMN known as the vNRF configured with information for the visited PLMN - the NRFs in the Home PLMN known as the hNRF configured with information for the home PLMN referenced by the vNRF via the N27 interface 6262 NF profile NF profile of NF instance maintained in an NRF includes the following information - NF instance ID - NF type - PLMN ID in the case of PLMN PLMN ID NID in the case of SNPN - Network Slice related Identifiers eg S-NSSAI NSI ID - FQDN or IP address of NF - NF capacity information - NF priority information NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1737",
    "document_id": "23501-i80",
    "chunk_id": 1737,
    "text": "This parameter is used for AMF selection if applicable as specified in clause 635 See clause 61622 of TS 29510 58 for its detailed use - NF Set ID - NF Service Set ID of the NF service instance - NF Specific Service authorization information - if applicable Names of supported services - Endpoint Addresses of instances of each supported service - Identification of stored datainformation NOTE 2 This is only applicable for a UDR profile See applicable input parameters for Nnrf_NFManagement_NFRegister service operation in clause 52722 of TS 23502 3 This information applicability to other NF profiles is implementation specific - Other service parameter eg DNN or DNN list notification endpoint for each type of notification that the NF service is interested in receiving - Location information for the NF instance NOTE 3 This information is operator specific Examples of such information can be geographical location data centre - TAIs - NF load information -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1738",
    "document_id": "23501-i80",
    "chunk_id": 1738,
    "text": "Routing Indicator Home Network Public Key identifier for UDM and AUSF - For UDM AUSF and NSSAAF in the case of access to an SNPN using credentials owned by a Credentials Holder with AAA Server identification of Credentials Holder ie the realm of the Network Specific Identifier based SUPI - For UDM and AUSF and if UDMAUSF is used for access to an SNPN using credentials owned by a Credentials Holder identification of Credentials Holder ie the realm if Network Specific Identifier based SUPI is used or the MCC and MNC if IMSI based SUPI is used see clause 53021 - For AUSF and NSSAAF in the case of SNPN Onboarding using a DCS with AAA server identification of DCS ie the realm of the Network Specific Identifier based SUPI - For UDM and AUSF and if UDMAUSF is used as DCS in the case of SNPN Onboarding identification of DCS ie the realm if Network Specific Identifier based SUPI or the MCC and MNC if IMSI based SUPI - One or more GUAMIs in the case of AMF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1739",
    "document_id": "23501-i80",
    "chunk_id": 1739,
    "text": "For the UPF see clause 52722 of TS 23502 3 - UDM Group ID ranges of SUPIs ranges of GPSIs ranges of internal group identifiers ranges of external group identifiers for UDM - UDR Group ID ranges of SUPIs ranges of GPSIs ranges of external group identifiers for UDR - AUSF Group ID ranges of SUPIs for AUSF - PCF Group ID ranges of SUPIs for PCF - HSS Group ID sets of IMPIs sets of IMPU sets of IMSIs sets of PSIs sets of MSISDN for HSS - CHF Group IDs ranges of SUPIs ranges of GPSIs list of PLMNs for CHF as defined in clause 61 of TS 32290 67 and TS 29510 58 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1740",
    "document_id": "23501-i80",
    "chunk_id": 1740,
    "text": "For NWDAF the following information are supported - Analytics IDs possibly per service - NWDAF Serving Area information refer to clause 6313 - Supported Analytics Delay per Analytics ID if available - NF types of the NF data sources NF Set IDs of the NF data sources if available - Analytics aggregation capability if available - Analytics metadata provisioning capability if available - ML model Filter information parameters include S-NSSAIs and Areas of Interest for the trained ML models per Analytics IDs - ML Model Interoperability indicator if available per Analytics IDs - FL capability information per analytics ID including FL capability type ie FL server andor FL client if available - Time interval supporting FL if available - Accuracy checking capability for ML model accuracy monitoring or Analytics Accuracy Monitoring if available - Roaming exchange capability if available NOTE 4 The NWDAFs Serving Area information is common to all its supported Analytics IDs NOTE 5 The Analytics IDs supported by the NWDAF may be associated with a Supported Analytics Delay ie the Analytics report can be generated with a time including data collection delay and inference delay in less than or equal to the Supported Analytics Delay NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1741",
    "document_id": "23501-i80",
    "chunk_id": 1741,
    "text": "The determination of Supported Analytics Delay and how the NWDAF avoid updating its Supported Analytics Delay in NRF frequently is NWDAF implementation specific - Event IDs supported by AFs in the case of NEF - Event Exposure service supported event IDs by UPF - Application Identifiers supported by AFs in the case of NEF - Ranges of External Identifiers or ranges of External Group Identifiers or the domain names served by the NEF in the case of NEF NOTE 7 This is applicable when NEF exposes AF information for analytics purpose as detailed in TS 23288 86 NOTE 8 It is expected service authorization information is usually provided by OAM system and it can also be included in the NF profile in the case that eg an NF instance has an exceptional service authorization information NOTE 9",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1742",
    "document_id": "23501-i80",
    "chunk_id": 1742,
    "text": "The NRF may store a mapping between UDM Group ID and SUPIs UDR Group ID and SUPIs AUSF Group ID and SUPIs and PCF Group ID and SUPIs to enable discovery of UDM UDR AUSF and PCF using SUPI SUPI ranges as specified in clause 63 or interact with UDR to resolve the UDM Group IDUDR Group IDAUSF Group IDPCF Group ID based on UE identity eg SUPI see clause 631 for details - IP domain list as described in clause 616221 of TS 29510 58 Ranges of UE IPv4 addresses or Ranges of UE IPv6 prefixes Ranges of SUPIs or Ranges of GPSIs or a BSF Group ID in the case of BSF - SCP Domain the NF belongs to - DCCF Serving Area information NF types of the data sources NF Set IDs of the data sources if available in the case of DCCF - Supported DNAI list in the case of SMF - For SNPN capability to support SNPN Onboarding in the case of AMF and capability to support User Plane Remote Provisioning in the case of SMF - IP address range DNAI for UPF - Supported DNS security protocols in the case of EASDF - Additional V2X related NF profile parameters are defined in TS 23287 121 - Additional ProSe related NF profile parameters are defined in TS 23304 128 - Additional MBS related NF profile parameters are defined in TS 23247 129 - Additional UAS related NF profile parameters are defined in TS 23256 136 - Additional Ranging based services and Sidelink Positioning related NF profile parameters are defined in TS 23586 180 - For additional information in PCF profile see clause 52722 of TS 23502 3 6263 SCP profile SCP profile maintained in an NRF includes the following information - SCP ID - FQDN or IP address of SCP - Indication that the profile is of an SCP eg NF type parameter set to type SCP - SCP capacity information - SCP load information - SCP priority - Location information for the SCP see locality in clause 61622 of TS 29510 58 - Served Locations see servingScope in clause 61622 of TS 29510 58 - Network Slice related Identifiers eg S-NSSAI NSI ID - Remote PLMNs reachable through SCP - Endpoint addresses accessible via the SCP - NF sets of NFs served by the SCP - SCP Domain the SCP belongs to If an SCP belongs to more than one SCP Domain the SCP will be able bridge these domains ie sending messages between these domains",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1743",
    "document_id": "23501-i80",
    "chunk_id": 1743,
    "text": "NOTE Service definition defines optional and mandatory parameters see TS 23502 3 627 UDM The Unified Data Management UDM includes support for the following functionality - Generation of 3GPP AKA Authentication Credentials - User Identification Handling eg storage and management of SUPI for each subscriber in the 5G system - Support of de-concealment of privacy-protected subscription identifier SUCI - Access authorization based on subscription data eg roaming restrictions - UEs Serving NF Registration Management eg storing serving AMF for UE storing serving SMF for UEs PDU Session - Support to servicesession continuity eg by keeping SMFDNN assignment of ongoing sessions - MT-SMS delivery support - Lawful Intercept Functionality especially in outbound roaming case where UDM is the only point of contact for LI - Subscription management - SMS management - 5G-VN group management handling - Support of external parameter provisioning Expected UE Behaviour parameters or Network Configuration parameters - Support for the Disaster Roaming as described in clause 540 - Support for the control of time synchronization service based on subscription data as described in clause 527111 To provide this functionality the UDM uses subscription data including authentication data that may be stored in UDR in which case a UDM implements the application logic and does not require an internal user data storage and then several different UDMs may serve the same user in different transactions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1744",
    "document_id": "23501-i80",
    "chunk_id": 1744,
    "text": "NOTE 1 The interaction between UDM and HSS when they are deployed as separate network functions is defined in TS 23632 102 and TS 29563 103 or it is implementation specific NOTE 2 The UDM is located in the HPLMN of the subscribers it serves and access the information of the UDR located in the same PLMN 628 AUSF The Authentication Server Function AUSF supports the following functionality - Supports authentication for 3GPP access and untrusted non-3GPP access as specified in TS 33501 29 - Supports authentication of UE for a Disaster Roaming service as specified in TS 33501 29 629 N3IWF The functionality of N3IWF in the case of untrusted non-3GPP access includes the following - Support of IPsec tunnel establishment with the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1745",
    "document_id": "23501-i80",
    "chunk_id": 1745,
    "text": "The N3IWF terminates the IKEv2IPsec protocols with the UE over NWu and relays over N2 the information needed to authenticate the UE and authorize its access to the 5G Core Network - Termination of N2 and N3 interfaces to 5G Core Network for control - plane and user-plane respectively - Relaying uplink and downlink control-plane NAS N1 signalling between the UE and AMF - Handling of N2 signalling from SMF relayed by AMF related to PDU Sessions and QoS - Establishment of IPsec Security Association IPsec SA to support PDU Session traffic - Relaying uplink and downlink user-plane packets between the UE and UPF This involves - De-capsulation encapsulation of packets for IPSec and N3 tunnelling - Enforcing QoS corresponding to N3 packet marking eg DSCP taking into account QoS requirements associated to such marking received over N2 QoS includes 5QI the Priority Level if explicitly signalled and optionally the ARP priority level NOTE Based on operator policy andor regionalnational regulations the N3IWF can apply a different DSCP value to the outer ESP tunnel packet than the DSCP value of the inner IP packet - Packet marking eg setting the DSCP value based on the Establishment cause on N2 and based on 5QI the Priority Level if explicitly signalled and optionally the ARP priority level on N3 - Local mobility anchor within untrusted non-3GPP access networks using MOBIKE per IETF RFC 4555 57 - Supporting AMF selection 629A TNGF The functionality of TNGF in the case of trusted non-3GPP access includes the following - Terminates the N2 and N3 interfaces - Terminates the EAP-5G signalling and behaves as authenticator when the UE attempts to register to 5GC via the TNAN - Implements the AMF selection procedure - Transparently relays NAS messages between the UE and the AMF via NWt - Handles N2 signalling with SMF relayed by AMF for supporting PDU sessions and QoS - Transparently relays PDU data units between the UE and UPFs - Implements a local mobility anchor within the TNAN - Packet marking in the downlink and the uplink on N2 and N3 as for the N3IWF clause 629 6210 AF The Application Function AF interacts with the 3GPP Core Network in order to provide services for example to support the following - Application Function influence on traffic routing see clause 567 - Application Function influence on Service Function Chaining see clause 56162 - Accessing Network Exposure Function see clause 520 - Interacting with the Policy and charging control framework see clause 514 - Time synchronization service see clause 52718 - IMS interactions with 5GC see clause 516 - Support PDU Set Handling as defined in clause 5375 Based on operator deployment Application Functions considered to be trusted by the operator can be allowed to interact directly with relevant Network Functions Application Functions not allowed by the operator to access directly the Network Functions shall use the external exposure framework see clause 73 via the NEF to interact with relevant Network Functions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1746",
    "document_id": "23501-i80",
    "chunk_id": 1746,
    "text": "The functionality and purpose of Application Functions are only defined in this specification with respect to their interaction with the 3GPP Core Network 6211 UDR The Unified Data Repository UDR supports the following functionality - Storage and retrieval of subscription data by the UDM - Storage and retrieval of policy data by the PCF - Storage and retrieval of structured data for exposure - Application data including Packet Flow Descriptions PFDs for application detection AF request information for multiple UEs 5G-VN group information for 5G-VN management - Storage and retrieval of NF Group ID corresponding to subscriber identifier eg IMPI IMPU SUPI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1747",
    "document_id": "23501-i80",
    "chunk_id": 1747,
    "text": "The Unified Data Repository is located in the same PLMN as the NF service consumers storing in and retrieving data from it using Nudr Nudr is an intra-PLMN interface NOTE 1 Deployments can choose to collocate UDR with UDSF 6212 UDSF The UDSF is an optional function that supports the following functionality - Storage and retrieval of information as unstructured data by any NF Notify a NF consumer if information validity has expired - Timer service to any NF NOTE 1 Structured data in this specification refers to data for which the structure is defined in 3GPP specifications Unstructured data refers to data for which the structure is not defined in 3GPP specifications NOTE 2 Deployments can choose to collocate UDSF with UDR 6213 SMSF The SMSF supports the following functionality to support SMS over NAS - SMS management subscription data checking and conducting SMS delivery accordingly - SM-RPSM-CP with the UE see TS 24011 6 - Relay the SM from UE toward SMS-GMSCIWMSCSMS-Router - Relay the SM from SMS-GMSCIWMSCSMS-Router toward the UE - SMS charging - Lawful Interception - Interaction with AMF and SMS-GMSC for notification procedure that the UE is unavailable for SMS transfer ie notifies SMS-GMSC to inform UDM when UE is unavailable for SMS 6214 NSSF The Network Slice Selection Function NSSF supports the following functionality - Selecting the set of Network Slice instances serving the UE - Determining the Allowed NSSAI and if needed the mapping to the Subscribed S-NSSAIs - Determining the Configured NSSAI and if needed the mapping to the Subscribed S-NSSAIs - Determining the AMF Set to be used to serve the UE or based on configuration a list of candidate AMFs possibly by querying the NRF - The NSSF may provide support for Network Slice restriction and Network Slice instance restriction based on NWDAF analytics - Determining whether an S-NSSAI has to be replaced and providing to the AMF the indication that the S-NSSAI is unavailable and a corresponding Alternative S-NSSAI eg based on received NWDAF analytics eg for Service Experience for a Network Slice or Slice load level or local trigger from the OAM system 6215 5G-EIR The 5G-EIR is an optional network function that supports the following functionality - Check the status of PEI eg to check that it has not been prohibited 6216 LMF The functionality of LMF is defined in clause 438 of TS 23273 87 6216A GMLC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1748",
    "document_id": "23501-i80",
    "chunk_id": 1748,
    "text": "The functionality of GMLC is defined in clause 438 of TS 23273 87 6217 SEPP The Security Edge Protection Proxy SEPP is a non-transparent proxy and supports the following functionality - Message filtering and policing on inter-PLMN control plane interfaces NOTE The SEPP protects the connection between Service Consumers and Service Producers from a security perspective ie the SEPP does not duplicate the Service Authorization applied by the Service Producers as specified in clause 714 - Topology hiding Detailed functionality of SEPP related flows and the N32 reference point are specified in TS 33501 29",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1749",
    "document_id": "23501-i80",
    "chunk_id": 1749,
    "text": "The SEPP applies the above functionality to every Control Plane message in inter-PLMN signalling acting as a service relay between the actual Service Producer and the actual Service Consumer For both Service Producer and Consumer the result of the service relaying is equivalent to a direct service interaction Every Control Plane message in inter-PLMN signalling between the SEPPs may pass via IPX entities More details on SEPPs and the IPX entities are described in TS 29500 49 and TS 33501 29 6218 Network Data Analytics Function NWDAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1750",
    "document_id": "23501-i80",
    "chunk_id": 1750,
    "text": "The Network Data Analytics Function NWDAF includes one or more of the following functionalities - Support data collection from NFs and AFs - Support data collection from OAM - Support retrieval of information from data repositories eg UDR via UDM for subscriber-related information or via NEFPFDF for PFD information - Support data collection of location information from LCS system - NWDAF service registration and metadata exposure to NFs and AFs - Support analytics information provisioning to NFs and AFs - Support analytics collection from MDAF - Support Machine Learning ML model training and provisioning to NWDAF containing AnLF or NWDAF containing MTLF - Support ML Model storage to and retrieval from ADRF - Support bulked data related to Analytics IDs provisioning for NFs - Support accuracy information about Analytics IDs provisioning for NFs - Support accuracy information or accuracy degradation about ML model provisioning for NFs - Support roaming exchange capability to exchange data and analytics between PLMNs - Support Federated Learning FL to train an ML model among multiple NWDAFs containing MTLF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1751",
    "document_id": "23501-i80",
    "chunk_id": 1751,
    "text": "The details of the NWDAF functionality are defined in TS 23288 86 NOTE 1 Some or all of the NWDAF functionalities can be supported in a single instance of an NWDAF NOTE 2 NWDAF functionality beyond its support for Nnwdaf is out of scope of 3GPP 6219 SCP The Service Communication Proxy SCP includes one or more of the following functionalities Some or all of the SCP functionalities may be supported in a single instance of an SCP - Indirect Communication see clause 711 for details - Delegated Discovery see clauses 711 and 631 for details - Message forwarding and routing to destination NFNF service - Message forwarding and routing to a next hop SCP - Communication security eg authorization of the NF Service Consumer to access the NF Service Producer API load balancing monitoring overload control etc - Optionally interact with UDR to resolve the UDM Group IDUDR Group IDAUSF Group IDPCF Group IDCHF Group IDHSS Group ID based on UE identity eg SUPI or IMPIIMPU see clause 631 for details NOTE 1 Communication security eg authorization of the NF Service Consumer to access the NF Service Producers API is specified in TS 33501 29 NOTE 2 Load balancing monitoring overload control functionality provided by the SCP is left up to implementation The SCP may be deployed in a distributed manner NOTE 3 More than one SCP can be present in the communication path between NF Services SCPs can be deployed at PLMN level shared-slice level and slice-specific level It is left to operator deployment to ensure that SCPs can communicate with relevant NRFs In order to enable SCPs to route messages through several SCPs ie next SCP hop discovery see clause 6316 an SCP may register its profile in the NRF Alternatively local configuration may be used 6220 W-AGF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1752",
    "document_id": "23501-i80",
    "chunk_id": 1752,
    "text": "The functionality of W-AGF is specified in TS 23316 84 6221 UE radio Capability Management Function UCMF The UCMF is used for storage of dictionary entries corresponding to either PLMN-assigned or Manufacturer-assigned UE Radio Capability IDs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1753",
    "document_id": "23501-i80",
    "chunk_id": 1753,
    "text": "An AMF may subscribe with the UCMF to obtain from the UCMF new values of UE Radio Capability ID that the UCMF assigns for the purpose of caching them locally Provisioning of Manufacturer-assigned UE Radio Capability ID entries in the UCMF is performed from an AF that interacts with the UCMF either directly or via the NEF or via Network Management using a procedure defined in TS 23502 3 A UCMF that serves both EPS and 5GS shall require provisioning the UE Radio Capability ID with the TS 36331 51 format or TS 38331 28 format or both the formats of the UE radio capabilities The UCMF also assigns the PLMN-assigned UE Radio Capability ID values Each PLMN-assigned UE Radio Capability ID is also associated to the TAC of the UE models that it is related to When an AMF requests the UCMF to assign a UE Radio Capability ID for a set of UE radio capabilities it indicates the TAC of the UE that the UE Radio Capability information is related to The UCMF stores a Version ID value for the PLMN assigned UE Radio Capability IDs so it is included in the PLMN assigned UE Radio Capability IDs it assigns This shall be configured in the UCMF The UCMF may be provisioned with a dictionary of Manufacturer-assigned UE Radio Capability IDs which include a Vendor ID that applies to the Manufacturers of these UE and a list of TACs for which the PLMN has obtained-Manufacturer-assigned UE Radio Capability IDs A PLMN-assigned UE Radio Capability IDs is kept in the UCMF storage as long as it is associated with at least a TAC value When a TAC value is related to a UE model that is earmarked for operation based on Manufacturer assigned UE Radio Capability IDs this TAC value is disassociated in the UCMF from any PLMN assigned UE Radio Capability IDs For the case that the PLMN is configured to store PLMN assigned IDs in the Manufacturer Assigned operation requested list defined in clause 441a the UCMF does not remove from storage any PLMN assigned UE Radio Capability ID no longer used and rather quarantines it to avoid any future reassignment A UCMF dictionary entry shall include also the related UE Radio Capability for Paging for each RAT 6222 TWIF The functionality of Trusted WLAN Interworking Function TWIF is specified in clause 42853 6223 NSSAAF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1754",
    "document_id": "23501-i80",
    "chunk_id": 1754,
    "text": "The Network Slice-specific and SNPN Authentication and Authorization Function NSSAAF supports the following functionality - Support for Network Slice-Specific Authentication and Authorization as specified in TS 23502 3 with a AAA Server AAA-S",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1755",
    "document_id": "23501-i80",
    "chunk_id": 1755,
    "text": "If the AAA-S belongs to a third party the NSSAAF may contact the AAA-S via a AAA proxy AAA-P - Support for access to SNPN using credentials from Credentials Holder using AAA server AAA-S as specified in clause 530292 or using credentials from Default Credentials Server using AAA server AAA-S as specified in clause 5302102 If the Credentials Holder or Default Credentials Server belongs to a third party the NSSAAF may contact the AAA server via a AAA proxy AAA-P NOTE When the NSSAAF is deployed in a PLMN the NSSAAF supports Network Slice-Specific Authentication and Authorization while when the NSSAAF is deployed in a SNPN the NSSAAF can support Network Slice-Specific Authentication and Authorization andor the NSSAAF can support access to SNPN using credentials from Credentials Holder 6224 DCCF The Data Collection Coordination Function DCCF supports the following functionality - Determining Data Sources that can provide data for a received data request - Determining whether data is already being collected from a data source - Instructing a Messaging Framework to send data to consumers or notification endpoints - Instructing a Messaging Framework to do formatting and processing of the data sent via the Messaging Framework - Formatting and processing of data - Sending data to consumers or notification endpoints - Registering NWDAFs and ADRFs that are already receiving data from a Data Source The DCCF functionality is specified in TS 23288 86 6225 MFAF The Messaging Framework Adaptor Function MFAF supports the following functionality - Interfacing with a DCCF that controls how a messaging framework will process format and send data to consumers or notification endpoints - Receiving data from Data Sources via services offered by those Data Sources - Sending data received from Data Sources to a messaging framework outside the scope of 3GPP - Receiving data from a messaging framework outside the scope of 3GPP - Processing formatting and sending data to specified consumers or notification endpoints NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1756",
    "document_id": "23501-i80",
    "chunk_id": 1756,
    "text": "The internal logic of Messaging Framework is outside the scope of 3GPP only MFAF and the interface between MFAF and other 3GPP defined NF is under 3GPP scope The MFAF functionality is specified in TS 23288 86 6226 ADRF The Analytics Data Repository Function ADRF supports the following functionality - Storage and retrieval of analytics generated by NWDAFs and collected data - Storage and retrieval of ML model files trained by NWDAFs containing MTLF The Analytics Data Repository Function ADRF is specified in TS 23288 86 6227 MB-SMF The functionality of MB-SMF is specified in TS 23247 129 6227a MB-UPF The functionality of MB-UPF is specified in TS 23247 129 6227b MBSF The functionality of MBSF is specified in TS 23247 129 6227c MBSTF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1757",
    "document_id": "23501-i80",
    "chunk_id": 1757,
    "text": "The functionality of MBSTF is specified in TS 23247 129 6228 NSACF The Network Slice Admission Control Function NSACF supports the following functionality - Support of monitoring and controlling the number of registered UEs per network slice - Support of monitoring and controlling the number of UEs with at least one PDU SessionPDN Connection per network slice in case of EPC interworking - Support of monitoring and controlling the number of established PDU Sessions per network slice - Support of event based Network Slice status notification and reports to a consumer NF - Acting as a Centralized NSACF in PLMNs deploying a centralized architecture as described in clause 515110 - Support of different type of NSAC modes for roaming UEs for the number of UEs per network slice - Support of different type of NSAC modes for roaming UEs for the number of PDU Sessions per network slice - Acting as a Primary NSACF in PLMNs deploying a hierarchal architecture as described in clause 515110",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1758",
    "document_id": "23501-i80",
    "chunk_id": 1758,
    "text": "The details of the NSACF functionality are defined in clause 51511 6229 TSCTSF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1759",
    "document_id": "23501-i80",
    "chunk_id": 1759,
    "text": "The Time Sensitive Communication and Time Synchronization Function TSCTSF supports the following functionality - Associating the time synchronization service request see clause 52718 from the NF consumer to the AF sessions with the PCF the session between the PCF and TSCTSF - Controlling time synchronization service request from the NF consumer gPTP-based time distribution and ASTI-based time distribution based on subscription data The TSCTSF may be pre-configured with one or several PTP instance configurations For each PTP instance configuration it may contain - a reference to the PTP instance configuration - PTP profile - PTP domain - Detecting and reporting time synchronization service status based on NG-RAN and UPFNW-TT timing synchronization status information and reporting status updates - Managing the DS-TT and NW-TT via exchange of PMIC and UMIC as described in Annex K - Detecting availability of 5GS BridgeRouter information including user plane node ID that applies also for IP type PDU Sessions as reported by PCF for both Ethernet and IP type PDU Sessions including the need to unsubscribe 5GS BridgeRouter information Notification from PCF - Creating the TSC Assistance Container based on individual traffic pattern parameters from the NEFAF or DetNet controller and providing it to the PCF - Determining the Requested PDB by subtracting the UE-DS-TT Residence Time from the Requested 5GS Delay provided by the NEFAF or DetNet controller and providing the determined Requested PDB to the PCF - Discovering the AMFs serving the list of TAs that comprise the spatial validity condition from the NRF or AMFs serving the UEs from the UDM and subscribing to the discovered AMFs to receive notifications about presence of the UE in an Area of Interest - Discovering the AMFs serving a UE or a list of TAs and subscribing to gNBs node-level timing synchronization status - Obtaining gNBs and UPFs node-level timing synchronization status information as defined in clause 527112 - Determining the spatial validity condition from the requested coverage area by the NEFAF and enforcing time synchronization service for the requested coverage area - Support for RAN feedback for BAT offset and adjusted periodicity as defined in clause 52725 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1760",
    "document_id": "23501-i80",
    "chunk_id": 1760,
    "text": "In the case of support of integration with IETF Deterministic Networking as depicted in clauses 4484 and 5285 acting as a stateful translator function between a DetNet controller and 5G System Network Functions and Procedures including the NW-TT This includes exposing the information about the 5GS router to the DetNet controller and mapping 5GS router configuration parameters provided by the DetNet controller to 5G System parameters The details are defined in clause 5285 6230 5G DDNMF The functionality of 5G DDNMF is defined in TS 23304 128 6231 EASDF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1761",
    "document_id": "23501-i80",
    "chunk_id": 1761,
    "text": "The functionality of EASDF is defined in TS 23548 130 6232 TSN AF The TSN AF supports control plane translator functionality for the integration of the 5GS with a TSN network this involves eg - 5GS Bridge management - Port and bridge management information exchange with DS-TT or NW-TT - Interactions with the CNC for 5GS Bridge configuration and reporting - determining the TSC Assistance Container and TSN QoS information by mapping TSN Streams based on IEEE standards The traffic pattern parameter determination may be based on PSFP IEEE Std 8021Q 98 as specified in Annex I clause I1 6233 NSWOF The NSWOF interfaces the WLAN access network using the SWa interface as defined in TS 23402 43 and interfaces the AUSF using the Nausf SBI performing protocol translation and AUSF discovery see clause 634 63 Principles for Network Function and Network Function Service discovery and selection 631 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1762",
    "document_id": "23501-i80",
    "chunk_id": 1762,
    "text": "The NF discovery and NF service discovery enable Core Network entities NFs or Service Communication Proxy SCP to discover a set of NF instances and NF service instances for a specific NF service or an NF type NF service discovery is enabled via the NF discovery procedure as specified in clauses 4174 4175 4179 and 41710 of TS 23502 3 Unless the expected NF and NF service information is locally configured on the requester NF eg when the expected NF service or NF is in the same PLMN as the requester NF the NF and NF service discovery is implemented via the Network Repository Function NRF NRF is the logical function that is used to support the functionality of NF and NF service discovery and status notification as specified in clause 626 NOTE 1 NRF can be colocated together with SCP eg for communication option D depicted in Annex E In order for the requested NF type or NF service to be discovered via the NRF the NF instance need to be registered in the NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1763",
    "document_id": "23501-i80",
    "chunk_id": 1763,
    "text": "This is done by sending a Nnrf_NFManagement_NFRegister containing the NF profile The NF profile contains information related to the NF instance such as NF instance ID supported NF service instances see clause 626 for more details regarding the NF profile The registration may take place eg when the producer NF instance and its NF service instances become operative for the first time The NF service registration procedure is specified in clause 4171 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1764",
    "document_id": "23501-i80",
    "chunk_id": 1764,
    "text": "In order for the requester NF or SCP to obtain information about the NF andor NF services registered or configured in a PLMNslice based on local configuration the requester NF or SCP may initiate a discovery procedure with the NRF by providing the type of the NF and optionally a list of the specific services it is attempting to discover The requester NF or SCP may also provide other service parameters eg slicing related information For the detailed service parameters used for specific NF and NF service discovery refer to clause 52732 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1765",
    "document_id": "23501-i80",
    "chunk_id": 1765,
    "text": "The requester NF may also provide NF Set related information to enable reselection of NF instances within the NF set The requester NF may also provide the required supported features of the NF For some Network Functions which have access to the subscription data eg HSS UDM the NRF may need to resolve the NF Group ID corresponding to a subscriber identifier If the NRF has no stored configuration mapping identity setsranges to NF Group ID locally the NRF may retrieve the NF Group ID corresponding to a specific subscriber identifier from the UDR using the Nudr_GroupIDmap_Query service operation In the case of Indirect Communication a NF Service Consumer employs an SCP which routes the request to the intended target of the request If the requester NF is configured to delegate discovery the requester NF may omit the discovery procedure with the NRF and instead delegate the discovery to the SCP the SCP will then act on behalf of the requester NF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1766",
    "document_id": "23501-i80",
    "chunk_id": 1766,
    "text": "In this case the requester NF adds any necessary discovery and selection parameters to the request in order for the SCP to be able to do discovery and associated selection The SCP may interact with the NRF to perform discovery and obtain discovery result and it may interact with the NRF or UDR to obtain NF Group ID corresponding to subscriber identifier NOTE 2 For delegated discovery of the HSS or the UDM the SCP can rely on the NRF to discover the group of HSSUDM instances serving the provided user identity or in some deployments the SCP can first query the UDR for the HSSUDM Group ID for the provided user identity It is expected that the stage 3 defines a single encoding for the user identity provided by the service consumer that can be used for both variants of delegated discovery to avoid that the service consumer needs to be aware of the SCP behaviour The NRF provides a list of NF instances and NF service instances relevant for the discovery criteria The NRF may provide the IP address or the FQDN of NF instances andor the Endpoint Addresses of relevant NF service instances to the NF Consumer or SCP The NRF may also provide NF Set ID andor NF Service Set ID to the NF Consumer or SCP The response contains a validity period during which the discovery result is considered valid and can be cached The result of the NF and NF service discovery procedure is applicable to any subscriber that fulfils the same discovery criteria The entity that does the discovery may cache the NF profiles received from the NFNF service discovery procedure During the validity period the cached NF profiles may be used for NF selection for any subscriber matching the discovery criteria NOTE 3 Refer to TS 29510 58 for details on using the validity period In the case of Direct Communication the requester NF uses the discovery result to select NF instance and a NF service instance that is able to provide a requested NF Service eg a service instance of the PCF that can provide Policy Authorization In the case of Indirect Communication without Delegated Discovery the requester NF uses the discovery result to select a NF instance while the associated NF service instance selection may be done by the requester NF andor an SCP on behalf of the requester NF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1767",
    "document_id": "23501-i80",
    "chunk_id": 1767,
    "text": "In both the cases above the requester NF may use the information from a valid cached discovery result for subsequent selections ie the requester NF does not need to trigger a new NF discovery procedure to perform the selection In the case of Indirect Communication with Delegated Discovery the SCP will discover and select a suitable NF instance and NF service instance based on discovery and selection parameters provided by the requester NF and optional interaction with the NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1768",
    "document_id": "23501-i80",
    "chunk_id": 1768,
    "text": "The NRF to be used may be provided by the NF consumer as part of the discovery parameters eg as a result of a NSSF query The SCP may use the information from a valid cached discovery result for subsequent selections ie the SCP does not need to trigger a new NF discovery procedure to perform the selection NOTE 4 In a given PLMN Direct Communication Indirect Communication or both may apply The requester NF or SCP may subscribe to receive notifications from the NRF of a newly updated NF profile of an NF eg NF service instances taken in or out of service or newly registered de-registered NF instances The NFNF service status subscribenotify procedure is defined in clauses 4177 and 4178 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1769",
    "document_id": "23501-i80",
    "chunk_id": 1769,
    "text": "For NF and NF service discovery across PLMNs the NRF in the local PLMN interacts with the NRF in the remote PLMN to retrieve the NF profiles of the NF instances in the remote PLMN that matches the discovery criteria The NRF in the local PLMN reaches the NRF in the remote PLMN by forming a target PLMN specific query using the PLMN ID provided by the requester NF The NFNF service discovery procedure across PLMNs is specified in clause 4175 of TS 23502 3 NOTE 5 See TS 29510 58 for details on using the target PLMN ID specific query to reach the NRF in the remote PLMN For topology hiding see clause 6217 6310",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1770",
    "document_id": "23501-i80",
    "chunk_id": 1770,
    "text": "Principles for Binding Selection and Reselection Binding can be used to indicate suitable target NF producer instances for NF service instance selection reselection and routing of subsequent requests associated with a specific NF producer resource context and NF service This allows the NF producer to indicate that the NF consumer for a particular context should be bound to an NF service instance NF instance NF service set or NF set depending on local policies and other criteria eg at what point it is in the middle of a certain procedure considering performance aspects etc Binding can also be used by the NF consumer to indicate suitable NF consumer instances for notification target instance reselection and routing of subsequent notification requests associated with a specific notification subscription and for providing Binding Indication for services that the NF consumer produces for the same data context and the NF service producer is subsequently likely to invoke The Binding Indication contains the information in Table 6310-1 The Routing Binding Indication may be included in Request Subscribe or Notification messages see clause 712 It may be used in the case of indirect communication by the SCP to route the message The Routing Binding Indication is a copy of the information in the Binding Indication and also contains the information in Table 6310-1 NOTE 1 Subscription request messages can contain both a Binding Indication and a Routing Binding Indication",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1771",
    "document_id": "23501-i80",
    "chunk_id": 1771,
    "text": "The NF service producer may provide a Binding Indication to the NF service consumer as part of the Direct or Indirect Communication procedures to be used in subsequent related service requests The level of Binding Indication provided by the NF service producer to the NF consumer indicates if the resource in the NF service producer is either bound to NF service instance NF instance NF Service Set or NF set as specified in Table 6310-1 The Binding Indication may include NF Service Set ID NF Set ID NF instance ID or NF service instance ID for use by the NF consumer or SCP for NF Service Producer re-selection If the resource is created in the NF Service Producer the NF Service Producer provides resource information which includes the endpoint address of the NF service producer For indirect communication the NF service consumer copies the Binding Indication into the Routing Binding Indication in Request or Subscribe message unless the NF service consumer performs a reselection for indirect communication without delegated discovery During explicit or implicit notification subscription a Binding Indication may be provided by the NF service consumer to NF service producer the NF service consumer will also provide a Notification Endpoint The NF service consumer may also provide a Binding Indication in response to notification requests The level of Binding Indication provided by the NF service consumer to the NF service provider indicates if the Notification Endpoint is either bound to NF service instance NF instance NF Service Set or NF set as specified in Table 6310-1 The Binding Indication shall include at least one of NF Set ID NF instance ID NF Service Set ID andor NF service instance ID and may also include the service name The NF Service Set ID NF service instance ID and service name relate to the service of the NF service consumer that will handle the notification NOTE 2 The NF service can either be a standardised service as per this specification or a custom service The custom service can be used for the sole purpose of registering endpoint addresses to receive notifications at the NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1772",
    "document_id": "23501-i80",
    "chunk_id": 1772,
    "text": "The Binding Indication is used by the NF service producer as notification sender to reselect an endpoint address and construct the Notification Endpoint ie the URI where the notification is to be sent eg if the provided Notification Endpoint of the NF service consumer included in the subscription cannot be reached according to the following - If the service name in the Binding Indication is omitted and the binding for notification is on NF Set or NF Instance level the endpoint address registered in the NRF at NF Profile level of the NFs selected according to the Binding Indication shall be used to construct a new Notification Endpoint - If the service name is included in the Binding Indication an endpoint address registered in the NRF for that service in the NF profiles selected according to the Binding Indication shall be used to construct a new Notification Endpoint For indirect communication the NF service producer copies the Binding Indication into the Routing Binding Indication that is included in the Notification request to be used by the SCP to discover an alternative endpoint address and construct a Notification Endpoint eg if the Notification Endpoint that the request targets cannot be reached according to the following - If the service name in the Routing Binding Indication is omitted and the binding for notification is on NF Set or NF Instance level the endpoint address registered in the NRF at NF Profile level of the NFs selected according to the Binding Indication shall be used to construct a new Notification Endpoint - If the service name is included in the Routing Binding Indication an endpoint address registered in the NRF for that service in the NF profiles selected according to the Binding Indication shall be used to construct a new Notification Endpoint For subscription to notifications via another network function a separate Binding Indication for subscription related events may be provided by the NF service consumer see clause 417124 of TS 23502 3 and if provided shall be associated with an applicability indicating notification for subscription related events If the NF as an NF consumer provides a Binding Indication for services that the NF produces in service requests the Binding Indication shall be associated with an applicability indicating other service and may contain the related service names in addition to the other parameters listed in Table 6310-1 If no service names are provided the Binding Indication relates to all services that the NF produces For NF Set or NF Instance level of binding a Binding Indication for notifications and other services may be combined if it relates to the same service and that combined Binding Indication shall then be associated with an applicability indicating all scenarios that the Binding Indication relates to For this purpose the applicability can indicate a combination of values If no applicability is indicated in a request or subscribe messages a Binding Indication in that messages is applicable for notification to all events except for the subscription related event see clause 417124 of TS 23502 3 NOTE 3 Such a request message can be used for implicit subscription NOTE 4 Request messages can contain both the Binding Indications for services and for notifications and in addition the Routing Binding Indication in the case of indirect communication A Binding Indication may be shared by a group of resources eg contexts identified by a group identifier",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1773",
    "document_id": "23501-i80",
    "chunk_id": 1773,
    "text": "This enables a NF Service consumer or producer to update the binding indication for this group of resources in a single request or notification towards a given peer NF service instance eg when a group of resources need to be taken over by a different NF within an NF set See clause 6121 of TS 29500 49 Table 6310-1 defines the selection and reselection behaviour of NF services consumers and SCPs depending on the Binding Indication provided by an NF service producer",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1774",
    "document_id": "23501-i80",
    "chunk_id": 1774,
    "text": "The detailed procedures refer to clause 41711 and 41712 of TS 23502 3 Table 6310-1 Binding selection and reselection 6311 NF Discovery and Selection aspects relevant with indirect communication For indirect communication shown in Annex E the SCP performs the following functionalities regarding Network Function and Network Function Service discovery and selection - If the request includes a Routing Binding Indication the SCP shall route the service request to the requested target as specified in Table 6310-1 If the Routing Binding Indication does not exist the SCP may get the NF Set ID from the NRF or local configuration if available - If the request recipient had previously provided a Binding Indication then the request sender shall include a Routing Binding Indication with the same contents in subsequent related requests 6312 Location information The location information describes the network location of the NF instance It can consist of one or more levels Each level describes one location aspect such as geographic location data centre cluster etc An NF instance has only one location The location information may be used to select the NF service instance or NF instance from a particular network location based on local configuration NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1775",
    "document_id": "23501-i80",
    "chunk_id": 1775,
    "text": "The location information in TS 29510 58 specifies the granularity of location information It is up to each deployment to determine the granularity of location information to be used 632 SMF discovery and selection The SMF selection functionality is supported by the AMF and SCP and is used to allocate an SMF that shall manage the PDU Session The SMF selection procedures are described in clause 43223 of TS 23502 3 The SMF discovery and selection functionality follows the principles stated in clause 631 If the AMF does discovery the AMF shall utilize the NRF to discover SMF instances unless SMF information is available by other means eg locally configured on AMF The AMF provides UE location information to the NRF when trying to discover SMF instances The NRF provides NF profiles of SMF instances to the AMF In addition the NRF also provides the SMF service area of SMF instances to the AMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1776",
    "document_id": "23501-i80",
    "chunk_id": 1776,
    "text": "The SMF selection functionality in the AMF selects an SMF instance and an SMF service instance based on the available SMF instances obtained from NRF or on the configured SMF information in the AMF NOTE 1 Protocol aspects of the access to NRF are specified in TS 29510 58 The SMF selection functionality is applicable to both 3GPP access and non-3GPP access The SMF selection for Emergency services is described in clause 51645 The following factors may be considered during the SMF selection a Selected Data Network Name DNN In the case of the home routed roaming the DNN is not applied for the V-SMF selection b S-NSSAI of the HPLMN for non-roaming and home-routed roaming scenarios and S-NSSAI of the VPLMN for roaming with local breakout and home-routed roaming scenarios c NSI-ID NOTE 2 The use of NSI -ID in the network is optional and depends on the deployment choices of the operator If used the NSI ID is associated with S-NSSAI d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1777",
    "document_id": "23501-i80",
    "chunk_id": 1777,
    "text": "Access technology being used by the UE e Support for Control Plane CIoT 5GS Optimisation f Subscription information from UDM eg - per DNN whether LBO roaming is allowed - per DNN whether HR-SBO roaming is allowed - per S-NSSAI the subscribed DNNs - per S-NSSAI subscribed DNN whether LBO roaming is allowed - per S-NSSAI subscribed DNN whether HR-SBO roaming is allowed - per S-NSSAI subscribed DNN whether EPC interworking is supported - per S-NSSAI subscribed DNN whether selecting the same SMF for all PDU sessions to the same S-NSSAI and DNN is required - per S-NSSAI DNN associated with 5G VN group Service Area LADN service area for the 5G VN group In the case of SMF selection for a PDU Session targeting 5G VN group the AMF may prefer candidate SMFs that have an intersection with the LADN service area of the 5G VN group g Void h Local operator policies NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1778",
    "document_id": "23501-i80",
    "chunk_id": 1778,
    "text": "These policies can take into account whether the SMF to be selected is an I-SMF or a V-SMF or a SMF i Load conditions of the candidate SMFs j Analytics ie statistics or predictions for candidate SMFs load as received from NWDAF see TS 23288 86 if NWDAF is deployed k UE location ie TA l Service Area of the candidate SMFs m Capability of the SMF to support a MA PDU Session n",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1779",
    "document_id": "23501-i80",
    "chunk_id": 1779,
    "text": "If interworking with EPS is required o Preference of V-SMF support This is applicable only for V-SMF selection in the case of home routed roaming p Target DNAI q Capability of the SMF to support User Plane Remote Provisioning see clause 53021043 r Supported DNAI list s HR-SBO support according to clause 67 of TS 23548 130 t Capability of the SMF V-SMF and H-SMF to support non-3GPP access path switching To support the allocation of a static IPv4 address andor a static IPv6 prefix as specified in clause 58221 a dedicated SMF may be deployed for the indicated combination of DNN and S-NSSAI and registered to the NRF or provided by the UDM as part of the subscription data In the case of delegated discovery the AMF shall send all the available factors a-d k and n to the SCP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1780",
    "document_id": "23501-i80",
    "chunk_id": 1780,
    "text": "In addition the AMF may indicate to the SCP which NRF to use in the case of NRF dedicated to the target slice If there is an existing PDU Session and the UE requests to establish another PDU Session to the same DNN and S-NSSAI of the HPLMN and the UE subscription data indicates the support for interworking with EPS for this DNN and S-NSSAI of the HPLMN or UE subscription data indicates the same SMF shall be selected for all PDU sessions to the same S-NSSAI DNN the same SMF in non roaming and LBO case or the same H-SMF in home routed roaming case shall be selected In addition if the UE Context in the AMF provides a SMF ID for an existing PDU session to the same DNN S-NSSAI the AMF uses the stored SMF ID for the additional PDU Session In any such a case where the AMF can determine which SMF should be selected if delegated discovery is used the AMF shall indicate a desired NF Instance ID so that the SCP is able to route the message to the relevant SMF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1781",
    "document_id": "23501-i80",
    "chunk_id": 1781,
    "text": "Otherwise if UE subscription data does not indicate the support for interworking with EPS for this DNN and S-NSSAI a different SMF in non roaming and LBO case or a different H-SMF in home routed roaming case may be selected For example to support a SMF load balancing or to support a graceful SMF shutdown eg a SMF starts to no more take new PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1782",
    "document_id": "23501-i80",
    "chunk_id": 1782,
    "text": "In the home-routed roaming case the SMF selection functionality selects an SMF in VPLMN based on the S-NSSAI of the VPLMN as well as an SMF in HPLMN based on the S-NSSAI of the HPLMN This is specified in clause 432233 of TS 23502 3 If the HR-SBO roaming is allowed for the PDU Session the DNN is also considered for V-SMF selection When the UE requests to establish a PDU Session to a DNN and an S-NSSAI of the HPLMN if the UE MM Core Network Capability indicates the UE supports EPC NAS and optionally if the UE subscription indicates the support for interworking with EPS for this DNN and S-NSSAI of the HPLMN the selection functionality in AMF or SCP selects a combined SMFPGW-C Otherwise a standalone SMF may be selected If the UDM provides a subscription context that allows for handling the PDU Session in the VPLMN ie using LBO for this DNN and S-NSSAI of the HPLMN and optionally the AMF is configured to know that the VPLMN has a suitable roaming agreement with the HPLMN of the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1783",
    "document_id": "23501-i80",
    "chunk_id": 1783,
    "text": "the following applies - If the AMF does discovery the SMF selection functionality in AMF selects an SMF from the VPLMN - If delegated discovery is used the SCP selects an SMF from the VPLMN If an SMF in the VPLMN cannot be derived for the DNN and S-NSSAI of the VPLMN or if the subscription does not allow for handling the PDU Session in the VPLMN using LBO then the following applies - If the AMF does discovery both an SMF in VPLMN and an SMF in HPLMN are selected and the DNN and S-NSSAI of the HPLMN is used to derive an SMF identifier from the HPLMN - If delegated discovery is used - The AMF performs discovery and selection of H-SMF from NRF The AMF may indicate the maximum number of H-SMF instances to be returned from NRF ie SMF selection at NRF -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1784",
    "document_id": "23501-i80",
    "chunk_id": 1784,
    "text": "The AMF sends Nsmf_PDUSession_CreateSMContext Request to SCP which includes the endpoint eg URI of the selected H-SMF and the discovery and selection parameters as defined in this clause ie parameter for V-SMF selection The SCP performs discovery and selection of the V-SMF and forwards the request to the selected V-SMF - The V-SMF sends the Nsmf_PDUSession_Create Request towards the H-SMF via the SCP the V-SMF uses the received endpoint eg URI of the selected H-SMF to construct the target destination to be addressed The SCP forwards the request to the H-SMF - Upon reception of a response from V-SMF based on the received V-SMF ID the AMF obtains the Service Area of the V-SMF from NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1785",
    "document_id": "23501-i80",
    "chunk_id": 1785,
    "text": "The AMF uses the Service Area of the V-SMF to determine the need for V-SMF relocation upon subsequent UE mobility If the initially selected SMF in VPLMN for roaming with LBO detects it does not understand information in the UE request it may reject the N11 message related with a PDU Session Establishment Request message with a proper N11 cause triggering the AMF to select both a new SMF in the VPLMN and a SMF in the HPLMN for home routed roaming The AMF selects SMFs considering support for CIoT 5GS optimisations eg Control Plane CIoT 5GS Optimisation In the case of onboarding of UEs for SNPNs when the UE is registered for SNPN onboarding the AMF selects SMFs of Onboarding Network considering the Capability of SMF to support User Plane Remote Provisioning",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1786",
    "document_id": "23501-i80",
    "chunk_id": 1786,
    "text": "Additional details of AMF selection of an I-SMF are described in clause 534 In the case of home routed scenario the AMF selects a new V-SMF if it determines that the current V-SMF cannot serve the UE location The selectionrelocation is same as an I-SMF selectionrelocation as described in clause 534 633 User Plane Function Selection 6331 Overview",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1787",
    "document_id": "23501-i80",
    "chunk_id": 1787,
    "text": "The selection and reselection of the UPF for PDU session establishment UE mobility or UE traffic offloading are performed by the SMF by considering UPF deployment scenarios such as centrally located UPF and distributed UPF located close to or at the Access Network site The selection of the UPF shall also enable deployment of UPF with different capabilities eg UPFs supporting no or a subset of optional functionalities When the UPF selection for PDU session establishment takes place in home routed roaming case the UPFs in home PLMN is selected by SMFs in HPLMN and the UPFs in the VPLMN is selected by SMFs in VPLMN The exact set of parameters used for the selection mechanism is deployment specific and controlled by the operator configuration The UPF selection for PDU session establishment UE mobility or UE traffic offloading involves - A step of SMF Provisioning of available UPFs details are described in clause 6332",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1788",
    "document_id": "23501-i80",
    "chunk_id": 1788,
    "text": "This step may take place while there is no PDU Session to establish and is followed by N4 Node Level procedures defined in clause 443 of TS 23502 3 where the UPF and the SMF may exchange information such as the support of optional functionalities and capabilities - A step of selection of an UPF for a particular PDU Session details are described in clause 6333 which is followed by N4 session management procedures defined in clause 441 of TS 23502 3 The selection and reselection of the UPF is also performed by an NF other than the SMF in order to collect the data from the UPF as defined in clause 58217",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1789",
    "document_id": "23501-i80",
    "chunk_id": 1789,
    "text": "In this case the related dedicated UPF is discovered and selected as follows - When the NF consumer or SCP directly subscribes to the UPF if allowed by the conditions defined in clause 58217 the NF consumer or SCP queries the NRF including the related discovery parameters The NRF returns the UPFs which meets the discovery request - When the NF consumer or SCP shall subscribe via the SMF the NF consumer gets the serving SMF information from the UDM per SUPI DNN and S-NSSAI After that the NF consumer sends a subscription to the indicated SMF and the SMF identifies the related UPFs using the parameters of the subscription eg target flow description AoI etc and transfers the related event subscription information to the identified UPFs If the NF consumer does not know the SUPI but only the UE IP address it may need to invoke the BSF to get the SUPI corresponding to the triplet UE IP address DNN and S-NSSAI 6332 SMF Provisioning of available UPFs SMF may be locally configured with the information about the available UPFs eg by OAM system when a UPF is instantiated or removed or the SMF may become aware of a UPF via a UPF initiated N4 Association establishment as described in clause 443 of",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1790",
    "document_id": "23501-i80",
    "chunk_id": 1790,
    "text": "TS 23502 3 NOTE 1 UPF information can be updated eg by OAM system any time after the initial provisioning or UPF itself updates its information to the SMF via N4 node level procedures anytime after N4 Association establishment The UPF selection functionality in the SMF may optionally utilize the NRF to discover UPFs In this case the SMF issues a request to the NRF that may include following parameters DNN S-NSSAI SMF Area Identity the requested functionalities and capabilities eg ATSSS steering capabilities functionality associated with high data rate low latency service etc In its answer the NRF provides the NF profiles that includes the IP addresses or the FQDN of the N4 interface of corresponding UPFs to the SMF UPFs may be associated with an SMF Area Identity in the NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1791",
    "document_id": "23501-i80",
    "chunk_id": 1791,
    "text": "This allows limiting the SMF provisioning of UPFs using NRF to those UPFs associated with a certain SMF Area Identity This can eg be used in the case that an SMF is only allowed to control UPFs configured in NRF as belonging to a certain SMF Area Identity The NRF may be configured by OAM with information on the available UPFs or the UPFs may register itstheir NF profiles in the NRF This is further defined in clause 417 of TS 23502 3 6333 Selection of an UPF for a particular PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1792",
    "document_id": "23501-i80",
    "chunk_id": 1792,
    "text": "The following parameters and information may be considered by the SMF for UPF selection and re-selection - UPFs dynamic load - Analytics ie statistics or predictions for UPF load Service Experience analytics andor DN Performance analytics per UP path including UPF andor DNAI andor AS instance and UE related analytics UE mobility UE communication and expected UE behavioural parameters as received from NWDAF see TS 23288 86 if NWDAF is deployed - UPFs relative static capacity among UPFs supporting the same DNN - UPF location available at the SMF - UE location information - Capability of the UPF and the functionality required for the particular UE session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1793",
    "document_id": "23501-i80",
    "chunk_id": 1793,
    "text": "An appropriate UPF can be selected by matching the functionality and features required for an UE - Data Network Name DNN - PDU Session Type ie IPv4 IPv6 IPv4v6 Ethernet Type or Unstructured Type and if applicable the static IP addressprefix - SSC mode selected for the PDU Session - UE subscription profile in UDM - DNAI as included in the PCC Rules and described in clause 567 - Local operator policies - S-NSSAI - Access technology being used by the UE - Information related to user plane topology and user plane terminations that may be deduced from - 5G-AN-provided identities eg CellID TAI available UPFs and DNAIs - Identifiers ie a FQDN andor IP addresses of N3 terminations provided by a W-AGF or a TNGF or a TWIF NOTE 1 A W-AGF or a TNGF may provide Identifiers of its N3 terminations when forwarding over N2 uplink NAS signalling to the 5GC The AMF may relay this information to the SMF as part of session management signalling for a new PDU Session - Information regarding the user plane interfaces of UPFs This information may be acquired by the SMF using N4 - Information regarding the N3 User Plane terminations of the AN serving the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1794",
    "document_id": "23501-i80",
    "chunk_id": 1794,
    "text": "This may be deduced from 5G-AN-provided identities eg CellID TAI - Information regarding the N9 User Plane terminations of UPFs if needed - Information regarding the User plane terminations corresponding to DNAIs - RSN support for redundant GTP-U path or support for redundant transport path in the transport layer as in clause 5332 when redundant UP handling is applicable - Information regarding the ATSSS Steering Capability of the UE session eg any combination of ATSSS-LL capability MPTCP capability MPQUIC capability and information on the UPF support of RTT measurements without PMF - Support for UPF allocation of IP addressprefix - Support of the IPUPS functionality specified in clause 58214 - Support for High latency communication see clause 5318 - Support for functionality associated with high data rate low latency services eXtended Reality XR and interactive media services specified in clause 537 for example ECN marking for L4S specified in clause 5373",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1795",
    "document_id": "23501-i80",
    "chunk_id": 1795,
    "text": "PDU Set Marking specified in clause 5375 UE power saving management specified in clause 5378 - User Plane Latency Requirements within AF request see clause 5671 and clause 636 of TS 23548 130 - List of supported Event IDs for exposure of UPF-related information via service based interface see clause 7229 and clause 52262 of TS 23502 3 NOTE 2 How the SMF determines information about the user plane network topology from information listed above and what information is considered by the SMF is based on operator configuration NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1796",
    "document_id": "23501-i80",
    "chunk_id": 1796,
    "text": "In this release the SMF uses no additional parameters for UPF selection for a PDU Session serving TSC or Deterministic Networking If a PDU Session needs to connect to a specific UPF hosting a specific TSN 5GS bridge or 5GS router this can be achieved eg by using a dedicated DNNS-NSSAI combination If there is an existing PDU Session and the SMF receives another PDU Session request to the same DNN and S-NSSAI and if the SMF determines that interworking with EPC is supported for this PDU Session as specified in clause 4115 of TS 23502 3 the SMF should select the same UPF if it supports all capabilities required for the new PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1797",
    "document_id": "23501-i80",
    "chunk_id": 1797,
    "text": "Otherwise if the SMF determines that interworking with EPC is not supported for the new PDU Session or the UPF of the existing PDU Session does not support all capabilities required for the new PDU Session a different UPF may be selected according to operator policy For the same DNN and S-NSSAI if different UPFs are selected at 5GC when the UE is moved to EPC network there is no requirement to enforce APN-AMBR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1798",
    "document_id": "23501-i80",
    "chunk_id": 1798,
    "text": "Whether and how to apply APN-AMBR for the PDN Connection associated with this DNNAPN is implementation dependent eg possibly only AMBR enforcement per PDU Session applies 634 AUSF discovery and selection In the case of NF consumer based discovery and selection the following applies - The AMF and the NSWOF perform AUSF selection to allocate an AUSF Instance that performs authentication between the UE and 5G CN in the HPLMN The AMF and the NSWOF shall utilize the NRF to discover the AUSF instances unless AUSF information is available by other means eg locally configured on AMF and on NSWOF The AUSF selection function in the AMF and in the NSWOF selects an AUSF instance based on the available AUSF instances obtained from the NRF or locally configured in the AMF - The UDM shall utilize the NRF to discover the AUSF instances unless AUSF information is available by other means eg locally configured on UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1799",
    "document_id": "23501-i80",
    "chunk_id": 1799,
    "text": "The UDM selects an AUSF instance based on the available AUSF instances obtained from the NRF or based on locally configured information and information stored by the UDM from a previously successful authentication AUSF selection is applicable to both 3GPP access and non-3GPP access The AUSF selection function in AUSF NF consumers or in SCP should consider one of the following factors when available 1 Home Network Identifier eg MNC and MCC realm of SUCISUPI by an NF consumer in the Serving network along with the selected NID provided by the NG-RAN in the case of SNPN Routing Indicator and optionally Home Network Public Key identifier eg in the case that Routing Indicator is not enough to provide SUPI range granularity NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1800",
    "document_id": "23501-i80",
    "chunk_id": 1800,
    "text": "The UE provides the SUCI which contains the Routing Indicator and Home Network Public Key identifier as defined in TS 23003 19 to the AMF during initial registration and to the NSWOF during NSWO authentication The AMF can provide the UEs Routing Indicator and optionally Home Network Public Key identifier to other AMFs as described in TS 23502 3 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1801",
    "document_id": "23501-i80",
    "chunk_id": 1801,
    "text": "The usage of Home Network Public Key identifier for AUSF discovery is limited to the scenario where the AUSF NF consumers belong to the same PLMN as AUSF NOTE 3 In the case of SNPN and if the UE provides an IMSI type SUCI to the AMF and the SUCI provided by UE or the SUPI derived from the SUCI is for an SNPN served by the AMF the AMF uses the selected NID provided by the NG-RAN together with the selected PLMN ID from IMSI or the Routing Indicator provided by the UE within the SUCI for selection of AUSF In the case of SNPN and the UE provides an NSI type SUCI to the AMF the AMF uses the Home Network Identifier and Routing Indicator of SUCISUPI for selection of AUSF When the UEs Routing Indicator is set to its default value as defined in TS 23003 19 the AUSF NF consumer can select any AUSF instance within the home network for the UE 2 AUSF Group ID the UEs SUPI belongs to NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1802",
    "document_id": "23501-i80",
    "chunk_id": 1802,
    "text": "The AMF can infer the AUSF Group ID the UEs SUPI belongs to based on the results of AUSF discovery procedures with NRF The AMF provides the AUSF Group ID the SUPI belongs to other AMFs as described in TS 23502 3 3 SUPI eg the AMF selects an AUSF instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI as input for AUSF discovery NOTE 5 In the case of Onboarding via ON-SNPN AUSF instances supporting UE onboarding can be registered in NRF or locally configured in the AMF The AMF in ON-SNPN can discover and select AUSF instances supporting UE onboarding based on the MCC and MNC or realm part in Home Network Identifier of the SUCISUPI provided by the onboarding UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1803",
    "document_id": "23501-i80",
    "chunk_id": 1803,
    "text": "In the case of delegated discovery and selection in SCP the AUSF NF consumer shall send all available factors to the SCP 635 AMF discovery and selection The AMF discovery and selection functionality is applicable to both 3GPP access and non-3GPP access The AMF selection functionality can be supported by the 5G-AN eg RAN N3IWF and is used to select an AMF instance for a given UE An AMF supports the AMF selection functionality to select an AMF for relocation or because the initially selected AMF was not an appropriate AMF to serve the UE eg due to change of Allowed NSSAI Other CP NFs eg SMF supports the AMF selection functionality to select an AMF from the AMF set when the original AMF serving a UE is unavailable The TSCTSF shall use the AMF discovery functionality to determine the AMFs serving the TAs in the spatial validity condition provided by the AF 5G-AN selects an AMF Set and an AMF from the AMF Set under the following circumstances 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1804",
    "document_id": "23501-i80",
    "chunk_id": 1804,
    "text": "When the UE provides no 5G-S-TMSI nor the GUAMI to the 5G-AN 2 When the UE provides 5G-S-TMSI or GUAMI but the routing information ie AMF identified based on AMF Set ID AMF pointer present in the 5G-S-TMSI or GUAMI is not sufficient andor not usable eg UE provides GUAMI with an AMF region ID from a different region 3 AMF has instructed AN that the AMF identified by GUAMIs is unavailable and no target AMF is identified andor AN has detected that the AMF has failed 4 When the UE attempts to establish a signalling connection and the following conditions are met - the 5G-AN knows in what country the UE is located and - the 5G-AN is connected to AMFs serving different PLMNs of different countries and - the UE provides a 5G-S-TMSI or GUAMI which indicates an AMF serving a different country to where the UE is currently located and - the 5G-AN is configured to enforce selection of the AMF based on the country the UE is currently located Then the 5G-AN shall select an AMF serving a PLMN corresponding to the UEs current location How 5G-AN selects the AMF in this case is defined in TS 38410 125 NOTE AMF selection case 4 does not apply if 5G-AN nodes serves one country only In the case of NF Service Consumer based discovery and selection the CP NF selects an AMF from the AMF Set under the following circumstances - When the AMF has instructed CP NF that a certain AMF identified by GUAMIs is unavailable and the CP NF was not notified of target AMF andor - CP NF has detected that the AMF has failed andor - When the selected AMF does not support the UEs Preferred Network Behaviour andor - When the selected AMF does not support the High Latency communication for NR RedCap UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1805",
    "document_id": "23501-i80",
    "chunk_id": 1805,
    "text": "In the case of delegated discovery and associated selection the SCP selects an AMF from the corresponding AMF Set under the following circumstances - The SCP gets an indication select new AMF within SET from the CP NF andor - SCP has detected that the AMF has failed The AMF selection functionality in the 5G-AN may consider the following factors for selecting the AMF Set - AMF Region ID and AMF Set ID derived from GUAMI - Requested NSSAI - Local operator policies - 5G CIoT features indicated in RRC signalling by the UE - IAB-indication - NB-IoT RAT Type - Category M Indication - NR RedCap Indication - SNPN Onboarding indication as indicated in 5G-AN signalling by the UE - Mobile IAB-indication AMF selection functionality in the 5G-AN or CP NFs or SCP considers the following factors for selecting an AMF from AMF Set - Availability of candidate AMFs - Load balancing across candidate AMFs eg considering weight factors of candidate AMFs in the AMF Set -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1806",
    "document_id": "23501-i80",
    "chunk_id": 1806,
    "text": "In 5G-AN 5G CIoT features indicated in RRC signalling by the UE - In 5G-AN SNPN Onboarding indication as indicated in 5G-AN signalling by the UE When the UE accesses the 5G-AN with a 5G-S-TMSI or GUAMI that identifies more than one AMF as configured during N2 setup procedure the 5G-AN selects the AMF considering the weight factors When 5G-S-TMSI or GUAMI provided by the UE to the 5G-AN contains an AMF Set ID that is usable and the AMF identified by AMF pointer that is not usable eg AN detects that the AMF has failed or the corresponding AMF indicates it is unavailable eg out of operation then the 5G-AN uses the AMF Set ID for selecting another AMF from the AMF set considering the factors above The discovery and selection of AMF in the CP NFs or SCP follows the principle in clause 631",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1807",
    "document_id": "23501-i80",
    "chunk_id": 1807,
    "text": "In the case of NF Service Consumer based discovery and selection the AMF or other CP NFs shall utilize the NRF to discover the AMF instances unless AMF information is available by other means eg locally configured on AMF or other CP NFs The NRF provides the NF profiles of AMF instances to the AMF or other CP NFs The AMF selection function in the AMF or other CP NFs selects an AMF instance as described below When NF Service Consumer performs discovery and selection the following applies -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1808",
    "document_id": "23501-i80",
    "chunk_id": 1808,
    "text": "In the case of AMF discovery and selection functionality in AMF or other CP NFs use GUAMI in the SNPN case along with NID of the SNPN that owns the AMF instances to be discovered and selected or TAI to discover the AMF instances the NRF provides the NF profile of the associated AMF instances If an associated AMF is unavailable due to AMF planned removal the NF profile of the backup AMF used for planned removal is provided by the NRF If an associated AMF is unavailable due to AMF failure the NF profile of the backup AMF used for failure is provided by the NRF If AMF pointer value in the GUAMI is associated with more than one AMF the NRF provides all the AMFs associated with this AMF pointer value If no AMF instances related to the indicated GUAMI can be found the NRF may provide a list of NF profiles of candidate AMF instances in the same AMF Set",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1809",
    "document_id": "23501-i80",
    "chunk_id": 1809,
    "text": "The other CP NF or AMF may select any AMF instance from the list of candidate AMF instances If no NF profiles of AMF is returned in the discovery result the other CP NF or AMF may discover an AMF using the AMF Set as below - In the case of AMF discovery and selection functionality in AMF use AMF Set to discover AMF instances the NRF provides a list of NF profiles of AMF instances in the same AMF Set - At intra-PLMN mobility the AMF discovery and selection functionality in AMF may use AMF Set ID AMF Region ID the target location information S-NSSAIs of Allowed NSSAI to discover target AMF instances The NRF provides the target NF profiles matching the discovery - At intra-SNPN mobility the AMF discovery and selection functionality in AMF may use AMF Set ID AMF Region ID along with NID of the SNPN that owns the AMF instances to be discovered and selected the target location information S-NSSAIs of Allowed NSSAI AMF support of SNPN Onboarding if the UE is registered for SNPN Onboarding to discover target AMF instances The NRF provides the target NF profiles matching the discovery -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1810",
    "document_id": "23501-i80",
    "chunk_id": 1810,
    "text": "At inter PLMN mobility the source AMF selects an AMF instances in the target PLMN by querying target PLMN level NRF via the source PLMN level NRF with target PLMN ID The target PLMN level NRF returns an AMF instance address based on the target operator configuration After the Handover procedure the AMF may select a different AMF instance as specified in clause 42223 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1811",
    "document_id": "23501-i80",
    "chunk_id": 1811,
    "text": "In the context of Network Slicing the AMF selection is described in clause 515521 When delegated discovery and associated selection is used the following applies - If the CP NF includes GUAMI or TAI in the request the SCP selects an AMF instance associated with the GUAMI or TAI and sends the request to a selected AMF service instance if it is available The following also applies - If none of the associated AMF service instances are available due to AMF planned removal an AMF service instance from the backup AMF used for planned removal is selected by the SCP - If none of the associated AMF service instances are available due to AMF failure an AMF service instance from the backup AMF used for failure is selected by the SCP - If no AMF service instances related to the indicated GUAMI in the SNPN case along with NID of the SNPN that owns the AMF instances to be discovered and selected can be found the SCP selects an AMF instance from the AMF Set or - AMF Pointer value used by more than one AMF SCP selects one of the AMF instances associated with the AMF Pointer - If the CP NF includes AMF Set ID in the request the SCP selects AMFAMF service instances in the provided AMF Set - At intra-PLMN mobility if a target AMF instance needs to be selected the AMF may provide AMF Set ID AMF Region ID and the target location information S-NSSAIs of Allowed NSSAI in the request optionally NRF to use The SCP will select a target AMF instance matching the discovery - At intra-SNPN mobility if a target AMF instance needs to be selected the AMF may provide AMF Set ID AMF Region ID along with NID of the SNPN that owns the AMF instances to be discovered and selected and the target location information S-NSSAIs of Allowed NSSAI AMF support of SNPN Onboarding in the request if the UE is registered for SNPN Onboarding optionally NRF to use The SCP will select a target AMF instance matching the discovery - At inter PLMN mobility the source AMF selects indicates roaming to the SCP The SCP interacts with the NRF in source PLMN so that the NRF in source PLMN can discover an AMF in the target PLMN via target PLMN NRF 636",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1812",
    "document_id": "23501-i80",
    "chunk_id": 1812,
    "text": "N3IWF selection 6361 General When the UE supports connectivity with N3IWF but does not support connectivity with ePDG as specified in TS 23402 43 the UE shall perform the procedure in clause 6362 for selecting an N3IWF When the UE supports connectivity with N3IWF as well as with ePDG as specified in TS 23402 43 the UE shall perform the procedure in clause 6363 for selecting either an N3IWF or an ePDG ie for selecting a non-3GPP access node In both cases above the UE can be configured by the HPLMN with the same information that includes 1 ePDG identifier configuration It contains the FQDN or IP address of the ePDG in the HPLMN as specified in clause 4543 of TS 23402 43 This is used only when the UE supports connectivity with ePDG and attempts to select an ePDG",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1813",
    "document_id": "23501-i80",
    "chunk_id": 1813,
    "text": "It is ignored in all other cases 2 N3IWF identifier configuration It contains the FQDN or IP address of the N3IWF in the HPLMN 3 Extended Home N3IWF identifier configuration It contains one or multiple tuples of FQDNIP address of the N3IWF in the HPLMN and the S-NSSAIs supported by this N3IWF 4 Non-3GPP access node selection information It contains a prioritized list of PLMNs and for each PLMN it includes i a Preference parameter which indicates if ePDG or N3IWF is preferred in this PLMN and ii an FQDN parameter which indicates if the TrackingLocation Area Identity FQDN or the Operator Identifier FQDN as specified in clause 4544 of TS 23402 43 should be used when discovering the address of an ePDG or N3IWF in this PLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1814",
    "document_id": "23501-i80",
    "chunk_id": 1814,
    "text": "The list of PLMNs shall include the HPLMN and shall include an any PLMN entry which matches any PLMN the UE is connected to except the HPLMN 5 Slice-specific N3IWF prefix configuration It contains one or multiple tuples consisting of - List of supported S-NSSAIs - Prefix for the Prefixed N3IWF OI or TA FQDNs NOTE 1 Extended Home N3IWF identifier configuration and Slice-specific N3IWF prefix configuration are assumed to be provided to the UE as part of ANDSP The ePDG identifier configuration the N3IWF identifier configuration the Extended Home N3IWF identifier configuration and the Slice-specific N3IWF Prefix Configuration are optional parameters while the Non-3GPP access node selection information is required and shall include at least the HPLMN and the any PLMN entry If the ePDG identifier configuration is configured in the UE then when the UE decides to select an ePDG in the HPLMN according to the procedure in clause 6363 the UE shall use the ePDG identifier configuration to find the IP address of the ePDG in the HPLMN and shall ignore the FQDN parameter of the HPLMN in the Non-3GPP access node selection information If the N3IWF identifier configuration or the Extended Home N3IWF identifier configuration is configured in the UE then when the UE decides to select an N3IWF in the HPLMN according to the procedure in clause 6363 for combined N3IWFePDG selection and the procedure in clause 6362 for Stand-alone N3IWF selection the UE shall use the Extended Home N3IWF identifier configuration if available and otherwise the N3IWF identifier configuration to find the IP address of the N3IWF in the HPLMN and shall ignore the FQDN parameter of the HPLMN in the Non-3GPP access node selection information The HPLMNs PCF takes the UEs subscribed S-NSSAIs into account when providing Extended Home N3IWF identifier configuration andor Slice-specific N3IWF Prefix Configuration to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1815",
    "document_id": "23501-i80",
    "chunk_id": 1815,
    "text": "If a UE does not support the Extended Home N3IWF identifier configuration and the Slice-specific N3IWF Prefix Configuration then the HPLMN provides to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1816",
    "document_id": "23501-i80",
    "chunk_id": 1816,
    "text": "the Non-3GPP access node selection information and the N3IWF identifier configuration by taking into account the UEs subscribed S-NSSAIs NOTE 2 If the HPLMN deploys multiple N3IWFs with different TAs which support different S-NSSAIs then the HPLMN can configure a UE with N3IWF identifier configuration so that the UE selects an N3IWF that supports the UEs subscribed S-NSSAIs The UE can be configured by the VPLMN with the following information applicable for the V-PLMN Slice-specific N3IWF prefix configuration It contains one or multiple tuples consisting of - List of supported S-NSSAIs - Prefix for the Prefixed N3IWF OI or TA FQDNs To enable the V-PCF to provide the UE with Slice-specific N3IWF prefix configuration the AMF provides the V-PCF with the Configured NSSAI for the serving PLMN during the UE Policy Association EstablishmentModification procedure NOTE 3 In non-roaming cases the UE PCF already receives the subscribed NSSAI from the UDR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1817",
    "document_id": "23501-i80",
    "chunk_id": 1817,
    "text": "Therefore there is no need for the AMF to provide the Configured NSSAI to the PCF in the non-roaming case NOTE 4 PCF V-PCF in the roaming case is assumed to be locally configured with information about the slices supported by the different N3IWFs in the serving PLMN During the registration procedure the AMF may determine if the N3IWF selected by the UE is suitable for the S-NSSAIs requested by the UE considering the UE subscription If the AMF determines that a different N3IWF should be selected as described in clause 41222 of TS 23502 3 the AMF - may if the UE supports slice-based N3IWF selection triggers the UE Policy Association Establishment or UE Policy Association Update procedure to provide the UE with updated N3IWF selection information when the AMF is informed by the PCF that the update of UE policy information on the UE is completed as described in clause 412222 of TS 23502 3 the AMF releases UE Policy Association if the UE is not registered over 3GPP access before proceeding to the Registration Reject over untrusted non-3GPP access - shall send a Registration Reject message to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1818",
    "document_id": "23501-i80",
    "chunk_id": 1818,
    "text": "The AMF may include target N3IWF information FQDN andor IP address in the Registration Reject so that the UE can if supported by the UE use the target N3IWF information to select the N3IWF to register to 5GC if the UE wishes to send the same Requested NSSAI as during the previous Registration Request The target N3IWF information only applies to the one N3IWF selection performed by the UE just after receiving the Registration Reject The AMF may determine the N3IWF based on the list of supported TAs and the corresponding list of supported slices for each TA obtained as defined in clause 5158 NOTE 5 The operator is assumed to ensure that UEs that do not support slice-based N3IWF selection always select an N3IWF that supports at least one slice requested by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1819",
    "document_id": "23501-i80",
    "chunk_id": 1819,
    "text": "This is to avoid unnecessary and potentially repetitive rejections of those UEs To ensure this the operator is assumed to provide identifiers of N3IWFs that only support a subset of the slices configured in the network only to UEs that support slice-based N3IWF selection 6362 Stand-alone N3IWF selection The UE performs N3IWF selection based on the ePDG selection procedure as specified in clause 454 of TS 23402 43 except for the following differences - The TrackingLocation Area Identifier FQDN shall be constructed by the UE based only on the Tracking Area wherein the UE is located The N3IWF TrackingLocation Area Identifier FQDN may use the 5GS TAI when the UE is registered to the 5GS or the EPS TAI when the UE is registered to EPS The Location Area is not applicable on the 3GPP access - The ePDG Operator Identifier OI FQDN format is substituted by with N3IWF OI FQDN format as specified in TS 23003 19 - If the UE is configured with Slice-specific N3IWF prefix configuration then the UE shall construct the Prefixed N3IWF OI FQDN or the Prefixed N3IWF TA FQDN as specified in clauses 283228 and 283229 of TS 23003 19 instead of the N3IWF OI FQDN and the N3IWF TA FQDN respectively To determine the prefix the UE selects the Slice-specific N3IWF prefix configuration for the selected PLMN that contains S-NSSAIs that match all or most in case there is no full match of the S-NSSAIs that the UE is going to include in the Requested NSSAI in the subsequent Registration procedure - The ePDG identifier configuration is substituted by the N3IWF identifier configuration and the Extended Home N3IWF identifier configuration The Extended Home N3IWF identifier configuration takes precedence over the N3IWF identifier configuration If the UE is located in the home country and the UE is configured with Extended Home N3IWF identifier configuration then the UE uses the Extended Home N3IWF identifier configuration to select an N3IWF - The UE uses the FQDN or IP address from the Extended Home N3IWF identifier configuration that matches all or most if there is no full match of the S-NSSAIs that the UE is going to request in the subsequent Registration - The ePDG selection information is substituted by the Non-3GPP access node selection information and slice-specific N3IWF prefix information The UE shall give preference to the N3IWF in all PLMNs in the Non-3GPP access node selection information independent of the Preference parameter - If the UE determines to be located in a country other than its home country called the visited country then instead of clause 4544 bullet 3 of TS 23402 43",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1820",
    "document_id": "23501-i80",
    "chunk_id": 1820,
    "text": "the following applies a If the UE is registered via 3GPP access to a PLMN and this PLMN is included in the Non-3GPP access node selection information then the UE shall select an N3IWF in this PLMN If the UE fails to connect to an N3IWF in this PLMN the UE shall select an N3IWF by performing the DNS procedure specified in clause 4545 of TS 23402 43 b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1821",
    "document_id": "23501-i80",
    "chunk_id": 1821,
    "text": "In all other cases eg when the UE is not configured with the Non-3GPP access node selection information or the UE is registered via 3GPP access to a PLMN but this PLMN is not included in the Non-3GPP access node selection information or the UE is not registered via 3GPP access to any PLMN the UE shall select an N3IWF by performing the DNS procedure specified in clause 4545 of TS 23402 43 with the difference that the UE shall construct the Prefixed N3IWF OI FQDN if the UE is configured with Slice-specific N3IWF prefix configuration for the selected PLMN If the UE is accessing PLMN services via SNPN the UE uses the procedure defined in this clause to select an N3IWF deployed in the PLMN If the UE is accessing standalone non-public network service via a PLMN see supported cases in clause 53020 the UE uses the procedure defined in clause 6362a 6362a",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1822",
    "document_id": "23501-i80",
    "chunk_id": 1822,
    "text": "SNPN N3IWF selection This procedure applies when the UE is accessing the SNPN N3IWF in its subscribed SNPN via a PLMN or directly via untrusted non-3GPP access The UE shall first determine the country in which it is located If the UE cannot determine the country in which the UE is located the UE shall stop N3IWF selection and abort the attempt to access the SNPN via PLMN NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1823",
    "document_id": "23501-i80",
    "chunk_id": 1823,
    "text": "It is up to UE implementation how to determine the country in which the UE is located The UE is configured with one N3IWF address and the MCC of the country where the configured N3IWF is located as defined in TS 24502 48 If the UE determines that it is located in the country where the configured N3IWF is located then the UE uses the configured N3IWF FQDN to select an N3IWF deployed in the SNPN If the UE determines that it is located in a country called the visited country different from the country where the configured N3IWF is located then - The UE shall construct an FQDN consisting of the SNPN ID of the subscribed SNPN and the Visited Country FQDN and indicating the query is for SNPN as specified in TS 23003 19 and perform a DNS query for the resulting FQDN - If the DNS response contains no records then the UE determines that the visited country does not mandate the selection of an N3IWF in this country for the SNPN identified by the SNPN ID provided by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1824",
    "document_id": "23501-i80",
    "chunk_id": 1824,
    "text": "In this case the UE uses the configured N3IWF FQDN to select an N3IWF deployed in the SNPN - If no DNS response is received the UE shall stop the N3IWF selection NOTE 2 The DNS can be configured to return no records for the visited country regardless of the SNPN ID provided by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1825",
    "document_id": "23501-i80",
    "chunk_id": 1825,
    "text": "This addresses the scenario that the visited country in general does not mandate selection of a local N3IWF - If the DNS response contains one or more records then the UE determines that the visited country mandates the selection of an N3IWF in this country Each record in the DNS response shall contain the identity of an N3IWF of the UEs subscribed SNPN in the visited country which may be used for N3IWF selection In this case - The UE shall select an N3IWF included in the DNS response based on its own implementation means - If the UE cannot select any N3IWF included in the DNS response then the UE shall stop the N3IWF selection NOTE 3 Visited countries which mandate the selection of an N3IWF in the country are assumed to configure the DNS as follows i For SNPNs that do not have any dedicated N3IWFs in the country and which are not exempt from the requirement to select an N3IWF in the visited country the DNS response contains a record that cannot be resolved to an IP address ii for SNPNs that have dedicated N3IWFs in the country the DNS response contains the identities of the SNPNs N3IWFs in the visited country iii for SNPNs that are exempt from the requirement to select an N3IWF in the visited country the DNS response contains no records NOTE 4 Self-assigned NIDs are not supported since a DNS cannot be properly configured for multiple SNPNs using the same self-assigned NID ie in collision scenarios If the visited country mandates the selection of an N3IWF in the same country the NAPTR records associated to the Visited Country FQDN of SNPNs that use a self-assigned NID can be provisioned with the replacement field containing an FQDN that cannot be resolved to an IP address NOTE 5",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1826",
    "document_id": "23501-i80",
    "chunk_id": 1826,
    "text": "The identity of an SNPNs N3IWF in the visited country can be any FQDN ie is not required to include the SNPN ID NOTE 6 It is assumed that the AMF SMF UPF are located in the same country as the N3IWF and belong to the subscribed SNPN of the UE 6363 Combined N3IWFePDG Selection When the UE wants to select a non-3GPP access node either an N3IWF or an ePDG the UE shall perform the following procedure 1 The UE shall attempt to determine the country it is located in This is determined by implementation-specific methods not defined in this specification If the UE cannot determine the country it is located in the UE shall stop the non-3GPP access node selection 2 If the UE determines to be located in its home country then a The UE shall select the HPLMN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1827",
    "document_id": "23501-i80",
    "chunk_id": 1827,
    "text": "If the UE fails to connect to an ePDGN3IWF in the HPLMN then the UE shall stop the non-3GPP access node selection 3 If the UE determines to be located in a country other than its home country called the visited country then a If the UE is registered via 3GPP access to a PLMN and this PLMN is included in the Non-3GPP access node selection information then the UE shall select this PLMN If the UE fails to connect to an ePDGN3IWF in this PLMN the UE shall select another PLMN by performing the DNS procedure specified in bullet 3c below b In all other cases eg when the UE is not configured with the Non-3GPP access node selection information or the UE is registered via 3GPP access to a PLMN but this PLMN is not included in the Non-3GPP access node selection information or the UE is not registered via 3GPP access to any PLMN the UE shall select a PLMN by performing the DNS procedure specified in bullet 3c below c The UE shall select a PLMN as follows i",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1828",
    "document_id": "23501-i80",
    "chunk_id": 1828,
    "text": "The UE shall determine if the non-3GPP access node selection is required for an IMS service or for a non-IMS service The means of that determination are implementation specific ii If the UE determines that the non-3GPP access node selection is required for a non-IMS service the UE shall select a PLMN as specified in clause 6362 As defined below if the UE fails to connect to an N3IWF in any PLMN the UE may attempt to select an ePDG according to the procedure specified in clause 4545 of TS 23402 43 iii",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1829",
    "document_id": "23501-i80",
    "chunk_id": 1829,
    "text": "If the UE determines that the non-3GPP access node selection is required for an IMS service the UE shall select a PLMN as follows - First the UE shall perform a DNS query using the Visited Country FQDN for N3IWF as specified in TS 23003 19 to determine if the visited country mandates the selection of N3IWF in this country The DNS response received by the UE may be empty or may contain the identities of one or more PLMNs in the visited country which may be used for N3IWF selection if the UE decides to select an N3IWF as specified below For example the DNS response may contain the identity of PLMN-1 and the identity of PLMN-2 - Then the UE shall perform a DNS query using the Visited Country FQDN for ePDG as specified in TS 23003 19 to determine if the visited country mandates the selection of ePDG in this country The DNS response received by the UE may be empty or may contain the identities of one or more PLMNs in the visited country which may be used for ePDG selection if the UE decides to select an ePDG as specified below For example the DNS response may contain the identity of PLMN-1 and the identity of PLMN-3 - If the UE does not receive a DNS response in none of the above two DNS queries then the UE shall stop the non-3GPP access node selection",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1830",
    "document_id": "23501-i80",
    "chunk_id": 1830,
    "text": "Otherwise the next steps are executed - The UE shall consolidate the PLMN identities received in the above two DNS responses and shall construct a candidate list of PLMNs For example the candidate list of PLMNs may contain the identities of PLMN-1 PLMN-2 PLMN-3 - If the candidate list of PLMNs is empty then - If the Non-3GPP access node selection information contains one or more PLMNs in the visited country the UE shall select one of these PLMNs based on their priorities in the Non-3GPP access node selection information If the UE fails to connect to a non-3GPP access node in any of these PLMNs the UE shall select the HPLMN - Otherwise the UE shall select the HPLMN - If the candidate list of PLMNs is not empty then - If the UE is registered via 3GPP access to a PLMN which is included in the candidate list of PLMNs then the UE shall select this PLMN If the UE fails to connect to a non-3GPP access node in this PLMN then the UE shall select a different PLMN included in the candidate list of PLMNs as specified in the next bullet - If the UE is registered via 3GPP access to a PLMN which is not included in the candidate list of PLMNs or the UE is not registered via 3GPP access to any PLMN or the UE fails to connect to a non-3GPP access node according to the previous bullet then the UE shall select one of the PLMNs included in the candidate list of PLMNs based on the prioritized list of PLMNs in the Non-3GPP access node selection information ie the UE shall select first the highest priority PLMN in the Non-3GPP access node selection information that is contained in the candidate list of PLMNs If the Non-3GPP access node selection information does not contain any of the PLMNs in the candidate list of PLMNs or the UE is not configured with the Non-3GPP access node selection information or the UE was not able to connect to a non-3GPP access node in any of the PLMNs included in the Non-3GPP access node selection information and in the candidate list of PLMN then the UE shall select a PLMN included in the candidate list of PLMNs based on its own implementation means - If the UE cannot select a non-3GPP access node in any of the PLMNs included in the candidate list of PLMNs then the UE shall stop the non-3GPP access node selection In the selected PLMN the UE shall attempt to select a non-3GPP access node as follows 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1831",
    "document_id": "23501-i80",
    "chunk_id": 1831,
    "text": "The UE shall determine if the non-3GPP access node selection is required for an IMS service or for a non-IMS service The means of that determination are implementation-specific 2 When the selection is required for an IMS service the UE shall choose a non-3GPP access node type ie ePDG or N3IWF based on the Preference parameter specified in clause 6361 unless the UE has its 5GS capability disabled in which case it shall choose an ePDG independent of the Preference parameter setting If the Preference parameter for the selected PLMN indicates that ePDG is preferred the UE shall attempt to select an ePDG If the Preference parameter for the selected PLMN indicates that N3IWF is preferred the UE shall attempt to select an N3IWF If the selection fails including the case when during the registration performed over either 3GPP or non-3GPP access the UE receives the IMS Voice over PS session Not Supported over Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1832",
    "document_id": "23501-i80",
    "chunk_id": 1832,
    "text": "Access indication specified in clause 51632a the UE shall attempt selecting the other non-3GPP access node type in the selected PLMN if any If that selection fails too or it is not possible then the UE shall select another PLMN according to the procedure specified bullet 3c above 3 When the selection is required for a non-IMS service the UE shall perform the selection by giving preference to the N3IWF independent of the Preference parameter setting If the N3IWF selection fails or it is not possible the UE should select another PLMN based on the procedure specified in clause 4544 of TS 23402 43 and shall attempt to select an N3IWF in this PLMN If the UE fails to select an N3IWF in any PLMN the UE may attempt to select an ePDG according to the procedure specified in clause 4545 of TS 23402 43",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1833",
    "document_id": "23501-i80",
    "chunk_id": 1833,
    "text": "In the above procedure when the UE attempts to construct a TrackingLocation Area Identifier FQDN either for ePDG selection or for N3IWF selection the UE shall use the Tracking Area wherein the UE is located and shall construct either - an ePDG or N3IWF TAI FQDN based on the 5GS TAI when the UE is registered to the 5GS or - an ePDG or N3IWF TAI FQDN based on the EPS TAI when the UE is registered to EPS NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1834",
    "document_id": "23501-i80",
    "chunk_id": 1834,
    "text": "A UE performing both a selection for an IMS service and a selection for a non-IMS service could get simultaneously attached to a N3IWF and to an ePDG in the same PLMN or in different PLMNs If the UE is configured with Slice-specific N3IWF prefix configuration then the UE shall construct the Prefixed N3IWF OI FQDN or the Prefixed N3IWF TA FQDN as specified in TS 23003 19 instead of the N3IWF OI FQDN and the N3IWF TA FQDN respectively Further details on constructing the Prefixed N3IWF OI and TA FQDN are described in clause 6362 6364 PLMN and non-3GPP access node Selection for emergency services 63641 General UE initiates PLMN and non-3GPP access node selection for emergency services when it detects a user request for emergency session and determines that untrusted non-3GPP access shall be used for the emergency access When the UE supports connectivity with N3IWF but does not support connectivity with ePDG as specified in TS 23402 43",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1835",
    "document_id": "23501-i80",
    "chunk_id": 1835,
    "text": "the UE shall perform the procedure in clause 63642 for selecting an N3IWF When the UE supports connectivity with N3IWF as well as with ePDG as specified in TS 23402 43 the UE shall perform the procedure in clause 63643 for selecting either an N3IWF or an ePDG ie for selecting a non-3GPP access node 63642 Stand-alone N3IWF selection If the UE is attached to 5GC via an N3IWF that is located in the same country as the country in which the UE is currently located and the AMF has previously indicated support for emergency services over non-3GPP access as defined in clause 51641 the UE reuses the existing N3IWF connection for emergency services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1836",
    "document_id": "23501-i80",
    "chunk_id": 1836,
    "text": "Otherwise the UE terminates any existing N3IWF connection and continues as follows If the UE is equipped with a UICC - The UE determines whether it is located in the home country or a visited country - If the UE is located in the home country then the UE selects the Home PLMN for emergency services and selects an N3IWF based on the procedure defined in clause 6362 - If the UE is located in a visited country the UE performs a DNS query using the Visited Country Emergency N3IWF FQDN as specified in TS 23003 19 to determine which PLMNs in the visited country support emergency services in non-3GPP access via N3IWF and - If the DNS response contains one or more records the UE selects a PLMN that supports emergency services in non-3GPP access via N3IWF Each record in the DNS response shall contain the identity of a PLMN in the visited country supporting emergency services in non-3GPP access via N3IWF - The UE shall consider these PLMNs based on their priorities in the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1837",
    "document_id": "23501-i80",
    "chunk_id": 1837,
    "text": "Access Node Selection Information if available If the UE cannot select a PLMN in the Non-3GPP Access Node Selection Information or if non-3GPP Access Node Selection Information is not available the UE shall attempt to select any PLMN in the list of PLMNs returned in the DNS response - Once the UE has selected a PLMN the UE shall select an N3IWF for the selected PLMN as follows - If non-3GPP Access Node Selection Information is available for the selected PLMN the UE constructs the Tracking Area Identity based N3IWF FQDN or the Operator Identifier based N3IWF FQDN as indicated in the non-3GPP Access Node Selection Information for the selected PLMN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1838",
    "document_id": "23501-i80",
    "chunk_id": 1838,
    "text": "If non-3GPP Access Node Selection Information is not available for the selected PLMN the UE constructs the Operator Identifier based N3IWF FQDN for the selected PLMN - If the DNS response does not contain any record or if the DNS response contains one or more records but the UE fails to select a PLMN that supports emergency services in non-3GPP access or if the Emergency Registration procedure has failed for all PLMNs supporting emergency services in non-3GPP access the UE notifies the user that an emergency session cannot be established If the UE is not equipped with a UICC the UE shall perform the emergency N3IWF selection procedure above as if always in a visited country and without using the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1839",
    "document_id": "23501-i80",
    "chunk_id": 1839,
    "text": "Access Node Selection Information ie the UE may construct the Operator Identifier based N3IWF FQDN format based on a PLMN ID obtained via implementation specific means When an N3IWF has been selected the UE initiates an Emergency Registration If the Emergency Registration fails the UE shall select another PLMN supporting emergency services in non-3GPP access 63633 Combined N3IWFePDG Selection",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1840",
    "document_id": "23501-i80",
    "chunk_id": 1840,
    "text": "If the UE is attached to 5GC via an N3IWF that is located in the same country as the country in which the UE is currently located and the AMF has previously indicated support for emergency services over non-3GPP access as defined in clause 51641 the UE reuses the existing N3IWF connection for emergency services Otherwise the UE terminates any existing N3IWF connection and performs PLMN and N3IWF or ePDG selection for emergency services If the UE is attached to EPC via an ePDG that has indicated support for the emergency services and is located in the same country as the country in which the UE is currently located the UE reuses the existing ePDG connection for emergency services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1841",
    "document_id": "23501-i80",
    "chunk_id": 1841,
    "text": "Otherwise the UE terminates the existing ePDG connection if any and performs PLMN and N3IWF or ePDG selection for emergency services PLMN and N3IWF or ePDG selection for emergency services is performed as follows If the UE is equipped with a UICC - The UE determines whether it is located in the home country or a visited country - If the UE is located in the home country the UE selects the Home PLMN for emergency services and selects an N3IWF or ePDG as follows - If the Non-3GPP Access Node Selection Information for the HPLMN is available the UE selects first an N3IWF or ePDG based on the Non-3GPP Access Node type preference in the Non-3GPP Access Node Selection Information for the HPLMN To select an N3IWF the UE uses the N3IWF identifier configuration if available If the N3IWF identifier configuration is not available the UE constructs the FQDN format as indicated by the FQDN format in the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1842",
    "document_id": "23501-i80",
    "chunk_id": 1842,
    "text": "Access Node Selection Information for the HPLMN To select an ePDG the UE selects the ePDG identified by the configured Emergency ePDG FQDN if available If the configured Emergency ePDG FQDN is not available the UE constructs either the TrackingLocation Area Identity based Emergency ePDG FQDN or the Operator Identifier based Emergency ePDG FQDN as indicated by the FQDN format in the Non-3GPP Access Node Selection Information for the HPLMN - If the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1843",
    "document_id": "23501-i80",
    "chunk_id": 1843,
    "text": "Access Node Selection Information is not available the UE shall first attempt to select an N3IWF following the procedure defined in clause 6362 before attempting to select an ePDG To select an ePDG the UE selects the ePDG identified by the configured Emergency ePDG FQDN if available If the configured Emergency ePDG FQDN is not available the UE constructs the Operator Identifier based Emergency ePDG FQDN - If the UE is located in a visited country the UE performs a DNS query using the Visited Country Emergency FQDN for N3IWF and using the Visited Country Emergency FQDN for ePDG as specified in TS 23003 19 to determine which PLMNs in the visited country support emergency services in non-3GPP access - If the DNS responses contain one or more records the UE selects a PLMN that supports emergency services in non-3GPP access for the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1844",
    "document_id": "23501-i80",
    "chunk_id": 1844,
    "text": "Each record in the DNS responses shall contain the identity of a PLMN in the visited country supporting emergency services in non-3GPP access via ePDG or N3IWF - The UE shall consider these PLMNs based on their priorities in the Non-3GPP Access Node Selection Information If the UE cannot select a PLMN in the Non-3GPP Access Node Selection Information or if non-3GPP Access Node Selection Information is not available the UE shall attempt to select any PLMN in the list of PLMNs returned in the DNS response - Once the UE has selected a PLMN the UE shall select an N3IWF or ePDG for the selected PLMN as follows - If the Non-3GPP Access Node Selection Information for the PLMN is available the UE selects first an N3IWF or ePDG based on the Non-3GPP Access Node type preference in the Non-3GPP Access Node Selection Information for the PLMN To select an N3IWF the UE constructs the FQDN format as indicated by the FQDN format in the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1845",
    "document_id": "23501-i80",
    "chunk_id": 1845,
    "text": "Access Node Selection Information for the PLMN To select an ePDG the UE constructs either the TrackingLocation Area Identity based Emergency ePDG FQDN or the Operator Identifier based Emergency ePDG FQDN as indicated by the FQDN format in the Non-3GPP Access Node Selection Information for the PLMN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1846",
    "document_id": "23501-i80",
    "chunk_id": 1846,
    "text": "If the Non-3GPP Access Node Selection Information is not available the UE shall first attempt to select an N3IWF following the procedure defined in clause 6362 before attempting to select an ePDG To select an ePDG the UE constructs the Operator Identifier based Emergency ePDG FQDN - If the DNS response does not contain any record or if the DNS response contains one or more records but the UE fails to select a PLMN that supports emergency services in non-3GPP access or if the Emergency Registration procedure has failed for all PLMNs supporting emergency services in non-3GPP access the UE notifies the user that emergency session cannot be established If the UE is not equipped with a UICC the UE shall perform the emergency ePDGN3IWF selection procedure above as if always in a visited country and without using the Non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1847",
    "document_id": "23501-i80",
    "chunk_id": 1847,
    "text": "Access Node Selection Information ie the UE may construct the Operator Identifier FQDN for N3IWF or ePDG based on a PLMN ID obtained via implementation specific means When a N3IWF has been selected the UE initiates an Emergency Registration If the Emergency Registration fails the UE shall attempt to select an ePDG before selecting another PLMN supporting emergency services in non-3GPP access When an ePDG has been selected the UE initiates an Emergency Registration If the Emergency Registration fails the UE shall attempt to select a N3IWF before selecting another PLMN supporting emergency services in non-3GPP access 637 PCF discovery and selection 6370 General principles Clause 6370 describes the underlying principles for PCF selection and discovery - There may be multiple and separately addressable PCFs in a PLMN - The PCF must be able to correlate the AF service session established over N5 or Rx with the associated PDU Session Session binding handled over N7 - It shall be possible to deploy a network so that the PCF may serve only specific DNs For example Policy Control may be enabled on a per DNN basis - Unique identification of a PDU Session in the PCF shall be possible based on the UE ID DNN-tuple the UE IP or MAC Addresses DNN-tuple and the UE ID UE IP or MAC Addresses DNN 6371 PCF discovery and selection for a UE or a PDU Session PCF discovery and selection functionality is implemented in AMF SMF SCP and PCF for the PDU Session and follows the principles in clause 631 When the NF service consumer performs PCF discovery and selection for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1848",
    "document_id": "23501-i80",
    "chunk_id": 1848,
    "text": "the following applies - The AMF may utilize the NRF to discover the candidate PCF instances for a UE In addition PCF information may also be locally configured in the AMF The AMF selects a PCF instance based on the available PCF instances obtained from the NRF or locally configured information in the AMF depending on operators policies In the non roaming case the AMF selects a PCF instance for AM Policy Association and selects the same PCF instance for UE Policy Association In the roaming case the AMF selects a V-PCF instance for AM Policy Association and selects the same V-PCF instance for UE Policy Association The PCF for the PDU Session selects a V-PCF instance for UE Policy Association",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1849",
    "document_id": "23501-i80",
    "chunk_id": 1849,
    "text": "The following factors may be considered at PCF discovery and selection for Access and Mobility policies and UE policies - SUPI the AMF selects a PCF instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI as input for PCF discovery - S-NSSAIs In the roaming case the AMF selects the V-PCF instance based on the S-NSSAIs of the VPLMN and selects the H-PCF instance based on the S-NSSAIs of the HPLMN - PCF Set ID - PCF Group ID of the UEs SUPI NOTE 1 The AMF can infer the PCF Group ID the UEs SUPI belongs to based on the results of PCF discovery procedures with NRF The AMF provides the PCF Group ID the SUPI belongs to to other PCF NF consumers as described in TS 23502 3 - DNN replacement capability of the PCF - Slice replacement capability of the PCF - PCF Selection Assistance Info and PCF IDs serving the established PDU SessionsPDN Connections received from UDM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1850",
    "document_id": "23501-i80",
    "chunk_id": 1850,
    "text": "In case PCF Selection Assistance Info and PCF IDs are received from the UDM the AMF selects the same PCF instance serving the combination of DNN and S-NSSAI as indicated by the PCF Selection Assistance Info if multiple DNN S-NSSAI combinations are provided the AMF selects the DNNS-NSSAI using local configuration In case PCF IDs are not received eg EPS interworking is not supported the AMF selects the PCF instance by considering other above factors - URSP delivery in EPS capability of the PCF When the NF service consumer performs PCF discovery and selection for a PDU Session the following applies - The SMF may utilize the NRF to discover the candidate PCF instances for a PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1851",
    "document_id": "23501-i80",
    "chunk_id": 1851,
    "text": "In addition PCF information may also be locally configured in the SMF The SMF selects a PCF instance based on the available PCF instances obtained from the NRF or locally configured information in the SMF depending on operators policies The following factors may be considered at PCF discovery and selection for a PDU Session a Local operator policies b Selected Data Network Name DNN c S-NSSAI of the PDU Session In the LBO roaming case the SMF selects the PCF instance based on the S-NSSAI of the VPLMN In the home routed roaming case the H-SMF selects the H-PCF instance based on the S-NSSAI of the HPLMN d SUPI the SMF selects a PCF instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI as input for PCF discovery e PCF selected by the AMF for the UE f MA PDU Session capability of the PCF for an MA PDU Session g The PCF Group ID provided by the AMF to the SMF h PCF Set ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1852",
    "document_id": "23501-i80",
    "chunk_id": 1852,
    "text": "i Same PCF Selection Indication j URSP delivery in EPS capability of the PCF In the case of delegated discovery and selection in SCP the SMF includes the factors b - h j if available in the first request The selected PCF instance for serving the UE and the selected PCF instance for serving a PDU Session of this UE may be the same or may be different In the following scenarios information about the PCF instance that has been selected ie the PCF ID PCF Set Id and if PCF Set Id is not available the PCF Group ID",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1853",
    "document_id": "23501-i80",
    "chunk_id": 1853,
    "text": "if available may be forwarded to another NF If the NF service consumer performs discovery and selection this NF may use this PCF instance If the NF service consumer performs delegated discovery and selection this NF may include PCF ID PCF Set Id and if PCF Set Id is not available the PCF Group ID if available in the request and the SCP may use this information to select the PCF instance discovery may still be needed depending on what level of information is sent by the AMF eg the endpoint address of the PCF instance may not be present When NF service consumer performs PCF discovery and selection the following applies -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1854",
    "document_id": "23501-i80",
    "chunk_id": 1854,
    "text": "During AMF relocation the target AMF may receive a PCF ID PCF Set Id and if PCF Set Id is not available the PCF Group ID if available from the source AMF to enable the usage of the same PCF by the target AMF and the target AMF may decide based on operator policy either to use the same PCF or select a new PCF - The AMF may based on operator policies forward the selected PCF to SMF instances during the PDU Session Establishment procedures to enable the usage of the same PCF for the AMF and the SMF instances The SMF may decide based on operator policy either to use the same PCF or select a new PCF If combination of the DNN and S-NSSAI of the PDU Session matches one of the combination of the DNN and S-NSSAI included in the PCF Selection Assistance info received from UDM the AMF shall forward Same PCF Selection Indication together with the selected PCF to SMF instance during the PDU Session Establishment procedure",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1855",
    "document_id": "23501-i80",
    "chunk_id": 1855,
    "text": "In case that the Same PCF Selection Indication is received together with the PCF ID the SMF shall select the same PCF instance for SM Policy Control - In the roaming case the AMF may based on operator policies eg roaming agreement select the H-PCF in addition to the V-PCF for a UE by performing the PCF discovery and selection as described above The AMF may send the ID andor endpoint address eg URI of the selected H-PCF instance to the V-PCF during the UE Policy Association establishment procedure When the SMF receives a redirection indication with PCF ID from the PCF for the PDU Session the SMF shall terminate the current SM Policy Association and reselects a PCF based on the received PCF ID The SMF shall then establish an SM Policy Association with the reselected PCF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1856",
    "document_id": "23501-i80",
    "chunk_id": 1856,
    "text": "In the case of delegated discovery and selection in the SCP the following applies - The selected PCF instance may include the PCF Id PCF Set Id and if PCF Set Id is not available the PCF Group ID if available in the response to the AMF NOTE 2 The selected V-PCF instance can include the binding indication including the V-PCF ID and possibly PCF Set ID in the response to the AMF as described in clause 6310 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1857",
    "document_id": "23501-i80",
    "chunk_id": 1857,
    "text": "The AMF first establishes an AM Policy Association when forwarding the related request message the SCP discovers and selects a PCF instance Unless binding information is provided in the response to that request the SCP adds the NF function producer ID it selected ie PCF ID into the response and the AMF uses the received PCF ID and available binding information as discovery and selection parameters for the request to establish the UE Policy Association towards the SCP The SCP selects the V-PCF instance for UE Policy Association based on the received discovery and selection parameters -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1858",
    "document_id": "23501-i80",
    "chunk_id": 1858,
    "text": "During AMF relocation the AMF may receive a PCF ID PCF Set Id and if PCF Set Id is not available the PCF Group ID if available from the source AMF to enable the usage of the same PCF instance by the AMF The AMF may decide based on operator policy either to use the old PCF instance or select another PCF instance If the AMF decides to use the old PCF the AMF includes the PCF ID PCF Set Id and if PCF Set Id is not available the PCF Group ID if available as received from the source AMF in the AM Policy Association update request to the SCP - The AMF may based on operator policies forward the selected PCF ID PCF Set Id and if PCF Set Id is not available the PCF Group ID if available to the SMF during the PDU Session Establishment procedure to enable the usage of the same PCF for the AMF and the SMF The SMF may include that information in the request in discovery and selection parameters to the SCP The SCP may decide based on operator policy either to use the indicated PCF instance or select another PCF instance -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1859",
    "document_id": "23501-i80",
    "chunk_id": 1859,
    "text": "In the roaming case the AMF performs discovery and selection of the H-PCF from NRF as described in this clause The AMF may indicate the maximum number of H-PCF instances to be returned from NRF ie H-PCF selection at NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1860",
    "document_id": "23501-i80",
    "chunk_id": 1860,
    "text": "The AMF uses the received V-PCF ID and endpoint address eg URI and available binding information received during the AM Policy Association procedure to send the UE Policy Association establishment request which may also include the H-PCF ID andor endpoint address eg URI to the SCP The SCP discovers and selects the V-PCF The V-PCF sends an UE Policy Association establishment request towards the HPLMN which may include the H-PCF ID andor endpoint address eg URI as a discovery and selection parameter to SCP 6372 Providing policy requirements that apply to multiple UE and hence to multiple PCF An authorized Application Function may via the NEF provide policy requirements that apply to multiple UEs which for example belong to group of UEs defined by subscription or to any UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1861",
    "document_id": "23501-i80",
    "chunk_id": 1861,
    "text": "Such policy requirements shall apply to any existing or future PDU Sessions that match the parameters in the AF request and they may apply to multiple PCF instances NOTE Application Function influence on traffic routing described in clause 567 is an example of such requirement After relevant validation of the AF request and possible parameter mapping the NEF stores this request received from the AF into the selected UDR instance as the Data Subset of the Application data The possible parameter mapping includes mapping UE group identifiers provided by the AF to identifiers used within the 5GC eg from GPSI to SUPI andor from External Group Identifier to Internal-Group Identifier Parameter mapping may also include mapping from the identifier of the Application Function towards internal identifiers such as the DNN andor the S-NSSAI PCFs that need to receive AF requests that targets a DNN and slice andor a group of UEs subscribe to receive notifications from the UDR about such AF request information The PCFs can be configured eg by OAM to subscribe to receive notification of such AF request information from the UDRs The PCFs takes the received AF request information into account when making policy decisions for existing and future relevant PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1862",
    "document_id": "23501-i80",
    "chunk_id": 1862,
    "text": "In the case of existing PDU Sessions the policy decision of the PCF instances may trigger a PCC rules change from the PCF to the SMF The PCF subscription to notifications of AF requests described above may take place during PDU Session Establishment or PDU Session Modification when the PCFs receive requests from the SMF for policy information related to the DNN and slice andor the Internal-Group Identifier of UEs For the PCFs that have subscribed to such notifications the UDRs notify the PCFs of any AF request update The NEF associates the AF request with information allowing to later modify or delete the AF request in the UDR it associates the AF request with - When the AF request targets PDU Sessions established by any UE the DNN the slicing information target of the AF request - When the request targets PDU Sessions established by UEs belonging to an Internal-Group the DNN the slicing information and the Internal-Group Identifier target of the application request - The AF transaction identifier in the AF request 6373 Binding an AF request targeting a UE address to the relevant PCF Binding an AF request targeting a UE address to the relevant PCF instance is described in clause 6112 of TS 23503 45 6374 Binding an AF request targeting a UE to the relevant PCF Binding an AF request targeting a UE to the relevant PCF is described in clause 6112a of TS 23503 45 638 UDM discovery and selection The NF consumer or the SCP performs UDM discovery to discover a UDM instance that manages the user subscriptions If the NF consumer performs discovery and selection the NF consumers shall utilize the NRF to discover the UDM instances unless UDM information is available by other means eg locally configured on NF consumers The UDM selection function in NF consumers selects a UDM instance based on the available UDM instances obtained from the NRF or locally configured The UDM selection functionality is applicable to both 3GPP access and non-3GPP access The UDM selection functionality in NF consumer or in SCP should consider one of the following factors 1 Home Network Identifier eg MNC and MCC realm of SUCISUPI along with the selected NID provided by the NG-RAN in the case of SNPN UEs Routing Indicator and optionally Home Network Public Key identifier eg in the case that Routing Indicator is not enough to provide SUPI range granularity NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1863",
    "document_id": "23501-i80",
    "chunk_id": 1863,
    "text": "The UE provides the SUCI to the AMF which contains the Routing Indicator and Home Network Public Key identifier as defined in TS 23003 19 during initial registration The AMF provides the UEs Routing Indicator and optionally Home Network Public Key identifier to other NF consumers of UDM as described in TS 23502 3 NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1864",
    "document_id": "23501-i80",
    "chunk_id": 1864,
    "text": "The usage of Home Network Public Key identifier for UDM discovery is limited to the scenario where the NF consumers belong to the same PLMN as AUSF NOTE 3 In the case of SNPN and the UE provides an IMSI type SUCI to the AMF and the SUCI provided by UE or the SUPI derived from the SUCI is for an SNPN served by the AMF the AMF uses the selected NID provided by the NG-RAN together with the selected PLMN ID from IMSI or the Routing Indicator provided by the UE within the SUCI for UDM selection In the case of SNPN and the UE provides an NSI type SUCI to the AMF the AMF uses the Home Network Identifier and Routing Indicator of SUCISUPI for selection of UDM When the UEs Routing Indicator is set to its default value as defined in TS 23003 19 the UDM NF consumer can select any UDM instance within the home network of the SUCISUPI 2 UDM Group ID of the UEs SUPI NOTE 4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1865",
    "document_id": "23501-i80",
    "chunk_id": 1865,
    "text": "The AMF can infer the UDM Group ID the UEs SUPI belongs to based on the results of UDM discovery procedures with NRF The AMF provides the UDM Group ID the SUPI belongs to other UDM NF consumers as described in TS 23502 3 3 SUPI or Internal Group ID the UDM NF consumer selects a UDM instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI or Internal Group ID as input for UDM discovery 4 GPSI or External Group ID UDM NF consumers which manage network signalling not based on SUPISUCI eg the NEF select a UDM instance based on the GPSI or External Group ID range the UEs GPSI or External Group ID belongs to or based on the results of a discovery procedure with NRF using the UEs GPSI or External Group ID as input for UDM discovery In the case of delegated discovery and selection in SCP NF consumer shall include one of these factors in the request towards SCP 639 UDR discovery and selection Multiple instances of UDR may be deployed each one storing specific data or providing service to a specific set of NF consumers as described in clause 425",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1866",
    "document_id": "23501-i80",
    "chunk_id": 1866,
    "text": "In segmented UDR deployment different instances of UDR store the data for different Data Sets and Data Subsets or for different users",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1867",
    "document_id": "23501-i80",
    "chunk_id": 1867,
    "text": "A UDR instance can also store application data that applies on any UE ie all subscribers of the PLMN If the NF service consumer performs discovery and selection the NF consumer shall utilize the NRF to discover the appropriate UDR instances unless UDR instance information is available by other means eg locally configured on NF consumer The UDR selection function in NF consumers is applicable to both 3GPP access and non-3GPP access The NF consumer or the SCP shall select a UDR instance that contains relevant information for the NF consumer eg UDMSCP selects a UDR instance that contains subscription data while NEFSCP when used to access data for exposure selects a UDR that contains data for exposure or PCFSCP selects a UDR that contains Policy Data andor Application Data For the resolution of the NF Group ID corresponding to a subscriber identifier the UDR NF consumer eg NRF SCP shall select a UDR instance that supports the Nudr_GroupIDMap service For data management procedures the UDR selection function in UDR NF consumers considers the Data Set Identifier of the data to be managed in UDR see UDR service definition in clause 5212 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1868",
    "document_id": "23501-i80",
    "chunk_id": 1868,
    "text": "Additionally the UDR selection function in UDR NF consumers should consider one of the following factors when available to the UDR NF consumer when selecting a UDR that stores the required Data Sets and Data Subsets 1 UDR Group ID the UEs SUPI belongs to 2 SUPI eg the UDR NF consumer selects a UDR instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI as input for UDR discovery 3 GPSI or External Group ID eg UDR NF consumers select a UDR instance based on the GPSI or External Group ID range the UEs GPSI or External Group ID belongs to or based on the results of a discovery procedure with NRF using the UEs GPSI or External Group ID as input for UDR discovery 4 UDR capability to store application data that is applicable on any UE ie all subscribers of the PLMN In the case of delegated discovery and selection the NF consumer shall include the available factors in the request towards SCP 6310 SMSF discovery and selection The SMSF selection function is supported by the AMF and is used to allocate an SMSF instance that shall manage the SMS If the SMS supported indication is included in the Registration Request by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1869",
    "document_id": "23501-i80",
    "chunk_id": 1869,
    "text": "the AMF checks SMS subscription from the UDM for the UE on whether the SMS is allowed for the UE If the SMS is allowed and the UE Context stored in AMF includes an SMSF address the AMF uses the SMSF address included in UE Context according to Table 52222-1 of TS 23502 3 If the SMS is allowed and the UE Context stored in AMF does not include an SMSF address the AMF discovers and selects an SMSF to serve the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1870",
    "document_id": "23501-i80",
    "chunk_id": 1870,
    "text": "The SMSF selection may be based on the following methods - SMSF instances addresses preconfigured in the AMF ie SMSF FQDN or IP addresses or - SMSF information available in the serving PLMN if received from an old AMF or the UDM or - The AMF invokes Nnrf_NFDiscovery service operation from NRF to discover SMSF instance as described in clause 52732 of TS 23502 3 For roaming scenario the AMF discovers and selects an SMSF in VPLMN If the NF consumer performs discovery and selection via NRF the SMSF selection function in the NF consumer selects a SMSF instance based on the available SMSF instances obtained from the NRF In the case of delegated discovery and selection in SCP the NF consumer shall include all available factors in the request towards SCP 6311 CHF discovery and selection The CHF discovery and selection function is supported by the SMF the AMF the SMSF and the PCF It is used by the SMF to select a CHF that manages the online charging or offline charging for a PDU Session of a subscriber It is used by the AMF to select a CHF that manages the online charging or offline charging for 5G connection and mobility of a subscriber It is used by the SMSF to select a CHF that manages the online charging or offline charging for the SMS over NAS transactions of a subscriber It is used by the PCF to select a CHF that manages the spending limits for a subscriber andor a PDU Session of a subscriber For the PCF to select the CHF the addresses of the CHF including the Primary CHF address and the Secondary CHF address may be - stored in the UDR as part of the PDU Session policy control subscription information as defined in clause 6213 of TS 23503 45 - stored in the UDR as part of the UE context policy control subscription information as defined in clause 6213 of TS 23503 45 - stored in the UDR as part of the Access and Mobility policy control subscription information as defined in clause 6213 of TS 23503 45 - locally configured in the PCF based on operator policies - discovered using NRF as described in in clause 61 of",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1871",
    "document_id": "23501-i80",
    "chunk_id": 1871,
    "text": "TS 32290 67 NOTE 1 The operator can perform the above UDR provisioning or local configuration in a consistent manner such that the same CHF address is used for SM policy AM policy and UE policy If NRF discovery is used it is up to the PCF logic or SCP logic when working in Delegated Discovery mode and operator configuration to guarantee the CHF address consistency The addresses of the CHF shall be applicable for all services provided by the CHF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1872",
    "document_id": "23501-i80",
    "chunk_id": 1872,
    "text": "The CHF addresses that a stored in the UDR or configured in the PCF may be complemented by the associated CHF instance IDs and CHF set IDs see clause 6310 stored or configured in the same location The CHF addresses retrieved from the UDR and possible associated CHF instance IDs and CHF set IDs take precendence over the locally configured CHF addresses and possible associated CHF instance IDs and CHF set IDs and over the CHF addresses discoverred by the NRF If no CHF addresses is received from the UDR the PCF selects based on operator policies either the CHF addressees provided by NRF or the locally configured CHF addresses and possible associated CHF instance IDs and CHF set IDs If the PCF has a CHF set ID but no CHF instance ID associated to the CHF addresses in the same location the CHF instance within the CHF set may change If the PCF is not able to reach the CHF addresses it should query the NRF for other CHF instances within the CHF set If the PCF received a CHF set ID and a CHF instance ID associated to the CHF addresses in the same location the CHF service instance within the CHF may change If an PCF is not able to reach the CHF addresses it should query the NRF for other CHF service instances within the CHF To enable the SMF to select the same CHF that is selected by the PCF for the PDU Session the PCF provides the selected CHF addresses and if available the associated CHF instance IDs andor CHF set IDs in the PDU Session related policy information to the SMF as described in Table 64-1 of TS 23503 45 and the SMF applies the CHF address and if available the associated CHF instance IDs andor CHF set IDs passed from the PCF as defined in clause 518 of TS 32255 68",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1873",
    "document_id": "23501-i80",
    "chunk_id": 1873,
    "text": "Otherwise the SMF selection of the CHF as defined in clause 518 of TS 32255 68 applies If operator policies indicates the AMF should select the same CHF that is selected by the PCF for the UE the PCF provides the selected CHF addresses and if available the associated CHF instance IDs andor CHF set IDs in the Access and mobility related policy information andor in the UE Policy Association supplementary information to the AMF as described in Table 65-1 and Table 667-1 of TS 23503 45 respectively and the AMF may apply the CHF address and if available the associated CHF instance IDs andor CHF set IDs passed from the PCF as defined in clause 513 of TS 32256 114",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1874",
    "document_id": "23501-i80",
    "chunk_id": 1874,
    "text": "Otherwise the AMF selection of the CHF as defined in clause 513 of TS 32256 114 applies How the CHF is selected by the SMSF is defined in clause 54 of TS 32274 118 If the NF consumer performs discovery and selection via NRF the CHF selection function in NF consumers selects a CHF instance based on the available CHF instances obtained from the NRF The CHF selection functionality in NF consumer or in SCP should consider one of the following factors 1 CHF Group ID of the UEs SUPI NOTE 2 The NF Consumer can infer the CHF Group ID the UEs SUPI belongs to based on the results of CHF discovery procedures with NRF 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1875",
    "document_id": "23501-i80",
    "chunk_id": 1875,
    "text": "SUPI the NF consumer selects a CHF instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI as input for CHF discovery In the case of delegated discovery and selection in SCP the NF consumer shall include all available factors in the request towards SCP 6312 Trusted Non-3GPP Access Network selection 63121 General Clause 6312 specifies how a UE which wants to establish connectivity via trusted non-3GPP access and is not operating in SNPN access mode selects a PLMN and a trusted non-3GPP access network TNAN to connect to NOTE For UE operating in SNPN access mode refer to clause 530213 How the UE decides to use trusted non-3GPP access is not specified in this document As an example a UE may decide to use trusted non-3GPP access for connecting to 5GC in a specific PLMN based on - the UE implementation-specific criteria or - the UE configuration eg the UE may be configured to try first the trusted non-3GPP access procedures or - the UE capabilities eg the UE may support only the trusted non-3GPP access procedures or - the advertised capabilities of the discovered non-3GPP access networks eg one or more available non-3GPP access networks advertise support of trusted connectivity to 5GC in a specific PLMN An example deployment scenario is schematically illustrated in Figure 63121-1 below In this scenario the UE has discovered five non-3GPP access networks which are WLAN access networks These WLANs advertise information about the PLMNs they interwork with eg by using the ANQP protocol as defined in the HS20 specification 85",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1876",
    "document_id": "23501-i80",
    "chunk_id": 1876,
    "text": "Each WLAN may support S2a connectivity andor 5G connectivity to one or more PLMNs Before establishing connectivity via trusted non-3GPP access the UE needs to select a a PLMN b a non-3GPP access network that provide trusted connectivity this this PLMN and c a connectivity type ie either 5G connectivity or S2a connectivity Each non-3GPP access network may advertise one or more of the following PLMN lists 1 A PLMN List-1 which includes PLMNs with which AAA connectivity is supported A non-3GPP access network supports AAA connectivity with a PLMN when it deploys an AAA function that can connect with a 3GPP AAA ServerProxy in this PLMN via an STa interface trusted WLAN to EPC or via an SWa interface untrusted WLAN to EPC see TS 23402 43 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1877",
    "document_id": "23501-i80",
    "chunk_id": 1877,
    "text": "A PLMN List-2 which includes PLMNs with which S2a connectivity is supported A non-3GPP access network supports S2a connectivity with a PLMN when it deploys a TWAG function that can connect with a PGW in this PLMN via an S2a interface see clause 16 of TS 23402 43 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1878",
    "document_id": "23501-i80",
    "chunk_id": 1878,
    "text": "A PLMN List-3 which includes PLMNs with which 5G connectivity is supported A non-3GPP access network supports 5G connectivity with a PLMN when it deploys a TNGF function that can connect with an AMF function and an UPF function in this PLMN via N2 and N3 interfaces respectively see clause 428 When the UE wants to discover the PLMN Lists supported by a non-3GPP access network and the non-3GPP access network supports ANQP the UE shall send an ANQP query to the non-3GPP access network requesting 3GPP Cellular Network information If the non-3GPP access network supports interworking with one or more PLMNs the response received by the UE includes a 3GPP Cellular Network information element containing one or more of the above three PLMN Lists The PLMN List-1 and the PLMN List-2 are specified in TS 23402 43 and indicate support of interworking with EPC in one or more PLMNs The PLMN List-3 is a list used to indicate support of interworking with 5GC in one or more PLMNs When the non-3GPP access network does not support ANQP how the UE discovers the PLMN Lists supported by the non-3GPP access network is not defined in the present specification The UE determines if a non-3GPP access network supports trusted connectivity to a specific PLMN by receiving the PLMN List-2 and the PLMN List-3 advertised by this access network If this PLMN is not included in any of these lists then the non-3GPP access network can only support connectivity to an ePDG or N3IWF in the PLMN ie untrusted connectivity Figure 63121-1 Example deployment scenario for trusted Non-3GPP access network selection 63122 Access Network Selection Procedure",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1879",
    "document_id": "23501-i80",
    "chunk_id": 1879,
    "text": "The steps below specify the steps executed by the UE when the UE wants to select and connect to a PLMN over trusted non-3GPP access Note that the UE executes these steps before connecting to a trusted non-3GPP access network This is different from the untrusted non-3GPP access see clause 636 N3IWF selection where the UE first connects to a non-3GPP access network it obtains IP configuration and then proceeds to PLMN selection and ePDGN3IWF selection In the case of trusted non-3GPP access the UE uses 3GPP-based authentication for connecting to a non-3GPP access so it must first select a PLMN and then attempt to connect to a non-3GPP access Step 1 The UE constructs a list of available PLMNs with which trusted connectivity is supported This list contains the PLMNs included in the PLMN List-2 and PLMN List-3 advertised by all discovered non-3GPP access networks For each PLMN the supported types of trusted connectivity is also included a In the example shown in Figure 63121-1 the list of available PLMNs includes - PLMN-a S2a connectivity 5G connectivity - PLMN-b 5G connectivity - PLMN-c S2a connectivity 5G connectivity - PLMN-d S2a connectivity",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1880",
    "document_id": "23501-i80",
    "chunk_id": 1880,
    "text": "Step 2 The UE selects a PLMN that is included in the list of available PLMNs as follows a If the UE is connected to a PLMN via 3GPP access and this PLMN is included in the list of available PLMNs the UE selects this PLMN If this PLMN is not included in the list of available PLMNs but it is included in the Non-3GPP access node selection information in the UE see clause 6361 the UE selects this PLMN and executes the combined ePDGN3IWF selection procedure specified in clause 6363 b Otherwise the UE is not connected to a PLMN via 3GPP access or the UE is connected to a PLMN via 3GPP access but this PLMN is neither in the list of available PLMNs nor in the Non-3GPP access node selection information the UE determines the country it is located in by using implementation specific means",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1881",
    "document_id": "23501-i80",
    "chunk_id": 1881,
    "text": "i If the UE determines to be located in its home country then - The UE selects the HPLMN if included in the list of available PLMNs Otherwise the UE selects an E-HPLMN Equivalent HPLMN if an E-HPLMN is included in the list of available PLMNs If the list of available PLMNs does not include the HPLMN and does not include an E-HPLMN the UE stops the procedure and may attempt to connect via untrusted non-3GPP access ie it may execute the N3IWF selection procedure specified in clause 636 ii If the UE determines to be located in a visited country then - The UE determines if it is mandatory to select a PLMN in the visited country as follows - If the UE has IP connectivity eg the UE is connected via 3GPP access the UE sends a DNS query and receives a DNS response that indicates if a PLMN must be selected in the visited country The DNS response includes also a lifetime that denotes how long the DNS response can be cached for The FQDN in the DNS query shall be different from the Visited Country FQDN see TS 23003 19 that is used for ePDGN3IWF selection The DNS response shall not include a list of PLMNs that support trusted connectivity in the visited country but shall only include an indication of whether a PLMN must be selected in the visited country or not - If the UE has no IP connectivity eg the UE is not connected via 3GPP access then the UE may use a cached DNS response that was received in the past or may use local configuration that indicates which visited countries mandate a PLMN selection in the visited country - If the UE determines that it is not mandatory to select a PLMN in the visited country and the HPLMN or an E-HPLMN is included in the list of available PLMNs then the UE selects the HPLMN or an E-HPLMN whichever is included in the list of available PLMNs - Otherwise the UE selects a PLMN in the visited country by considering in priority order the PLMNs first in the User Controlled PLMN Selector list and next in the Operator Controlled PLMN Selector list see TS 23122 17",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1882",
    "document_id": "23501-i80",
    "chunk_id": 1882,
    "text": "The UE selects the highest priority PLMN in a PLMN Selector list that is also included in the list of available PLMNs - If the list of available PLMNs does not include a PLMN that is also included in a PLMN Selector list the UE stops the procedure and may attempt to connect via untrusted non-3GPP access c In the example shown in Figure 63121-1 the UE may select PLMN-c for which S2a connectivity and 5G connectivity is supported Step 3 The UE selects the type of trusted connectivity S2a connectivity or 5G connectivity for connecting to the selected PLMN as follows a If the list of available PLMNs indicates that both S2a connectivity and 5G connectivity is supported for the selected PLMN then the UE shall select 5G connectivity because it is the preferred type of trusted access b",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1883",
    "document_id": "23501-i80",
    "chunk_id": 1883,
    "text": "Otherwise if the list of available PLMNs indicates that only one type of trusted connectivity either S2a connectivity or 5G connectivity is supported for the selected PLMN the UE selects this type of trusted connectivity c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1884",
    "document_id": "23501-i80",
    "chunk_id": 1884,
    "text": "In the example shown in Figure 63121-1 the UE may select PLMN-c and 5G connectivity There are two non-3GPP access networks that support 5G connectivity to PLMN-c the WLAN access network 2 and the WLAN access network 4 Step 4 Finally the UE selects a non-3GPP access network to connect to as follows a The UE puts the available non-3GPP access networks in priority order For WLAN access the UE constructs a prioritized list of WLAN access networks by using the WLANSP rules if provided and the procedure specified in clause 6613 of TS 23503 45 When the UE supports the selection of Trusted access supporting the network slices it desires to use and has received extended WLANSP rule as specified in clause 6611 of TS 23503 45 the UE selects the non-3GPP access network with the SSIDs which can access to the TNGF supporting the S-NSSAI needed by the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1885",
    "document_id": "23501-i80",
    "chunk_id": 1885,
    "text": "If the UE is not provided with WLANSP rules the UE constructs the prioritized list of WLAN access networks by using an implementation specific procedure For other types of non-3GPP access the UE may use access specific information to construct this prioritized list b From the prioritized list of non-3GPP access networks the UE selects the highest priority non-3GPP access network that supports the selected type of trusted connectivity to the selected PLMN c In the example shown in Figure 63121-1 the UE selects either the WLAN access network 2 or the WLAN access network 4 whichever has the highest priority in the prioritized list of non-3GPP access networks d",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1886",
    "document_id": "23501-i80",
    "chunk_id": 1886,
    "text": "Over the selected non-3GPP access network the UE starts the 5GC registration procedure specified in clause 412a22 of TS 23502 3 e If the AMF detects the UE is using a wrong TNGF the AMF may trigger a UE policy update and reject the UE registration During the registration procedure the AMF may determine if the TNGF selected by the UE is suitable for the S-NSSAIs requested by the UE considering the UE subscription If the AMF determines that a different TNGF should be selected as described in clause 412a22 of TS 23502 3 the AMF - may if the UE supports slice-based TNGF selection triggers the UE Policy Association Establishment or UE Policy Association Update procedure to provide the UE with updated TNGF selection information when the AMF is informed by the PCF that the update of UE policy information on the UE is completed as described in clause 412a22 of TS 23502 3 the AMF releases UE Policy Association if the UE is not registered over 3GPP access before proceeding to the Registration Reject over trusted non-3GPP access NOTE 1 To enable the V-PCF to provide the UE with Slice-specific TNGF selection information in the roaming case the AMF provides the V-PCF with the Configured NSSAI for the serving PLMN during the UE Policy Association EstablishmentUpdate procedure - shall send a Registration Reject message to the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1887",
    "document_id": "23501-i80",
    "chunk_id": 1887,
    "text": "The AMF may include target TNAN information SSID TNGF ID in the Registration Reject so that the UE can if supported by the UE use the target TNAN information to try again to register to 5GC if the UE wishes to send the same Requested NSSAI as during the previous Registration Request The target TNAN information only applies to the one TNAN selection performed by the UE just after receiving the Registration Reject NOTE 2 A TNGF ID sent within a Registration Reject message to a UE trying to register over Trusted Non-3GPP access corresponds to a UE side interface of a TNGF while a TNGF Identifier of N3 terminations provided by a TNGF over N2 and defined in clause 6333 corresponds to an internal 5GC identifier related with a TNGF The AMF may determine the target TNAN based on the list of supported TAs and the corresponding list of supported slices for each TA obtained as defined in clause 5158 and considering UE location NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1888",
    "document_id": "23501-i80",
    "chunk_id": 1888,
    "text": "The operator is assumed to ensure that UEs that do not support slice-based TNGF selection always select a TNGF that supports at least one slice requested by the UE This is to avoid unnecessary and potentially repetitive rejections of those UEs To ensure this the operator is assumed to provide identifiers of TNGFs that only support a subset of the slices configured in the network only to UEs that support slice-based TNGF selection 6312a Access Network selection for devices that do not support 5GC NAS over WLAN 6312a1 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1889",
    "document_id": "23501-i80",
    "chunk_id": 1889,
    "text": "As specified in clause 4285 devices that do not support 5GC NAS signalling over WLAN access referred to as Non-5G-Capable over WLAN devices or N5CW devices for short may access 5GC in a PLMN or an SNPN via a trusted WLAN access network that supports a TWIF function The following clause specifies a how a N5CW device selects a PLMN and b how it selects a trusted WLAN access network that can provide 5G connectivity-without-NAS to the selected PLMN This selection procedure is called access network selection NOTE For N5CW device accessing an SNPN refer to clause 530215 Each WLAN access network that provides 5G connectivity-without-NAS advertises with ANQP a list of PLMNs with which 5G connectivity-without-NAS is supported This list is called PLMN List-4 and is different from the PLMN List-1 PLMN List-2 and PLMN List-3 defined in clause 6312 A WLAN advertises the PLMN List-4 when the WLAN supports a TWIF function 6312a2 Access Network Selection Procedure",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1890",
    "document_id": "23501-i80",
    "chunk_id": 1890,
    "text": "The steps executed by a N5CW device for access network selection are specified below and are very similar with the corresponding steps executed by a UE that supports NAS see clause 63122 Step 1 The N5CW device constructs a list of available PLMNs This list contains the PLMNs included in the PLMN List-4 advertised by all discovered WLAN access networks a The N5CW device discovers the PLMN List-4 advertised by all discovered WLAN access networks by sending an ANQP query to each discovered WLAN access network The ANQP query shall request 3GPP Cellular Network information If a WLAN access network supports interworking with one or more PLMNs the ANQP response received by the N5CW device includes a 3GPP Cellular Network information element containing one or more of the following lists PLMN List-1 PLMN List-2 PLMN List-3 and PLMN List-4 The PLMN List-1 PLMN List-2 and PLMN List-3 are defined in clause 6312",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1891",
    "document_id": "23501-i80",
    "chunk_id": 1891,
    "text": "The PLMN List-4 includes the PLMNs with which 5G connectivity-without-NAS is supported Step 2 The N5CW device selects a PLMN that is included in the list of available PLMNs as follows a If the N5CW device is connected to a PLMN via 3GPP access and this PLMN is included in the list of available PLMNs then the N5CW device selects this PLMN b Otherwise the N5CW device is not connected to a PLMN via 3GPP access or the N5CW device is connected to a PLMN via 3GPP access but this PLMN is not in the list of available PLMNs",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1892",
    "document_id": "23501-i80",
    "chunk_id": 1892,
    "text": "i If the N5CW device determines to be located in its home country then - The N5CW device selects the HPLMN if the N5CW device has a USIM or is pre-configured with an HPLMN if the HPLMN is included in the list of available PLMNs Otherwise the N5CW device selects an E-HPLMN Equivalent HPLMN if an E-HPLMN is included in the list of available PLMNs If the list of available PLMNs does not include the HPLMN and does not include an E-HPLMN the N5CW device stops the access network selection procedure ii",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1893",
    "document_id": "23501-i80",
    "chunk_id": 1893,
    "text": "If the N5CW device determines to be located in its visited country then - The N5CW device determines if it is mandatory to select a PLMN in the visited country as follows - If the N5CW device has IP connectivity eg it is connected via 3GPP access the N5CW device sends a DNS query and receives a DNS response that indicates if a PLMN must be selected in the visited country The DNS response includes a lifetime that denotes how long the DNS response can be cached - If the N5CW device has no IP connectivity eg it is not connected via 3GPP access then the N5CW device may use a cached DNS response that was received in the past or may use local configuration that indicates which visited countries mandate a PLMN selection in the visited country - If the N5CW device determines that it is not mandatory to select a PLMN in the visited country and the HPLMN or an E-HPLMN is included in the list of available PLMNs then the N5CW device selects the HPLMN or an E-HPLMN whichever is included in the list of available PLMNs - Otherwise the N5CW device selects a PLMN in the visited country as follows - If the N5CW device has a USIM the UE selects a PLMN in the visited country by considering in priority order the PLMNs first in the User Controlled PLMN Selector list and next in the Operator Controlled PLMN Selector list see TS 23122 17 - If the N5CW device does not have a USIM the N5CW device selects the highest priority PLMN in a pre-configured list which is also included in the list of available PLMNs - If the list of available PLMNs does not include a PLMN that is also included in the pre-configured lists the N5CW device either stops the access network selection procedure or may select a PLMN based on its own implementation Step 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1894",
    "document_id": "23501-i80",
    "chunk_id": 1894,
    "text": "Finally the N5CW device selects a WLAN access network eg an SSID to connect to following the procedure specified in clause 6613 of TS 23503 45 UE procedure for selecting a WLAN access based on WLANSP rules or any other implementation specific means After the N5CW device completes the above access network selection procedure the N5CW device initiates the Initial Registration and PDU Session Establishment procedure specified in clause 412b2 of TS 23502 3 6312b Access Network selection for 5G NSWO",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1895",
    "document_id": "23501-i80",
    "chunk_id": 1895,
    "text": "In addition to the PLMN lists specified in clause 6312 and in clause 6312a a WLAN access network may also advertise the following PLMN list - A PLMN List-5 which includes candidate PLMNs with which AAA connectivity to 5GC is supported A WLAN access network supports AAA connectivity to 5GC in a candidate PLMN when it deploys an AAA function that can connect with a NSWOF in this PLMN or can connect with a NSWOF in another PLMN ie HPLMN in roaming case via AAA proxy The NSWOF supports WLAN connection using 5G credentials without 5GS registration as defined in clause 4215 If the UE selects a PLMN that is neither UEs HPLMN nor EHPLMN through which the NSWO request should be sent towards the HPLMN the UE shall use the decorated NAI format as specified in clause 4215 and in TS 23003 19",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1896",
    "document_id": "23501-i80",
    "chunk_id": 1896,
    "text": "For access to SNPN or CH a WLAN access network may also advertise the following SNPN list - A SNPN List-5 which includes SNPNs with which AAA connectivity to 5GC is supported The SNPNs are the candidate serving SNPNs that the WLAN access network can connect with A WLAN access network supports AAA connectivity to 5GC in a SNPN when it deploys an AAA function that can connect with a NSWOF in this SNPN or can connect with a NSWOF or AAA server in a CH via AAA Proxy The SNPN or CH supports WLAN connection using 5G credentials without 5GS registration as defined in clause 4215 NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1897",
    "document_id": "23501-i80",
    "chunk_id": 1897,
    "text": "The selected SNPN within the SNPN List-5 is interpreted as serving SNPN when the SNPN does not correspond to UEs subscribed SNPN When the UE wants to connect to a WLAN access network using the 5G NSWO procedure defined in TS 33501 29 Annex S the UE may retrieve the PLMN List-5 or SNPN List-5 advertised by each discovered WLAN access network and may consider this list for selecting the WLAN access network to connect to For example if the UE identifies that the HPLMN or CH is included in the PLMN List-5 or SNPN List-5 advertised by a WLAN access network the UE may select this WLAN access network to connect to using the 5G NSWO procedure When the UE is configured by HPLMN or CH to use 5G NSWO for connecting to WLAN access networks using its 5G credentials as defined in TS 33501 29 the UE shall attempt to select a WLAN that supports 5G NSWO and shall only use the 5G NSWO procedure for connecting to the selected WLAN A WLAN access network may also advertise a list of SNPNs which includes SNPNs with which AAA connectivity to 5GC is supported A WLAN access network supports AAA connectivity to 5GC in an SNPN when it deploys an AAA function that can connect with a SNPN or CH using any of the architectures defined in clause 4215 When the UE operating in SNPN access mode wants to connect to a WLAN access network using the 5G NSWO procedure defined in Annex S of TS 33501 29 the UE may retrieve the SNPNs with which AAA connectivity to 5GC is supported that are advertised by each discovered WLAN access network and may consider this information for selecting the WLAN access network to which it attempts to connect 6313 NWDAF discovery and selection Multiple instances of NWDAF may be deployed in a network The NF consumers shall utilize the NRF to discover NWDAF instances unless NWDAF information is available by other means eg locally configured on NF consumers NF consumers may make an additional query to UDM when supported as detailed below The NWDAF selection function in NF consumers selects an NWDAF instance based on the available NWDAF instances The NRF may return one or more candidate NWDAF instances and each candidate NWDAF instance based on its registered profile supports the Analytics ID with a time that is less than or equal to the Supported Analytics Delay",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1898",
    "document_id": "23501-i80",
    "chunk_id": 1898,
    "text": "The following factors may be considered by the NF consumer for NWDAF selection - S-NSSAI - Analytics IDs - Supported services possibly with their associated Analytics IDs - NWDAF Serving Area information ie list of TAIs for which the NWDAF can provide services and collect data for each item of this list a weight may be defined in the NWDAF NF profile to indicate the priority of the NWDAF to cover the TA If there exists AoI then the NWDAF whose serving area covers the AoI may be selected NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1899",
    "document_id": "23501-i80",
    "chunk_id": 1899,
    "text": "If all services provided by one NWDAF do not support the same Analytics ID the NWDAF registers the Analytics IDs of the services at the service level NOTE 2 Analytics IDs at service level take precedence over Analytics IDs at NF level NOTE 3 For discovery of NWDAF supporting Nnwdaf_AnalyticsSubscription or Nnwdaf_AnalyticsInfo services the Analytics IDs at the NWDAF NF profile are used - only when DCCF is hosted by NWDAF - NF type of the data source - NF Set ID of the data source NOTE 4 Can be used when the NWDAF determines that it needs to discover another NWDAF which is responsible for co-ordinating the collection of required data The NWDAF does a new discovery for a target NWDAF via NRF using NF Set ID or NF type of the data source or using Area of Interest NOTE 5 For discovery of NWDAF supporting Nnwdaf_DataManagement service at least the NWDAF Serving Area information from the NWDAF profile are used NOTE 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1900",
    "document_id": "23501-i80",
    "chunk_id": 1900,
    "text": "The presence of NF type of data source or NF set ID of the data source denotes that the NWDAF can collect data from such NF Sets or NF Types - Supported Analytics Delay of the requested Analytics IDs see clause 6262 - Vendor IDs of potential target AnLFs eg used in transfer procedure In the case of multiple instances of NWDAFs deployment following factors may also be considered - NWDAF Capabilities - Analytics aggregation capability - Analytics metadata provisioning capability - Accuracy checking capability ie analytics accuracy checking capability for the AnLF andor ML Model accuracy checking capability for the MTLF as defined in clause 5C1 of TS 23288 86 Applicable when NF consumer cannot determine a suitable NWDAF instance based on NRF discovery response and when NWDAF registration in UDM is supported as defined in clause 52 of TS 23288 86 NF consumers may query UDM Nudm_UECM_Get service operation for determining the ID of the NWDAF serving the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1901",
    "document_id": "23501-i80",
    "chunk_id": 1901,
    "text": "The following factors may be considered by NF consumers to select an NWDAF instance already serving a UE for an Analytics ID - SUPI - Analytics IDs When selecting an NWDAF for ML model provisioning the following additional factors may be considered by the NWDAF - The ML model Filter information parameters S-NSSAIs and Areas of Interest see clause 52 TS 23288 86 for the trained ML models per Analytics IDs and ML Model Interoperability indicator per Analytics ID if available When selecting an NWDAF that supports Federated Learning the following additional factors may be considered by the NWDAF - Time Period of Interest time interval startend during which the Federated Learning will be performed - when selecting FL client NWDAF - FL capability type as FL client NWDAF per Analytics ID - NF types of the data sources where data can be collected as input for local model training - NF Set IDs of the data sources where data can be collected as input for local model training - ML Model Interoperability indicator - when selecting FL server NWDAF - FL capability type as FL server NWDAF per Analytics ID - The ML model Filter information parameters S-NSSAIs and Areas of Interest see clause 52 of TS 23288 86 for the trained ML models per Analytics IDs if available When selecting a NWDAF for roaming case the detailed mechanism is defined in clause 52 of TS 23288 86 6314",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1902",
    "document_id": "23501-i80",
    "chunk_id": 1902,
    "text": "NEF Discovery",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1903",
    "document_id": "23501-i80",
    "chunk_id": 1903,
    "text": "The NF consumers may utilize the NRF to discover NEF instances unless NEF information is available by other means eg locally configured in NF consumers The NRF provides NF profiles of NEF instances to the NF consumers The IP addressesports of the NEF or L-NEF may be locally configured in the AF or the AF may discover the FQDN or IP addressesports of the NEFL-NEF by performing a DNS query using the External Identifier of an individual UE or using the External Group Identifier of a group of UEs or using EDNS Client Subnet or if the AF is trusted by the operator the AF may utilize the NRF to discover the FQDN or IP addressesports of the NEF or L-NEF NOTE 1 When the AF discovers the FQDN or IP addressesports of the NEFL-NEF by performing a DNS query the AF can add in its DNS request an EDNS Client Subnet option in order to help the DNS determine a local NEF directly The use of a DNS query for the selection of a L-NEF is only supported for AF and not internal network functions NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1904",
    "document_id": "23501-i80",
    "chunk_id": 1904,
    "text": "The EDNS Client Subnet may be derived by the AF based on factors that are considered for NEF selection Whether and which factors are considered for NEFL-NEF selection may depend on whether the AF performs an initial NEF discovery or a NEF discovery due to L-PSA relocation NOTE 3 The NEF discovery and selection procedures described in this clause are intended to be applied by NF consumers deployed within the operators domain NOTE 4 The NEF supporting the capabilities can be configured in the AF or discovered by AF with the assistance of NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1905",
    "document_id": "23501-i80",
    "chunk_id": 1905,
    "text": "The following factors may be considered for NEF selection - S-NSSAIs - S-NSSAI and DNN corresponding to an untrusted AF - Event IDs supported by an AF see clause 626 clause 6223 of TS 23288 86 and clause 5219 of TS 23502 3 - AF Instance ID Application Identifier - External Identifier External Group Identifier or domain name - A request for local NEF selection - Location see locality in clause 61622 of TS 29510 58 - for local NEF selection List of supported TAI - for local NEF selection List of supported DNAI - Capability of NEF to support UAS NF functionality for UUAA procedures - Capability of NEF to support Multi-member AF session with required QoS for a set of UEs identified by a list of UE addresses - Capability of NEF to support member UE selection assistance functionality Local NEF instances can be deployed close to UE access For local NEF selection the location of the local NEF instance eg geographical location data centre may be used in conjunction with the location of L-PSA UPF or AF 6315 UCMF Discovery and Selection The AMF MME NEF AF SCEF SCSAS may utilize the NRF to discover UCMF instances unless UCMF information is available by other means eg locally configured in UCMF services consumers In the case of delegated discovery and selection in SCP the NF consumer shall forward the request towards SCP 6316 SCP discovery and selection An NF is configured with its serving SCPs In a deployment where several SCPs are deployed a message may traverse several SCP instances until reaching its final destination A SCP may discover and select a next hop SCP by querying the Nnrf_NFDiscovery Service of the NRF or it may be configured with next SCP in the message path An SCP may use the SCP profile parameters in clause 6263 as discovery parameters in Nnrf_NFDiscovery",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1906",
    "document_id": "23501-i80",
    "chunk_id": 1906,
    "text": "The parameters to be used depends on network deployment The NRF returns a list SCP Profiles as per the provided discovery parameters If an SCP receives a Routing Binding Indication within a service or notification request and decides to forward that request to a next-hop SCP it shall include the Routing Binding Indication in the forwarded request NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1907",
    "document_id": "23501-i80",
    "chunk_id": 1907,
    "text": "It is up to SCP implementation deployment specific configuration and operator policies as to how the SCP will use information retrieved from the NRF to resolve the optimal route to a producer Based on SCP configuration an SCP deciding to address a next-hop SCP for a service request may then delegate the NF instance andor service instance selection to subsequent SCPs and provide discovery and selection parameters to the next-hop SCP 6317 NSSAAF discovery and selection In the case of NF consumer based discovery and selection the following applies - The NF consumer eg AMF AUSF performs NSSAAF selection to select an NSSAAF Instance that supports authentication between the UE and the AAA-S associated with the HPLMN or in the Credentials Holder in the case of SNPN or in the DCS domain in the case of ON-SNPN The NF consumer shall utilize the NRF to discover the NSSAAF instances unless NSSAAF information is available by other means eg locally configured on the NF consumer The NSSAAF selection function in the NF consumer selects an NSSAAF instance based on the available NSSAAF instances obtained from the NRF or locally configured in the NF consumer NSSAAF selection is applicable to both 3GPP access and non-3GPP access The NSSAAF selection function in NSSAAF NF consumers or in SCP should consider the following factor when it is available 1 Home Network Identifier eg MNC and MCC realm of SUPI by an NF consumer in the Serving network 2 S-NSSAI of the HPLMN 3 SUPI or Internal Group ID the NSSAAF NF consumer selects a NSSAAF instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI or Internal Group ID as input for NSSAAF discovery An HPLMN deploying NSSAAF instances supporting specific S-NSSAIs andor sets of SUPIs according to factors 2-3 shall also deploy NSSAAF instances that can be selected using factor 1 if they need to interoperate with VPLMNs using only factor 1 for NSSAAF selection In the case of delegated discovery and selection in SCP the NSSAAF NF consumer shall send all available factors to the SCP 6318 5G-EIR discovery and selection A consumer NF of the 5G-EIR performs discovery of 5G-EIR using either configuration or NRF as specified in clause 631",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1908",
    "document_id": "23501-i80",
    "chunk_id": 1908,
    "text": "The network is configured with the 5G-EIR to serve the PLMN of the NF consumer requesting the 5G-EIR service ie no roaming interface is defined The 5G-EIR selection function in NF consumers is independent of Access Type 6319 DCCF discovery and selection Multiple instances of DCCF may be deployed in a network The NF consumers shall utilize the NRF to discover DCCF instances unless DCCF information is available by other means eg locally configured on NF consumers The DCCF selection function in NF consumers selects a DCCF instance based on the available DCCF instances The following factors may be considered by the NF consumer for DCCF selection - DCCF Serving Area information ie list of TAIs for which the DCCF coordinates Data Sources - S-NSSAI - NF type of the data source - NF Set ID of the data source NOTE NF Set ID can be used when the NF consumer is a DCCF when the DCCF determines that it needs to discover another DCCF which is responsible for co-ordinating the collection of required data The DCCF discovers a target DCCF via NRF using NF Set ID of the data source - DCCF relocation capability Support for relocating the data collection subscription among DCCFs 6320 ADRF discovery and selection Multiple instances of ADRF may be deployed in a network The NF consumers shall utilize the NRF to discover ADRF instances unless ADRF information is available by other means eg locally configured on NF consumers The ADRF selection function in NF consumers selects an ADRF instance based on the available ADRF instances NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1909",
    "document_id": "23501-i80",
    "chunk_id": 1909,
    "text": "When NF consumer is DCCF the DCCF can have information available already from previous registrations of ADRFs In this case NRF discovery is not needed The following factors may be considered by the NF consumer for ADRF selection - S-NSSAI - ML model storage capability 6321 MFAF discovery and selection Multiple instances of MFAF may be deployed in a network The MFAF selection function is supported by the DCCF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1910",
    "document_id": "23501-i80",
    "chunk_id": 1910,
    "text": "The DCCF shall utilize the NRF to discover MFAF instances unless MFAF information is available by other means eg locally configured on the DCCF The MFAF selection function in the DCCF selects a MFAF instance based on the available MFAF instances The following factors may be considered by the DCCF for MFAF selection - S-NSSAI - NF Types of the Data Sources handled by the MFAF - NF Set IDs of the Data Sources handled by the MFAF - MFAF Serving Area information ie list of TAIs for which the MFAF may receive data from Data Sources 6322 NSACF discovery and selection The NF consumers shall utilise the NRF to discover NSACF instances including the NSACF acting as Primary NSACF role unless NSACF information is available by other means eg locally configured in NF consumers The NSACF selection function in the NSACF NF consumer selects an NSACF instance based on the available NSACF instances which are obtained from the NRF or locally configured in the NSACF NF consumer The following factors may be considered by the NF consumer for NSACF discovery and selection - S-NSSAIs - NSAC Service Area Identifier or a reserved value Entire PLMN for discovering the NSACF acting as Primary NSACF or centralized NSAC role The NSAC Service Area Identifier is configured at the consumer NF and NSACF see clause 515110 Each Service Area Identifier is a unique and unambiguous identifier and a NSACF registers with the NRF the NSAC Service Area Identifiers of the NSAC Service Areas it serves Entire PLMN is indicated in roaming case to the NRF of HPLMN by the VPLMN NF consumer when the VPLMN NF consumer needs to discover the HPLMN NSACF or in non roaming case to select a Primary NSACF - NSACF service capabilities - Support monitoring and controlling the number of registered UEs per network slice for the network slice that is subject to NSAC - Support for network slices that are subject to NSAC and configured to support EPS counting monitoring and controlling the number of registered UEs with at least one PDU session per network slice as defined in clause 515115a - Support monitoring and controlling the number of established PDU Sessions per network slice for the network slice that is subject to NSAC - PLMN ID information in the case of roaming to contact the HPLMN NSACF for inbound roamers In the case of delegated discovery and selection in SCP the NSACF NF consumer shall send all available and applicable factors to the SCP 6323 EASDF discovery and selection Multiple instances of EASDF may be deployed in a network NF consumers mentioned in this clause are SMFs The NF consumers shall utilize the NRF to discover EASDF instances unless EASDF information is available by other means eg locally configured on the NF consumer The EASDF selection function in NF consumers or SCP selects an EASDF instance based on the available EASDF instances The following factors may be considered by the NF consumer or SCP for EASDF selection - S-NSSAI - DNN - the N6 IP address of the EASDF NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1911",
    "document_id": "23501-i80",
    "chunk_id": 1911,
    "text": "The IP address of the EASDF is not used for EASDF discovery It can be used is to select an EASDF that is IP near to the PSA of the PDU Session - The N6 IP address of the PSA UPF - Location as per NF profile - DNAI if exist - Supported DNS security protocols if existing 6324 TSCTSF Discovery The NFs eg NEF AF and PCF may utilize the NRF to discover TSCTSF instances unless TSCTSF information is available by other means eg locally configured in the requested NF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1912",
    "document_id": "23501-i80",
    "chunk_id": 1912,
    "text": "The following factors may be considered for TSCTSF discovery and selection - DNN and S-NSSAI When the NF discovers the TSCTSF for a DNNS-NSSAI the NRF provides the NF with NF profiles of TSCTSF instances belonging to single TSCTSF Set for a given DNNS-NSSAI For example the same TSCTSF Set shall be selected by the PCF serving PDU Sessions for this DNN and S-NSSAI to notify the TSCTSF for a PDU Session that is potentially impacted by the gPTP time synchronization service - GPSI or External Group Identifier TSCTSF NF consumers which manage network signalling not based on SUPISUCI eg the NEF select a TSCTSF instance based on the GPSI or External Group ID range the UEs GPSI or External Group ID belongs to or based on the results of a discovery procedure with NRF using the UEs GPSI or External Group ID as input for TSCTSF discovery - SUPI or Internal Group ID TSCTSF NF consumers select a TSCTSF instance based on the SUPI range the UEs SUPI belongs to or based on the results of a discovery procedure with NRF using the UEs SUPI or Internal Group ID as input for TSCTSF discovery If the TSCTSF is locally configured in NFs it shall be ensured that the same TSCTSF Set is configured in all NFs eg NEF AF and PCF for the given DNN and S-NSSAI NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1913",
    "document_id": "23501-i80",
    "chunk_id": 1913,
    "text": "Thus it is assumed that there is only one TSCTSF Set for a given DNNS-NSSAI in this Release of the specification 6325 AF Discovery and Selection The NF consumers eg NWDAF may utilize the NRF to discover AF instances in the MNO domain ie trusted AFs unless AF information is available by other means eg locally configured in NF consumers The NRF provides NF profiles of AF instances to the NF consumers The following factors may be considered for AF discovery and selection - One or multiple combinations of the S-NSSAI and DNN corresponding to an AF - Supported Application Ids - Event IDs Supported by an AF - Internal-Group Identifier The NF consumer eg NWDAF may select an AF instance in the MNO domain considering one or multiple combinations of the S-NSSAI and DNN corresponding to an AF and the EventIDs supported by an AF to provide the input data required for generation of analytics The NF consumer eg NWDAF may consider the supported Application Ids if the input data is required only for those applications The NF consumer eg NWDAF may consider the Internal-Group Identifier supported by the AF if the input data is required for a particular group of UEs 6326 NRF discovery and selection The following mechanisms may be used for discovery of NRF service instances and their endpoint addresses - NF consumers or SCP may have all the NRF services instances and their endpoint addresses locally configured - NF consumers or SCP may have the endpoint address of a NRF discovery service locally configured and utilize it to discover the NRFs and get the NF profiles of the NRFs - NF consumers eg v-NRF or SCP may have endpoint addresses of the NRF bootstrapping service and utilize it to discover the NRF service instances and their endpoint addresses The NRF bootstrapping service is a version independent API which may be especially useful over roaming interfaces - The NF consumer eg AMF may use the Nnssf_NSSelection service to get the endpoint address of a NRF discovery service for a certain slice 7 Network Function Services and descriptions 71 Network Function Service Framework 711 General Service Framework functionalities include eg service registrationde-registration consumer authorization service discovery and inter service communication which include selection and message passing Four communication options are listed in Annex E and can all co-exist within one and the same network An NF service is one type of capability exposed by an NF NF Service Producer to other authorized NF NF Service Consumer through a service-based interface A Network Function may expose one or more NF services Following are criteria for specifying NF services - NF services are derived from the system procedures that describe end-to-end functionality where applicable see TS 23502 3 Annex B drafting rules Services may also be defined based on information flows from other 3GPP specifications - System procedures can be described by a sequence of NF service invocations NF services may communicate directly between NF Service consumers and NF Service Producers or indirectly via an SCP Direct and Indirect Communication are illustrated in Figure 711-1 For more information see Annex E and clauses 631 and 712 Whether a NF Service Consumer eg in the case of requests or subscriptions or NF Service Producer eg in the case of notifications uses Direct Communication or Indirect Communication by using an SCP is based on the local configuration of the NF Service ConsumerNF Service Producer An NF may not use SCP for all its communication based on the local configuration NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1914",
    "document_id": "23501-i80",
    "chunk_id": 1914,
    "text": "The SCP can be deployed in a distributed manner In Direct Communication the NF Service consumer performs discovery of the target NF Service producer by local configuration or via NRF The NF Service consumer communicates with the target NF Service producer directly In Indirect Communication the NF Service consumer communicates with the target NF Service producer via a SCP The NF Service consumer may be configured to perform discovery of the target NF Service producer directly or delegate the discovery of the target NF Service Producer to the SCP used for Indirect Communication In the latter case the SCP uses the parameters provided by NF Service consumer to perform discovery andor selection of the target NF Service producer The SCP address may be locally configured in NF Service consumer Figure 711-1 NFNF service inter communication 712 NF Service Consumer - NF Service Producer interactions The end-to-end interaction between two Network Functions Consumer and Producer within this NF service framework follows two mechanisms irrespective of whether Direct Communication or Indirect Communication is used - Request-response A Control Plane NF_B NF Service Producer is requested by another Control Plane NF_A NF Service Consumer to provide a certain NF service which either performs an action or provides information or both NF_B provides an NF service based on the request by NF_A",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1915",
    "document_id": "23501-i80",
    "chunk_id": 1915,
    "text": "In order to fulfil the request NF_B may in turn consume NF services from other NFs In Request-response mechanism communication is one to one between two NFs consumer and producer and a one-time response from the producer to a request from the consumer is expected within a certain timeframe The NF Service Producer may also add a Binding Indication see clause 6310 in the Response which may be used by the NF Service Consumer to select suitable NF service producer instances for subsequent requests For indirect communication the NF Service Consumer copies the Binding Indication into the Routing Binding indication that is included in subsequent requests to be used by the SCP to discover a suitable NF service producer instances Figure 712-1 Request-response NF Service illustration - Subscribe-Notify A Control Plane NF_A NF Service Consumer subscribes to NF Service offered by another Control Plane NF_B NF Service Producer Multiple Control Plane NFs may subscribe to the same Control Plane NF Service NF_B notifies the results of this NF service to the interested NFs that subscribed to this NF service The subscription request shall include the notification endpoint ie a Notification Target Address and a Notification Correlation ID eg the callback URL of the NF Service Consumer to which the event notification from the NF Service Producer should be sent to NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1916",
    "document_id": "23501-i80",
    "chunk_id": 1916,
    "text": "The notification endpoint can be a URL and contains both the Notification Target Address and the Notification Correlation ID The NF Service Consumer may add a Binding Indication see clause 6310 in the subscribe request which may be used by the NF Service Producer to discover a suitable notification endpoint For indirect communication the NF Service Producer copies the Binding Indication into the Routing Binding Indication that is included in the response to be used by the SCP to discover a suitable notification target The NF Service Producer may also add a Binding Indication see clause 6310 in the subscribe response which may be used by the NF Service Consumer or SCP to select suitable NF service producer instances or NF producer service instance",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1917",
    "document_id": "23501-i80",
    "chunk_id": 1917,
    "text": "In addition the subscription request may include notification request for periodic updates or notification triggered through certain events eg the information requested gets changed reaches certain threshold etc The subscription for notification can be done through one of the following ways - Explicit subscription A separate requestresponse exchange between the NF Service Consumer and the NF Service Producer or - Implicit subscription The subscription for notification is included as part of another NF service operation of the same NF Service or - Default notification endpoint Registration of a notification endpoint for each type of notification the NF consumer is interested to receive as a NF service parameter with the NRF during the NF and NF service Registration procedure as specified in clause 4171 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1918",
    "document_id": "23501-i80",
    "chunk_id": 1918,
    "text": "The NF Service Consumer may also add a Binding Indication see clause 6310 in the response to the notification request which may be used by the NF Service Producer to discover a suitable notification endpoint For indirect communication the NF Service Producer copies the Binding Indication into the Routing Binding indication that is included in subsequent notification requests The binding indication is then used by the SCP to discover a suitable notification target Figure 712-2 Subscribe-Notify NF Service illustration 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1919",
    "document_id": "23501-i80",
    "chunk_id": 1919,
    "text": "A Control Plane NF_A may also subscribe to NF Service offered by Control Plane NF_B on behalf of Control Plane NF_C ie it requests the NF Service Producer to send the event notification to another consumers In this case NF_A includes the notification endpoint ie Notification Target Address and a Notification Correlation ID of the NF_C in the subscription request NF_A may also additionally include the notification endpoint and a Notification Correlation ID of NF A associated with subscription change related Event IDs eg Subscription Correlation ID Change in the subscription request so that NF_A can receive the notification of the subscription change related event The NF_A may add Binding Indication see clause 6310 in the subscribe request Figure 712-3 Subscribe-Notify NF Service illustration 2 Routing of the messages for the NF interaction mechanisms above may be direct as shown in the figures 712-1 to 712-3 or indirect In the case of Indirect Communication an SCP is employed by the NF service consumer The SCP routes messages between NF service consumers and NF service producers based on the Routing Binding Indication if available and may do discovery and associated selection of the NF service producer on behalf of a NF service consumer Figure 712-4 shows the principle for a request-response interaction and figure 712-5 shows an example of a subscribe-notify interaction Figure 712-4 Request response using Indirect Communication Figure 712-5 Subscribe-Notify using Indirect Communication NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1920",
    "document_id": "23501-i80",
    "chunk_id": 1920,
    "text": "The subscribe request and notify request can be routed by different SCPs 713 Network Function Service discovery A Control Plane Network function NF within the 5G Core network may expose its capabilities as services via its service based interface which can be re-used by Control Plane CN NFs The NF service discovery enables a CN NF or SCP to discover NF instances that provide the expected NF services The NF service discovery is implemented via the NF discovery functionality For more detail NF discovery refer to clause 631 714 Network Function Service Authorization NF service authorization shall ensure the NF Service Consumer is authorized to access the NF service provided by the NF Service Provider according to eg the policy of NF the policy from the serving operator the inter-operator agreement Service authorization information shall be configured as one of the components in NF profile of the NF Service Producer",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1921",
    "document_id": "23501-i80",
    "chunk_id": 1921,
    "text": "It shall include the NF type s and NF realmsorigins allowed to consume NF Services of NF Service Producer Due to roaming agreements and operator policies a NF Service Consumer shall be authorised based on UEsubscriberroaming information and NF type the Service authorization may entail two steps - Check whether the NF Service Consumer is permitted to discover the requested NF Service Producer instance during the NF service discovery procedure This is performed on a per NF granularity by NRF NOTE 1 When NF discovery is performed based on local configuration it is assumed that locally configured NFs are authorized - Check whether the NF Service Consumer is permitted to access the requested NF Service Producer for consuming the NF service with a request type granularity This is performed on a per UE subscription or roaming agreements granularity This type of NF Service authorization shall be embedded in the related NF service logic NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1922",
    "document_id": "23501-i80",
    "chunk_id": 1922,
    "text": "The security of the connection between NF Service Consumer and NF Service Producer is specified in TS 33501 29 NOTE 3 It is expected that an NF authorization framework exists in order to perform consumer NF authorization considering UE subscription or roaming agreements granularity This authorization is assumed to be performed without configuration of the NRF regarding UE subscription or roaming information 715 Network Function and Network Function Service registration and de-registration For the NRF to properly maintain the information of available NF instances and their supported services each NF instance informs the NRF of the list of NF services that it supports NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1923",
    "document_id": "23501-i80",
    "chunk_id": 1923,
    "text": "The NF informs the appropriate NRF based on configuration The NF instance may make this information available to NRF when the NF instance becomes operative for the first time registration operation or upon individual NF service instance activationde-activation within the NF instance update operation eg triggered after a scaling operation The NF instance while registering the list of NF services it supports for each NF service may provide a notification endpoint information for each type of notification service that the NF service is prepared to consume to the NRF during the NF instance registration The NF instance may also update or delete the NF service related parameters eg to delete the notification endpoint information Alternatively another authorised entity such as an OAM function may inform the NRF on behalf of an NF instance triggered by an NF service instance lifecycle event register or de-registration operation depending on instance instantiation termination activation or de-activation Registration with the NRF includes capacity and configuration information at time of instantiation The NF instance may also de-registers from the NRF when it is about to gracefully shut down or disconnect from the network in a controlled way If an NF instance become unavailable or unreachable due to unplanned errors eg NF crashes or there are network issues an authorised entity shall de-register the NF instance with the NRF 72 Network Function Services 721 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1924",
    "document_id": "23501-i80",
    "chunk_id": 1924,
    "text": "In the context of this specification an NF service is offering a capability to authorised consumers Network Functions may offer different capabilities and thus different NF services to distinct consumers Each of the NF services offered by a Network Function shall be self-contained reusable and use management schemes independently of other NF services offered by the same Network Function eg for scaling healing etc The discovery of the NF instance and NF service instance is specified in clause 631 NOTE 1 There can be dependencies between NF services within the same Network Function due to sharing some common resources eg context data This does not preclude that NF services offered by a single Network Function are managed independently of each other Figure 721-1 Network Function and NF Service",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1925",
    "document_id": "23501-i80",
    "chunk_id": 1925,
    "text": "Each NF service shall be accessible by means of an interface An interface may consist of one or several operations Figure 721-2 Network Function NF Service and NF Service Operation System procedures as specified in TS 23502 3 can be built by invocation of a number of NF services The following figure shows an illustrative example on how a procedure can be built it is not expected that system procedures depict the details of the NF Services within each Network Function Figure 721-3 System Procedures and NF Services NOTE 2 The SCP can be used for indirect communication between NFNF service instances For simplicity the SCP is not shown in the procedure The following clauses provide for each NF the NF services it exposes through its service based interfaces 722 AMF Services The following NF services are specified for AMF Table 722-1 NF Services provided by AMF 723 SMF Services The following NF services are specified for SMF Table 723-1 NF Services provided by SMF 724 PCF Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1926",
    "document_id": "23501-i80",
    "chunk_id": 1926,
    "text": "The following NF services are specified for PCF Table 724-1 NF Services provided by PCF 725 UDM Services The following NF services are specified for UDM Table 725-1 NF Services provided by UDM 726 NRF Services The following NF services are specified for NRF Table 726-1 NF Services provided by NRF 727 AUSF Services The following NF services are specified for AUSF Table 727-1 NF Services provided by AUSF 728 NEF Services The following NF services are specified for NEF Table 728-1 NF Services provided by NEF 728A Void 729 SMSF Services The following NF services are specified for SMSF Table 729-1 NF Services provided by SMSF 7210 UDR Services The following NF services are specified for UDR Table 7210-1 NF Services provided by UDR 7211 5G-EIR Services The following NF services are specified for 5G-EIR Table 7211-1 NF Services provided by 5G-EIR 7212 NWDAF Services The following NF services are specified for NWDAF Table 7212-1 NF Services provided by NWDAF 7213 UDSF Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1927",
    "document_id": "23501-i80",
    "chunk_id": 1927,
    "text": "The following NF services are specified for UDSF Table 7213-1 NF Services provided by UDSF 7214 NSSF Services The following NF services are specified for NSSF Table 7214-1 NF Services provided by NSSF 7215 BSF Services The following NF services are specified for BSF as described in TS 23503 45 Table 7215-1 NF Services provided by BSF 7216 LMF Services The following NF services are specified for LMF Table 7216-1 NF Services provided by LMF 7216A GMLC Services The following NF services are specified for GMLC Table 7216A-1 NF Services provided by GMLC 7217 CHF Services The following NF services for spending limits and charging are specified for CHF Table 7217-1 NF Services provided by CHF 7218 UCMF Services The following NF services are specified for UCMF Table 7218-1 NF Services provided by UCMF 7219 AF Services The following NF services are specified for AF Table 7219-1 NF Services provided by AF 7220 NSSAAF Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1928",
    "document_id": "23501-i80",
    "chunk_id": 1928,
    "text": "The following NF services are specified for NSSAAF Table 7220 -1 NF Services provided by NSSAAF 7221 DCCF Services The following NF services are specified for DCCF Table 7221-1 NF Services provided by DCCF 7222 MFAF Services The following NF services are specified for MFAF Table 7222-1 NF Services provided by MFAF 7223 ADRF Services The following NF services are specified for ADRF Table 7223-1 NF Services provided by ADRF 7224 5G DDNMF Services The 5G DDNMF supports the N5g-ddnmf service defined in clause 71 of TS 23304 128 7225 EASDF Services The following NF services are specified for EASDF Table 7225-1 NF Services provided by EASDF 7226 TSCTSF Services The following NF services are specified for TSCTSF Table 7226-1 NF Services provided by TSCTSF 7227 NSACF Services The following NF services are specified for NSACF Table 7227-1 NF Services provided by NSACF 7228 MB-SMF Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1929",
    "document_id": "23501-i80",
    "chunk_id": 1929,
    "text": "The following NF service is specified for MB-SMF Table 7228-1 NF Services provided by MB-SMF 7229 UPF Services The following NF service is specified for UPF Table 7229-1 NF Services provided by UPF 73 Exposure Network exposure is described in clauses 520 520d and in clause 415 of TS 23502 3 8 Control and User Plane Protocol Stacks 81 General Clause 8 specifies the overall protocol stacks between 5GS entities eg between the UE and the 5GC Network Functions between the 5G-AN and the 5GC Network Functions or between the 5GC Network Functions 82 Control Plane Protocol Stacks 821 Control Plane Protocol Stacks between the 5G-AN and the 5G Core N2 8211 General NOTE 1 N2 maps to NG-C as defined in TS 38413 34",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1930",
    "document_id": "23501-i80",
    "chunk_id": 1930,
    "text": "Following procedures are defined over N2 - Procedures related with N2 Interface Management and that are not related to an individual UE such as for Configuration or Reset of the N2 interface These procedures are intended to be applicable to any access but may correspond to messages that carry some information only on some access such as information on the default Paging DRX used only for 3GPP access - Procedures related with an individual UE - Procedures related with NAS Transport",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1931",
    "document_id": "23501-i80",
    "chunk_id": 1931,
    "text": "These procedures are intended to be applicable to any access but may correspond to messages that for UL NAS transport carry some access dependent information such as User Location Information eg Cell-Id over 3GPP access or other kind of User Location Information for Non-3GPP access - Procedures related with UE context management These procedures are intended to be applicable to any access The corresponding messages may carry - some information only on some access such as Mobility Restriction List used only for 3GPP access - some information related eg with N3 addressing and with QoS requirements that is to be transparently forwarded by AMF between the 5G-AN and the SMF - Procedures related with resources for PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1932",
    "document_id": "23501-i80",
    "chunk_id": 1932,
    "text": "These procedures are intended to be applicable to any access They may correspond to messages that carry information related eg with N3 addressing and with QoS requirements that is to be transparently forwarded by AMF between the 5G-AN and the SMF - Procedures related with Hand-Over management These procedures are intended for 3GPP access only The Control Plane interface between the 5G-AN and the 5G Core supports - The connection of multiple different kinds of 5G-AN eg 3GPP RAN N3IWF for Un-trusted access to 5GC to the 5GC via a unique Control Plane protocol A single NGAP protocol is used for both the 3GPP access and non-3GPP access - There is a unique N2 termination point in AMF per access for a given UE regardless of the number possibly zero of PDU Sessions of the UE - The decoupling between AMF and other functions such as SMF that may need to control the services supported by 5G-ANs eg control of the UP resources in the 5G-AN for a PDU Session For this purpose NGAP may support information that the AMF is just responsible to relay between the 5G-AN and the SMF The information can be referred as N2 SM information in TS 23502 3 and this specification NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1933",
    "document_id": "23501-i80",
    "chunk_id": 1933,
    "text": "The N2 SM information is exchanged between the SMF and the 5G-AN transparently to the AMF 8212 5G-AN - AMF Legend - NG Application Protocol NG-AP Application Layer Protocol between the 5G-AN node and the AMF NG-AP is defined in TS 38413 34 - Stream Control Transmission Protocol SCTP This protocol guarantees delivery of signalling messages between AMF and 5G-AN node N2 SCTP is defined in RFC 4960 44 Figure 8212-1 Control Plane between the 5G-AN and the AMF 8213 5G-AN - SMF Legend - N2 SM information This is the subset of NG-AP information that the AMF transparently relays between the 5G-AN and the SMF and is included in the NG-AP messages and the N11 related messages Figure 8213-1 Control Plane between the 5G-AN and the SMF NOTE 1 From the 5G-AN perspective there is a single termination of N2 ie the AMF NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1934",
    "document_id": "23501-i80",
    "chunk_id": 1934,
    "text": "For the protocol stack between the AMF and the SMF see clause 823 822 Control Plane Protocol Stacks between the UE and the 5GC 8221 General A single N1 NAS signalling connection is used for each access to which the UE is connected The single N1 termination point is located in AMF The single N1 NAS signalling connection is used for both Registration Management and Connection Management RMCM and for SM-related messages and procedures for a UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1935",
    "document_id": "23501-i80",
    "chunk_id": 1935,
    "text": "The NAS protocol on N1 comprises a NAS-MM and a NAS-SM components There are multiple cases of protocols between the UE and a core network function excluding the AMF that need to be transported over N1 via NAS-MM protocol Such cases include - Session Management Signalling - SMS - UE Policy - LCS RMCM NAS messages in NAS-MM and other types of NAS messages eg SM as well as the corresponding procedures are decoupled The NAS-MM supports generic capabilities - NAS procedures that terminate at the AMF This includes - Handles Registration Management and Connection Management state machines and procedures with the UE including NAS transport the AMF supports following capabilities - Decide whether to accept the RMCM part of N1 signalling during the RMCM procedures without considering possibly combined other non NAS-MM messages eg SM in the same NAS signalling contents - Know",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1936",
    "document_id": "23501-i80",
    "chunk_id": 1936,
    "text": "if one NAS message should be routed to another NF eg SMF or locally processed with the NAS routing capabilities inside during the RMCM procedures - Provide a secure NAS signalling connection integrity protection ciphering between the UE and the AMF including for the transport of payload - Provide access control if it applies - It is possible to transmit the other type of NAS message eg NAS SM together with an RMCM NAS message by supporting NAS transport of different types of payload or messages that do not terminate at the AMF ie NAS-SM SMS UE Policy and LCS between the UE and the AMF This includes - Information about the Payload type - Additional Information for forwarding purposes - The Payload eg the SM message in the case of SM signalling - There is a Single NAS protocol that applies on both 3GPP and non-3GPP access When an UE is served by a single AMF while the UE is connected over multiple 3GPPNon 3GPP accesses there is a N1 NAS signalling connection per access Security of the NAS messages is provided based on the security context established between the UE and the AMF Figure 8221-1 depicts NAS transport of SM signalling SMS UE Policy and LCS Figure 8221-1 NAS transport for SM SMS UE Policy and LCS 8222 UE - AMF Legend - NAS-MM",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1937",
    "document_id": "23501-i80",
    "chunk_id": 1937,
    "text": "The NAS protocol for MM functionality supports registration management functionality connection management functionality and user plane connection activation and deactivation It is also responsible of ciphering and integrity protection of NAS signalling 5G NAS protocol is defined in TS 24501 47 - 5G-AN Protocol layer This set of protocolslayers depends on the 5G-AN In the case of NG-RAN the radio protocol between the UE and the NG-RAN node eNodeB or gNodeB is specified in TS 36300 30 and TS 38300 27 In the case of non-3GPP access see clause 824 Figure 8222-1 Control Plane between the UE and",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1938",
    "document_id": "23501-i80",
    "chunk_id": 1938,
    "text": "the AMF 8223 UE SMF The NAS-SM supports the handling of Session Management between the UE and the SMF The SM signalling message is handled ie created and processed in the NAS-SM layer of UE and the SMF The content of the SM signalling message is not interpreted by the AMF The NAS-MM layer handles the SM signalling is as follows - For transmission of SM signalling - The NAS-MM layer creates a NAS-MM message including security header indicating NAS transport of SM signalling additional information for the receiving NAS-MM to derive how and where to forward the SM signalling message - For reception of SM signalling - The receiving NAS-MM processes the NAS-MM part of the message ie performs integrity check and interprets the additional information to derive how and where to derive the SM signalling message The SM message part shall include the PDU Session ID Legend - NAS-SM The NAS protocol for SM functionality supports user plane PDU Session Establishment modification and release It is transferred via the AMF and transparent to the AMF 5G NAS protocol is defined in TS 24501 47 Figure 8223-1 Control Plane protocol stack between the UE and the SMF 823 Control Plane Protocol Stacks between the network functions in 5GC 8231 The Control Plane Protocol Stack for the service based interface",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1939",
    "document_id": "23501-i80",
    "chunk_id": 1939,
    "text": "The control plane protocols for the service-based interfaces listed in clause 426 is defined in the TS 29500 49 8232 The Control Plane protocol stack for the N4 interface between SMF and UPF The control plane protocol for SMF-UPF ie N4 reference point is defined in TS 29244 65 824 Control Plane for untrusted non 3GPP Access Figure 824-1 Control Plane before the signalling IPsec SA is established between UE and N3IWF Figure 824-2 Control Plane after the signalling IPsec SA is established between UE and N3IWF Large NAS messages may be fragmented by the inner IP layer or by TCP Figure 824-3 Control Plane for establishment of user-plane via N3IWF In the above figures 824-1 824-2 and 824-3 the UDP protocol may be used between the UE and N3IWF to enable NAT traversal for IKEv2 and IPsec traffic The signalling IPsec SA is defined in clause 4122 of TS 23502 3 825 Control Plane for trusted non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1940",
    "document_id": "23501-i80",
    "chunk_id": 1940,
    "text": "Access Figure 825-1 Control Plane before the NWt connection is established between UE and TNGF Figure 825-2 Control Plane after the NWt connection is established between UE and TNGF Large NAS messages may be fragmented by the inner IP layer or by TCP Figure 825-3 Control Plane for establishment of user-plane via TNGF In the above figures 825-2 and 825-3 the UDP protocol may be used between the UE and TNGF to enable NAT traversal for IKEv2 and IPsec traffic The NWt connection is defined in clause 4283 and in clause 412a22 of TS 23502 3 826 Control Plane for W-5GAN Access The control plane for W-5GAN is defined in clause 6 of TS 23316 84 827 Control Plane for Trusted WLAN Access for N5CW Device Figure 827-1 Control Plane for trusted WLAN access for N5CW device The EAP protocol applies only for performing EAP-based access authentication procedure to connect to a trusted WLAN access network 83 User Plane Protocol Stacks 831 User Plane Protocol Stack for a PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1941",
    "document_id": "23501-i80",
    "chunk_id": 1941,
    "text": "This clause illustrates the protocol stack for the User plane transport related with a PDU Session Legend - PDU layer This layer corresponds to the PDU carried between the UE and the DN over the PDU Session When the PDU Session Type is IPv4 or IPv6 or IPv4v6 it corresponds to IPv4 packets or IPv6 packets or both of them When the PDU Session Type is Ethernet it corresponds to Ethernet frames etc - GPRS Tunnelling Protocol for the user plane GTP-U This protocol supports tunnelling user data over N3 ie between the 5G-AN node and the UPF and N9 ie between different UPFs of the 5GC in the backbone network details see TS 29281 75 GTP shall encapsulate all end user PDUs It provides encapsulation on a per PDU Session level This layer carries also the marking associated with a QoS Flow defined in clause 57 This protocol is also used on N4 interface as defined in TS 29244 65",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1942",
    "document_id": "23501-i80",
    "chunk_id": 1942,
    "text": "Figure 831-1 User Plane Protocol Stack - 5G-AN protocol stack This set of protocolslayers depends on the AN - When the 5G-AN is a 3GPP NG-RAN these protocolslayers are defined in TS 38401 42 The radio protocol between the UE and the 5G-AN node eNodeB or gNodeB is specified in TS 36300 30 and TS 38300 27 - When the AN is an Untrusted non 3GPP access to 5GC the 5G-AN interfaces with the 5GC at a N3IWF defined in clause 432 and the 5G-AN protocol stack is defined in clause 832 - UDPIP These are the backbone network protocols NOTE 1 The number of UPF in the data path is not constrained by 3GPP specifications there may be in the data path of a PDU Session 0 1 or multiple UPF that do not support a PDU Session Anchor functionality for this PDU Session NOTE 2 The non PDU Session Anchor UPF depicted in the Figure 831-1 is optional NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1943",
    "document_id": "23501-i80",
    "chunk_id": 1943,
    "text": "The N9 interface may be intra-PLMN or inter PLMN in the case of Home Routed deployment If there is an UL CL Uplink Classifier or a Branching Point both defined in clause 564 in the data path of a PDU Session the UL CL or Branching Point acts as the non PDU Session Anchor UPF of Figure 831-1 In that case there are multiple N9 interfaces branching out of the UL CL Branching Point each leading to different PDU Session anchors NOTE 4 Co-location of the UL CL or Branching Point with a PDU Session Anchor is a deployment option 832 User Plane for untrusted non-3GPP Access Figure 832-1 User Plane via N3IWF Large GRE packets may be fragmented by the inner IP layer Details about the PDU Layer the N3 stack and the N9 stack are included in clause 831 The UDP protocol may be used below the IPsec layer to enable NAT traversal 833 User Plane for trusted non-3GPP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1944",
    "document_id": "23501-i80",
    "chunk_id": 1944,
    "text": "Access Figure 833-1 User Plane via TNGF Large GRE packets may be fragmented by the inner IP layer Details about the PDU Layer the N3 stack and the N9 stack are included in clause 831 The UDP protocol may be used below the IPsec layer to enable NAT traversal 834 User Plane for W-5GAN Access The user plane for W-5GAN is defined in clause 6 of TS 23316 84 835 User Plane for N19-based forwarding of a 5G VN group Figure 835-1 User Plane for N19-based forwarding Details about the PDU Layer PDU Session User Plane Protocol Stack are included in clause 831 and clause 832",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1945",
    "document_id": "23501-i80",
    "chunk_id": 1945,
    "text": "The N19 is based on a shared User Plane tunnel connecting two PSA UPFs of a single 5G VN group 836 User Plane for Trusted WLAN Access for N5CW Device Legend - Transport this layer refers to the transport of PDUs between the N5CW device and TWIF see clause 42854 In this Release of the specification Trusted WLAN Access for N5CW Device only supports IP PDU Session type Figure 828-1 User Plane for trusted WLAN access for N5CW device Annex A informative Relationship between Service-Based Interfaces and Reference Points Service-Based Interfaces and Reference Points are two different ways to model interactions between architectural entities A Reference Point is a conceptual point at the conjunction of two non-overlapping functional groups see TR 21905 1 In figure A-1 the functional groups are equivalent to Network Functions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1946",
    "document_id": "23501-i80",
    "chunk_id": 1946,
    "text": "A reference point can be replaced by one or more service-based interfaces which provide equivalent functionality Figure A-1 Example show a Reference Point replaced by two Service based Interfaces Figure A-2 Example showing a Reference Point replaced by a single Service based Interface Reference points exist between two specific Network Functions Even if the functionality is equal on two reference points between different Network Functions there has to be a different reference point name Using the service-based interface representation it is immediately visible that it is the same service-based interface and that the functionality is equal on each interface Figure A-3 Reference Points vs Service-based Interfaces representation of equal functionality on the interfaces A NF may expose one or more services through Service based interfaces Figure A-4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1947",
    "document_id": "23501-i80",
    "chunk_id": 1947,
    "text": "One or more Services exposed by one Network Function Annex B normative Mapping between temporary identities When interworking procedures with N26 are used and the UE performs idle mode mobility from 5GC to EPC the following mapping from 5G GUTI to EPS GUTI applies - 5G MCC maps to EPS MCC - 5G MNC maps to EPS MNC - 5G AMF Region ID and 5G AMF Set ID maps to EPS MMEGI and part of EPS MMEC - 5G AMF Pointer map to part of EPS MMEC - 5G 5G-TMSI maps to EPS M-TMSI NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1948",
    "document_id": "23501-i80",
    "chunk_id": 1948,
    "text": "The mapping described above does not necessarily imply the same size for the 5G GUTI and EPS GUTI fields that are mapped The size of 5G GUTI fields and other mapping details will be defined in TS 23003 19 NOTE 2 To support interworking with the legacy EPC core network entity ie when MME is not updated to support interworking with 5GS it is assumed that the 5G AMF Region ID and EPS MMEGI is partitioned to avoid overlapping values in order to enable discovery of source node ie MME or AMF without ambiguity Once the EPS in the PLMN has been updated to support interworking with 5GS the full address space of the AMF Region ID can be used for 5GS Annex C informative Guidelines and Principles for Compute-Storage Separation 5G System Architecture allows any NFNF Service to store and retrieve its unstructured data eg UE contexts intofrom a Storage entity eg UDSF as stated in clause 425 in this release of the specification This clause highlights some assumptions principles regarding NFNF services that use this Storage entity for storing unstructured data 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1949",
    "document_id": "23501-i80",
    "chunk_id": 1949,
    "text": "It is up to the Network Function implementation to determine whether the Storage entity is used as a Primary Storage in which case the corresponding context stored within the NFNF Service is deleted after storage in the Storage entity or the Storage entity is used as a Secondary Storage in which case the corresponding context within the NFNF Service is stored 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1950",
    "document_id": "23501-i80",
    "chunk_id": 1950,
    "text": "It is up to the NFNF Service implementation to determine the trigger eg at the end of Registration procedure Service Request procedure etc for storing unstructured data eg UE contexts in the Storage entity but it is a good practice for NFNF service to store stable state in the Storage entity 3 Multiple NFNF service instances may require to access the same stored data in the Storage entity eg UE context around the same time then the resolution the race condition is implementation specific 4 All NFs within the same NF Set are assumed to have access to the same unstructured data stored within the Storage entity 5 AMF planned removal with UDSF clause 521221 and AMF auto-recovery with UDSF option in clause 52123 assume that a storage entityUDSF is used either as a primary storage or secondary storage by the AMF for storing UE contexts 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1951",
    "document_id": "23501-i80",
    "chunk_id": 1951,
    "text": "It is up to implementation of the Storage entity to make sure that only NFs that are authorized for a certain data record can access this data record Annex D informative 5GS support for Non-Public Network deployment options D1 Introduction This annex provides guidance on how 5GS features and capabilities can be used to support various Non-Public Network deployment options Overlay network When UE is accessing SNPN service via NWu using user plane established in PLMN SNPN is the overlay network When UE is accessing PLMN services via NWu using user plane established in SNPN PLMN is the overlay network Underlay network When UE is accessing SNPN service via NWu using user plane established in PLMN PLMN is the underlay network When UE is accessing PLMN services via NWu using user plane established in SNPN SNPN is the underlay network D2 Support of Non-Public Network as a network slice of a PLMN The PLMN operator can provide access to an NPN by using network slicing mechanisms NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1952",
    "document_id": "23501-i80",
    "chunk_id": 1952,
    "text": "Access to PLMN services can be supported in addition to PNI-NPN services eg based on different S-NSSAIDNN for different services The following are some considerations in such a PNI-NPN case 1 The UE has subscription and credentials for the PLMN 2 The PLMN and NPN service provider have an agreement of where the NPN Network Slice is to be deployed ie in which TAs of the PLMN and optionally including support for roaming PLMNs 3 The PLMN subscription includes support for Subscribed S-NSSAI to be used for the NPN see clause 5153 4 The PLMN operator can offer possibilities for the NPN service provider to manage the NPN Network Slice according to TS 28533 79 5 When the UE registers the first time to the PLMN the PLMN can configure the UE with URSP including NSSP associating Applications to the NPN S-NSSAI if the UE also is able to access other PLMN services 6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1953",
    "document_id": "23501-i80",
    "chunk_id": 1953,
    "text": "The PLMN can configure the UE with Configured NSSAI for the Serving PLMN see clause 5154 7 The PLMN and NPN can perform a Network Slice specific authentication and authorization using additional NPN credentials 8 The UE follows the logic as defined for Network Slicing see clause 515 9 The network selection logic access control etc are following the principles for PLMN selection and 10 The PLMN may indicate to the UE that the NPN S-NSSAI is rejected for the RA when the UE moves out of the coverage of the NPN Network Slice However limiting the availability of the NPN S-NSSAI would imply that the NPN is not available outside of the area agreed for the NPN S-NSSAI eg resulting in the NPN PDU Sessions being terminated when the UE moves out of the coverage of the NPN Network Slice Similarly access to NPN DNNs would not be available via non-NPN cells 11",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1954",
    "document_id": "23501-i80",
    "chunk_id": 1954,
    "text": "In order to prevent access to NPNs for authorized UEs in the case of network congestionoverload and if a dedicated S-NSSAI has been allocated for an NPN the Unified Access Control can be used using the operator-defined access categories with access category criteria type as defined in TS 24501 47 set to the S-NSSAI used for an NPN 12 If NPN isolation is desired it is assumed that a dedicated S-NSSAI is configured for the NPN and that the UE is configured to operate in Access Stratum Connection Establishment NSSAI Inclusion Mode a b or c see clause 5159 such that NG-RAN receives Requested NSSAI from the UE and it can use the S-NSSAI for AMF selection D3 Support for access to PLMN services via Stand-alone Non-Public Network and access to Stand-alone Non Public Network services via PLMN Figure D3-1 Access to PLMN services via Stand-alone Non-Public Network NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1955",
    "document_id": "23501-i80",
    "chunk_id": 1955,
    "text": "The reference architecture in Figure D3-1 and Figure D3-2 only shows the network functions directly connected to the UPF or N3IWF and other parts of the architecture are same as defined in clause 42 In order to obtain access to PLMN services when the UE is camping in NG-RAN of Stand-alone Non-Public Network the UE obtains IP connectivity discovers and establishes connectivity to an N3IWF in the PLMN In the Figure D3-1 the N1 for NPN represents the reference point between UE and the AMF in Stand-alone Non-Public Network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1956",
    "document_id": "23501-i80",
    "chunk_id": 1956,
    "text": "The NWu for PLMN represents the reference point between the UE and the N3IWF in the PLMN for establishing secure tunnel between UE and the N3IWF over the Stand-alone Non-Public Network N1 for PLMN represents the reference point between UE and the AMF in PLMN Figure D3-2 Access to Stand-alone Non-Public Network services via PLMN In order to obtain access to Non-Public Network services when the UE is camping in NG-RAN of a PLMN the UE obtains IP connectivity discovers and establishes connectivity to an N3IWF in the Stand-alone Non-Public Network",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1957",
    "document_id": "23501-i80",
    "chunk_id": 1957,
    "text": "In Figure D3-2 the N1 for PLMN represents the reference point between UE and the AMF in the PLMN The NWu for NPN represents the reference point between the UE and the N3IWF in the stand-alone Non-Public Network for establishing a secure tunnel between UE and the N3IWF over the PLMN The N1 for NPN represents the reference point between UE and the AMF in NPN When using the mechanism described above to access overlay network via underlay network the overlay network can act as authorized 3rd party with AF to interact with NEF in the underlay network to use the existing network exposure capabilities provided by the underlay network defined in clause 415 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1958",
    "document_id": "23501-i80",
    "chunk_id": 1958,
    "text": "This interaction is subject of agreements between the overlay and the underlay network D4 Support for UE capable of simultaneously connecting to an SNPN and a PLMN When a UE capable of simultaneously connecting to an SNPN and a PLMN and the UE is not set to operate in SNPN access mode for any of the UuYtNWu interfaces the UE only performs PLMN selection procedures using the corresponding interface for connection to the PLMN A UE supporting simultaneous connectivity to an SNPN and a PLMN applies the network selection as applicable for the access and network for SNPN and PLMN respectively Whether the UE uses SNPN or PLMN for its services is implementation dependent A UE supporting simultaneous connectivity to an SNPN and a PLMN applies the cell re-selection as applicable for the access and network for SNPN and PLMN respectively Whether the UE uses SNPN or PLMN for its services is implementation dependent D5 Support for keeping UE in CM-CONNECTED state in overlay network when accessing services via NWu When UE is accessing the overlay network via the underlay network as described in clause D3 it is possible to keep the UE in CM-CONNECTED state in the overlay network - UE maintains at least one PDU Session in underlay network from where the N3IWF of the overlay network is reachable via the DN of the PDU Session in underlay network In this case the UE is considered as successfully connected to the non-3GPP access of the overlay network thus UE always attempts to transit to CM-CONNECTED state from CM-IDLE as described in NOTE 3 in clause 552 - IKEv2 liveness check procedure initiated either by UE or N3IWF as defined in clause 78 and clause 79 of TS 24502 48 can be utilized to ensure the signalling connection between UE and N3IWF is still valid when UE stays in CM-CONNECTED state Adjusting the time interval of the liveness check to avoid the deletion of the IKEv2 SA due to inactivity on both endpoints of the SA - If NAT is used so as to avoid a timeout of the NAT entries between the UPF in the underlay network and the N3IWF in the overlay network NAT-Traversal mechanisms described in RFC 7296 60 and NAT-Keepalive described in RFC 3948 138 are recommended - AMF in overlay network keeps the UE in CM-CONNECTED state unless UE or N3IWF triggers the release - The NG-RAN node in the underlay network can use the existing information to decide an appropriate RRC state for the UE eg whether release a UE to RRC_INACTIVE D6 Support for sessionservice continuity between SNPN and PLMN when using N3IWF Depending on the UEs radio capability and implementation the following existing mechanisms can be used to allow sessionservice continuity between SNPN and PLMN -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1959",
    "document_id": "23501-i80",
    "chunk_id": 1959,
    "text": "For Single Radio UE which includes single RxTx and dual Rxsingle Tx UE seamless service continuity is not supported in this release when the UE is moving between the 3GPP access networks of SNPN and PLMN because of the single radio limitation But the PDU session continuity between SNPN and PLMN can be realized by utilizing the existing handover procedure between non-3GPP access and 3GPP access as defined in clause 492 of TS 23502 3 where one network is acting as non-3GPP access of the other network - For Dual Radio Dual RxDual Tx UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1960",
    "document_id": "23501-i80",
    "chunk_id": 1960,
    "text": "the service continuity can be achieved by utilizing the existing handover procedure between non-3GPP access and 3GPP access for PDU session on a single access and the existing user plane resource addition procedure for MA PDU session where one network is acting as non-3GPP access of the other network - For PDU session on a single access UE can register to the same 5GC via both Uu and NWu interfaces from two networks when it is possible by following the procedure defined in clause 422 of TS 23502 3 if the registration is via Uu or in clause 4122 of TS 23502 3 if the registration is via NWu",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1961",
    "document_id": "23501-i80",
    "chunk_id": 1961,
    "text": "The registration via NWu utilizes the user plane which is established in another 5GC using another networks Uu interface For example if UE is moving out of its SNPN 3GPP access coverage and would like to continue its SNPN service in PLMN UE can register to its SNPN 5GC via PLMNs 3GPP access network using NWu interface with SNPNs 5GC before moving out SNPN NG-RAN coverage Upon mobility the existing handover procedure between non-3GPP access and 3GPP access defined in clause 492 of TS 23502 3 can be utilized -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1962",
    "document_id": "23501-i80",
    "chunk_id": 1962,
    "text": "For MA PDU session if supported by UE and network UE can register to the same 5GC via Uu and NWu interfaces and establish MA PDU session with ATSSS support to be anchored in the 5GC as defined in clause 42222 of TS 23502 3 where one network is acting as non-3GPP access of the other network Figure D6-1 shows the example of UE with MA PDU session anchored in SNPN UPF when connected to SNPN via Uu and NWu interfaces Upon mobility UE can addactivate the user plane resource to the corresponding access type basing on the procedures defined in clause 4227 of TS 23502 3 Figure D6-1 MA PDU session with ATSSS support for dual radio UE accessing to Stand-alone Non-Public Network services via Uu and NWu interfaces D7 Guidance for underlay network to support QoS differentiation for User Plane IPsec Child SA D71 Network initiated QoS When UE is accessing an overlay network via an underlay network as described in clause D3 in order to ensure the underlay network to support the QoS required by the overlay network User Plane IPsec Child SA the QoS differentiation mechanism based on network-initiated QoS modification as described in clause 53027 and clause 53028 can be used with the following considerations - An overlay network service can have specific QoS requirement that needs to be fulfilled by the underlay network based on SLA between the two networks - The SLA covers selective services of the overlay network which require QoS support in underlay network The rest of the overlay network traffic could be handled in best efforts basis by underlay network - The SLA between the overlay network and the underlay network includes a mapping between DSCP values of the User Plane IPsec Child SAs and the QoS requirement of the overlay network services The QoS requirement includes the QoS parameters described in clause 572 that are necessary eg 5QI ARP etc during the network-initiated QoS modification in underlay network In order to facilitate the SLA a guidance for details of the mapping between DSCP values of the User Plane IPSec Child SAs and QoS requirement of the overlay network services is described of TS 29513 133",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1963",
    "document_id": "23501-i80",
    "chunk_id": 1963,
    "text": "The SLA also includes the N3IWF IP address of the overlay network - The mapping agreed in SLA is configured at N3IWF of the overlay network and at the SMFPCF of the underlay network If a dedicated DNNS-NSSAI is used in the underlay network for providing access to the N3IWF in the overlay network the SMFPCF in the underlay network can be configured to enable packet detection based on N3IWF IP address and DSCP value for PDU sessions associated with the dedicated DNNS-NSSAI - When UE establishes a PDU Session in underlay network the PCF in the underlay network determines PCC rules based on UE subscription information and local configuration which takes into account the SLA described above and installs the PCC rules on the SMF which generates and installs PDRURR on UPF The PCC rules indicate N3IWF IP address and the DSCP values of the User Plane IPsec Child SAs of the overlay network which require QoS differentiation by the underlay network So the UPF in the underlay network can detect packets of the User Plane IPsec Child SAs corresponding to the overlay network services which require QoS support by the underlay network - UE registers and establishes PDU Session in the overlay network via the User Plane connectivity established in the underlay network When UE is accessing a specific service of overlay network a QoS Flow can be created by the overlay network then N3IWF creates dedicated User Plane IPsec Child SA for each overlay network QoS Flow that requires underlay network QoS support - N3IWF uses the QoS profile and the Session-AMBR it receives from SMF in overlay network along with the mapping agreed in the SLA to derive a specific DSCP value for the User Plane IPsec Child SA N3IWF assigns a specific DSCP value only to one User Plane IPsec Child SA for a UE at the same time UE for UL and N3IWF for DL will set the DSCP marking in the outer IP header of the User Plane IPsec Child SA accordingly - The overlay network traffic between UE and N3IWF using the specific DSCP marking will be detected by the UPF in the underlay network based on previous installed PDRURR",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1964",
    "document_id": "23501-i80",
    "chunk_id": 1964,
    "text": "The SMFPCF in underlay network will be informed when the overlay network traffic is detected Then the PCF installs new PCC rules on the SMF including the QoS parameters for handling of packets corresponding to the specific User Plane IPsec Child SA based on the N3IWF IP address and the DSCP value of the User Plane IPsec Child SA and the SMF generates a QoS profile that triggers the PDU Session Modification procedure as described in clause 433 of TS 23502 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1965",
    "document_id": "23501-i80",
    "chunk_id": 1965,
    "text": "The QoS parameters are derived from the mapping agreed in SLA based on the detected DSCP value D72 UE initiated QoS When UE is accessing an overlay network via an underlay network as described in clause D3 if UE-initiated QoS modification in clause 53027 and clause 53028 is used the following principles can be considered to enable consistent QoS for User Plane IPsec Child SAs between the two networks - UE registers and establishes PDU Session in the overlay network via the User Plane connectivity established in the underlay network When UE is accessing a specific service of overlay network a QoS Flow in overlay network can be created according to clause 433 of TS 23502 3 UE receives the QoS Flow level QoS parameters eg 5QI GFBR MFBR as specified in TS 24501 47 from SMFPCF in overlay network for the QoS Flow which is created for the specific overlay network service - N3IWF in overlay network creates dedicated User Plane IPsec Child SA for each overlay network QoS Flow that requires underlay network QoS support -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1966",
    "document_id": "23501-i80",
    "chunk_id": 1966,
    "text": "In order to ensure the traffic of the overlay network service is handled with the desired QoS in underlay network UE can request new QoS Flow for the PDU session in the underlay network by PDU Session Modification procedure described in clause 433 of TS 23502 3 The requested QoS can be derived from the QoS Flow level QoS parameters which the UE has received from the overlay network The Packet Filter in the QoS rule of the request includes overlay network N3IWF IP address and SPI associated with the User Plane IPsec Child SA - SMF in the underlay network notifies the PCF that the UE has initiated resource modification after receiving the PDU Session Modification Request PCF in the underlay network determines if the request can be authorized based on UE subscription and local policy which can take into account the SLA between overlay network and underlay network If the request is authorized PCF generates new PCC rule and installs on SMF in order to create new QoS Flow in underlay network using the QoS Flow level QoS parameters from the overlay network The PDRFAR generated refers to the N3IWF IP address and the SPI provided by the UE in Traffic filter in PDU Session Modification request to enable filtering and mapping of DL traffic towards the right PDU SessionQoS Flow within the underlay network - If SLA exists it can include a mapping between the DSCP values of the User Plane IPsec Child SAs and the QoS requirement of the overlay network services The SLA is configured at N3IWF in overlay network and at SMFPCF in underlay network N3IWF can provide DSCP value to UE for the User Plane IPsec Child SA at PDU Session Establishment clause 4125 step 4a and 4c of TS 23502 3 UE can include the DSCP value as an addition in the Packet Filter by initiating the PDU Session Modification procedure in the underlay network PCF in the underlay network performs QoS authorization of UE QoS request considering the UE subscription and local configuration which takes into account the mapping in the SLA Details of the mapping between DSCP values of the User Plane IPSec Child SAs and QoS requirement of the overlay network services is described in TS 29513 133 Annex E informative Communication models for NFNF services interaction E1 General",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1967",
    "document_id": "23501-i80",
    "chunk_id": 1967,
    "text": "This annex provides a high level description of the different communication models that NF and NF services can use to interact which each other Table E1-1 summarizes the communication models their usage and how they relate to the usage of an SCP Table E1-1 Communication models for NFNF services interaction summary Model A - Direct communication without NRF interaction Neither NRF nor SCP are used Consumers are configured with producers NF profiles and directly communicate with a producer of their choice Model B - Direct communication with NRF interaction Consumers do discovery by querying the NRF Based on the discovery result the consumer does the selection The consumer sends the request to the selected producer Model C - Indirect communication without delegated discovery Consumers do discovery by querying the NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1968",
    "document_id": "23501-i80",
    "chunk_id": 1968,
    "text": "Based on discovery result the consumer does the selection of an NF Set or a specific NF instance of NF set The consumer sends the request to the SCP containing the address of the selected service producer pointing to a NF service instance or a set of NF service instances In the latter case the SCP selects an NF Service instance",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1969",
    "document_id": "23501-i80",
    "chunk_id": 1969,
    "text": "If possible the SCP interacts with NRF to get selection parameters such as location capacity etc The SCP routes the request to the selected NF service producer instance Model D - Indirect communication with delegated discovery Consumers do not do any discovery or selection The consumer adds any necessary discovery and selection parameters required to find a suitable producer to the service request The SCP uses the request address and the discovery and selection parameters in the request message to route the request to a suitable producer instance The SCP can perform discovery with an NRF and obtain a discovery result Figure E1-1 depicts the different communication models Figure E1-1 Communication models for NFNF services interaction Annex F informative Redundant user plane paths based on multiple UEs per device This clause describes an approach to realize multiple user plane paths in the system based on a device having multiple UEs and specific network deployments The approach assumes a RAN deployment where redundant coverage by multiple gNBs in the case of NR is generally available Upper layer protocols such as the IEEE 8021 TSN Time Sensitive Networking can make use of the multiple user plane paths The UEs belonging to the same terminal device request the establishment of PDU Sessions that use independent RAN and CN network resources using the mechanisms outlined below This deployment option has a number of preconditions - The redundancy framework uses separate gNBs to achieve user plane redundancy over the 3GPP system It is however up to operator deployment and configuration whether separate gNBs are available and used If separate gNBs are not available for a device the redundancy framework may still be applied to provide user plane redundancy in the rest of the network as well as between the device and the gNB using multiple UEs - Terminal devices integrate multiple UEs which can connect to different gNBs independently - RAN coverage is redundant in the target area it is possible to connect to multiple gNBs from the same location To ensure that the two UEs connect to different gNBs the gNBs need to operate such that the selection of gNBs can be distinct from each other eg gNB frequency allocation allows the UE to connect to multiple gNBs - The core network UPF deployment is aligned with RAN deployment and supports redundant user plane paths - The underlying transport topology is aligned with the RAN and UPF deployment and supports redundant user plane paths - The physical network topology and geographical distribution of functions also supports the redundant user plane paths to the extent deemed necessary by the operator - The operation of the redundant user plane paths is made sufficiently independent to the extent deemed necessary by the operator eg independent power supplies Figure F-1 illustrates the architecture view UE1 and UE2 are connected to gNB1 and gNB2 respectively and UE1 sets up a PDU Session via gNB1 to UPF1 while UE2 sets up a PDU Session via gNB2 to UPF2 UPF1 and UPF2 connect to the same Data Network DN but the traffic via UPF1 and UPF2 might be routed via different user plane nodes within the DN UPF1 and UPF2 are controlled by SMF1 and SMF2 respectively Figure F-1 Architecture with redundancy based on multiple UEs in the device The approach comprises the following main components shown as example using NR in figure F-2 - gNB selection The selection of different gNBs for the UEs in the same device is realized by the concept of UE Reliability Groups for the UEs and also for the cells of gNBs By grouping the UEs in the device and cells of gNBs in the network into more than one reliability group and preferably selecting cells in the same reliability group as the UE it is ensured that UEs in the same device can be assigned different gNBs for redundancy as illustrated in Figure F-2 where UE1 and the cells of gNB1 belong to reliability group A and UE2 and the cells of gNB2 belong to reliability group B Figure F-2 Reliability group-based redundancy concept in RAN For determining the reliability grouping of a UE one of the following methods or a combination of them can be used - It could be configured explicitly to the UE and sent in a Registration Request message to the network using an existing parameter such as an S-NSSAI in the Requested NSSAI where the SST is URLLC the Reliability Group can be decided by the SD part -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1970",
    "document_id": "23501-i80",
    "chunk_id": 1970,
    "text": "It could also be derived from existing system parameters eg SUPI PEI S-NSSAI RFSP based on operator configuration The Reliability Group of each UE is represented via existing parameters and sent from the AMF to the RAN when the RAN context is established so each gNB has knowledge about the reliability group of the connected UEs NOTE An example realisation can be as follows the UEs Allowed NSSAI can be used as input to select the RFSP index value for the UE The RAN node uses the RFSP for RRM purposes and can based on local configuration determine the UEs Reliability Group based on the S-NSSAI in Allowed NSSAI andor S-NSSAI for the PDU Sessions",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1971",
    "document_id": "23501-i80",
    "chunk_id": 1971,
    "text": "The reliability group of the RAN cells of gNBs entities are pre-configured by the OM system in RAN It is possible for gNBs to learn the reliability group neighbouring cells as the Xn connectivity is set up or the reliability group of neighbouring cells are also configured into the gNBs In the case of connected mode mobility the serving gNB prioritizes candidate target cells that belong to different reliability group than the UE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1972",
    "document_id": "23501-i80",
    "chunk_id": 1972,
    "text": "It follows that normally the UE is handed over only to cells in the same reliability group If cells in the same reliability group are not available UE is out of the coverage of cells of its own reliability group or link quality is below a given threshold the UE may be handed over to a cell in another reliability group as well If the UE connects to a cell whose reliability group is different from the UEs reliability group the gNB initiates a handover to a cell in the appropriate reliability group whenever such a suitable cell is available In the case of an Idle UE it is possible to use the existing cell re-selection priority mechanism with a priori UE config using dedicated signalling in the RRCConnectionRelease message during transition from connected to idle mode to configure the UE to reselect the cells of the appropriate reliability group for camping in deployments where the cell reliability groups use different sets of frequencies - UPF selection UPF selection mechanisms as described in clause 633 can be used to select different UPFs for the UEs within the device The selection may be based either on UE configuration or network configuration of different DNNs leading to the same DN or different slices for the two UEs It is possible to use the UEs Reliability Group described above for gNB selection as an input to the UPF selection The proper operator configuration of the UPF selection can ensure that the path of the PDU Sessions of UE1 and UE2 are independent - Control plane",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1973",
    "document_id": "23501-i80",
    "chunk_id": 1973,
    "text": "The approach can optionally apply different control plane entities for the individual UEs within the device This may be achieved by using - different DNNs for the individual UEs within the device to select different SMFs - or applying different slices for the individual UEs within the device either based on UE configuration or network subscription to select different AMFs andor SMFs Annex G informative SCP Deployment Examples G1 General This Annex provides deployment examples for the SCP but is not meant to be an exhaustive list of deployment options for the SCP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1974",
    "document_id": "23501-i80",
    "chunk_id": 1974,
    "text": "The first example G1 is based on an SCP implement using network wide service mesh technology while the second example builds on SCP and 5GC functions as independent deployment units G2 An SCP based on service mesh G21 Introduction This clause describes an SCP deployment based on a distributed model in which SCP endpoints are co-located with 5GC functionality eg an NF an NF Service a subset thereof such as a microservice implementing part of an NFNF service or a superset thereof such as a group of NFs NF Services or microservices This example makes no assumptions as to the internal composition of each 5GC functionality eg whether they are internally composed of multiple elements or whether such internal elements communicate with means other than the service mesh depicted in this example In this deployment example Service Agents implementing necessary peripheral tasks eg an SCP endpoint are co-located with 5GC functionality as depicted in Figure G21-1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1975",
    "document_id": "23501-i80",
    "chunk_id": 1975,
    "text": "In this example Service Agents and 5GC functionality although co-located are separate components Figure G21-1 Deployment unit 5GC functionality and co-located Service Agents implementing peripheral tasks In this deployment example an SCP Service Agent ie a service communication proxy is co-located in the same deployment unit with 5GC functionality and provides each deployed unit eg a container-based VNFC with indirect communication and delegated discovery Figure G21-2 shows an overview of this deployment scenario For SBI-based interactions with other 5GC functionalities a consumer 5GC functionality A communicates through its Service Agent via SBI Its Service Agent selects a target producer based on the request and routes the request to the producers 5GC functionality B Service Agent",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1976",
    "document_id": "23501-i80",
    "chunk_id": 1976,
    "text": "What routing and selection policies a Service Agent applies for a given request is determined by routing and selection policies pushed by the service mesh controller Information required by the service mesh controller is pushed by the Service Agents to the service mesh controller In this deployment the SCP manages registration and discovery for communication within the service mesh and it interacts with an external NRF for service exposure and communication across service mesh boundaries Operator-defined policies are additionally employed to generate the routing and selection policies to be used by the Service Agents This example depicts only SBI-based communication via a service mesh but it does not preclude the simultaneous use of the service mesh for protocols other than SBI supported by the service mesh or that the depicted 5GC functionality additionally communicates via other means Figure G21-2 SCP Service mesh co-location with 5GC functionality From a 3GPP perspective in this deployment example a deployment unit thus contains NF functionality and SCP functionality Figure G21-3 depicts the boundary between both 3GPP entities In the depicted example two NF Services part of the same NF and each exposing an SBI interface are deployed each in a container-based VNFC A co-located Service Agent provides each NF Service with indirect communication and delegated discovery Figure G21-3 Detail of the NF-SCP boundary G22 Communication across service mesh boundaries It is a deployment where a single service mesh covers all functionality within a given deployment or not In cases of communication across the boundaries of a service mesh the service mesh routing the outbound message knows neither whether the selected producer is in a service mesh nor the internal topology of the potential service mesh where the producer resides In such a deployment as shown in Figure G22-1 after producer selection is performed routing policies on the outgoing service mesh are only aware of the next hop Given a request sent by A As Service Agent will perform producer selection based on the received request If the selected producer endpoint eg D is determined to be outside of Service Mesh 1 As Service Agent routes the request to the Egress Proxy For a successful routing the Egress Proxy needs to be able to determine the next hop of the request In this case this is the Ingress Proxy of Service Mesh 2 The Ingress Proxy of Service Mesh 2 is based on the information in the received request and its routing policies able to determine the route for the request Subsequently D receives the request No topology information needs to be exchanged between Service Mesh 1 and Service Mesh 2 besides a general routing rule towards Service Mesh 2 eg a FQDN prefix and an Ingress Proxy destination for requests targeting endpoints in Service Mesh 2 Figure G22-1 Message routing across service mesh boundaries G3 An SCP based on independent deployment units This clause shows an overview of SCP deployment based on the 5GC functionality and SCP being deployed in independent deployment units Figure G3-1 Independent deployment units for SCP and 5GC functionality The SCP deployment unit can internally make use of microservices however these microservices are up to vendors implementation and can be for example SCP agents and SCP controller as used in this example The SCP agents implement the http intermediaries between service consumers and service producers The SCP agents are controlled by the SCP controller Communication between SCP controller and SCP agents is via SCP internal interface 4 and up to vendors implementation In this model it is a deployment choice to co-locate SCP and other 5GC functions or not The SCP interfaces 1 2 and 3 are service based interfaces SCP itself is not a service producer itself however acting as http proxy it registers services on behave of the producers in NRF Interface 2 represents same services as 1 however using SCP proxy addresses Interface 3 is interfacing NRF eg for service registration on behalf of the 5GC functions or service discovery Figure G3-2 5GC functionality and SCP co-location choices For SBI-based interactions with other 5GC functions a consumer communicates through a SCP agent via SBI 1 SCP agent selects a target based on the request and routes the request to the target SCP agent 2 What routing and selection policies each SCP agent applies for a given request is determined by routing and selection policies determined by the SCP controller using for example information provided via NRF 3 or locally configured in the SCP controller The routing and selection information is provided by the SCP controller to the SCP agents via SCP internal interface 4 Direct communication can coexist in the same deployment based on 3GPP specified mechanisms Figure G3-3 Overview of SCP deployment G4",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1977",
    "document_id": "23501-i80",
    "chunk_id": 1977,
    "text": "An SCP deployment example based on name-based routing G40 General Information This clause provides a deployment example for the SCP which is based on a name-based routing mechanism that provides IP over ICN capabilities such as those described in Xylomenos George et al G1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1978",
    "document_id": "23501-i80",
    "chunk_id": 1978,
    "text": "The scenario describes an SCP offering based on an SBA-platform to interconnect 5GC Services or a subset of the respective services The Name-based Routing mechanism described in this deployment example is realized through a Path Computation Element which is the core part of the SCP The 5GC Services are running as microservices on clouddeployment units clusters A Service Router is the communication node access nodegateway between the SCP and the 5GC Services and resides as a single unit within a Service Deployment Cluster The Service Router acts as communication proxy and it is responsible for mapping IP based messages onto ICN publication and subscriptions The Service Router serves multiple 5GC Service Endpoints within that cluster For direct communication the Service Router is not used 5GC Functionalities communicate with the Service Router using standardized 3GPP SBIs The Functionalities within the Service Deployment Cluster are containerized Service Functions Depicted in Figure G4-1 the Service Router act as SCP termination point and offer the SBI to the respective 5GC Service Functionalities",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1979",
    "document_id": "23501-i80",
    "chunk_id": 1979,
    "text": "In this example Service Routers and 5GC functionality although co-located are separate components within the Service Deployment Cluster Multiple Functionalities can exist within the Service Deployment Cluster all served by the respective Service Router when needed to communicate to other Service Functionalities within different clusters Figure G4-1 Deployment unit 5GC functionality and co-located Service Agents implementing peripheral tasks In Figure G4-1 the two depicted 5GC Service Functionalities realized as Network Function Service Instances may communicate in two ways However before the communication can be established between two 5GC Functionalities Service Registration and Service Discovery need to take place as described in Figure G41-1 Service Registration and Service Discovery are provided in a standardized manner using 3GPP Service Based Interfaces G41 Service Registration and Service Discovery Service registration can be done in several ways One option is that ready 5GC Service Functions may register themselves with their service profile via the Nnrf interface The registration request is forwarded to the internal Registry as well as forwarded to the operators NRF",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1980",
    "document_id": "23501-i80",
    "chunk_id": 1980,
    "text": "The internal registration is used to store the address to identifier relationship and the Service Deployment Cluster location The external registration NRF is used to expose the Service Functionality to Services outside the depicted SCP Service discovery entails Function A requesting a resolvable identifier for Functionality B",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1981",
    "document_id": "23501-i80",
    "chunk_id": 1981,
    "text": "This resolve request is received by the Service Router which performs the task with the help of the SCP After the resolve is done the 5GC Functionalities may communicate either directly without any further interaction through the SCP when the targeted address is resolved within the same Service Deployment Cluster or via the Service Router when the Functionality resides outside of the originators Service Deployment Cluster The Service Router then acts as gateway towards the underlying SCP platform Figure G41-1 Registering 5GC Functionalities in the SCP G42 Overview of Deployment Scenario Figure G42-1 shows an overview of this deployment scenario For SBI-based interactions with other 5GC functionalities a consumer entity eg 5GC functionality B in the cluster on the left side communicates through the clusters Service Router with other entities in other clusters eg 5GC Functionality D in the cluster on the right side The target selection is performed through the platforms Discovery Service From the clients perspective the Service Router is the first and only contact point to the SCP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1982",
    "document_id": "23501-i80",
    "chunk_id": 1982,
    "text": "The platform resolves the requested Service identifier and aligns the results with the platforms policies The Path Computation Element calculates a path between the consumer and the producer eg the shortest path between the nodes Figure G42-1 NbR- SCP interconnects multiple deployment clusters with external NRF G43 References G1 Xylomenos George et al IP over ICN goes live 2018 European Conference on Networks and Communications EuCNC IEEE 2018 Annex H normative PTP usage guidelines H1 General This Annex provides guidelines on the use of certain specific IEEE parameters and protocol messages in the case of TSN as described in clause 527 H2 Signalling of ingress time for time synchronization The ingress timestamp TSi of the PTP event eg Sync message is provided from the ingress TT NW-TTUPF or DS-TTUE to the egress TT if supported in the PTP messages as described in clauses 5271221 and 5271222 using the Suffix field defined in clause 134 of IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1983",
    "document_id": "23501-i80",
    "chunk_id": 1983,
    "text": "The structure of the Suffix field follows the recommendation of clause 143 of IEEE Std 1588 126 with an organizationId specific to 3GPP an organizationSubType referring to an ingress timestamp and data field that carries the ingress timestamp encoded as specified in clause 533 of IEEE Std 1588 126 TS 24535 117 specifies the coding of the ingress timestamp in the gPTP messages between a DS-TT and a NW-TT H3 Void H4 Path and Link delay measurements The procedure described in this clause is applicable if DS-TT and NW-TT support operating as a boundary clock or as a time-aware system or as peer to peer Transparent Clock or end to end Transparent Clock and when the PTP instance in 5GS is configured to operate as a time-aware system or as a Boundary Clock or as peer to peer Transparent Clock or as end to end Transparent Clock Whether DS-TTNW-TT support operating as a boundary clock or peer to peer Transparent Clock or end to end Transparent Clock or as a time-aware system support of the IEEE Std 8021AS 104 PTP profile may be determined as described in clause K21 PTP ports in DS-TT and NW-TT may support the following delay measurement mechanisms - Delay request-response mechanism as described in clause 113 of IEEE Std 1588 126 - Peer-to-peer delay mechanism as defined in clause 114 of IEEE Std 1588 126 - Common Mean Link Delay Service",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1984",
    "document_id": "23501-i80",
    "chunk_id": 1984,
    "text": "Depending on the measurement mechanisms supported by DS-TT and NW-TT as well as the configured clock mode of 5GS the PTP ports in DS-TT and NW-TT are configured as follows - PTP ports configured to operate as a time-aware system according to IEEE Std 8021AS 104 may be configured to use the peer-to-peer delay mechanism or Common Mean Link Delay Service - PTP ports configured to operate as a Boundary Clock according to IEEE Std 1588 126 may be configured to use the delay request-response mechanism the peer-to-peer delay mechanism or Common Mean Link Delay Service - PTP ports in 5GS configured to operate as a peer-to-peer Transparent Clock according to IEEE Std 1588 126 shall use the peer-to-peer delay mechanism - PTP ports in 5GS configured to operate as an end-to-end Transparent Clock according to IEEE Std 1588 126 do not actively participate in path and link measurements mechanisms but shall calculate and add residence time and delay asymmetry information to PTP messages as defined in clause 1022 of IEEE Std 1588 126 If DS-TT and NW-TT support operating as an end-to-end Transparent Clock then the residence time for one-step operation as an end-to-end Transparent Clock for the path and link measurements is calculated as follows - Upon reception of a PTP Delay_ReqPdelay_ReqPdely_Resp message from the upstream PTP instance the ingress TT ie NW-TT or DS-TT makes an ingress timestamping TSi for the message - The ingress timestamp is conveyed to the egress TT via the PDU Session as described in clause H2 - The PTP port in the egress TT then creates egress timestamping TSe for the PTP message for external PTP network The difference between TSi and TSe is considered as the calculated residence time spent within the 5G system for this PTP message expressed in 5GS time If needed the PTP port in the egress TT convert the calculated resident time in 5GS into the residence time expressed in PTP GM time eg by means of the factor as specified in Equation 6 of clause 1222 of IEEE Std 1588 126 - The PTP port in the egress TT modifies the payload of the PTP Delay_ReqPdelay_ReqPdelay_Resp message that it sends towards the downstream PTP instance as follows - Adds the calculated residence time to the correction field - Removes Suffix field that contains TSi If DS-TT and NW-TT support operating as an end-to-end Transparent Clock then the residence time for two-step operation as an end-to-end Transparent Clock for the path and link measurements is calculated as follows - Upon reception of a PTP Delay_ReqPdelay_ReqPdelay_Resp message from the upstream PTP instance the ingress TT ie NW-TT or DS-TT makes an ingress timestamping TSi for the message - If the ingress TT receives a Pdelay_Resp message with the twoStepFlag set to FALSE then the ingress TT modifies the twoStepFlag to TRUE and creates a PTP Pdelay_Resp_Follow_Up message - The ingress timestamp is conveyed to the egress TT via the PDU Session as described in clause H2 - The PTP port in the egress TT then creates egress timestamping TSe for the PTP message for external PTP network The difference between TSi and TSe is considered as the calculated residence time spent within the 5G system for this PTP message expressed in 5GS time If needed the PTP port in the egress TT converts the calculated residence time in 5GS into the residence time expressed in PTP GM time eg by means of the factor as specified in Equation 6 of clause 1222 of IEEE Std 1588 126",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1985",
    "document_id": "23501-i80",
    "chunk_id": 1985,
    "text": "The egress TT then stores the calculated residence time expressed in PTP GM time and removes Suffix field that contains TSi before sending the PTP Delay_ReqPdelay_ReqPdelay_Resp message towards the downstream PTP instance - Upon reception of the PTP Delay_Resp message associated with the PTP Delay_Req the egress TT for the PTP Delay_Req message ie the ingress TT for the PTP Delay_Resp message modifies the payload of the PTP Delay_Resp message that it sends towards the ingress TT of the PTP Delay_Req message ie egress TT for the PTP Delay_Resp message as follows - Adds the previously stored calculated residence time to the correction field - Upon reception or local creation of the PTP Pdelay_Resp_Follow_Up message associated with the previously received PTP Pdelay_Resp message the ingress TT for the PTP Pdelay_Resp_Follow_Up message modifies the payload of the PTP Pdelay_Resp_Follow_Up message that it sends towards the egress TT for the PTP Pdelay_Resp_Follow_Up message as follows - Adds the previously stored calculated residence time of the associated PTP Pdelay_Req message to the correction field - Upon reception of the PTP Pdelay_Resp_Follow_Up message associated with the PTP Pdelay_Resp the egress TT for PTP Pdelay_Resp_Follow_Up message modifies the payload of the PTP Pdelay_Resp_Follow_Up message that it sends towards the downstream PTP instance as follows - Adds the previously stored calculated residence time of the associated PTP Pdelay_Resp messages to the correction field Annex I normative TSN usage guidelines I1 Determination of traffic pattern information As described in clause 5272 the calculation of the TSCAI relies upon mapping of information for the TSN streams based upon certain IEEE standard information Additional traffic pattern parameters such as maximum burst size and maximum flow bitrate can be mapped to MDBV and GFBR The traffic pattern parameter determination based on PSFP IEEE Std 8021Q 98 when available is as follows - Periodicity of a TSN stream is set equal to StreamGateAdminCycleTime if there is only one StreamGateControlEntry with a StreamGateStatesValue set to Open in the StreamGateAdminControlList",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1986",
    "document_id": "23501-i80",
    "chunk_id": 1986,
    "text": "If there is more than one StreamGateGateControlEntry with a StreamGateStatesValue set to Open in the StreamGateAdminControlList then the Periodicity of the TSN Stream is set equal to sum of the timeIntervalValues from the first gate open instance to a next gate open instance in the StreamGateAdminControlList",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1987",
    "document_id": "23501-i80",
    "chunk_id": 1987,
    "text": "For aggregated TSN streams with same periodicity and compatible Burst Arrival Times the periodicity of the aggregated flow of these TSN Streams is set equal to StreamGateAdminCycleTime received from CNC for one of the TSN streams that are aggregated NOTE 1 Given that only TSN streams that have the same periodicity and compatible Burst Arrival Time can be aggregated the StreamGateAdminCycleTime for those TSN streams is assumed to be the same - Burst Arrival time of a TSN stream at the ingress port is determined based on the following conditions - The Burst Arrival Time of a TSN Stream should be set to StreamGateAdminBaseTime plus the sum of the timeIntervalValues for which the StreamGateStatesValue is Closed in the StreamGateAdminControlList until the first gate open time ie until StreamGateStatesValue set to Open is found If the StreamGateStatesValue is Open for the first timeIntervalValue then the Burst Arrival time is set to StreamGateAdminBaseTime For aggregated TSN streams the arrival time is calculated similarly but using the time interval to the first StreamGateStatesValue that is Open from the aggregated TSN streams - Burst Size of a TSN stream at the ingress port which is useful to map to MDBV is determined based on the following conditions - The Burst Size may be determined from TSN Stream gate control operations in the StreamGateAdminControlList",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1988",
    "document_id": "23501-i80",
    "chunk_id": 1988,
    "text": "If in the StreamGateAdminControlList IntervalOctetMax is provided for a StreamGateControlEntry with an open StreamGateStatesValue the Burst Size is set to the IntervalOctetMax for that control list entry If IntervalOctetMax is not provided the Burst Size is set to the timeIntervalValue converted from ns to s of the StreamGateControlEntry with an open StreamGateStatesValue multiplied by the port bitrate - When multiple compatible TSN Streams are aggregated the Burst Size is set to the sum of the Burst Sizes for each TSN stream as determined above - Maximum Flow Bitrate of a TSN stream which is useful to map to GBR is determined as follows - The Maximum Flow Bitrate of a TSN Stream is equal to the summation of all timeIntervalValue converted from ns to s with StreamGateStatesValue Open multiplied by the bitrate of the corresponding port and divided by StreamGateAdminCycleTime For aggregated TSN streams the same calculation is performed over the burst of aggregated streams calculated using superposition ie timeIntervalValue with StreamGateStatesValue Open of every stream is summed up as they are assumed to have same periodicity compatible Burst arrival time and same traffic class if they are to be aggregated When CNC configures the PSFP information to the TSN AF the TSN AF may use local information eg local configuration to map the PSFP information to an ingress port andor egress port of the 5GS bridge NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1989",
    "document_id": "23501-i80",
    "chunk_id": 1989,
    "text": "As an example for the local configuration the PSFP can use either the destination MAC address and VLAN identifier or the source MAC address and VLAN identifier for stream identification The TSN AF is pre-configured with either the MAC address of Ethernet hosts behind a given DS-TT port identified by the DS-TT port MAC address or the VLAN identifier used over a given DS-TT port or both When the TSN AF determines that one of the known Ethernet hosts MAC address appears as a source or destination MAC address it can identify that the ingress or egress port is the associated DS-TT port Annex J informative Link MTU considerations According to clause 56104 networks can provide link MTU size for UEs A purpose of the link MTU size provisioning is to limit the size of the packets sent by the UE to avoid packet fragmentation in the backbone network between the UE and the UPF acting as PSA andor across the N6 reference point Fragmentation within the backbone network creates a significant overhead Therefore operators might desire to avoid it This Annex presents an overhead calculation that can be used by operators to set the link MTU size provided by the network A UE might not employ the provided link MTU size eg when the MT and TE are separated as discussed in clause 56104",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1990",
    "document_id": "23501-i80",
    "chunk_id": 1990,
    "text": "Therefore providing an MTU size does not guarantee that there will be no packets larger than the provided value However if UEs follow the provided link MTU value operators will benefit from reduced transmission overhead within backbone networks One of the worst-case scenarios is when GTP packets eg between a NG-RAN node and the 5GC are transferred over IPSec tunnel in an IPv6 deployment In that case the user packet first encapsulated in a GTP tunnel which results in the following overhead - IPv6 header which is 40 octets - UDP overhead which is 8 octets - Extended GTP-U header which is 16 octets NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1991",
    "document_id": "23501-i80",
    "chunk_id": 1991,
    "text": "The sending of a Reflective QoS Indicator within a GTP-U header extension or the use of Long PDCP PDU numbers at handover or the use of some other features specified in Release 17 or later Releases will further increase the GTP-U header size see TS 29281 75 and TS 38415 116 NOTE 2 For UEs that start their PDN connection in EPS and can be subject to mobility to 5GS the operator can use this smaller 5GS link MTU in EPS rather than the EPS link MTU suggested by Annex C of TS 23060 56",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1992",
    "document_id": "23501-i80",
    "chunk_id": 1992,
    "text": "In this scenario the GTP packet then further encapsulated into an IPSec tunnel The actual IPSec tunnel overhead depends on the used encryption and integrity protection algorithms TS 33210 115 mandates the support of AES-GMAC with a key length of 128 bits and the use of HMAC_SHA-1 for integrity protection Therefore the overhead with those algorithms is calculated as - IPv6 header which is 40 octets - IPSec Security Parameter Index and Sequence Number overhead which is 44 octets - Initialization Vector for the encryption algorithm which is 16 octets - Padding to make the size of the encrypted payload a multiple of 16 - Padding Length and Next Header octets 2 octets - Integrity Check Value which is 12 octets In order to make the user packet size as large as possible a padding of 0 octet is assumed With this zero padding assumption the total overhead is 142 octets which results a maximum user packet size of transport MTU minus 142 octets Note that in the case of transport MTU1500",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1993",
    "document_id": "23501-i80",
    "chunk_id": 1993,
    "text": "this user packet size will result in a 1424 octets payload length to be ciphered which is a multiple of 16 thus the assumption that no padding is needed is correct see Figure J1 Similar calculations can be done for networks with transport that supports larger MTU sizes Figure J-1 Overhead calculation for transport MTU1500 octet The link MTU value that can prevent fragmentation in the backbone network between the UE and the UPF acting as PSA depends on the actual deployment Based on the above calculation a link MTU value of 1358 is small enough in most of the network deployments However for network deployments where the transport uniformly supports for example ethernet jumbo frames transport MTU9216 octets can provide a much larger UE MTU and hence more efficient transfer of user data One example of when it can be ensured that all links support larger packet sizes is when the UE uses a specific Network Slice with a limited coverage area Note that using a link MTU value smaller than necessary would decrease the efficiency in the network Moreover a UE might also apply some tunnelling eg VPN",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1994",
    "document_id": "23501-i80",
    "chunk_id": 1994,
    "text": "It is desirable to use a link MTU size that assures at least MTU minus 220 octets within the UE tunnel to avoid the fragmentation of the user packets within the tunnel applied in the UE In the case transport MTU is 1500 octets this results a link MTU of 1280 octets for the transport which is the minimum MTU size in the case of IPv6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1995",
    "document_id": "23501-i80",
    "chunk_id": 1995,
    "text": "The above methodology can be modified for calculation of the UEs link MTU when a UPF has MTU limits on the N6 reference point and is offering a PDU Session with Ethernet or Unstructured PDU Session type between the UPF and the UE Annex K normative Port and user plane node management information exchange K1 Standardized port and user plane node management information Table K1-1 and Table K1-2 list standardized port management information and user plane node management information respectively Table K1-1 Standardized port management information Table K1-2 Standardized user plane node management information K2 Port and user plane node management information exchange for time synchronization K21 Capability exchange DS-TT and NW-TT indicate time synchronization information they support inside the Port management capabilities see Table K1-1 TSN AF and TSCTSF may determine the PTP functionalities supported by DS-TT and NW-TT by retrieving the following port management information or user plane node management information",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1996",
    "document_id": "23501-i80",
    "chunk_id": 1996,
    "text": "respectively - Supported PTP instance types - Supported transport types - Supported PTP delay mechanisms - Grandmaster capability - Supported PTP profiles - Number of supported PTP instances NOTE If NW-TT or DS-TT do not indicate support for any of the PTP profiles and PTP instance types then TSN AF or TSCTSF assume that the NW-TT or DS-TT only support acting as a PTP Relay instance with the gPTP GM connected on N6 If DS-TT and NW-TT support the PTP Relay instance type as defined by IEEE 8021AS 104 then DS-TT and NW-TT shall include the IEEE 8021AS 104 PTP profile in the Supported PTP profiles in PMIC and UMIC respectively The TSN AF or TSCTSF may retrieve the Number of supported PTP instances from NW-TT via UMIC and from DS-TT via PMIC K22 PTP Instance configuration K221 General Based on input received from external applications CNC in case of TSN AF or any AF in case of TSCTSF TSN AF or TSCTSF may configure PTP instances identified by PTP Instance ID in a DS-TT or NW-TT by sending port management information PMIC see Table K1-1 and user plane node management information UMIC see Table K1-2 to DS-TT or NW-TT as described below - use PMIC PTP instance specification for configuring DS-TTs for PTP instance data sets common for all PTP ports ie defaultDS and TimePropertiesDS and PTP instance data sets specific for each PTP port ie portDS data set - use UMIC PTP instance specification for configuring NW-TT for PTP instance data sets common for all PTP ports - use PMIC PTP instance specification for configuring NW-TT for PTP instance data sets specific for each PTP port - use UMIC Time synchronization information for DS-TT ports for configuring NW-TT for PTP instance data sets specific for each PTP port for the PTP ports in DS-TTs TSN AF or TSCTSF may also configure PTP instances for DS-TT ports in NW-TT by sending UMIC see Table K1-2 to NW-TT to enable NW-TT to operate as a grandmaster on behalf of DS-TT see clause K224 for more details For each PTP instance the TSN AF or TSCTSF may provide individual PTP configuration parameters or may provide a PTP profile ID to DS-TT or NW-TT The DS-TT and NW-TT use the default values as defined in the corresponding PTP Profile if individual PTP configuration parameters that are covered by the PTP profile are not provided NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1997",
    "document_id": "23501-i80",
    "chunk_id": 1997,
    "text": "Even if PTP profiles are used to configure DS-TT or NW-TT individual PTP parameters can still be configured in addition eg domain numbers transport to use etc To configure DS-TT and NW-TT to operate as a PTP relay instance TSN AF or TSCTSF shall set the PTP profile see Table K1-1 to IEEE Std 8021AS 104 DS-TT may operate as a PTP relay instance with the gPTP GM connected on N6 until the first PTP instance is configured in the DS-TT by TSN AF or TSCTSF To initialize a PTP instance in 5GS TSN AF or TSCTSF creates a new PTP instance in NW-TT by assigning a new PTP Instance ID and indicating it to the NW-TT in PTP instance specification in UMIC and PMICs for each NW-TT port that is part of the PTP instance TSN AF or TSCTSF then retrieves the defaultDSclockIdentity of the PTP instance in NW-TT via UMIC NW-TT ensures that the clockIdentity in defaultDS in UMIC matches with the clockIdentity in the portDSportIdentity in PMICs for a particular PTP Instance ID To add a DS-TT port into an existent PTP instance in 5GS the TSN AF or TSCTSF indicates the PTP Instance ID to which the DS-TT port is being added to the DS-TT in PTP instance specification in PMIC and indicating the PTP Instance ID to the NW-TT in Time synchronization information for DS-TT ports in UMIC for the corresponding DS-TT port For a particular PTP instance in NW-TT the same PTP Instance ID shall be used in PTP instance specification in PMIC in PTP instance specification in UMIC and in Time synchronization information for DS-TT ports in UMIC NOTE 2",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1998",
    "document_id": "23501-i80",
    "chunk_id": 1998,
    "text": "The TSN AF or TSCTSF creates a PTP Instance in the NW-TT or DS-TT by using the Set parameter operation code as described in TS 24539 139 The NW-TT or DS-TT determines that this Set parameter operation creates a new PTP Instance based on the PTP Instance ID that does not correspond to any of the configured PTP Instances in the PTP instance specification and Time synchronization information for DS-TT ports for NW-TT or in the PTP instance specification for DS-TT The TSN AF or TSCTSF then initializes the PTP instance in the DS-TT by setting the applicable PTP instance data sets common for all PTP ports ie defaultDS and TimePropertiesDS includingdefaultDSclockIdentity via PTP instance specification in PMIC to the same value as retrieved from the NW-TT via PTP instance specification in UMIC The TSN AF or TSCTSF also enables the PTP instance by setting the defaultDSinstanceEnable TRUE to DS-TT via PMIC and to NW-TT via UMIC if applicable The TSN AF or TSCTSF can initialize any number of PTP instances a among the DS-TTs and NW-TT that are part of the same set of PTP instances in 5GS up to the maximum number of supported PTP instances by the NW-TT or DS-TT that supports the lowest number of supported PTP instances and b in the NW-TT up to the maximum number of supported PTP instances by the NW-TT NOTE 3 How the TSN AF or TSCTSF assign NW-TT ports of one NW-TT to different PTP instances is up to implementation To remove a DS-TT port from a PTP instance in 5GS the TSN AF or TSCTSF deletes the PTP instance in DS-TT using PMIC and in NW-TT using UMIC as specified in TS 24539 139 To remove a NW-TT port from a PTP instance in 5GS the TSN AF or TSCTSF deletes the PTP instance in NW-TT using PMIC as specified in TS 24539 139 If a PTP instance in 5GS is no more needed the TSN AF or TSCTSF may delete the PTP instance in NW-TT using UMIC as specified in TS 24539 139 K222 Configuration for Sync and Announce reception timeouts The NW-TT shall be able to determine the timeout of the reception of gPTP Announce when the 5GS operates as a time-aware system or Boundary Clock and gPTP Sync messages when the 5GS operates as time-aware system To enable this the TSCTSF or TSN AF shall configure the NW-TT for the following information via PMIC for each PTP port in NW-TT and Time synchronization information for each DS-TT port element in UMIC for each PTP port in DS-TT portDSannounceReceiptTimeout for time-aware system and Boundary Clock portDSsyncReceiptTimeout for time-aware system portDSlogAnnounceInterval for Boundary Clock portDSinitialLogAnnounceInterval portDSuseMgtSettableLogAnnounceInterval and portDSmgtSettableLogAnnounceInterval for time-aware system K223 Configuration for PTP port states The PTP port states may be determined by NW-TT either via - Method a BMCA procedure - Method b local configuration When Method b is used the TSN AF or TSCTSF sets the defaultDSexternalPortConfigurationEnabled per PTP instance in UMIC to TRUE and sets the value of externalPortConfigurationPortDSdesiredState per PTP port in UMIC for each DS-TT port and in PMIC for each NW-TT port for the gPTP domain K224 Configuration for PTP grandmaster function The following options may be supported per DS-TT for the 5GS to generate the Sync Follow_Up and Announce messages for the Leader ports on the DS-TT a NW-TT generates the Sync Follow_Up and Announce messages on behalf of DS-TT eg if DS-TT does not support this b DS-TT generates the Sync Follow_Up and Announce messages in this DS-TT TSN AF and TSCTSF may use the elements in port and user plane node management information container to determine the PTP grandmaster functionality supported by DS-TT and NW-TT and may configure the DS-TT and NW-TT ports to operate as in option a or b as follows - The PTP grandmaster capable element and the gPTP grandmaster capable element in PMIC are used to indicate the support for PTP or gPTP grandmaster capability respectively in each DS-TT If the TSN AF or TSCTSF determines the DS-TT supports grandmaster capability PTP or gPTP grandmaster capable is TRUE then either option a or b can be used for the PTP instances in the DS-TT",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_1999",
    "document_id": "23501-i80",
    "chunk_id": 1999,
    "text": "Otherwise only option a can be used for the PTP instances in the DS-TT - To enable option a for PTP ports in DS-TT the TSN AF or TSCTSF sets the element Grandmaster on behalf of DS-TT enabled TRUE per PTP instance per DS-TT in UMIC for the respective DS-TT port and the TSN AF or TSCTSF sets the element Grandmaster enabled FALSE per PTP instance per DS-TT in PMIC to the respective DS-TT port - To enable option b for PTP ports in DS-TT the TSN AF or TSCTSF sets the element Grandmaster on behalf of DS-TT enabled FALSE in UMIC per PTP instance per DS-TT for the respective port and the TSN AF or TSCTSF sets the element Grandmaster enabled TRUE per PTP instance per DS-TT in PMIC to the respective DS-TT port - To enable either option a or option b for a PTP instance the TSN AF or TSCTSF sets the element Grandmaster candidate enabled TRUE per PTP instance in UMIC - When option b is used for one or more PTP ports in DS-TTs the TSN AF or TSCTSF shall use the elements in defaultDS in PMIC for the respective DS-TTs and in UMIC for NW-TT to ensure that all PTP ports in the DS-TTs and NW-TT in particular PTP instance are distributing the same values of grandmasterPriority1 grandmasterClockQuality grandmasterPriority2 grandmasterIdentity and timeSource message fields in Announce messages K225 Configuration for Sync and Announce intervals The TSN AF or TSCTSF uses the values in portDSlogSyncInterval for Boundary Clock or portDSinitialLogSyncInterval portDSuseMgtSettableLogSyncInterval and portDSmgtSettableLogSyncInterval for time-aware system to configure the interval for the Sync messages per PTP port as described in IEEE Std 1588 126 or IEEE Std 8021AS 104 respectively The TSCTSF or TSN AF configures those values as follows - TSCTSF or TSN AF use PMIC to configure the values for the PTP ports in NW-TT - TSCTSF or TSN AF use the Time synchronization information for each DS-TT port element in UMIC to configure the values for PTP ports in DS-TTs if NW-TT acts as GM on behalf of those DS-TTs - TSCTSF or TSN AF use PMIC to configure the values for the PTP ports in DS-TT if the DS-TT is capable of acting as a GM When the NW-TT generates the gPTP Sync messages on behalf of the DS-TT the NW-TT uses the values in the element Time synchronization information for each DS-TT port in UMIC to determine the Sync interval for the PTP ports the respective DS-TT When DS-TT generates the gPTP Sync messages the DS-TT uses the values in PMIC to determine the Sync interval for the PTP ports in this DS-TT The TSN AF or TSCTSF uses the values in portDSlogAnnounceInterval for Boundary Clock or portDSinitialLogAnnounceInterval portDSuseMgtSettableLogAnnounceInterval and portDSmgtSettableLogAnnounceInterval for time-aware system to configure the interval for the Announce messages per PTP port as described in IEEE Std 1588 126 and",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2000",
    "document_id": "23501-i80",
    "chunk_id": 2000,
    "text": "IEEE Std 8021AS 104 respectively The TSCTSF or TSN AF configures those values as follows - TSCTSF or TSN AF use PMIC to configure the values for the PTP ports in NW-TT - TSCTSF or TSN AF use the Time synchronization information for each DS-TT port element in UMIC to configure the values for PTP ports in DS-TTs if NW-TT acts as GM on behalf of those DS-TTs - TSCTSF or TSN AF use PMIC to configure the values for the PTP ports in DS-TT if the DS-TT is capable of acting as a GM When the NW-TT generates the gPTP",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2001",
    "document_id": "23501-i80",
    "chunk_id": 2001,
    "text": "Announce messages on behalf of the DS-TT the NW-TT uses the values in the element Time synchronization information for each DS-TT port in UMIC to determine the Announce interval for the PTP ports the respective DS-TT When DS-TT generates the gPTP Announce messages the DS-TT uses the values in PMIC to determine the Announce interval for the PTP ports in this DS-TT K226 Configuration for transport protocols The procedure described in this clause is applicable when the PTP Profile that is used for the PTP instance in 5GS defines multiple permitted transport protocols TSN AF or TSCTSF may use the element Supported transport types in port management information container per DS-TT to determine the supported transport types in the DS-TT TSN AF or TSCTSF may use the element Supported transport types in UMIC per NW-TT to determine the supported transport types in the NW-TT The TSN AF or TSCTSF may use the element Transport type per PTP instance in PMIC to configure the transport protocol in use for the PTP instance in DS-TT The TSN AF or TSCTSF may use the element Transport type per PTP instance in UMIC to configure the transport protocol in use for the PTP instance in NW-TT The PTP instance shall be configured to use one of the following transport protocols 1 Ethernet as described in Annex E of IEEE Std 1588 126 The Ethertype as defined for PTP shall be used The related Ethernet frames carry the PTP multicast Ethernet destination MAC address 2 UDP over IPv4 as described in Annex C of IEEE Std 1588 126 3 UDP over IPv6 as described in Annex D of IEEE Std 1588 126 Option 1 applies to Ethernet PDU Session type Options 2 and 3 apply to IP PDU Session type or Ethernet PDU Session type with IP payload Annex L normative Support of GERANUTRAN access This annex applies when the SMFPGW-C is enhanced to support UE accessing the network via GERANUTRAN over GnGp interface For this scenario the SMFPGW-C uses N7 interface to interact with PCF and the N40 interface to interact with CHF NOTE 1",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2002",
    "document_id": "23501-i80",
    "chunk_id": 2002,
    "text": "For the interface with the serving node of the UE the SMFPGW-C is assumed to behave as the Control Plane of the PGW described in Annex D of TS 23401 26 SMFPGW-C selection by SGSN is specified in Annex G of TS 23502 3 The SMFPGW-C interacting with PCF for GERANUTRAN access is specified in Annex G of TS 23502 3 The functional description for SMFPGW-C interacting with PCF to support GERANUTRAN access is specified in TS 23503 45 NOTE 2 Support for IP address preservation upon mobility between 5GS and GERANUTRAN for PDN sessions established in EPC is described in clause 51724 IP address preservation is not supported for direct mobility between 5GS and GERANUTRAN nor for indirect mobility cases when the PDN session is established in 5GS or in GERANUTRAN The charging services on SMFPGW-C interactions with CHF for GERANUTRAN access are specified in TS 32255 68 Annex M normative Interworking with TSN deployed in the Transport Network M1 Mapping of the parameters between 5GS and TSN UNI",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2003",
    "document_id": "23501-i80",
    "chunk_id": 2003,
    "text": "The details of the parameters in the TSN UNI are specified in IEEE Std 8021Q 98 and IEEE Std 8021Qdj 146 Stream identification is further specified in IEEE Std 8021CB 83 and IEEE Std 8021CBdb 178 The SMFCUC derives the End Station related information for the stream requirements towards the TN CNC for the QoS Flow as follows a For the Talker group StreamID can be generated by the SMFCUC based on the End Station MAC address acting as Talker and a UniqueID SUPI PDU Session ID and QFI may be used to derive the UniqueID The MAC address is either pre-configured at the SMFCUC or provided by the AN-TL or CN-TL to the SMFCUC eg as part of the EndStationInterfaces information - StreamRank set to zero for ARP priority values 1-8 set to one for other ARP values EndStationInterfaces",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2004",
    "document_id": "23501-i80",
    "chunk_id": 2004,
    "text": "If the AN-TL and CN-TL are supported the SMFCUC receives the EndStationInterfaces MacAddress InterfaceName from the AN-TL and CN-TL via TL-Container If the AN-TL and CN-TL are not supported the SMFCUC sets the information based on pre-configuration - DataFrameSpecification optional When it is present it specifies how the TN can identify packets of the TN stream using Ethernet IP and transport protocol header fields in order to apply the required TSN configuration The SMFCUC may derive the DataFrameSpecification based on - N3 tunnel end point addresses that are used for the QoS Flow The SMFCUC may instruct the UPF and NG-RAN to assign a separate N3 tunnel end point address for each QoS Flow that may carry TSC streams so that the TN can distinguish the QoS Flows based on the N3 tunnel destination IP addresses NOTE 1 IPv6 can be used in the N3 tunnel end point addresses to provide sufficient address space in case separate N3 tunnel end point addresses are used for each QoS flow that can carry time sensitive streams - Mask-and-match stream identification parameters IEEE 8021CBdb 178 clause 916 optional The SMFCUC may indicate mask-and-match configuration based on the TEID and QFI of the given QoS flow and the destination IP address to the TN CNC when the deployment supports mask-and-match stream identification function as defined in clause 68 in IEEE Std 8021CBdb 178",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2005",
    "document_id": "23501-i80",
    "chunk_id": 2005,
    "text": "This functionality can be used for example to check for the TEID and QFI in the GTP header and the destination IP address to distinguish the QoS Flows",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2006",
    "document_id": "23501-i80",
    "chunk_id": 2006,
    "text": "This enables the TN CNC to configure the mask-and-match stream identification function in the transport network This is an option that allows to use a single GTP-U tunnel as defined for non-TSN Transport networks The DataFrameSpecification or mask-and-match stream identification parameters may be provided to the AN-TL and CN-TL to configure stream identification In that case the AN-TL and CN-TL can perform the stream identification without relying on additional information from the upper layers of the AN or CN node When AN-TL and CN-TL are not supported the TN CNC configures the edge bridge to perform the stream transformation based on the provided the DataFrameSpecification or mask-and-match parameters when applicable TrafficSpecification elements Interval derived from the Periodicity of the traffic as indicated in the TSCAI MaxFramesPerInterval specifies the maximum number of frames that the Talker transmits in one Interval NOTE 2 How the SMFCUC derives MaxFramesPerInterval is up to implementation MaxFrameSize derived from the MDBV of the QoS Flow If the PCF determines interworking with a TSN network deployed in the transport network is supported based on the DNNS-NSSAI of the PDU Session the PCF generates MDBV based on the Burst Size as described in clause 5273 and the PCF transfers the MDBV to the SMFCUC The SMFCUC sets MaxFrameSize based on the following formula MDBV of the QoS Flow - the framing bits which is not used for transferring in 5GS eg CRC the GTP-U tunnel overhead - TransmissionSelection specifies the algorithm that the Talker uses to transmit the Streams traffic class If no algorithm is known the value zero strict priority is used TSpecTimeAware group optional present only if the traffic in the QoS Flow is time-synchronized EarliestTransmitOffset the earliest offset within the Interval For uplink EarliestTransmitOffset should be set based on the following formula Packet arrival time at the Talker UL - M x Interval where M is the largest integer for which the relation Packet arrival time at the Talker UL M x Interval duration would be true Packet arrival time at the Talker UL should be The corrected TSCAC BAT in UL direction presented in TAI time as specified in clause 52724 for the QoS flow5G-AN PDBUE-DS-TT Residence Time",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2007",
    "document_id": "23501-i80",
    "chunk_id": 2007,
    "text": "For downlink EarliestTransmitOffset should be set based on the following formula Packet arrival time at the Talker DL - M x Interval where M is the largest integer for which the relation Packet arrival time at",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2008",
    "document_id": "23501-i80",
    "chunk_id": 2008,
    "text": "the Talker DL M x Interval duration would be true Packet arrival time at the Talker DL should be The corrected TSCAC BAT in DL direction presented in TAI time as specified in clause 52724 LatestTransmitOffset the last chance within an interval should leave enough time to transfer a packet with MaxFrameSize Derived from the end of the interval the time to transfer a packet with MaxFrameSize The LatestTransmitOffset shall be set to the Buffer Capability when the value of LatestTransmitOffset subtracted by the packet arrival time at the Talker either UL or DL respectively as described in EarliestTransmitOffset exceeds the Buffer capability The value of LatestTransmitOffset shall be larger or equal than EarliestTransmitOffset Jitter derived in SMFCUC based on local information on Jitter in AN-TL and CN-TL and respective stream and traffic interference Annex U clauses U11 U12 and U13 of IEEE Std 8021Q 98 provide some examples UserToNetworkRequirements NumSeamlessTrees set to one no redundancy or other value if redundancy is required MaxLatency set to CN PDB subtracted by maximum possible buffer duration in Talker Maximum possible buffer duration is set to LatestTransmitOffset subtracted by EarliestTransmitOffset - InterfaceCapabilities optional",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2009",
    "document_id": "23501-i80",
    "chunk_id": 2009,
    "text": "If the AN-TL and CN-TL are supported the SMFCUC collects InterfaceCapabilities from AN-TL and CN-TL via TL-Container If the AN-TL and CN-TL are not supported the SMFCUC leaves the InterfaceCapabilities empty b For the Listener group - Stream ID and Stream Rank that were generated for the Talker of the TN stream are also used by the SMFCUC for the Listener - EndStationInterfaces derived as with the corresponding information for the Talker group - UserToNetworkRequirements NumSeamlessTrees set to one MaxLatency derived as with the corresponding information for the Talker group - InterfaceCapabilities derived as with the corresponding information for the Talker group c",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2010",
    "document_id": "23501-i80",
    "chunk_id": 2010,
    "text": "For the Status group The Status group contains the end station communication-configuration provided by TN CNC to the SMFCUC Stream ID StatusInfo AccumulatedLatency If the AccumulatedLatency is included from TN CNC to SMFCUC for a stream in DL direction the SMFCUC may use the AccumulatedLatency to update the TSCAI BAT to the NG-RAN the SMF sets the TSCAI Burst Arrival Time in downlink direction as the sum of the TSCAC BAT value in downlink direction and AccumulatedLatency and the buffer duration in Talker in CN-TL The buffer duration in CN-TL is zero if TimeAwareOffset for the Talker group is not present and TimeAwareOffset",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2011",
    "document_id": "23501-i80",
    "chunk_id": 2011,
    "text": "- EarliestTransmitOffset if the TimeAwareOffset is present for the Talker group InterfaceConfiguration optional MAC Addresses optional present only if the respective InterfaceCapability contains a value for Active Destination MAC and VLAN Stream identification in CB-StreamIdenTypeList and stream transformation is performed in AN-TL and CN-TL VLAN Tag optional present only if VlanTagCapable is True in the respective InterfaceCapability and the stream transformation is performed in AN-TL and CN-TL IPv4IPv6",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2012",
    "document_id": "23501-i80",
    "chunk_id": 2012,
    "text": "Tuples optional but not supported in this release of the specification TimeAwareOffset optional present only if the traffic is time-synchronized AN-TL and CN-TL is supported and TSpecTimeAware elements were provided in the stream requirements If the InterfaceConfiguration is included and if the AL-TLCN-TL acting as Talker End Station support the Stream Transformation as described in IEEE Std 8021Q 98 the SMFCUC can instruct the UPF and NG-RAN to assign an individual TSN Transport address by providing the InterfaceConfiguration to the AN-TLCN-TL via TL-Container The Talker in AN-TLCN-TL shall use the indicated InterfaceConfiguration eg source MAC address multicast destination MAC address VLAN ID as assigned by the TN CNC for the data stream in a QoS Flow The TN can identify the streams based on the Stream Transformation that is applied in the AN-TLCN-TL acting as Taker End Station",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2013",
    "document_id": "23501-i80",
    "chunk_id": 2013,
    "text": "This allows to use a single GTP-U tunnel as defined for non-TSN Transport networks If the TimeAwareOffset is included from TN CNC to SMFCUC the SMFCUC should send the TimeAwareOffset to the AN-TL for streams in UL direction or the CN-TL port for streams in the DL direction The AL-TLCN-TL derive Gate Control information ie AdminBaseTime AdminCycleTime AdminControlListLength and AdminControlList based on the TimeAwareOffset as defined in IEEE Std 8021Q 98 at the AN-TL for streams in UL direction and the CN-TL port for streams in the DL direction The AN-TL or CN-TL acting as Talker buffers the data burst until the time indicated in the TimeAwareOffset is reached If the SMFCUC receives a TimeAwareOffset from TN CNC for a downlink stream ie for a Talker in the UPFCN-TL the SMFCUC adds the received TimeAwareOffset value to the TSCAI BAT in the DL direction in the TSCAI and updates the NG-RAN for the new TSCAI FailedInterfaces optional provides a list of one or more physical ports of failed end stations or bridges to locate the interfaces in the physical topology that caused the failure It is up to implementation how the SMF reacts when it receives FailedInterfaces NOTE 3",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2014",
    "document_id": "23501-i80",
    "chunk_id": 2014,
    "text": "It is assumed that the end station communication-configuration will contain at least the same information as defined for the status NOTE 4 If Jitter value needs to be considered EarliestTransmitOffset for UL and DL and LatestTransmitOffset shall be Jitter corrected How Jitter correction is carried out is up to implementation M2 TL-Container Information Table M2-1 TL-Container Information Annex N informative Support for access to Localized Services N1 General A Localized Service is a service which is provided at specificlimited area andor can be bounded in time The service can be realized via applications eg live or on-demand audiovideo stream electric game IMS etc or connectivity eg UE to UE UE to Data Network etc A Localized Service provider is an application provider or network operator who make their services localized and that are offered to the end user via a network A network providing Localized Services can be an SNPN or a PNI-NPN N2 Enabling access to Localized Services N21 General To enable a PNI-NPN or SNPN to provide access to Localized Services the PNI-NPN or SNPN operator configures the network with information enabling the UEs to access the Localized Services using the PNI-NPN or SNPN according to any validity of the Localized Services and the information is determined in agreement with the Localized Service Provider eg a Identification of each Localized Service eg to be used in URSP rules b validity restriction for each Localized Service eg the validity of time andor location c service parameters for each Localized Service eg DNN S-NSSAI and QoS requirements d service authorization methods eg NSSAA or Secondary authenticationauthorization during PDU Session establishment To allow the UE to access the PNI-NPN providing access to Localized Services using credentials of the HPLMN the PNI-NPN can be configured based on the Localized Service agreements between the PNI-NPN and the HPLMN to allow primary authentication towards the HPLMN To allow the UE to access the SNPN providing access to Localized Services using credentials of the Credentials Holder the SNPN can be configured based on Localized Service agreements between the SNPN and the Credentials Holder to allow primary authentication towards the Credentials Holder To allow the UE to access the SNPN providing access to Localized Services when new credential is required the SNPN can provide UE onboarding function as specified in clause 530210 for the UE to obtain credential and necessary information to access the SNPN or the UE can leverage existing credential and network connection to get access to a PVS via User Plane to obtain new credential To allow the UE to access the PNI-NPN providing access to the Localized Services where NSSAA or secondary authenticationauthorization during PDU session establishment is required the UE can obtain new credential using remote provisioning functionality as defined in clause 539 To allow the UE to access the HPLMN or subscribed SNPN services while being registered in the PNI-NPN or SNPN the PNI-NPN or SNPN can establish service agreements and configure inter-connect with the HPLMN or subscribed SNPN operator If a PNI-NPN is providing access to the Localized Services the existing roaming architecture with home-routed PDU Sessions are used If an SNPN is providing access to the Localized Services then the UE can access HPLMN or subscribed SNPN as described in Annex D clauses D3 D6 and D7 N22 Configuration of network to provide access to Localized Services For configuring the PNI-NPN or SNPN eg creation of network sliceDNN for carrying Localized Service traffic existing OAM mechanisms can be re-used as per TS 28557 148 clause 631 that provides a solution for NPN provisioning by a network slice of a PLMN and for exposure of management capability of PNI-NPN clause 632",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2015",
    "document_id": "23501-i80",
    "chunk_id": 2015,
    "text": "The attributes to support this management is further documented in TS 28541 149 N23 Session Management aspects For session management level information and interactions such as monitoring the PNI-NPN or SNPN performance and enabling suitable QoS for UE in the PNI-NPN or SNPN for Localized Service the following non-exhaustive options can be used - Covered by the SLA between the PNI-NPN or SNPN operator and the Localized Service Provider - Reuse the existing network exposure procedures as specified in TS 23502 3 clause 415 where the Localized Service Provider is taking the AF role and utilizing the exposure capability provided by the PNI-NPN or SNPN - Enable NEFPCF in the PNI-NPN or SNPN providing access to the Localized Services via AF of the Localized Service Provider to receive and forward the validity conditions and QoS requirements of the Localized Services to the AMFSMF by reusing the existing PCF initiated AMSM policy association procedures described in TS 23502 3 clause 416 N3 Selection of network providing access to Localized Services",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2016",
    "document_id": "23501-i80",
    "chunk_id": 2016,
    "text": "The UE selects an SNPN providing access for Localized Services as described in clause 530242 clause 530243 and in TS 23122 17 N4 Enabling the UE access to Localized Services The access to a Localized Service is made available in a specific area andor a specific period of time After the UE has successfully registered to a PNI-NPNSNPN providing access to the Localized Service the UE can be configured with URSP rules using existing principles see clause 6622 of TS 23503 45 The URSP rules can include an association between the UE application and the DNNS-NSSAI which is meant for a particular Localized Service The URSP rules can also include Route Selection Validation Criteria as described in Table 6621-3 of TS 23503 45 with the timelocation defined for the particular Localized Service",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2017",
    "document_id": "23501-i80",
    "chunk_id": 2017,
    "text": "The existing LADN feature described in clause 565 can also be used for enabling the UE access to Localized Service which is defined by a LADN DNN The S-NSSAI used for a Localized Service can be restricted to a specific area and time as described in clause 515 N5 Support for leaving network that provides access to Localized Services When Localized Services in a network are completed all UEs that are registered with the network are expected to be transferred to other network or to other network resources eg other cells within the same network potentially within a relatively short timeframe The other network can be HPLMN VPLMN or another SNPN UE can stop using the network resources for Localized Services for numerous reasons eg when one or more of the following conditions apply - Localized Services in a network are completed - Validity conditions of network selection information are no longer met -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2018",
    "document_id": "23501-i80",
    "chunk_id": 2018,
    "text": "The user decides to stop using the Localized Services before they are completed - A policy decision is taken by the network with the effect that the UE is deregistered before the Localized Services are completed NOTE",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2019",
    "document_id": "23501-i80",
    "chunk_id": 2019,
    "text": "The list is not an exhaustive list and UE can stop using the network resources for Localized Services due to other reasons eg UE loses coverage power off When large number of UEs move to other network ie HPLMN VPLMN or another SNPN or other network resources within a relatively short timeframe the total signalling involved can cause signalling overload in the target network Existing mechanisms for Control Plane Load Control Congestion and Overload Control described in clause 519 and access control and barring described in clause 525 can be used to mitigate the signalling overload caused by returning UEs For further enhancement of mitigation of signalling overload additional mechanisms can be implemented to ensure spreading of the load that returning UEs cause Such mechanisms are implementation-specific but some guidelines that can be considered are described below - The time validity of the network selection information given to a UE can be set somewhat longer than the actual duration of the service eg users will by themselves disable Localized Service and the UE then stops using the connectivity to access the Localized Service thus causing the UE to be moved eg by performing normal network selection -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2020",
    "document_id": "23501-i80",
    "chunk_id": 2020,
    "text": "The time validity of the network selection information given to a UE can be different for each UE so that each UE performs network selection at a different time to distribute returning UEs - When the AMF after end of Localized Services triggers deregistration of UEs the deregistration requests can be sent at a certain rate in an adaptive and distributed manner with the effect that the signalling load on both the source network and the target network is limited - When the AMF after end of Localized Services triggers UE configuration update procedure eg to remove S-NSSAI from the Allowed NSSAI if dedicated S-NSSAI is used for the Localized Service the requests can be sent at a certain rate with the effect that the signalling load in the network is limited When the NAS level congestion control is activated at AMF as specified in clause 51972 to prevent a UE staying in an SNPN for accessing for Localized Services but not able to get services from the SNPN due to the congestion additional mechanism can be implemented Such mechanisms are implementation-specific but some guidelines that can be considered are described below - the AMF can determine whether to reject the UE with a proper cause without Mobility Management back-off timer to allow the UE to reselect another SNPN for Localized Services N6 Configuration of Credentials Holder for determining SNPN selection information To enable the HPLMN or the subscribed SNPN acting as Credentials Holder to generate and provision UEs with SNPN selection information for discovery and selection of SNPNs providing Localized Services based on Localized Service agreements between the Localized Service Provider or the SNPN providing Localized Services and the HPLMN or the subscribed SNPN acting as Credentials Holder the Localized Service Provider or the SNPN providing access to Localized Services can provide configuration information for SNPN selection to the HPLMN or the subscribed SNPN acting as Credentials Holder The configuration information for SNPN selection may contain at least one of the following parameters a SNPN ID or GIN of the SNPN providing access to one or more Localized Services b Identification of each Localized Service c validity information eg time validity information and optionally location validity information for each Localized Service andor location assistance information andor",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2021",
    "document_id": "23501-i80",
    "chunk_id": 2021,
    "text": "d List of UE IDs eg GPSIs or External Group ID identifying the UEs subscribed with a Localized Service NOTE How HPLMN or subscribed SNPN obtains the information above as part of the Localized Service agreements is out of 3GPP scope",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2022",
    "document_id": "23501-i80",
    "chunk_id": 2022,
    "text": "The operator of the HPLMN or the subscribed SNPN acting as Credentials Holder then may use the information received from the SNPN providing Localized Services andor Localized Service Provider to create or update the Credentials Holder controlled prioritized lists of preferred SNPNsGINs for accessing Localized Services and provision the UEs using the Steering of Roaming procedure as defined in TS 23122 17 Annex O informative Allowing UE to simultaneously send data to different groups with different QoS policy This Annex provides deployment examples allowing a UE to simultaneously send data to different groups ie IP or Ethernet multicast groups with different QoS policy as in clause 6132 of TS 22261 2 O1 A PDU Session with multiple QoS Flows for different groups In case the UE Application sends individual copies of data to different receivers 5GS allows UE to simultaneously send data to different groups with different QoS policy via the following - If different groups IP or Ethernet multicast groups are associated to the same DNN and S-NSSAI combination used for a 5G VN group then different QoS Flows of a single PDU Session may be used to transfer the data copy sent to different groups Figure O1-1 shows a PDU Session with multiple QoS Flows for different groups as an example - Group1 G1 a group of multicast address 1 with members UE1 and UE2 is associated with 5GVNA group The QoS for multicast address 1 is set to QoS1 For G1 its members multicast address 1 and corresponding QoS1 are provisioned as part of the AF requested QoS information as described in clause 61328 of TS 23503 45 - Group2 G2 a group of multicast address 2 with members UE1 and UE3 is associated with 5GVNA group The QoS for multicast address 2 is set to QoS2 For G2 its members",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2023",
    "document_id": "23501-i80",
    "chunk_id": 2023,
    "text": "multicast address 2 and corresponding QoS2 are provisioned as part of the AF requested QoS information as described in clause 61328 of TS 23503 45 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2024",
    "document_id": "23501-i80",
    "chunk_id": 2024,
    "text": "During establishment or modification procedure for PDU Sessions targeting to DNN and S-NSSAI for 5GVNA group or upon detection of the UE joining a multicast address the SMF and PCF can jointly use the AF requested QoS information for 5GVNA group to set up the QoS flow in respective members PDU Session As a result - There will have two QoS flows in UE1s PDU Session targeting to DNN and S-NSSAI for 5GVNA group one QoS flow QoS Flow 11 is used to carry data destined to multicast address 1 with QoS1 the other one QoS Flow 12 is used to carry data destined to multicast address 2 with QoS2 - There will have one QoS flow QoS Flow 2 in UE2s PDU Session targeting to DNN and S-NSSAI for 5GVNA group this QoS flow is used to carry data destined to multicast address 1 with QoS1 - There will have one QoS flow QoS Flow 3 in UE3s PDU Session targeting to DNN and S-NSSAI for 5GVNA group this QoS flow is used to carry data destined to multicast address 2 with QoS2 - UE1 sends data with multicast address 1 MA1 to a UPF via QoS Flow 11 of UE1s PDU session for 5GVNA group The UPF forwards the packet to UE2 as it is a member of multicast group represented by multicast address 1 via QoS Flow 2 of UE2s PDU Session for 5GVNA group - UE1 also sends the same data with multicast address 2 MA2 to the UPF via QoS Flow 12 of the same PDU Session for 5GVNA group The UPF forwards the packet to UE3 as it is a member of multicast group represented by multicast address 2 via QoS Flow 3 of UE3sPDU Session for 5GVNA group Figure O1-1 A PDU Session with multiple QoS Flows for different groups O2 Multiple PDU Sessions for different groups In the case that the UE Application sends individual copies of data to different receivers 5GS allows UE to simultaneously send data to different groups with different QoS policy via the following - If different groups IP or Ethernet multicast groups are associated to different DNN and S-NSSAI combinations used for different 5G VN groups then different PDU Sessions are used to transfer the data copy sent to different groups As a result the UE sends the same data to different groups using the QoS Flow of the respective PDU Sessions Figure O2-1 shows multiple PDU sessions used for different groups as an example - Group1 G1 a group of multicast address 1 with members UE1 and UE2 is associated with 5GVN1 group The QoS for multicast address 1 is set to QoS1 For G1 its members multicast address 1 and corresponding QoS1 are provisioned as part of the AF requested QoS information as described in clause 61328 of TS 23503 45 - Group2 G2 a group of multicast address 2 with members UE1 and UE3 is associated with 5GVN2 group The QoS for multicast address 2 is set to QoS2 For G2 its members multicast address 2 and corresponding QoS2 are provisioned as part of the AF requested QoS information as described in clause 61328 of TS 23503 45 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2025",
    "document_id": "23501-i80",
    "chunk_id": 2025,
    "text": "During establishment or modification procedure for PDU Sessions targeting to DNN and S-NSSAI for 5GVN1 group or upon detection of the UE joining a multicast address the SMF and PCF can jointly use the AF requested QoS information for 5GVN1 group to set up the QoS flow in respective members PDU Session",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2026",
    "document_id": "23501-i80",
    "chunk_id": 2026,
    "text": "During establishment or modification procedure for PDU Sessions targeting to DNN and S-NSSAI for 5GVN2 group or upon detection of the UE joining a multicast address the SMF and PCF can jointly use the AF requested QoS information for 5GVN2 group to set up the QoS flow in respective members PDU Session As a result - There will have two PDU Sessions for UE1 one PDU Session is targeting to DNN and S-NSSAI for 5GVN1 group and there will have one QoS flow setup to carry data destined to multicast address 1 with QoS1 the other PDU Session is targeting to DNN and S-NSSAI for 5GVN2 group and there will have one QoS flow setup to carry data destined to multicast address 2 with QoS2 - There will have one PDU Session for UE2 this PDU Session is targeting to DNN and S-NSSAI for 5GVN1 group and there will have one QoS flow setup to carry data destined to multicast address 1 with QoS1 - There will have one PDU Session for UE3 this PDU Session is targeting to DNN and S-NSSAI for 5GVN2 group and there will have one QoS flow setup to carry data destined to multicast address 2 with QoS2 - UE1 sends data with multicast address 1 MA1 to a UPF via the QoS Flow of UE1s PDU session for 5GVN1 group The UPF forwards the packet to UE2 as it is a member of multicast group represented by multicast address 1 via the QoS Flow of UE2s PDU Session for 5GVN1 group - UE1 also sends the same data with multicast address 2 MA2 to the UPF via the QoS Flow of UE1s PDU Session for 5GVN2 group The UPF forwards the packet to UE3 as it is a member of multicast group represented by multicast address 2 via the QoS Flow of UE3s PDU Session for 5GVN2 group Figure O2-1 Multiple PDU Sessions for different groups O3 A PDU Session targeting a predefined group formed of multiple sub-groups In the case when the UE Application uses IP or Ethernet multicast 5GS allows UE to simultaneously send data to different groups with different QoS policy via the following - UE establishes a PDU Session to a DNN and S-NSSAI which can be a special DNN and S-NSSAI configured by the operator for eg an electrical system The DNN and S-NSSAI is associated with a 5GVN group which is defined as a combination of multiple sub-groups IP or Ethernet",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2027",
    "document_id": "23501-i80",
    "chunk_id": 2027,
    "text": "multicast groups - The 5G VN group and each sub-group is associated with a separate multicast address and QoS the QoS for a 5G VN group is set to refer to the QoS of the sub-group that has the strictest QoS requirements among all the sub-group groups When a UE belongs to multiple groups the QoS provisioning for the groups needs to be done in the order that enables the the strictest QoS profile to be selected for the UE For each group its members multicast address corresponding QoS information associated DNN and S-NSSAI are provisioned as part of the AF requested QoS information as described in clause 61328 of TS 23503 45 - The application sends traffic to a multicast address depending on which groups it wants to target For example an application sends traffic to the multicast address associated with the 5G VN group",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2028",
    "document_id": "23501-i80",
    "chunk_id": 2028,
    "text": "This allows an application to send a single packet reaching multiple destinations and also multiple groups Figure O3-1 shows a PDU Session targeting a predefined group formed of multiple sub-groups as an example - Group1 G1 a group of multicast address 1 with members UE1 and UE2 is associated with mapped to 5GVN1 group The QoS for the group is set to QoS1 For G1 its members multicast address 1 corresponding QoS1 DNN and S-NSSAI are provisioned as part of the AF requested QoS information for 5GVN1 group as described in clause 61328 of TS 23503 45 - Group2 G2 a group of multicast address 2 with members UE1 and UE3 is associated with mapped to 5GVN2 group The QoS for the group is set to QoS2 For G2 its members multicast address 2 and corresponding QoS2 DNN and S-NSSAI are provisioned as part of the AF requested QoS information for 5GVN2 group as described in clause 61328 of TS 23503 45 - GroupA GA a group of multicast address A with members UE1 UE2 and UE3 is associated with 5GVNA group G1 and G2 are combined to form the GA The QoS for the 5GVNA group is indicated to refer to the strictest QoS among other groups the UE belongs to For GA its members multicast address A and corresponding QoS indication DNN and S-NSSAI are provisioned as part of the AF requested QoS information for 5GVNA group as described in clause 61328 of TS 23503 45 -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2029",
    "document_id": "23501-i80",
    "chunk_id": 2029,
    "text": "During establishment or modification procedure for PDU Sessions targeting to the DNN and S-NSSAI or upon detection of the UE joining a multicast address the SMF and PCF can jointly use the AF requested QoS information to set up the QoS flow in respective members PDU Session As a result - There will have two QoS flows in UE1s PDU Session targeting to DNN and S-NSSAI one QoS flow is used to carry data destined to multicast address 1 with QoS1 the other one is used to carry data destined to multicast address 2 with QoS2 With the QoS indication for GA the higher QoS between QoS1 of G1 and QoS2 of G2 is selected for UE1 since the UE1 belongs to both the G1 and G2 then the QoS flow with higher QoS requirements QoS Flow 1 is also used to carry data destined to multicast address A - There will have one QoS flow in UE2s PDU Session targeting to DNN and S-NSSAI this QoS flow QoS Flow 2 is used to carry data destined to multicast address 1 with QoS1 With the QoS indication for GA the QoS1 of G1 is selected for UE1 since the UE2 only belongs to G1 then the same QoS flow is also used to carry data destined to multicast address",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2030",
    "document_id": "23501-i80",
    "chunk_id": 2030,
    "text": "A - There will have one QoS flow in UE3s PDU Session targeting to DNN and S-NSSAI this QoS flow QoS Flow 3 is used to carry data destined to multicast address 2 with QoS2 With the QoS indication for GA the QoS2 of G2 is selected for UE3 since the UE3 only belongs to G2 then the same QoS flow is also used to carry data destined to multicast address A - UE1 sends data with multicast address A MAA to a UPF via QoS Flow 1 of UE1s PDU Session for 5GVNA group The UPF forwards the packet to UE2 as it is a member of multicast group represented by multicast address A MAA via the QoS Flow 2 of UE2s PDU Session and forwards the packet to UE3 as it is a member of the multicast group represented by multicast address A MAA via the QoS Flow 3 of UE3s PDU Session Figure O3-1 A PDU Session targeting a predefined group formed of multiple sub-groups Annex P informative Personal IoT Networks P1 PIN Reference Architecture Figure P1-1 shows the logical Personal IoT Network PIN reference architecture Figure P1-1 PIN reference architecture A PIN consists of one or more devices providing gatewayrouting functionality known as the PEGC to route the traffic towards the 5G network and one or more devices providing PIN management functionality known as the PEMC to manage the PIN and devices enabling communication within the PIN called the PINE A PINE and PEMC can be a non-3GPP device The PIN can also have an AF for PIN see TS 23542 181",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2031",
    "document_id": "23501-i80",
    "chunk_id": 2031,
    "text": "The AF for PIN can be deployed by mobile operator or by an authorized third party When the AF for PIN is deployed by third party the interworking with 5GC is performed via the NEF With PIN-DN communication the PEMC and PEGC communicates with the AF for PIN at the application layer over the user plane The PEGC and PEMC can communicate with each other via PIN direct communication using 3GPP access eg PC5 or non-3GPP access eg WiFi BT or via PIN indirect communication using a PDU Session in the 5GS P2 Session management and traffic routing for PIN The general session management principles as described in clause 56 the QoS model as defined in clause 57 and the User Plane management for 5GS as defined in clause 58 are applicable to PIN-DN communication and PIN indirect communication If a PIN has multiple PEGCs 5G VN group communication mechanisms can be used for PIN indirect communication In this case a dedicated SMF set is used for managing the PIN related PDU Sessions from all the PEGCs of that PIN and the PDU session management principles for 5G VN-LAN-type services as specified in clause 5293 are applicable The user plane handling for 5G LAN-type services as specified in 5294 are applicable with following differences -",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2032",
    "document_id": "23501-i80",
    "chunk_id": 2032,
    "text": "For PIN indirect communication N19-based traffic forwarding is not used ie the PIN traffic is forwarded using - N6-based traffic forwarding method where the ULDL traffic for the PIN communication is forwarded tofrom the DN - local switching as depicted in Figure P2-1 below following the principles of local switching of traffic for 5G VN LAN-type service Figure P2-1 Local-switch based user plane architecture for PIN NOTE Figure P2-1 does not show traffic from a PEMC",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2033",
    "document_id": "23501-i80",
    "chunk_id": 2033,
    "text": "The SMF configures the UPFs to apply N6-based traffic forwarding to route traffic between PDU Sessions of different PEGCs of a PIN as specified in clause 58213 The SMF can apply local switching as specified in clause 58213 in order to enable UPF locally forward uplink stream from one PDU session of one PEGC of a PIN as downlink stream of PDU session of one or more PEGCs of the same PIN For local switching of PIN traffic between PIN related PDU sessions from different PEGCs of a single PIN based on the DNN S-NSSAI combination that is used for the PDU session related to PIN the SMF provides a Network Instance to the UPF in FAR andor PDR via N4 Session EstablishmentModification procedures Annex Q informative Satellite coverage availability information The protocol and format of satellite coverage availability information to be provisioned to the UE via PDU session or SMS is not defined in this release of the specification but this annex provides some examples on the information that constitutes input to the source of satellite coverage availability information eg external server and the output it provides to the UE Satellite coverage availability information can be indicated to the UE by indications corresponding to whether or not coverage is available for a specific satellite RAT Type for a particular location and time where - These indications can be Boolean True eg coverage available and False coverage not available - locations can correspond to grid points in a fixed array eg rectangular hexagonal - Coverage availability times may occur at fixed periodic intervals and - Coverage availability information is per RAT Type",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2034",
    "document_id": "23501-i80",
    "chunk_id": 2034,
    "text": "The information provisioned to the UE can include coverage information on only one PLMN or multiple PLMNs If Satellite coverage availability information indicates coverage is available then additional information on whether PLMN is allowed to operate in that location can be provided to the UE In order for the source of satellite coverage availability information to provide accurate information to the UE a UE might indicate for example the following information to a source of satellite coverage availability information eg an external server - Serving PLMN ID if not already known or implied - One or more satellite RAT Types where satellite coverage availability information is then expected for these one or more RAT Types - List of supported satellite frequency bands if not implied by the particular RAT Types - Present UE location eg latitude and longitude for a reference grid point eg the most",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2035",
    "document_id": "23501-i80",
    "chunk_id": 2035,
    "text": "Southerly and then most Westerly grid point - Type of Array eg rectangular or hexagonal - Minimum elevation angle Based on the above information provided by the UE satellite coverage availability information could be delivered to the UE as a sequence of time durations for each grid point where each time duration includes an indication of coverage availability or unavailability one example of many alternatives as illustrated below for a particular grid point with N different durations Satellite coverage availability information at a given grid point N Binary 0 or 1Duration 1 Binary 0 or 1Duration 2 Binary 0 or 1Duration N",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  },
  {
    "id": "23501-i80_chunk_2036",
    "document_id": "23501-i80",
    "chunk_id": 2036,
    "text": "The above would be concatenated for all of the grid points to produce the satellite coverage availability information When SMS is used to deliver the satellite coverage availability information the UE input and satellite coverage availability information output can be delivered in a series of concatenated SMS messages using possibly the same format Annex R informative Change history",
    "metadata": {
      "source": "0_spec/23501-i80.docx"
    }
  }
]